VERSION 5.00
Object = "{7D622DE6-0ABC-471E-9234-97DEC5E0A708}#3.8#0"; "sevCmd3.ocx"
Object = "{00025600-0000-0000-C000-000000000046}#5.2#0"; "CRYSTL32.OCX"
Object = "{648A5603-2C6E-101B-82B6-000000000014}#1.1#0"; "mscomm32.ocx"
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "threed32.ocx"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.2#0"; "MSCOMCTL.OCX"
Object = "{0ECD9B60-23AA-11D0-B351-00A0C9055D8E}#6.0#0"; "mshflxgd.ocx"
Object = "{248DD890-BB45-11CF-9ABC-0080C7E7B78D}#1.0#0"; "MSWINSCK.OCX"
Begin VB.Form frmWKL20 
   BackColor       =   &H00C0C0C0&
   ClientHeight    =   8880
   ClientLeft      =   525
   ClientTop       =   0
   ClientWidth     =   12285
   ControlBox      =   0   'False
   ForeColor       =   &H00000000&
   LinkTopic       =   "Form1"
   Moveable        =   0   'False
   PaletteMode     =   1  'ZReihenfolge
   ScaleHeight     =   8880
   ScaleWidth      =   12285
   StartUpPosition =   2  'Bildschirmmitte
   Begin VB.Frame Frame3 
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      Height          =   1815
      Left            =   360
      TabIndex        =   40
      Top             =   3600
      Width           =   12255
      Begin VB.PictureBox Picture4 
         BackColor       =   &H00C0FFC0&
         BorderStyle     =   0  'Kein
         FontTransparent =   0   'False
         Height          =   855
         Left            =   5400
         MouseIcon       =   "frmWKL20.frx":0000
         MousePointer    =   99  'Benutzerdefiniert
         ScaleHeight     =   855
         ScaleWidth      =   975
         TabIndex        =   585
         Top             =   960
         Width           =   975
      End
      Begin VB.PictureBox Picture2 
         BackColor       =   &H00C0C0FF&
         BorderStyle     =   0  'Kein
         FontTransparent =   0   'False
         Height          =   855
         Left            =   4320
         MouseIcon       =   "frmWKL20.frx":030A
         MousePointer    =   99  'Benutzerdefiniert
         ScaleHeight     =   855
         ScaleWidth      =   975
         TabIndex        =   459
         Top             =   960
         Width           =   975
      End
      Begin sevCommand3.Command Command2 
         Height          =   495
         Index           =   17
         Left            =   1200
         TabIndex        =   394
         Top             =   360
         Visible         =   0   'False
         Width           =   735
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox txtStatus 
         Height          =   315
         Left            =   600
         TabIndex        =   381
         Top             =   0
         Visible         =   0   'False
         Width           =   495
      End
      Begin VB.PictureBox picprogress 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   3.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   135
         Left            =   9120
         ScaleHeight     =   75
         ScaleWidth      =   2595
         TabIndex        =   380
         Top             =   0
         Visible         =   0   'False
         Width           =   2655
      End
      Begin VB.TextBox Text1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Index           =   0
         Left            =   1200
         MaxLength       =   3
         TabIndex        =   0
         Top             =   360
         Width           =   735
      End
      Begin VB.TextBox Text1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Index           =   1
         Left            =   9120
         MaxLength       =   18
         TabIndex        =   1
         Top             =   360
         Visible         =   0   'False
         Width           =   2655
      End
      Begin VB.PictureBox Picture1 
         Appearance      =   0  '2D
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'Kein
         ForeColor       =   &H80000008&
         Height          =   285
         Index           =   1
         Left            =   6720
         MouseIcon       =   "frmWKL20.frx":0614
         MousePointer    =   99  'Benutzerdefiniert
         Picture         =   "frmWKL20.frx":091E
         ScaleHeight     =   285
         ScaleWidth      =   285
         TabIndex        =   451
         Top             =   960
         Visible         =   0   'False
         Width           =   285
      End
      Begin VB.PictureBox Picture1 
         Appearance      =   0  '2D
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'Kein
         ForeColor       =   &H80000008&
         Height          =   285
         Index           =   2
         Left            =   6960
         MouseIcon       =   "frmWKL20.frx":09A8
         MousePointer    =   99  'Benutzerdefiniert
         Picture         =   "frmWKL20.frx":0CB2
         ScaleHeight     =   285
         ScaleWidth      =   285
         TabIndex        =   452
         Top             =   960
         Visible         =   0   'False
         Width           =   285
      End
      Begin VB.PictureBox Picture1 
         Appearance      =   0  '2D
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'Kein
         ForeColor       =   &H80000008&
         Height          =   285
         Index           =   3
         Left            =   7200
         MouseIcon       =   "frmWKL20.frx":0D3C
         MousePointer    =   99  'Benutzerdefiniert
         Picture         =   "frmWKL20.frx":1046
         ScaleHeight     =   285
         ScaleWidth      =   285
         TabIndex        =   453
         Top             =   960
         Visible         =   0   'False
         Width           =   285
      End
      Begin VB.PictureBox Picture1 
         Appearance      =   0  '2D
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'Kein
         ForeColor       =   &H80000008&
         Height          =   285
         Index           =   4
         Left            =   7440
         MouseIcon       =   "frmWKL20.frx":10D0
         MousePointer    =   99  'Benutzerdefiniert
         Picture         =   "frmWKL20.frx":13DA
         ScaleHeight     =   285
         ScaleWidth      =   285
         TabIndex        =   454
         Top             =   960
         Visible         =   0   'False
         Width           =   285
      End
      Begin VB.PictureBox Picture1 
         Appearance      =   0  '2D
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'Kein
         ForeColor       =   &H80000008&
         Height          =   285
         Index           =   5
         Left            =   7680
         MouseIcon       =   "frmWKL20.frx":1464
         MousePointer    =   99  'Benutzerdefiniert
         Picture         =   "frmWKL20.frx":176E
         ScaleHeight     =   285
         ScaleWidth      =   285
         TabIndex        =   455
         Top             =   960
         Visible         =   0   'False
         Width           =   285
      End
      Begin VB.Label Label39 
         Alignment       =   2  'Zentriert
         BackStyle       =   0  'Transparent
         Caption         =   "12"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   8280
         TabIndex        =   611
         Top             =   165
         Width           =   255
      End
      Begin VB.Shape Shape3 
         BackColor       =   &H0080C0FF&
         BackStyle       =   1  'Undurchsichtig
         Height          =   255
         Left            =   8280
         Top             =   120
         Width           =   255
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Notizen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   495
         Index           =   28
         Left            =   6720
         TabIndex        =   594
         Top             =   2040
         Visible         =   0   'False
         Width           =   5175
      End
      Begin VB.Label Label39 
         Alignment       =   2  'Zentriert
         BackStyle       =   0  'Transparent
         Caption         =   "12"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   4
         Left            =   7845
         TabIndex        =   586
         Top             =   165
         Width           =   255
      End
      Begin VB.Label Label39 
         Alignment       =   2  'Zentriert
         BackStyle       =   0  'Transparent
         Caption         =   "12"
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   3
         Left            =   7560
         TabIndex        =   587
         Top             =   165
         Width           =   255
      End
      Begin VB.Shape Shape1 
         BackColor       =   &H0000FFFF&
         BackStyle       =   1  'Undurchsichtig
         Height          =   255
         Left            =   7560
         Top             =   120
         Width           =   255
      End
      Begin VB.Shape Shape2 
         BackColor       =   &H0080C0FF&
         BackStyle       =   1  'Undurchsichtig
         Height          =   255
         Left            =   7845
         Top             =   120
         Width           =   255
      End
      Begin VB.Image Image4 
         Height          =   300
         Left            =   3840
         Top             =   1800
         Visible         =   0   'False
         Width           =   450
      End
      Begin VB.Label Label2 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   1
         Left            =   3240
         TabIndex        =   46
         Top             =   960
         Visible         =   0   'False
         Width           =   735
      End
      Begin VB.Label Label2 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   3
         Left            =   3240
         TabIndex        =   48
         Top             =   1320
         Visible         =   0   'False
         Width           =   735
      End
      Begin VB.Image Image2 
         Height          =   300
         Left            =   3480
         Top             =   1680
         Visible         =   0   'False
         Width           =   450
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C0C0&
         Caption         =   "BedNr:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   0
         Left            =   120
         TabIndex        =   41
         Top             =   480
         Width           =   1095
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Titel"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   285
         Index           =   19
         Left            =   6000
         TabIndex        =   398
         Top             =   1320
         Visible         =   0   'False
         Width           =   855
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Provisionsartikel"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   18
         Left            =   960
         TabIndex        =   395
         Top             =   1680
         Visible         =   0   'False
         Width           =   2295
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C0C0&
         Caption         =   "KTEXT1"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Index           =   17
         Left            =   6720
         TabIndex        =   393
         Top             =   1875
         Visible         =   0   'False
         Width           =   5175
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Fil"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Index           =   15
         Left            =   10680
         TabIndex        =   384
         Top             =   1680
         Visible         =   0   'False
         Width           =   495
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Bonus"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Index           =   14
         Left            =   11160
         TabIndex        =   383
         Top             =   1680
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Strasse"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Index           =   13
         Left            =   8880
         TabIndex        =   379
         Top             =   1680
         Visible         =   0   'False
         Width           =   2055
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Ort"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Index           =   12
         Left            =   7080
         TabIndex        =   378
         Top             =   1680
         Visible         =   0   'False
         Width           =   1695
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "PLZ"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Index           =   11
         Left            =   6120
         TabIndex        =   377
         Top             =   1680
         Visible         =   0   'False
         Width           =   855
      End
      Begin VB.Label Label41 
         BackColor       =   &H00C0C0C0&
         Caption         =   "0"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   1
         Left            =   10680
         TabIndex        =   348
         Top             =   120
         Visible         =   0   'False
         Width           =   735
      End
      Begin VB.Label Label41 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Gesamtmenge:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   9120
         TabIndex        =   347
         Top             =   120
         Visible         =   0   'False
         Width           =   1455
      End
      Begin VB.Label Label8 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Label8"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   3
         Left            =   2400
         TabIndex        =   225
         Top             =   720
         Visible         =   0   'False
         Width           =   735
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   495
         Index           =   8
         Left            =   2040
         TabIndex        =   224
         Top             =   360
         Width           =   3375
      End
      Begin VB.Label Label8 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Label8"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   2
         Left            =   1680
         TabIndex        =   74
         Top             =   720
         Visible         =   0   'False
         Width           =   735
      End
      Begin VB.Label Label8 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Label8"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   1
         Left            =   840
         TabIndex        =   73
         Top             =   720
         Visible         =   0   'False
         Width           =   735
      End
      Begin VB.Label Label8 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Label8"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   72
         Top             =   720
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.Label Label2 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "0"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   290
         Index           =   7
         Left            =   10680
         TabIndex        =   65
         Top             =   1320
         Visible         =   0   'False
         Width           =   1095
      End
      Begin VB.Label Label1 
         Appearance      =   0  '2D
         BackColor       =   &H80000005&
         BorderStyle     =   1  'Fest Einfach
         Caption         =   "Kundenname"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H80000008&
         Height          =   285
         Index           =   7
         Left            =   6960
         TabIndex        =   64
         Top             =   1320
         Visible         =   0   'False
         Width           =   3495
      End
      Begin VB.Label Label2 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   6
         Left            =   9720
         TabIndex        =   54
         Top             =   960
         Visible         =   0   'False
         Width           =   2055
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Zsumme:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   8040
         TabIndex        =   53
         Top             =   960
         Visible         =   0   'False
         Width           =   1695
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Eingabe :"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   7440
         TabIndex        =   52
         Top             =   480
         Visible         =   0   'False
         Width           =   1455
      End
      Begin VB.Label Label2 
         BackColor       =   &H00C0C0C0&
         Caption         =   "1"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   5
         Left            =   6600
         TabIndex        =   51
         Top             =   480
         Visible         =   0   'False
         Width           =   975
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Menge:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   372
         Index           =   4
         Left            =   5400
         TabIndex        =   50
         Top             =   480
         Visible         =   0   'False
         Width           =   1212
      End
      Begin VB.Label Label2 
         BackColor       =   &H00C0C0C0&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   0
         Left            =   120
         TabIndex        =   45
         Top             =   1320
         Visible         =   0   'False
         Width           =   1095
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Gesamtrabatt:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   1200
         TabIndex        =   44
         Top             =   1320
         Visible         =   0   'False
         Width           =   2055
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C0C0&
         Caption         =   "Artikelrabatt:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   1560
         TabIndex        =   43
         Top             =   960
         Visible         =   0   'False
         Width           =   1695
      End
      Begin VB.Label Label1 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Sonderpreis"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   120
         TabIndex        =   42
         Top             =   960
         Visible         =   0   'False
         Width           =   1575
      End
      Begin VB.Label Label2 
         BackColor       =   &H00C0C0C0&
         Caption         =   " %"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   2
         Left            =   3960
         TabIndex        =   47
         Top             =   960
         Visible         =   0   'False
         Width           =   375
      End
      Begin VB.Label Label2 
         BackColor       =   &H00C0C0C0&
         Caption         =   " %"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   4
         Left            =   3960
         TabIndex        =   49
         Top             =   1320
         Visible         =   0   'False
         Width           =   375
      End
   End
   Begin VB.Timer TimerNetwork 
      Enabled         =   0   'False
      Interval        =   5000
      Left            =   2400
      Top             =   120
   End
   Begin VB.Frame Frame9 
      BackColor       =   &H00C0C000&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H0000FFFF&
      Height          =   855
      Left            =   0
      TabIndex        =   520
      Top             =   6120
      Visible         =   0   'False
      Width           =   3375
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   87
         Left            =   120
         TabIndex        =   521
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "!"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   86
         Left            =   960
         TabIndex        =   522
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "§"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   85
         Left            =   1800
         TabIndex        =   523
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "$"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   84
         Left            =   2640
         TabIndex        =   524
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "%"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   83
         Left            =   3480
         TabIndex        =   525
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "&&"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   82
         Left            =   4320
         TabIndex        =   526
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "/"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   81
         Left            =   5160
         TabIndex        =   527
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "("
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   80
         Left            =   6000
         TabIndex        =   528
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   ")"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   79
         Left            =   6840
         TabIndex        =   529
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "="
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   78
         Left            =   7680
         TabIndex        =   530
         Top             =   0
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "ß"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   61
         Left            =   8520
         TabIndex        =   531
         Top             =   0
         Width           =   1410
         _Version        =   65536
         _ExtentX        =   2487
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "RÜCKG"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   72
         Left            =   120
         TabIndex        =   532
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   71
         Left            =   960
         TabIndex        =   533
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "2"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   70
         Left            =   1800
         TabIndex        =   534
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "3"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   69
         Left            =   2640
         TabIndex        =   535
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "4"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   68
         Left            =   3480
         TabIndex        =   536
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "5"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   67
         Left            =   4320
         TabIndex        =   537
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "6"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   66
         Left            =   5160
         TabIndex        =   538
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "7"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   65
         Left            =   6000
         TabIndex        =   539
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "8"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   64
         Left            =   6840
         TabIndex        =   540
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "9"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   63
         Left            =   7680
         TabIndex        =   541
         Top             =   770
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "0"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   62
         Left            =   8520
         TabIndex        =   542
         Top             =   770
         Width           =   1410
         _Version        =   65536
         _ExtentX        =   2487
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "LEEREN"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   0
         Left            =   360
         TabIndex        =   543
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "Q"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   1
         Left            =   1200
         TabIndex        =   544
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "W"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   2
         Left            =   2040
         TabIndex        =   545
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "E"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   3
         Left            =   2880
         TabIndex        =   546
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "R"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   4
         Left            =   3720
         TabIndex        =   547
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "T"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   5
         Left            =   4560
         TabIndex        =   548
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "Z"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   6
         Left            =   5400
         TabIndex        =   549
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "U"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   7
         Left            =   6240
         TabIndex        =   550
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "I"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   8
         Left            =   7080
         TabIndex        =   551
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "O"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   9
         Left            =   7920
         TabIndex        =   552
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "P"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   10
         Left            =   8760
         TabIndex        =   553
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "Ü"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   11
         Left            =   9600
         TabIndex        =   554
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "*"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   12
         Left            =   10440
         TabIndex        =   555
         Top             =   1530
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "+"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   13
         Left            =   600
         TabIndex        =   556
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "A"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   14
         Left            =   1440
         TabIndex        =   557
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "S"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   15
         Left            =   2280
         TabIndex        =   558
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "D"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   16
         Left            =   3120
         TabIndex        =   559
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "F"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   17
         Left            =   3960
         TabIndex        =   560
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "G"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   18
         Left            =   4800
         TabIndex        =   561
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "H"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   19
         Left            =   5640
         TabIndex        =   562
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "J"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   20
         Left            =   6480
         TabIndex        =   563
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "K"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   21
         Left            =   7320
         TabIndex        =   564
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "L"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   22
         Left            =   8160
         TabIndex        =   565
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "Ö"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   23
         Left            =   9000
         TabIndex        =   566
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "Ä"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   24
         Left            =   9840
         TabIndex        =   567
         Top             =   2300
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "#"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   25
         Left            =   840
         TabIndex        =   568
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "Y"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   26
         Left            =   1680
         TabIndex        =   569
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "X"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   27
         Left            =   2520
         TabIndex        =   570
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "C"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   28
         Left            =   3360
         TabIndex        =   571
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "V"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   29
         Left            =   4200
         TabIndex        =   572
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "B"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   30
         Left            =   5040
         TabIndex        =   573
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "N"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   31
         Left            =   5880
         TabIndex        =   574
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "M"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   32
         Left            =   6720
         TabIndex        =   575
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   ","
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   33
         Left            =   7560
         TabIndex        =   576
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "-"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   34
         Left            =   8400
         TabIndex        =   577
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   " "
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   35
         Left            =   9240
         TabIndex        =   578
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "<<<"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   36
         Left            =   10080
         TabIndex        =   579
         Top             =   3060
         Width           =   810
         _Version        =   65536
         _ExtentX        =   1429
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   ">>>"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand100 
         Height          =   735
         Index           =   37
         Left            =   10680
         TabIndex        =   583
         Top             =   2300
         Width           =   1170
         _Version        =   65536
         _ExtentX        =   2064
         _ExtentY        =   1296
         _StockProps     =   78
         Caption         =   "A -> a"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin VB.Label Label3 
         BackColor       =   &H00C0C000&
         Caption         =   "-1"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   10440
         TabIndex        =   582
         Top             =   960
         Visible         =   0   'False
         Width           =   1455
      End
      Begin VB.Label Label3 
         BackColor       =   &H00FFFF00&
         Caption         =   "-1"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   1300
         TabIndex        =   581
         Top             =   360
         Visible         =   0   'False
         Width           =   1095
      End
      Begin VB.Label Label3 
         BackColor       =   &H00FFFF00&
         Caption         =   "Zielfeld:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   120
         TabIndex        =   580
         Top             =   360
         Visible         =   0   'False
         Width           =   1095
      End
   End
   Begin VB.Frame Frame4 
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      Height          =   1095
      Left            =   240
      TabIndex        =   486
      Top             =   6120
      Width           =   11415
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   16
         Left            =   120
         TabIndex        =   503
         Top             =   0
         Width           =   1185
         _Version        =   65536
         _ExtentX        =   2090
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "Storno"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   0
         Left            =   1320
         TabIndex        =   488
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "1"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   1
         Left            =   1920
         TabIndex        =   487
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "2"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   2
         Left            =   2520
         TabIndex        =   489
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "3"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   3
         Left            =   3120
         TabIndex        =   490
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "4"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   4
         Left            =   3720
         TabIndex        =   491
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "5"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   5
         Left            =   4320
         TabIndex        =   492
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "6"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   6
         Left            =   4920
         TabIndex        =   493
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "7"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   7
         Left            =   5520
         TabIndex        =   494
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "8"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   8
         Left            =   6120
         TabIndex        =   495
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "9"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   9
         Left            =   6720
         TabIndex        =   496
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "0"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   10
         Left            =   7320
         TabIndex        =   497
         Top             =   0
         Width           =   705
         _Version        =   65536
         _ExtentX        =   1235
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "00"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   11
         Left            =   8040
         TabIndex        =   498
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   ","
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   12
         Left            =   8640
         TabIndex        =   499
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "X"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   495
         Index           =   13
         Left            =   9240
         TabIndex        =   500
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1032
         _ExtentY        =   873
         _StockProps     =   78
         Caption         =   "<"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   14
         Left            =   9840
         TabIndex        =   501
         Top             =   0
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1023
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "C"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand2 
         Height          =   855
         Index           =   15
         Left            =   10440
         TabIndex        =   502
         Top             =   0
         Width           =   1335
         _Version        =   65536
         _ExtentX        =   2355
         _ExtentY        =   1508
         _StockProps     =   78
         Caption         =   "OK"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
      Begin Threed.SSCommand SSCommand3 
         Height          =   340
         Left            =   9240
         TabIndex        =   622
         Top             =   510
         Width           =   585
         _Version        =   65536
         _ExtentX        =   1032
         _ExtentY        =   609
         _StockProps     =   78
         Caption         =   "W"
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   1
      End
   End
   Begin VB.Frame Frame30 
      BackColor       =   &H00C000C0&
      BorderStyle     =   0  'Kein
      Height          =   1215
      Left            =   -120
      TabIndex        =   475
      Top             =   7920
      Visible         =   0   'False
      Width           =   1575
      Begin sevCommand3.Command Command9 
         Height          =   855
         Left            =   5040
         TabIndex        =   476
         Top             =   5880
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "OK"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label46 
         Alignment       =   2  'Zentriert
         BackColor       =   &H00C000C0&
         Caption         =   "Bitte überprüfen Sie den Preis!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   27.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   855
         Left            =   240
         TabIndex        =   480
         Top             =   360
         Width           =   11415
      End
      Begin VB.Label Label45 
         BackColor       =   &H00C000C0&
         Caption         =   "Was nun?"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   479
         Top             =   2040
         Width           =   2175
      End
      Begin VB.Label Label43 
         BackColor       =   &H00C000C0&
         Caption         =   "Ändern Sie in den Kassenverkaufspreis!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   478
         Top             =   3600
         Width           =   8895
      End
      Begin VB.Label Label42 
         BackColor       =   &H00C000C0&
         Caption         =   "Möchten Sie diese Meldung nicht mehr angezeigt bekommen?"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   477
         Top             =   3240
         Width           =   8175
      End
   End
   Begin VB.Frame Frame26 
      BackColor       =   &H000000C0&
      BorderStyle     =   0  'Kein
      Height          =   1935
      Left            =   3720
      TabIndex        =   466
      Top             =   6000
      Visible         =   0   'False
      Width           =   1575
      Begin sevCommand3.Command Command3 
         Height          =   855
         Left            =   5040
         TabIndex        =   467
         Top             =   5880
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "OK"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label38 
         BackColor       =   &H000000C0&
         Caption         =   "Oder"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   474
         Top             =   4320
         Width           =   2175
      End
      Begin VB.Label Label37 
         BackColor       =   &H000000C0&
         Caption         =   "Überprüfen Sie den hinterlegten Strichcode in den Artikeldaten."
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   473
         Top             =   4680
         Width           =   8895
      End
      Begin VB.Label Label36 
         BackColor       =   &H000000C0&
         Caption         =   "Möchten Sie diese Meldung nicht mehr angezeigt bekommen?"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   472
         Top             =   3240
         Width           =   8175
      End
      Begin VB.Label Label35 
         BackColor       =   &H000000C0&
         Caption         =   "Legen Sie diesen Artikel an!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   471
         Top             =   3600
         Width           =   8895
      End
      Begin VB.Label Label34 
         BackColor       =   &H000000C0&
         Caption         =   "Drücken Sie auf OK und Kassieren Sie diesen Preis über eine Warengruppe ab!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   470
         Top             =   2400
         Width           =   8895
      End
      Begin VB.Label Label32 
         BackColor       =   &H000000C0&
         Caption         =   "Was nun?"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   1560
         TabIndex        =   469
         Top             =   2040
         Width           =   2175
      End
      Begin VB.Label Label31 
         Alignment       =   2  'Zentriert
         BackColor       =   &H000000C0&
         Caption         =   "Der Artikel wurde nicht gefunden!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   27.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   855
         Left            =   360
         TabIndex        =   468
         Top             =   360
         Width           =   11415
      End
   End
   Begin VB.Frame Frame10 
      BackColor       =   &H00808000&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H0000FFFF&
      Height          =   4935
      Left            =   4680
      TabIndex        =   66
      Top             =   1200
      Visible         =   0   'False
      Width           =   6735
      Begin VB.CheckBox Check15 
         BackColor       =   &H00808000&
         Caption         =   "manuelle Eingabe der Kreditkartendaten"
         Height          =   255
         Left            =   240
         TabIndex        =   601
         Top             =   3120
         Visible         =   0   'False
         Width           =   4335
      End
      Begin VB.CheckBox chkEinzKarte 
         BackColor       =   &H00808000&
         Caption         =   "Einzahlung mit Karte"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   345
         Left            =   960
         TabIndex        =   596
         Top             =   2790
         Visible         =   0   'False
         Width           =   4935
      End
      Begin sevCommand3.Command cmdBonKK 
         Height          =   855
         Left            =   2760
         TabIndex        =   465
         Top             =   1680
         Visible         =   0   'False
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Bon"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   255
         Index           =   7
         Left            =   6600
         TabIndex        =   391
         Top             =   3360
         Width           =   375
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "P"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command5 
         Height          =   855
         Index           =   0
         Left            =   240
         TabIndex        =   69
         Top             =   1680
         Width           =   2415
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "OK"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command5 
         Height          =   855
         Index           =   1
         Left            =   4560
         TabIndex        =   70
         Top             =   1680
         Width           =   2415
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schließen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.CheckBox Check4 
         BackColor       =   &H00808000&
         Caption         =   "Ausdruck im DIN A4 Format"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Left            =   3720
         TabIndex        =   351
         Top             =   3360
         Width           =   2415
      End
      Begin VB.Frame Frame16 
         BackColor       =   &H00808000&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1095
         Left            =   360
         TabIndex        =   335
         Top             =   240
         Visible         =   0   'False
         Width           =   9615
         Begin VB.ComboBox cboVerfall 
            Height          =   315
            Left            =   3480
            TabIndex        =   607
            Text            =   "Combo2"
            Top             =   600
            Width           =   1455
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   9
            Left            =   1560
            MaxLength       =   35
            TabIndex        =   603
            Top             =   240
            Width           =   3375
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   8
            Left            =   1560
            MaxLength       =   4
            TabIndex        =   602
            Top             =   600
            Width           =   1095
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "gültig bis:"
            Height          =   255
            Index           =   10
            Left            =   2760
            TabIndex        =   606
            Top             =   600
            Width           =   1335
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Kartennummer:"
            Height          =   255
            Index           =   9
            Left            =   120
            TabIndex        =   605
            Top             =   240
            Width           =   1335
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Sicherheitscode:"
            Height          =   255
            Index           =   8
            Left            =   120
            TabIndex        =   604
            Top             =   600
            Width           =   1335
         End
      End
      Begin VB.CheckBox Check2 
         BackColor       =   &H00808000&
         Caption         =   "andere Rechnungsanschrift"
         Height          =   255
         Left            =   240
         TabIndex        =   275
         Top             =   3360
         Visible         =   0   'False
         Width           =   3375
      End
      Begin VB.Frame Frame13 
         BackColor       =   &H00808000&
         Caption         =   "Rechnungsanschrift"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2775
         Left            =   240
         TabIndex        =   260
         Top             =   3720
         Width           =   6735
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   7
            Left            =   2520
            MaxLength       =   10
            TabIndex        =   457
            Top             =   600
            Width           =   975
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   6
            Left            =   840
            MaxLength       =   10
            TabIndex        =   262
            Top             =   600
            Width           =   1095
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   5
            Left            =   840
            MaxLength       =   35
            TabIndex        =   261
            Top             =   240
            Width           =   3135
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   4
            Left            =   1200
            MaxLength       =   35
            TabIndex        =   272
            Top             =   2400
            Width           =   3255
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   3
            Left            =   120
            MaxLength       =   8
            TabIndex        =   270
            Top             =   2400
            Width           =   855
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   2
            Left            =   120
            MaxLength       =   35
            TabIndex        =   268
            Top             =   1800
            Width           =   3975
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   1
            Left            =   1680
            MaxLength       =   35
            TabIndex        =   266
            Top             =   1200
            Width           =   1455
         End
         Begin VB.TextBox Text2 
            Height          =   285
            Index           =   0
            Left            =   120
            MaxLength       =   35
            TabIndex        =   264
            Top             =   1200
            Width           =   1455
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Titel"
            Height          =   255
            Index           =   7
            Left            =   2040
            TabIndex        =   456
            Top             =   600
            Width           =   495
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Ort"
            Height          =   255
            Index           =   6
            Left            =   1200
            TabIndex        =   274
            Top             =   2160
            Width           =   615
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Plz"
            Height          =   255
            Index           =   5
            Left            =   120
            TabIndex        =   273
            Top             =   2160
            Width           =   735
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Straße"
            Height          =   255
            Index           =   4
            Left            =   120
            TabIndex        =   271
            Top             =   1560
            Width           =   1455
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Vorname"
            Height          =   255
            Index           =   3
            Left            =   1680
            TabIndex        =   269
            Top             =   960
            Width           =   1455
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Name"
            Height          =   255
            Index           =   2
            Left            =   120
            TabIndex        =   267
            Top             =   960
            Width           =   1455
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Anrede"
            Height          =   255
            Index           =   1
            Left            =   120
            TabIndex        =   265
            Top             =   600
            Width           =   735
         End
         Begin VB.Label Label24 
            BackStyle       =   0  'Transparent
            Caption         =   "Firma"
            Height          =   255
            Index           =   0
            Left            =   120
            TabIndex        =   263
            Top             =   240
            Width           =   735
         End
      End
      Begin VB.Frame Frame31 
         BackColor       =   &H00808000&
         Height          =   735
         Left            =   1920
         TabIndex        =   226
         Top             =   3840
         Visible         =   0   'False
         Width           =   4935
         Begin VB.Label Label19 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "0"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   12
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   375
            Index           =   2
            Left            =   3360
            TabIndex        =   229
            Top             =   240
            Width           =   1455
         End
         Begin VB.Label Label19 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "von"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   12
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   375
            Index           =   1
            Left            =   1680
            TabIndex        =   228
            Top             =   240
            Width           =   1455
         End
         Begin VB.Label Label19 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "0"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   12
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   375
            Index           =   0
            Left            =   120
            TabIndex        =   227
            Top             =   240
            Width           =   1455
         End
      End
      Begin VB.TextBox Text1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Index           =   4
         Left            =   4800
         MaxLength       =   18
         TabIndex        =   618
         Top             =   1800
         Width           =   1815
      End
      Begin VB.Label Label28 
         Alignment       =   2  'Zentriert
         BackColor       =   &H00808000&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   1695
         Left            =   120
         TabIndex        =   346
         Top             =   4800
         Width           =   6975
      End
      Begin VB.Label Label21 
         Alignment       =   2  'Zentriert
         BackColor       =   &H00808000&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   615
         Left            =   6360
         TabIndex        =   253
         Top             =   960
         Width           =   495
      End
      Begin VB.Label Label15 
         Alignment       =   2  'Zentriert
         BackColor       =   &H00808000&
         Caption         =   "LEER"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   615
         Left            =   120
         TabIndex        =   252
         Top             =   240
         Width           =   6615
      End
      Begin VB.Label Label6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00808000&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   615
         Index           =   1
         Left            =   2280
         TabIndex        =   68
         Top             =   960
         Width           =   3975
      End
      Begin VB.Label Label6 
         BackColor       =   &H00808000&
         Caption         =   "Summe:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   21.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   615
         Index           =   0
         Left            =   240
         TabIndex        =   67
         Top             =   960
         Width           =   1935
      End
   End
   Begin VB.Frame Frame33 
      BackColor       =   &H00C0E0FF&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H0000FFFF&
      Height          =   1695
      Left            =   7440
      TabIndex        =   233
      Top             =   5280
      Width           =   2055
      Begin VB.ListBox List7 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   660
         Left            =   120
         TabIndex        =   621
         Top             =   840
         Width           =   975
      End
      Begin VB.TextBox txtZollEr 
         Alignment       =   1  'Rechts
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   360
         Left            =   120
         MaxLength       =   9
         TabIndex        =   599
         Top             =   360
         Width           =   1335
      End
      Begin VB.Frame Frame40 
         BackColor       =   &H00C0E0FF&
         Height          =   2055
         Left            =   360
         TabIndex        =   504
         Top             =   5400
         Width           =   9735
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   0
            Left            =   600
            TabIndex        =   505
            ToolTipText     =   "1 Cent"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "0,01"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   1
            Left            =   1680
            TabIndex        =   506
            ToolTipText     =   "2 Cent"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "0,02"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   2
            Left            =   2760
            TabIndex        =   507
            ToolTipText     =   "5 Cent"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "0,05"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   3
            Left            =   3840
            TabIndex        =   508
            ToolTipText     =   "10 Cent"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "0,10"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   4
            Left            =   4920
            TabIndex        =   509
            ToolTipText     =   "20 Cent"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "0,20"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   5
            Left            =   6000
            TabIndex        =   510
            ToolTipText     =   "50 Cent"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "0,50"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   6
            Left            =   7080
            TabIndex        =   511
            ToolTipText     =   "1 Euro"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "1"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   975
            Index           =   7
            Left            =   8160
            TabIndex        =   512
            ToolTipText     =   "2 Euro"
            Top             =   120
            Width           =   1020
            _Version        =   65536
            _ExtentX        =   1799
            _ExtentY        =   1720
            _StockProps     =   78
            Caption         =   "2"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   735
            Index           =   8
            Left            =   0
            TabIndex        =   513
            ToolTipText     =   "5 Euro"
            Top             =   1200
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   1296
            _StockProps     =   78
            Caption         =   "5"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   735
            Index           =   9
            Left            =   1410
            TabIndex        =   514
            ToolTipText     =   "10 Euro"
            Top             =   1200
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   1296
            _StockProps     =   78
            Caption         =   "10"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   735
            Index           =   10
            Left            =   2820
            TabIndex        =   515
            ToolTipText     =   "20 Euro"
            Top             =   1200
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   1296
            _StockProps     =   78
            Caption         =   "20"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   735
            Index           =   11
            Left            =   4220
            TabIndex        =   516
            ToolTipText     =   "50 Euro"
            Top             =   1200
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   1296
            _StockProps     =   78
            Caption         =   "50"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   735
            Index           =   12
            Left            =   5610
            TabIndex        =   517
            ToolTipText     =   "100 Euro"
            Top             =   1200
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   1296
            _StockProps     =   78
            Caption         =   "100"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   735
            Index           =   13
            Left            =   7000
            TabIndex        =   518
            ToolTipText     =   "200 Euro"
            Top             =   1200
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   1296
            _StockProps     =   78
            Caption         =   "200"
            ForeColor       =   -2147483630
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
            Picture         =   "frmWKL20.frx":17F8
         End
         Begin Threed.SSCommand SSCommand33 
            Height          =   735
            Index           =   14
            Left            =   8400
            TabIndex        =   519
            ToolTipText     =   "500 Euro"
            Top             =   1200
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   1296
            _StockProps     =   78
            Caption         =   "500"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   2.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   0
            Picture         =   "frmWKL20.frx":1814
         End
      End
      Begin sevCommand3.Command cmdBon 
         Height          =   735
         Left            =   3360
         TabIndex        =   464
         Top             =   3360
         Visible         =   0   'False
         Width           =   3015
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Bon drucken"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   255
         Index           =   12
         Left            =   9120
         TabIndex        =   392
         Top             =   240
         Width           =   375
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "P"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text88 
         Alignment       =   1  'Rechts
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   360
         Left            =   2880
         MaxLength       =   9
         TabIndex        =   363
         Top             =   2960
         Visible         =   0   'False
         Width           =   1335
      End
      Begin VB.ComboBox cboNoEuro 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Left            =   240
         Style           =   2  'Dropdown-Liste
         TabIndex        =   360
         Top             =   4200
         Visible         =   0   'False
         Width           =   6735
      End
      Begin VB.CheckBox Check6 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Fremdwährung annehmen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Left            =   3720
         TabIndex        =   361
         Top             =   4200
         Width           =   3135
      End
      Begin VB.CheckBox Check3 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Rechnung im DIN A4 Format"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Left            =   240
         TabIndex        =   350
         Top             =   4200
         Width           =   3135
      End
      Begin sevCommand3.Command Command33 
         Height          =   735
         Index           =   1
         Left            =   6480
         TabIndex        =   236
         Top             =   3360
         Width           =   3015
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schließen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command33 
         Height          =   735
         Index           =   0
         Left            =   240
         TabIndex        =   235
         Top             =   3360
         Width           =   3015
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "OK"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text333 
         Alignment       =   1  'Rechts
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   495
         Left            =   4200
         MaxLength       =   9
         TabIndex        =   234
         Top             =   2280
         Width           =   3375
      End
      Begin Threed.SSCommand SSCommand33 
         Height          =   405
         Index           =   15
         Left            =   240
         TabIndex        =   386
         Top             =   4680
         Visible         =   0   'False
         Width           =   855
         _Version        =   65536
         _ExtentX        =   1508
         _ExtentY        =   714
         _StockProps     =   78
         Caption         =   "DUKA(10)"
         ForeColor       =   -2147483630
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BevelWidth      =   0
      End
      Begin VB.TextBox Text1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Index           =   3
         Left            =   7320
         MaxLength       =   18
         TabIndex        =   461
         Top             =   3480
         Width           =   1815
      End
      Begin sevCommand3.Command Command1 
         Height          =   420
         Index           =   55
         Left            =   7800
         TabIndex        =   616
         Top             =   160
         Width           =   420
         _ExtentX        =   741
         _ExtentY        =   741
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Wingdings 3"
            Size            =   8.25
            Charset         =   2
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ToolTipTitle    =   "Wechseln"
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   3
         Version3        =   -1  'True
      End
      Begin VB.Label lblZollER 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Zollbelege:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Left            =   120
         TabIndex        =   600
         Top             =   120
         Visible         =   0   'False
         Width           =   1575
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Summe Dukaten:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Index           =   5
         Left            =   1440
         TabIndex        =   389
         Top             =   2040
         Visible         =   0   'False
         Width           =   2055
      End
      Begin VB.Label Label333 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0E0FF&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Index           =   1
         Left            =   3600
         TabIndex        =   388
         Top             =   2040
         Visible         =   0   'False
         Width           =   3975
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   255
         Index           =   1
         Left            =   7920
         TabIndex        =   387
         Top             =   2040
         Visible         =   0   'False
         Width           =   375
      End
      Begin VB.Label Label88 
         BackColor       =   &H00C0E0FF&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Index           =   4
         Left            =   7920
         TabIndex        =   367
         Top             =   3000
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.Label Label88 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0E0FF&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Index           =   3
         Left            =   6480
         TabIndex        =   366
         Top             =   3000
         Visible         =   0   'False
         Width           =   1335
      End
      Begin VB.Label Label88 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0E0FF&
         Caption         =   "noch offen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Index           =   2
         Left            =   4920
         TabIndex        =   365
         Top             =   3000
         Visible         =   0   'False
         Width           =   1335
      End
      Begin VB.Label Label88 
         BackColor       =   &H00C0E0FF&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Index           =   1
         Left            =   4320
         TabIndex        =   364
         Top             =   3000
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.Label Label88 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0E0FF&
         Caption         =   "Gegeben..."
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Index           =   0
         Left            =   1440
         TabIndex        =   362
         Top             =   3000
         Visible         =   0   'False
         Width           =   1335
      End
      Begin VB.Label Label77 
         Alignment       =   2  'Zentriert
         BackColor       =   &H00C0E0FF&
         Caption         =   "BAR - Zahlung in Euro"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   24
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   615
         Left            =   1800
         TabIndex        =   248
         Top             =   120
         Width           =   6135
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   495
         Index           =   4
         Left            =   7920
         TabIndex        =   247
         Top             =   840
         Width           =   375
      End
      Begin VB.Label Label333 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0E0FF&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   32.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   720
         Index           =   3
         Left            =   4680
         TabIndex        =   246
         Top             =   4605
         Width           =   2895
      End
      Begin VB.Label Label333 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0E0FF&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   495
         Index           =   0
         Left            =   3600
         TabIndex        =   245
         Top             =   840
         Width           =   3975
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Zurück:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   32.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   735
         Index           =   8
         Left            =   1680
         TabIndex        =   244
         Top             =   4605
         Width           =   2655
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Gegeben..."
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   615
         Index           =   3
         Left            =   1440
         TabIndex        =   243
         Top             =   2280
         Width           =   2655
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   "Summe:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   615
         Index           =   0
         Left            =   1440
         TabIndex        =   242
         Top             =   840
         Width           =   2055
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   495
         Index           =   7
         Left            =   7920
         TabIndex        =   241
         Top             =   2280
         Width           =   375
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   32.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   735
         Index           =   9
         Left            =   7920
         TabIndex        =   240
         Top             =   4605
         Width           =   735
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   "noch offen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   -1  'True
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   495
         Index           =   2
         Left            =   1440
         TabIndex        =   239
         Top             =   1440
         Width           =   2655
      End
      Begin VB.Label Label333 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0E0FF&
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   495
         Index           =   2
         Left            =   4200
         TabIndex        =   238
         Top             =   1440
         Width           =   3375
      End
      Begin VB.Label Label33 
         BackColor       =   &H00C0E0FF&
         Caption         =   ""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   495
         Index           =   6
         Left            =   7920
         TabIndex        =   237
         Top             =   1440
         Width           =   375
      End
   End
   Begin VB.Timer Timer2 
      Enabled         =   0   'False
      Interval        =   1000
      Left            =   1440
      Top             =   120
   End
   Begin VB.Frame Frame12 
      BackColor       =   &H00C0C000&
      BorderStyle     =   0  'Kein
      Height          =   495
      Left            =   3360
      TabIndex        =   432
      Top             =   7320
      Visible         =   0   'False
      Width           =   855
      Begin VB.ListBox List6 
         Height          =   1620
         Left            =   9120
         TabIndex        =   450
         Top             =   120
         Visible         =   0   'False
         Width           =   2535
      End
      Begin VB.CheckBox Check13 
         BackColor       =   &H00C0C000&
         Caption         =   "mit Preis drucken"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   1680
         TabIndex        =   448
         Top             =   8160
         Width           =   2295
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   8
         Left            =   120
         MaxLength       =   100
         TabIndex        =   436
         Top             =   3240
         Width           =   11535
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   7
         Left            =   120
         MaxLength       =   100
         TabIndex        =   435
         Top             =   2280
         Width           =   11535
      End
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   20
         Left            =   4560
         TabIndex        =   434
         Top             =   7920
         Width           =   3495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Drucken"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   19
         Left            =   8160
         TabIndex        =   433
         Top             =   7920
         Width           =   3495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Zurück"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   20
         Left            =   4200
         TabIndex        =   446
         Top             =   960
         Width           =   5895
      End
      Begin VB.Label Label30 
         BackColor       =   &H00C0C000&
         Caption         =   "Gutscheindaten eingeben"
         BeginProperty Font 
            Name            =   "Arial Black"
            Size            =   21.75
            Charset         =   0
            Weight          =   900
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   615
         Left            =   120
         TabIndex        =   445
         Top             =   0
         Width           =   6975
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   19
         Left            =   2520
         TabIndex        =   444
         Top             =   1320
         Width           =   1815
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   18
         Left            =   2520
         TabIndex        =   443
         Top             =   960
         Width           =   1695
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Preis:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   30
         Left            =   120
         TabIndex        =   442
         Top             =   960
         Width           =   2175
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Gutschein - Nr.:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   29
         Left            =   120
         TabIndex        =   441
         Top             =   1320
         Width           =   2295
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Gutscheintext (100 Zeichen):"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   28
         Left            =   120
         TabIndex        =   440
         Top             =   1920
         Width           =   4095
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Bemerkung(100 Zeichen):"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   27
         Left            =   120
         TabIndex        =   439
         Top             =   2880
         Width           =   4095
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Kund-Nr.:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   26
         Left            =   4320
         TabIndex        =   438
         Top             =   1320
         Width           =   1455
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   735
         Index           =   17
         Left            =   5760
         TabIndex        =   437
         Top             =   1320
         Width           =   3255
      End
   End
   Begin VB.Frame Frame5 
      BackColor       =   &H00C0C000&
      BorderStyle     =   0  'Kein
      Height          =   495
      Left            =   3600
      TabIndex        =   416
      Top             =   6120
      Visible         =   0   'False
      Width           =   1215
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   17
         Left            =   960
         TabIndex        =   430
         Top             =   7920
         Width           =   3495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Garantiedaten"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   16
         Left            =   8160
         TabIndex        =   429
         Top             =   7920
         Width           =   3495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Zurück"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   30
         Left            =   4560
         TabIndex        =   419
         Top             =   7920
         Width           =   3495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Speichern"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   13
         Left            =   120
         MaxLength       =   100
         TabIndex        =   418
         Top             =   2280
         Width           =   11535
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   9
         Left            =   120
         MaxLength       =   100
         TabIndex        =   417
         Top             =   3240
         Width           =   11535
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   2
         Left            =   6720
         TabIndex        =   428
         Top             =   1320
         Width           =   3735
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Kund-Nr.:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   25
         Left            =   4320
         TabIndex        =   427
         Top             =   1320
         Width           =   2295
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Bemerkung(100 Zeichen):"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   24
         Left            =   120
         TabIndex        =   426
         Top             =   2880
         Width           =   4095
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Seriennummer(100 Zeichen):"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   23
         Left            =   120
         TabIndex        =   425
         Top             =   1920
         Width           =   4095
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Artikel-Nr.:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   45
         Left            =   120
         TabIndex        =   424
         Top             =   1320
         Width           =   2295
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Bezeichnung:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   44
         Left            =   120
         TabIndex        =   423
         Top             =   960
         Width           =   2175
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   31
         Left            =   2520
         TabIndex        =   422
         Top             =   960
         Width           =   5895
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   30
         Left            =   2520
         TabIndex        =   421
         Top             =   1320
         Width           =   1935
      End
      Begin VB.Label Label29 
         BackColor       =   &H00C0C000&
         Caption         =   "Garantiedaten eingeben"
         BeginProperty Font 
            Name            =   "Arial Black"
            Size            =   21.75
            Charset         =   0
            Weight          =   900
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   615
         Left            =   120
         TabIndex        =   420
         Top             =   0
         Width           =   7215
      End
   End
   Begin VB.Frame Frame23 
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   735
      Left            =   5760
      TabIndex        =   117
      Top             =   120
      Visible         =   0   'False
      Width           =   975
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   18
         Left            =   120
         TabIndex        =   259
         Top             =   240
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 1"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   35
         Left            =   10560
         TabIndex        =   36
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "gehe zu Leiste 1"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   34
         Left            =   9240
         TabIndex        =   35
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "2.Bon"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   33
         Left            =   7920
         TabIndex        =   34
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schublade"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   31
         Left            =   6600
         TabIndex        =   33
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Termine"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   30
         Left            =   5280
         TabIndex        =   32
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Sonder Funkt."
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   29
         Left            =   3960
         TabIndex        =   31
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 12"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   28
         Left            =   2640
         TabIndex        =   30
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 11"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   27
         Left            =   1320
         TabIndex        =   29
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 10"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   32
         Left            =   10560
         TabIndex        =   27
         Top             =   240
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "BAR"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   26
         Left            =   120
         TabIndex        =   28
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 9"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   25
         Left            =   9240
         TabIndex        =   26
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 8"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   24
         Left            =   7920
         TabIndex        =   25
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 7"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   23
         Left            =   6600
         TabIndex        =   24
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 6"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   22
         Left            =   5280
         TabIndex        =   23
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 5"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   21
         Left            =   3960
         TabIndex        =   22
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 4"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   20
         Left            =   2640
         TabIndex        =   21
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 3"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   19
         Left            =   1320
         TabIndex        =   20
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 2"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
   End
   Begin VB.Frame Frame15 
      BackColor       =   &H000000C0&
      BorderStyle     =   0  'Kein
      Height          =   1935
      Left            =   5160
      TabIndex        =   331
      Top             =   8400
      Visible         =   0   'False
      Width           =   1095
      Begin sevCommand3.Command Command6 
         Height          =   495
         Left            =   2040
         TabIndex        =   333
         Top             =   1560
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "OK"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         IMEMode         =   3  'DISABLE
         Index           =   2
         Left            =   240
         PasswordChar    =   "*"
         TabIndex        =   332
         Top             =   960
         Width           =   5415
      End
      Begin VB.Label lbl6 
         BackColor       =   &H000000C0&
         Caption         =   "Bitte geben Sie zum Entsperren der Kasse ein Passwort ein!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   855
         Left            =   120
         TabIndex        =   334
         Top             =   120
         Width           =   5655
      End
   End
   Begin VB.Frame Frame14 
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   735
      Left            =   6960
      TabIndex        =   276
      Top             =   120
      Visible         =   0   'False
      Width           =   975
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   155
         Left            =   120
         TabIndex        =   330
         Top             =   3600
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 48"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   106
         Left            =   10560
         TabIndex        =   329
         Top             =   4440
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "gehe zu Leiste 1"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   171
         Left            =   9240
         TabIndex        =   328
         Top             =   4440
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 64"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   170
         Left            =   7920
         TabIndex        =   327
         Top             =   4440
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 63"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   169
         Left            =   6600
         TabIndex        =   326
         Top             =   4440
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 62"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   168
         Left            =   5280
         TabIndex        =   325
         Top             =   4440
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 61"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   167
         Left            =   3960
         TabIndex        =   324
         Top             =   4440
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 60"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   166
         Left            =   2640
         TabIndex        =   323
         Top             =   4440
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 59"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   165
         Left            =   1320
         TabIndex        =   322
         Top             =   4440
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 58"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   163
         Left            =   10560
         TabIndex        =   321
         Top             =   3600
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 56"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   164
         Left            =   120
         TabIndex        =   320
         Top             =   4440
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 57"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   162
         Left            =   9240
         TabIndex        =   319
         Top             =   3600
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 55"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   161
         Left            =   7920
         TabIndex        =   318
         Top             =   3600
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 54"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   160
         Left            =   6600
         TabIndex        =   317
         Top             =   3600
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 53"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   159
         Left            =   5280
         TabIndex        =   316
         Top             =   3600
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 52"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   158
         Left            =   3960
         TabIndex        =   315
         Top             =   3600
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 51"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   157
         Left            =   2640
         TabIndex        =   314
         Top             =   3600
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 50"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   156
         Left            =   1320
         TabIndex        =   313
         Top             =   3600
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 49"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   137
         Left            =   120
         TabIndex        =   312
         Top             =   1920
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 30"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   154
         Left            =   10560
         TabIndex        =   311
         Top             =   2760
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 47"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   153
         Left            =   9240
         TabIndex        =   310
         Top             =   2760
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 46"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   152
         Left            =   7920
         TabIndex        =   309
         Top             =   2760
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 45"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   151
         Left            =   6600
         TabIndex        =   308
         Top             =   2760
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 44"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   150
         Left            =   5280
         TabIndex        =   307
         Top             =   2760
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 43"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   149
         Left            =   3960
         TabIndex        =   306
         Top             =   2760
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 42"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   148
         Left            =   2640
         TabIndex        =   305
         Top             =   2760
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 41"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   147
         Left            =   1320
         TabIndex        =   304
         Top             =   2760
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 40"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   145
         Left            =   10560
         TabIndex        =   303
         Top             =   1920
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 38"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   146
         Left            =   120
         TabIndex        =   302
         Top             =   2760
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 39"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   144
         Left            =   9240
         TabIndex        =   301
         Top             =   1920
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 37"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   143
         Left            =   7920
         TabIndex        =   300
         Top             =   1920
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 36"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   142
         Left            =   6600
         TabIndex        =   299
         Top             =   1920
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 35"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   141
         Left            =   5280
         TabIndex        =   298
         Top             =   1920
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 34"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   140
         Left            =   3960
         TabIndex        =   297
         Top             =   1920
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 33"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   139
         Left            =   2640
         TabIndex        =   296
         Top             =   1920
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 32"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   138
         Left            =   1320
         TabIndex        =   295
         Top             =   1920
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 31"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   121
         Left            =   1320
         TabIndex        =   294
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 14"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   122
         Left            =   2640
         TabIndex        =   293
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 15"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   123
         Left            =   3960
         TabIndex        =   292
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 16"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   124
         Left            =   5280
         TabIndex        =   291
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 17"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   125
         Left            =   6600
         TabIndex        =   290
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 18"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   126
         Left            =   7920
         TabIndex        =   289
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 19"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   127
         Left            =   9240
         TabIndex        =   288
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 20"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   128
         Left            =   120
         TabIndex        =   287
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 21"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   63
         Left            =   10560
         TabIndex        =   286
         Top             =   240
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "BAR"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   129
         Left            =   1320
         TabIndex        =   285
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 22"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   130
         Left            =   2640
         TabIndex        =   284
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 23"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   131
         Left            =   3960
         TabIndex        =   283
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 24"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   132
         Left            =   5280
         TabIndex        =   282
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 25"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   133
         Left            =   6600
         TabIndex        =   281
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 26"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   134
         Left            =   7920
         TabIndex        =   280
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 27"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   135
         Left            =   9240
         TabIndex        =   279
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 28"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   136
         Left            =   10560
         TabIndex        =   278
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 29"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   120
         Left            =   120
         TabIndex        =   277
         Top             =   240
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "WG 13"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
   End
   Begin VB.Frame Frame8 
      BackColor       =   &H00FFC0C0&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   2775
      Left            =   6720
      TabIndex        =   55
      Top             =   5040
      Visible         =   0   'False
      Width           =   4695
      Begin VB.CheckBox chk_Kunde_halten 
         BackColor       =   &H00FFC0C0&
         Caption         =   "halten"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   4680
         TabIndex        =   595
         Top             =   1440
         Width           =   1215
      End
      Begin VB.CheckBox Check12 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Firma"
         CausesValidation=   0   'False
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   2160
         TabIndex        =   431
         Top             =   1440
         Width           =   1095
      End
      Begin sevCommand3.Command Command1 
         Height          =   285
         Index           =   56
         Left            =   1680
         TabIndex        =   371
         Top             =   1440
         Width           =   375
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   14
         Left            =   11040
         TabIndex        =   400
         Top             =   4440
         Visible         =   0   'False
         Width           =   495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   13
         Left            =   10440
         TabIndex        =   399
         Top             =   4440
         Visible         =   0   'False
         Width           =   495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.ComboBox Combo1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Left            =   2040
         TabIndex        =   57
         Top             =   960
         Width           =   2055
      End
      Begin sevCommand3.Command cmdNew 
         Height          =   375
         Left            =   5400
         TabIndex        =   257
         Top             =   960
         Width           =   1175
         _ExtentX        =   2064
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Neu"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   375
         Index           =   3
         Left            =   9720
         TabIndex        =   63
         Top             =   1440
         Width           =   1415
         _ExtentX        =   2487
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schließen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   375
         Index           =   8
         Left            =   6600
         TabIndex        =   62
         Top             =   960
         Width           =   1175
         _ExtentX        =   2064
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Daten"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   375
         Index           =   6
         Left            =   7800
         TabIndex        =   61
         Top             =   960
         Width           =   1175
         _ExtentX        =   2064
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Historie"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   375
         Index           =   4
         Left            =   8280
         TabIndex        =   60
         Top             =   1440
         Width           =   1415
         _ExtentX        =   2487
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Wählen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   375
         Index           =   5
         Left            =   6840
         TabIndex        =   59
         Top             =   1440
         Width           =   1415
         _ExtentX        =   2487
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Suchen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Index           =   3
         Left            =   120
         MaxLength       =   35
         TabIndex        =   56
         Text            =   "Text3"
         Top             =   960
         Width           =   1815
      End
      Begin MSHierarchicalFlexGridLib.MSHFlexGrid grd1 
         Height          =   2415
         Left            =   120
         TabIndex        =   258
         Top             =   1920
         Width           =   11655
         _ExtentX        =   20558
         _ExtentY        =   4260
         _Version        =   393216
         FocusRect       =   0
         AllowUserResizing=   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty FontFixed {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         _NumberOfBands  =   1
         _Band(0).Cols   =   2
      End
      Begin sevCommand3.Command Command4 
         Height          =   375
         Index           =   11
         Left            =   4200
         TabIndex        =   355
         Top             =   960
         Width           =   1175
         _ExtentX        =   2064
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Bonus"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.CheckBox Check1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Umsatz"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   4680
         TabIndex        =   58
         Top             =   1680
         Width           =   1215
      End
      Begin VB.CheckBox Check8 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Strasse"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   3360
         TabIndex        =   373
         Top             =   1680
         Width           =   1215
      End
      Begin VB.CheckBox Check7 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Bonus"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   2160
         TabIndex        =   369
         Top             =   1680
         Width           =   1215
      End
      Begin VB.CheckBox Check11 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Notizen"
         CausesValidation=   0   'False
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   3360
         TabIndex        =   401
         Top             =   1440
         Width           =   1215
      End
      Begin sevCommand3.Command Command8 
         Height          =   375
         Index           =   121
         Left            =   11280
         TabIndex        =   481
         Top             =   1440
         Width           =   495
         _ExtentX        =   873
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Wingdings 3"
            Size            =   8.25
            Charset         =   2
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ToolTip         =   "Zurück"
         ToolTipTitle    =   "Zurück"
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   3
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command8 
         Height          =   375
         Index           =   120
         Left            =   11280
         TabIndex        =   482
         Top             =   960
         Width           =   495
         _ExtentX        =   873
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Wingdings 3"
            Size            =   8.25
            Charset         =   2
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ToolTip         =   "Vor"
         ToolTipTitle    =   "Vor"
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   3
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   375
         Index           =   16
         Left            =   9000
         TabIndex        =   485
         Top             =   960
         Width           =   1175
         _ExtentX        =   2064
         _ExtentY        =   661
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kosmetik"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Karte/KdNr/Name"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   -1  'True
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   27
         Left            =   120
         MouseIcon       =   "frmWKL20.frx":1830
         MousePointer    =   99  'Benutzerdefiniert
         TabIndex        =   463
         Top             =   600
         Width           =   1935
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "anzeigen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   26
         Left            =   120
         TabIndex        =   414
         Top             =   1680
         Width           =   1335
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "1.Platz"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   25
         Left            =   4200
         MouseIcon       =   "frmWKL20.frx":1B3A
         MousePointer    =   99  'Benutzerdefiniert
         TabIndex        =   413
         ToolTipText     =   "Die Besten anzeigen"
         Top             =   600
         Width           =   7095
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Neukunden:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   24
         Left            =   4200
         MouseIcon       =   "frmWKL20.frx":1E44
         MousePointer    =   99  'Benutzerdefiniert
         TabIndex        =   412
         ToolTipText     =   "Daten aktualisieren"
         Top             =   120
         Width           =   1695
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Neukunden VJ"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   23
         Left            =   7200
         TabIndex        =   411
         Top             =   360
         Width           =   2295
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Neukunden AJ"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   22
         Left            =   7200
         TabIndex        =   410
         Top             =   120
         Width           =   2175
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Neukunden VJM"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   21
         Left            =   9600
         TabIndex        =   409
         Top             =   360
         Width           =   2175
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Neukunden AM"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   20
         Left            =   9600
         TabIndex        =   408
         Top             =   120
         Width           =   2175
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Vorname"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   16
         Left            =   2040
         TabIndex        =   385
         Top             =   600
         Width           =   1695
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "alle Farben"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   10
         Left            =   120
         TabIndex        =   372
         Top             =   1440
         Width           =   1695
      End
      Begin VB.Label Label10 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Kunde suchen"
         BeginProperty Font 
            Name            =   "Arial Black"
            Size            =   21.75
            Charset         =   0
            Weight          =   900
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   615
         Left            =   120
         TabIndex        =   251
         Top             =   0
         Width           =   4335
      End
   End
   Begin VB.Frame Frame6 
      BackColor       =   &H00FFC0C0&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   615
      Left            =   840
      TabIndex        =   186
      Top             =   2640
      Visible         =   0   'False
      Width           =   1095
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   77
         Left            =   2640
         MaxLength       =   6
         TabIndex        =   193
         Text            =   "Text3"
         Top             =   1680
         Width           =   1215
      End
      Begin VB.CheckBox Check18 
         BackColor       =   &H00FFC0C0&
         Caption         =   "nur mit Bestand"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   1440
         TabIndex        =   623
         Top             =   560
         Width           =   1695
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   19
         Left            =   3240
         MaxLength       =   13
         TabIndex        =   189
         Text            =   "Text3"
         Top             =   840
         Width           =   1215
      End
      Begin sevCommand3.Command Command66 
         Height          =   360
         Index           =   1
         Left            =   9360
         TabIndex        =   376
         Top             =   480
         Width           =   495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   360
         Index           =   0
         Left            =   10080
         TabIndex        =   201
         Top             =   480
         Width           =   1695
         _ExtentX        =   2990
         _ExtentY        =   635
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Suchen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Frame Frame7 
         BackColor       =   &H00FFC0C0&
         BorderStyle     =   0  'Kein
         Height          =   495
         Left            =   4560
         TabIndex        =   589
         Top             =   0
         Visible         =   0   'False
         Width           =   5295
         Begin VB.OptionButton Option2 
            BackColor       =   &H00FFC0C0&
            Caption         =   "direkt"
            Height          =   255
            Index           =   4
            Left            =   4320
            TabIndex        =   608
            Top             =   0
            Value           =   -1  'True
            Width           =   975
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00FFC0C0&
            Caption         =   "gleicher Lieferant und gleiche Linie"
            Height          =   255
            Index           =   3
            Left            =   1920
            TabIndex        =   593
            Top             =   240
            Width           =   3015
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00FFC0C0&
            Caption         =   "die ersten 7 Stellen der EAN"
            Height          =   255
            Index           =   2
            Left            =   1920
            TabIndex        =   592
            Top             =   0
            Width           =   2655
         End
         Begin VB.Label Label5 
            BackColor       =   &H00FFC0C0&
            Caption         =   "Vergleichskriterien:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   10
            Left            =   0
            TabIndex        =   591
            Top             =   240
            Width           =   1935
         End
         Begin VB.Label Label5 
            BackColor       =   &H00FFC0C0&
            Caption         =   "verwandte Artikel"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   9
            Left            =   0
            TabIndex        =   590
            Top             =   0
            Width           =   1935
         End
      End
      Begin VB.PictureBox Picture3 
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   0  'Kein
         FontTransparent =   0   'False
         Height          =   855
         Left            =   7080
         MouseIcon       =   "frmWKL20.frx":214E
         MousePointer    =   99  'Benutzerdefiniert
         ScaleHeight     =   855
         ScaleWidth      =   975
         TabIndex        =   460
         Top             =   7800
         Width           =   975
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   70
         Left            =   8880
         MaxLength       =   10
         TabIndex        =   196
         Top             =   1680
         Width           =   975
      End
      Begin VB.CheckBox Check14 
         BackColor       =   &H00FFC0C0&
         Caption         =   "ohne Ex"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   10080
         TabIndex        =   449
         Top             =   1080
         Width           =   975
      End
      Begin sevCommand3.Command Command4 
         Height          =   330
         Index           =   15
         Left            =   10080
         TabIndex        =   406
         Top             =   1800
         Visible         =   0   'False
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "weitere"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin MSComctlLib.TreeView List4 
         Height          =   4935
         Left            =   120
         TabIndex        =   356
         Top             =   2760
         Visible         =   0   'False
         Width           =   1935
         _ExtentX        =   3413
         _ExtentY        =   8705
         _Version        =   393217
         HideSelection   =   0   'False
         LabelEdit       =   1
         Appearance      =   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Lucida Console"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin sevCommand3.Command Command1 
         Height          =   360
         Index           =   54
         Left            =   11280
         TabIndex        =   357
         Top             =   1320
         Width           =   495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command66 
         Height          =   360
         Index           =   2
         Left            =   1920
         TabIndex        =   382
         Top             =   1710
         Width           =   495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   6
         Left            =   6960
         MaxLength       =   35
         TabIndex        =   191
         Text            =   "Text3"
         Top             =   840
         Width           =   2895
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   5
         Left            =   120
         MaxLength       =   6
         TabIndex        =   192
         Text            =   "Text3"
         Top             =   1680
         Width           =   1695
      End
      Begin sevCommand3.Command Command66 
         Height          =   360
         Index           =   0
         Left            =   8280
         TabIndex        =   354
         Top             =   1320
         Width           =   495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   4
         Left            =   6960
         MaxLength       =   2
         TabIndex        =   195
         Text            =   "Text3"
         Top             =   1680
         Width           =   1815
      End
      Begin VB.OptionButton Option2 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Artikelbezeichnung"
         Height          =   255
         Index           =   0
         Left            =   8760
         TabIndex        =   343
         Top             =   0
         Width           =   2055
      End
      Begin sevCommand3.Command cmdFoto 
         Height          =   495
         Left            =   1440
         TabIndex        =   256
         Top             =   7920
         Visible         =   0   'False
         Width           =   1575
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Nein VK"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   10
         Left            =   120
         TabIndex        =   206
         Top             =   7920
         Visible         =   0   'False
         Width           =   1215
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Info"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   9
         Left            =   3120
         TabIndex        =   199
         Top             =   7920
         Visible         =   0   'False
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Bestand"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   0
         Left            =   120
         MaxLength       =   35
         TabIndex        =   188
         Text            =   "Text3"
         Top             =   840
         Width           =   3015
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   1
         Left            =   4560
         MaxLength       =   13
         TabIndex        =   194
         Text            =   "Text3"
         Top             =   1680
         Width           =   2295
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   1
         Left            =   8280
         TabIndex        =   203
         Top             =   7920
         Visible         =   0   'False
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Wählen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   2
         Left            =   10080
         TabIndex        =   205
         Top             =   7920
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schließen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   2
         Left            =   4560
         MaxLength       =   13
         TabIndex        =   190
         Text            =   "Text3"
         Top             =   840
         Width           =   2295
      End
      Begin VB.ListBox List2 
         Enabled         =   0   'False
         BeginProperty Font 
            Name            =   "Lucida Console"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   780
         Left            =   120
         TabIndex        =   187
         Top             =   2400
         Visible         =   0   'False
         Width           =   11655
      End
      Begin VB.OptionButton Option2 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Lieferant, Linie, Artikelbezeichnung"
         Height          =   255
         Index           =   1
         Left            =   8760
         TabIndex        =   344
         Top             =   240
         Width           =   3015
      End
      Begin VB.CheckBox Check9 
         BackColor       =   &H00FFC0C0&
         Caption         =   "auch ""Schwarze"""
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   10080
         TabIndex        =   374
         Top             =   840
         Width           =   1695
      End
      Begin sevCommand3.Command Command8 
         Height          =   495
         Index           =   119
         Left            =   6000
         TabIndex        =   483
         Top             =   7920
         Width           =   495
         _ExtentX        =   873
         _ExtentY        =   873
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Wingdings 3"
            Size            =   8.25
            Charset         =   2
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ToolTip         =   "Zurück"
         ToolTipTitle    =   "Zurück"
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   3
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command8 
         Height          =   495
         Index           =   118
         Left            =   5400
         TabIndex        =   484
         Top             =   7920
         Width           =   495
         _ExtentX        =   873
         _ExtentY        =   873
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Wingdings 3"
            Size            =   8.25
            Charset         =   2
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ToolTip         =   "Vor"
         ToolTipTitle    =   "Vor"
         ButtonStyle     =   2
         Caption         =   ""
         PictureAlign    =   3
         Version3        =   -1  'True
      End
      Begin VB.CheckBox Check16 
         BackColor       =   &H00FFC0C0&
         Caption         =   "gef"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   11160
         TabIndex        =   619
         Top             =   1080
         Width           =   855
      End
      Begin sevCommand3.Command Command66 
         Height          =   360
         Index           =   3
         Left            =   3960
         TabIndex        =   624
         Top             =   1710
         Width           =   495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Linie:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   12
         Left            =   2640
         TabIndex        =   625
         Top             =   1440
         Width           =   855
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Artnr:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   11
         Left            =   3240
         TabIndex        =   615
         Top             =   600
         Width           =   1095
      End
      Begin VB.Label Label40 
         BackColor       =   &H00FFC0C0&
         Caption         =   "ausgewählter Artikel"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   270
         Left            =   130
         TabIndex        =   598
         Top             =   2110
         Width           =   9735
      End
      Begin VB.Image Image1 
         Height          =   300
         Left            =   6840
         Top             =   8040
         Visible         =   0   'False
         Width           =   450
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Größe"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   47
         Left            =   8880
         TabIndex        =   458
         Top             =   1440
         Width           =   735
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "keine Auswahl"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   8
         Left            =   6960
         TabIndex        =   405
         Top             =   1440
         Width           =   1935
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "kein Lieferant"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   840
         TabIndex        =   404
         Top             =   1320
         Width           =   1695
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Marke:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   7
         Left            =   6960
         TabIndex        =   375
         Top             =   600
         Width           =   615
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Lieferant:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   6
         Left            =   120
         TabIndex        =   370
         Top             =   1320
         Width           =   855
      End
      Begin VB.Label Label1 
         BackColor       =   &H00FFC0C0&
         Caption         =   "alle Farben:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   9
         Left            =   9960
         TabIndex        =   358
         Top             =   1440
         Width           =   1215
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "PGN:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   5
         Left            =   6960
         TabIndex        =   353
         Top             =   1300
         Width           =   495
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Sortierung nach:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   4
         Left            =   7080
         TabIndex        =   345
         Top             =   120
         Width           =   1575
      End
      Begin VB.Label Label9 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Artikel suchen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   495
         Left            =   120
         TabIndex        =   250
         Top             =   120
         Width           =   3615
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "Artikelname:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   200
         Top             =   600
         Width           =   1215
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "LiefBestellNr:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   1
         Left            =   4560
         TabIndex        =   198
         Top             =   1440
         Width           =   1215
      End
      Begin VB.Label Label5 
         BackColor       =   &H00FFC0C0&
         Caption         =   "EAN-Code:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   6.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   2
         Left            =   4560
         TabIndex        =   197
         Top             =   600
         Width           =   1335
      End
   End
   Begin VB.Frame Frame24 
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1935
      Left            =   1800
      TabIndex        =   118
      Top             =   6360
      Visible         =   0   'False
      Width           =   2160
      Begin VB.Frame Frame25 
         Caption         =   "gewünschter Wochentag"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   8775
         Left            =   120
         TabIndex        =   119
         Top             =   120
         Width           =   11655
         Begin VB.CheckBox Check17 
            Alignment       =   1  'Rechts ausgerichtet
            Caption         =   "als Nettorechnung?"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   210
            Left            =   5040
            TabIndex        =   620
            Top             =   600
            Visible         =   0   'False
            Width           =   1935
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   5
            Left            =   8040
            TabIndex        =   462
            Top             =   1800
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Zoll"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   4
            Left            =   6120
            TabIndex        =   447
            Top             =   1800
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "mehr"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.ComboBox Combo2 
            Height          =   315
            Left            =   2640
            TabIndex        =   403
            Text            =   "Combo2"
            Top             =   1440
            Width           =   3615
         End
         Begin VB.ListBox List5 
            BeginProperty Font 
               Name            =   "Courier New"
               Size            =   6
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   7620
            Left            =   9000
            TabIndex        =   402
            Top             =   360
            Width           =   2535
         End
         Begin VB.CheckBox Check5 
            Alignment       =   1  'Rechts ausgerichtet
            Caption         =   "Rechnung im DIN A4 Format"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   210
            Left            =   4320
            TabIndex        =   352
            Top             =   360
            Width           =   2655
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   3
            Left            =   7080
            TabIndex        =   128
            Top             =   360
            Width           =   1815
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Letzter Bon"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command11 
            Height          =   495
            Index           =   2
            Left            =   9720
            TabIndex        =   131
            Top             =   8040
            Width           =   1815
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Zurück"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   1
            Left            =   7080
            TabIndex        =   130
            Top             =   840
            Width           =   1815
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Drucken"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.ListBox List12 
            BeginProperty Font 
               Name            =   "Courier New"
               Size            =   11.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   5670
            Left            =   120
            TabIndex        =   129
            Top             =   2280
            Width           =   8775
         End
         Begin sevCommand3.Command Command11 
            Height          =   255
            Index           =   0
            Left            =   6360
            TabIndex        =   127
            Top             =   1440
            Visible         =   0   'False
            Width           =   615
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Suchen"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.OptionButton Option1 
            Caption         =   "SONNTAG"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   6
            Left            =   2640
            TabIndex        =   126
            Top             =   1080
            Width           =   2295
         End
         Begin VB.OptionButton Option1 
            Caption         =   "SAMSTAG"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   5
            Left            =   2640
            TabIndex        =   125
            Top             =   720
            Width           =   2055
         End
         Begin VB.OptionButton Option1 
            Caption         =   "FREITAG"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   4
            Left            =   2640
            TabIndex        =   124
            Top             =   360
            Width           =   2295
         End
         Begin VB.OptionButton Option1 
            Caption         =   "DONNERSTAG"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   3
            Left            =   120
            TabIndex        =   123
            Top             =   1440
            Width           =   2295
         End
         Begin VB.OptionButton Option1 
            Caption         =   "MITTWOCH"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   2
            Left            =   120
            TabIndex        =   122
            Top             =   1080
            Width           =   2295
         End
         Begin VB.OptionButton Option1 
            Caption         =   "DIENSTAG"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   1
            Left            =   120
            TabIndex        =   121
            Top             =   720
            Width           =   2295
         End
         Begin VB.OptionButton Option1 
            Caption         =   "MONTAG"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   0
            Left            =   120
            TabIndex        =   120
            Top             =   360
            Value           =   -1  'True
            Width           =   2295
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   6
            Left            =   7080
            TabIndex        =   584
            Top             =   1320
            Visible         =   0   'False
            Width           =   1815
            _ExtentX        =   3201
            _ExtentY        =   661
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "nur Gutschein"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   7
            Left            =   7080
            TabIndex        =   609
            Top             =   1800
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Paket"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   8
            Left            =   5160
            TabIndex        =   610
            ToolTipText     =   $"frmWKL20.frx":2458
            Top             =   1800
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ToolTipTitle    =   "Winkiss Hinweis:"
            ButtonStyle     =   2
            Caption         =   "Spez L"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command11 
            Height          =   375
            Index           =   9
            Left            =   4080
            TabIndex        =   612
            ToolTipText     =   $"frmWKL20.frx":2550
            Top             =   1800
            Width           =   975
            _ExtentX        =   1720
            _ExtentY        =   661
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ToolTipTitle    =   "Winkiss Hinweis:"
            ButtonStyle     =   2
            Caption         =   "Belg W"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.Label Label26 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            BackStyle       =   0  'Transparent
            Caption         =   "0.00"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Left            =   5400
            TabIndex        =   407
            ToolTipText     =   "B"
            Top             =   1080
            Width           =   1575
         End
         Begin VB.Label Label14 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            BackStyle       =   0  'Transparent
            Caption         =   "0.00"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Left            =   5400
            TabIndex        =   390
            Top             =   840
            Width           =   1575
         End
      End
   End
   Begin VB.Frame Frame27 
      BackColor       =   &H00C0C000&
      BorderStyle     =   0  'Kein
      Height          =   615
      Left            =   120
      TabIndex        =   132
      Top             =   720
      Visible         =   0   'False
      Width           =   855
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   10
         Left            =   7200
         MaxLength       =   3
         TabIndex        =   617
         Text            =   "Text8"
         Top             =   4440
         Width           =   615
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Index           =   6
         Left            =   2520
         TabIndex        =   415
         Top             =   1590
         Width           =   855
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   5
         Left            =   9240
         MaxLength       =   1
         TabIndex        =   397
         Text            =   "Text8"
         Top             =   840
         Width           =   375
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   4
         Left            =   2520
         MaxLength       =   8
         TabIndex        =   339
         Top             =   3360
         Width           =   3015
      End
      Begin VB.TextBox Text4 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   405
         Left            =   2520
         MaxLength       =   35
         TabIndex        =   337
         Top             =   840
         Width           =   6375
      End
      Begin VB.Frame Frame28 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Height          =   3975
         Left            =   8640
         TabIndex        =   133
         Top             =   1080
         Width           =   2415
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   12
            Left            =   840
            TabIndex        =   146
            Top             =   3120
            Width           =   1455
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Clear"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   11
            Left            =   120
            TabIndex        =   145
            Top             =   3120
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   ","
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   10
            Left            =   840
            TabIndex        =   144
            Top             =   2400
            Width           =   1455
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "00"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   9
            Left            =   120
            TabIndex        =   143
            Top             =   2400
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "0"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   8
            Left            =   1560
            TabIndex        =   142
            Top             =   1680
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "3"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   7
            Left            =   840
            TabIndex        =   141
            Top             =   1680
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   6
            Left            =   120
            TabIndex        =   140
            Top             =   1680
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "1"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   5
            Left            =   1560
            TabIndex        =   139
            Top             =   960
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "6"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   4
            Left            =   840
            TabIndex        =   138
            Top             =   960
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "5"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   3
            Left            =   120
            TabIndex        =   137
            Top             =   960
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "4"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   2
            Left            =   1560
            TabIndex        =   136
            Top             =   240
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "9"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   1
            Left            =   840
            TabIndex        =   135
            Top             =   240
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "8"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command14 
            Height          =   735
            Index           =   0
            Left            =   120
            TabIndex        =   134
            Top             =   240
            Width           =   735
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "7"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
      End
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   15
         Left            =   120
         TabIndex        =   147
         Top             =   5280
         Width           =   3615
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Speichern in Datei"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   3
         Left            =   2520
         MaxLength       =   13
         TabIndex        =   342
         Text            =   "Text8"
         Top             =   4800
         Width           =   3015
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   2
         Left            =   2520
         MaxLength       =   13
         TabIndex        =   341
         Text            =   "Text8"
         Top             =   4320
         Width           =   3015
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   1
         Left            =   2520
         MaxLength       =   13
         TabIndex        =   340
         Text            =   "Text8"
         Top             =   3840
         Width           =   3015
      End
      Begin VB.TextBox Text8 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   435
         Index           =   0
         Left            =   2520
         TabIndex        =   338
         Text            =   "Text8"
         Top             =   2880
         Width           =   3015
      End
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   14
         Left            =   7440
         TabIndex        =   149
         Top             =   5280
         Width           =   3495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schließen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command14 
         Height          =   735
         Index           =   13
         Left            =   3840
         TabIndex        =   148
         Top             =   5280
         Width           =   3495
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Speichern im Bon"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "-1"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   31
         Left            =   7800
         TabIndex        =   627
         Top             =   480
         Width           =   615
      End
      Begin VB.Label Label2 
         Caption         =   "000000"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00E0E0E0&
         Height          =   400
         Index           =   24
         Left            =   8760
         TabIndex        =   614
         Top             =   360
         Width           =   2175
      End
      Begin VB.Label Label1 
         BackStyle       =   0  'Transparent
         Caption         =   "Farbbeschreibung:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00404000&
         Height          =   255
         Index           =   29
         Left            =   8760
         TabIndex        =   613
         Top             =   120
         Width           =   2055
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "bes. Merkmal:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   0
         Left            =   600
         TabIndex        =   349
         Top             =   3360
         Width           =   1815
      End
      Begin VB.Label Label22 
         BackColor       =   &H00C0C000&
         Caption         =   "Position ändern"
         BeginProperty Font 
            Name            =   "Arial Black"
            Size            =   21.75
            Charset         =   0
            Weight          =   900
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   495
         Left            =   120
         TabIndex        =   255
         Top             =   120
         Width           =   5055
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "-1"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   22
         Left            =   8040
         TabIndex        =   230
         Top             =   120
         Width           =   615
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   16
         Left            =   7200
         TabIndex        =   185
         Top             =   4920
         Width           =   1215
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Rabattfähig:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   21
         Left            =   5520
         TabIndex        =   184
         Top             =   4920
         Width           =   1575
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Datei gespeichert)"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   20
         Left            =   120
         TabIndex        =   183
         Top             =   4440
         Width           =   2295
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "(werden nur in der"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   19
         Left            =   120
         TabIndex        =   182
         Top             =   4200
         Width           =   2295
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Bediener:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   18
         Left            =   5760
         TabIndex        =   181
         Top             =   4560
         Width           =   1335
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Bestand:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   17
         Left            =   5760
         TabIndex        =   180
         Top             =   4200
         Width           =   1335
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Listen-Prs:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   16
         Left            =   5760
         TabIndex        =   179
         Top             =   3840
         Width           =   1335
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "MWSt (E):"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   15
         Left            =   5760
         TabIndex        =   178
         Top             =   3480
         Width           =   1335
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "MWSt (V):"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   14
         Left            =   5760
         TabIndex        =   177
         Top             =   3120
         Width           =   1335
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "VK-Preis:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   13
         Left            =   5760
         TabIndex        =   176
         Top             =   2760
         Width           =   1335
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "MWSt-Kz:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   12
         Left            =   5760
         TabIndex        =   175
         Top             =   2400
         Width           =   1335
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "-1"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   11
         Left            =   120
         TabIndex        =   174
         Top             =   4440
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "EANs:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   10
         Left            =   120
         TabIndex        =   173
         Top             =   3960
         Width           =   2295
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   15
         Left            =   1200
         TabIndex        =   172
         Top             =   4800
         Visible         =   0   'False
         Width           =   1215
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   13
         Left            =   7200
         TabIndex        =   171
         Top             =   4200
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   12
         Left            =   7200
         TabIndex        =   170
         Top             =   3840
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   11
         Left            =   7200
         TabIndex        =   169
         Top             =   3480
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   10
         Left            =   7200
         TabIndex        =   168
         Top             =   3120
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   9
         Left            =   7200
         TabIndex        =   167
         Top             =   2760
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   8
         Left            =   7200
         TabIndex        =   166
         Top             =   2400
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   7
         Left            =   7200
         TabIndex        =   165
         Top             =   2040
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   6
         Left            =   7200
         TabIndex        =   164
         Top             =   1680
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   5
         Left            =   7200
         TabIndex        =   163
         Top             =   1320
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   4
         Left            =   2520
         TabIndex        =   162
         Top             =   2400
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   3
         Left            =   2520
         TabIndex        =   161
         Top             =   2040
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   375
         Index           =   1
         Left            =   6360
         TabIndex        =   160
         Top             =   840
         Width           =   1935
      End
      Begin VB.Label Label17 
         BackColor       =   &H00C0C000&
         Caption         =   "Label17"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   255
         Index           =   0
         Left            =   2520
         TabIndex        =   159
         Top             =   1320
         Width           =   1455
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "neuer Stückpreis:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   9
         Left            =   120
         TabIndex        =   158
         Top             =   3000
         Width           =   2295
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Rabatt-Betrag:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   8
         Left            =   4800
         TabIndex        =   157
         Top             =   2040
         Width           =   2295
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Artikel-Rabatt %:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   7
         Left            =   4800
         TabIndex        =   156
         Top             =   1680
         Width           =   2295
      End
      Begin VB.Label Label16 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Listen/Sond.Preis:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   4800
         TabIndex        =   155
         Top             =   1320
         Width           =   2295
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Gesamtpreis:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   120
         TabIndex        =   154
         Top             =   2400
         Width           =   2295
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "VK-Preis / Stck:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   120
         TabIndex        =   153
         Top             =   2040
         Width           =   2295
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Menge:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   120
         TabIndex        =   152
         Top             =   1680
         Width           =   2175
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Bezeichnung:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   120
         TabIndex        =   151
         Top             =   960
         Width           =   2175
      End
      Begin VB.Label Label16 
         BackColor       =   &H00C0C000&
         Caption         =   "Artikel-Nr.:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   120
         TabIndex        =   150
         Top             =   1320
         Width           =   2295
      End
   End
   Begin VB.Frame Frame18 
      BorderStyle     =   0  'Kein
      Height          =   375
      Left            =   8760
      TabIndex        =   75
      Top             =   7200
      Visible         =   0   'False
      Width           =   975
      Begin VB.Frame Frame21 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Height          =   1335
         Left            =   3960
         TabIndex        =   94
         Top             =   7320
         Visible         =   0   'False
         Width           =   1215
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   11
            Left            =   8160
            TabIndex        =   106
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "<"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   10
            Left            =   7440
            TabIndex        =   105
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "C"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   9
            Left            =   6720
            TabIndex        =   104
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "0"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   8
            Left            =   6000
            TabIndex        =   103
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "9"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   7
            Left            =   5280
            TabIndex        =   102
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "8"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   6
            Left            =   4560
            TabIndex        =   101
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "7"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   5
            Left            =   3840
            TabIndex        =   100
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "6"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   4
            Left            =   3120
            TabIndex        =   99
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "5"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   3
            Left            =   2400
            TabIndex        =   98
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "4"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   2
            Left            =   1680
            TabIndex        =   97
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "3"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   1
            Left            =   960
            TabIndex        =   96
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command13 
            Height          =   735
            Index           =   0
            Left            =   240
            TabIndex        =   95
            Top             =   360
            Width           =   720
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "1"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.Label Label12 
            BackColor       =   &H00FFFF00&
            Caption         =   "-1"
            Height          =   255
            Left            =   9000
            TabIndex        =   107
            Top             =   480
            Visible         =   0   'False
            Width           =   255
         End
      End
      Begin VB.Frame Frame20 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   4695
         Left            =   6480
         TabIndex        =   83
         Top             =   2760
         Visible         =   0   'False
         Width           =   8055
         Begin sevCommand3.Command Command12 
            Height          =   735
            Index           =   1
            Left            =   6360
            TabIndex        =   93
            Top             =   2640
            Width           =   2535
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Zurück"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command12 
            Height          =   735
            Index           =   0
            Left            =   240
            TabIndex        =   92
            Top             =   2640
            Width           =   2535
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "OK"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.TextBox Text6 
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   12
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   420
            Index           =   3
            Left            =   4680
            MaxLength       =   2
            TabIndex        =   90
            Text            =   "Text6"
            Top             =   2040
            Width           =   855
         End
         Begin VB.TextBox Text6 
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   12
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   420
            Index           =   2
            Left            =   3240
            MaxLength       =   2
            TabIndex        =   89
            Text            =   "Text6"
            Top             =   2040
            Width           =   855
         End
         Begin VB.TextBox Text6 
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   12
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   420
            Index           =   1
            Left            =   3240
            MaxLength       =   8
            TabIndex        =   88
            Text            =   "Text6"
            Top             =   1440
            Width           =   2895
         End
         Begin VB.TextBox Text6 
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   12
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   420
            Index           =   0
            Left            =   3240
            MaxLength       =   10
            TabIndex        =   87
            Text            =   "Text6"
            Top             =   840
            Width           =   2895
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "manuelle Eingabe EC-Karte"
            BeginProperty Font 
               Name            =   "Arial Black"
               Size            =   18
               Charset         =   0
               Weight          =   900
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00808000&
            Height          =   615
            Left            =   120
            TabIndex        =   254
            Top             =   120
            Width           =   8775
         End
         Begin VB.Label Label11 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00FFFF80&
            BackStyle       =   0  'Transparent
            Caption         =   "/"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Index           =   8
            Left            =   4080
            TabIndex        =   91
            Top             =   2040
            Width           =   615
         End
         Begin VB.Label Label11 
            BackColor       =   &H00C0C000&
            Caption         =   "gültig bis:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Index           =   7
            Left            =   240
            TabIndex        =   86
            Top             =   2040
            Width           =   2655
         End
         Begin VB.Label Label11 
            BackColor       =   &H00C0C000&
            Caption         =   "Bankleitzahl:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Index           =   6
            Left            =   240
            TabIndex        =   85
            Top             =   1440
            Width           =   2775
         End
         Begin VB.Label Label11 
            BackColor       =   &H00C0C000&
            Caption         =   "Kontonummer:"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   18
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   495
            Index           =   5
            Left            =   240
            TabIndex        =   84
            Top             =   840
            Width           =   2775
         End
      End
      Begin VB.Frame Frame22 
         BorderStyle     =   0  'Kein
         Height          =   3135
         Left            =   3120
         TabIndex        =   108
         Top             =   4080
         Width           =   4455
         Begin sevCommand3.Command Command10 
            Height          =   855
            Index           =   0
            Left            =   120
            TabIndex        =   113
            Top             =   240
            Width           =   2055
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Beleg drucken"
            Enabled         =   0   'False
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command10 
            Height          =   855
            Index           =   1
            Left            =   2280
            TabIndex        =   112
            Top             =   240
            Width           =   2055
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Kunden- daten..."
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command10 
            Height          =   855
            Index           =   2
            Left            =   120
            TabIndex        =   111
            Top             =   1200
            Width           =   2055
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Eingabe löschen"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command10 
            Height          =   855
            Index           =   3
            Left            =   120
            TabIndex        =   110
            Top             =   2160
            Width           =   4215
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Abbrechen"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command10 
            Height          =   855
            Index           =   4
            Left            =   2280
            TabIndex        =   109
            Top             =   1200
            Width           =   2055
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "manuelle Eingabe"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
      End
      Begin VB.Frame Frame19 
         BorderStyle     =   0  'Kein
         Height          =   7335
         Left            =   7560
         TabIndex        =   80
         Top             =   240
         Width           =   4215
         Begin VB.ListBox List11 
            BeginProperty Font 
               Name            =   "Courier New"
               Size            =   9
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   7020
            Left            =   120
            TabIndex        =   81
            Top             =   120
            Width           =   3975
         End
      End
      Begin MSCommLib.MSComm MSComm1 
         Left            =   120
         Top             =   1080
         _ExtentX        =   1005
         _ExtentY        =   1005
         _Version        =   393216
         CommPort        =   2
         DTREnable       =   -1  'True
         Handshaking     =   1
         RThreshold      =   1
         ParitySetting   =   2
         SThreshold      =   1
      End
      Begin VB.Label Label13 
         Alignment       =   2  'Zentriert
         Caption         =   "Wenn alles okay, dann Beleg drucken und die EC-Karte zurück an Kunden!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   -1  'True
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   1455
         Index           =   2
         Left            =   240
         TabIndex        =   116
         Top             =   7080
         Visible         =   0   'False
         Width           =   3015
      End
      Begin VB.Label Label13 
         Alignment       =   2  'Zentriert
         Caption         =   "Unterschrift geprüft?"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   -1  'True
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   375
         Index           =   1
         Left            =   120
         TabIndex        =   115
         Top             =   6360
         Visible         =   0   'False
         Width           =   3015
      End
      Begin VB.Label Label13 
         Alignment       =   2  'Zentriert
         Caption         =   "Karte geprüft?"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   -1  'True
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   375
         Index           =   0
         Left            =   120
         TabIndex        =   114
         Top             =   5640
         Visible         =   0   'False
         Width           =   3015
      End
      Begin VB.Label Label11 
         Alignment       =   2  'Zentriert
         Caption         =   "Kunde / Kontoinhaber:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   495
         Index           =   4
         Left            =   600
         TabIndex        =   82
         Top             =   3120
         Visible         =   0   'False
         Width           =   6975
      End
      Begin VB.Label Label11 
         Caption         =   "0,00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   495
         Index           =   3
         Left            =   5160
         TabIndex        =   79
         Top             =   1200
         Width           =   2295
      End
      Begin VB.Label Label11 
         Alignment       =   2  'Zentriert
         Caption         =   "Zahlung über EC-Lastschrift"
         BeginProperty Font 
            Name            =   "Arial Black"
            Size            =   21.75
            Charset         =   0
            Weight          =   900
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   615
         Index           =   2
         Left            =   360
         TabIndex        =   78
         Top             =   240
         Width           =   7335
      End
      Begin VB.Label Label11 
         Caption         =   "zu zahlender Betrag:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Index           =   1
         Left            =   720
         TabIndex        =   77
         Top             =   1200
         Width           =   4215
      End
      Begin VB.Label Label11 
         Alignment       =   2  'Zentriert
         Caption         =   "Bitte die EC-Karte durch den Kartenleser ziehen!"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   18
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1215
         Index           =   0
         Left            =   840
         TabIndex        =   76
         Top             =   2040
         Width           =   6855
      End
   End
   Begin VB.Frame Frame29 
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   735
      Left            =   8160
      TabIndex        =   202
      Top             =   120
      Visible         =   0   'False
      Width           =   975
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   53
         Left            =   10560
         TabIndex        =   223
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "gehe zu Leiste 1"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   52
         Left            =   9240
         TabIndex        =   222
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Ende Arbeit"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   51
         Left            =   7920
         TabIndex        =   221
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kredit Verwalt."
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   50
         Left            =   6600
         TabIndex        =   220
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "letzter Bon"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   49
         Left            =   5280
         TabIndex        =   219
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Retoure"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   48
         Left            =   3960
         TabIndex        =   218
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Filial Tausch"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   47
         Left            =   2640
         TabIndex        =   217
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kolleg. Verkauf"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   46
         Left            =   1320
         TabIndex        =   216
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Einz."
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   825
         Index           =   45
         Left            =   120
         TabIndex        =   215
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Ausz."
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   44
         Left            =   10560
         TabIndex        =   214
         Top             =   240
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "gehe zu Leiste 2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   43
         Left            =   9240
         TabIndex        =   213
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Beginn Arbeit"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   42
         Left            =   7920
         TabIndex        =   212
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MaskColor       =   14737632
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Auswahl"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   41
         Left            =   6600
         TabIndex        =   211
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kunden Auslief"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   40
         Left            =   5280
         TabIndex        =   210
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kunden Konto"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   39
         Left            =   3960
         TabIndex        =   209
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Gutschein prüfen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   38
         Left            =   2640
         TabIndex        =   208
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "MDE"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   37
         Left            =   1320
         TabIndex        =   207
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "aus Datei"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   825
         Index           =   36
         Left            =   120
         TabIndex        =   204
         Top             =   240
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "R Beleg"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
   End
   Begin VB.Timer Timer1 
      Enabled         =   0   'False
      Left            =   360
      Top             =   7800
   End
   Begin MSCommLib.MSComm MSComm3 
      Left            =   1440
      Top             =   7680
      _ExtentX        =   1005
      _ExtentY        =   1005
      _Version        =   393216
      CommPort        =   2
      DTREnable       =   -1  'True
   End
   Begin MSCommLib.MSComm MSComm2 
      Left            =   840
      Top             =   7680
      _ExtentX        =   1005
      _ExtentY        =   1005
      _Version        =   393216
      DTREnable       =   -1  'True
   End
   Begin VB.Frame Frame2 
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   735
      Left            =   9240
      TabIndex        =   39
      Top             =   120
      Width           =   1215
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   8
         Left            =   10560
         TabIndex        =   10
         Top             =   240
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "BAR"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   15
         Left            =   9240
         TabIndex        =   9
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Zahlung Gutsch"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   17
         Left            =   7920
         TabIndex        =   8
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Karten- zahlung"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   6
         Left            =   6600
         TabIndex        =   7
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "G Z"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   5
         Left            =   5280
         TabIndex        =   6
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kredit  Vk"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   0
         Left            =   3960
         TabIndex        =   5
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "EC Last"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   10
         Left            =   2640
         TabIndex        =   4
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Waren - gruppe"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   9
         Left            =   1320
         TabIndex        =   3
         Top             =   240
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Unterbr. Fortsetz"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   825
         Index           =   11
         Left            =   120
         TabIndex        =   2
         Top             =   240
         Width           =   1185
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "ENDE"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   7
         Left            =   10560
         TabIndex        =   19
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "gehe zu Leiste 2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   14
         Left            =   9240
         TabIndex        =   18
         Top             =   1080
         Width           =   1305
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Verkauf Gutsch"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   3
         Left            =   7920
         TabIndex        =   17
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Ges Rabatt"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   4
         Left            =   6600
         TabIndex        =   16
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Art Rabatt"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   825
         Index           =   2
         Left            =   5280
         TabIndex        =   15
         Top             =   1080
         Width           =   1305
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Sond Preis"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   13
         Left            =   3960
         TabIndex        =   14
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Prov."
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   12
         Left            =   2640
         TabIndex        =   13
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kunden Best"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   1
         Left            =   1320
         TabIndex        =   12
         Top             =   1080
         Width           =   1300
         _ExtentX        =   2302
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Kunde suchen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   820
         Index           =   16
         Left            =   120
         TabIndex        =   11
         Top             =   1080
         Width           =   1180
         _ExtentX        =   2090
         _ExtentY        =   1455
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Art. suchen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
   End
   Begin VB.Frame Frame1 
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1695
      Left            =   7800
      TabIndex        =   37
      Top             =   2880
      Visible         =   0   'False
      Width           =   1695
      Begin MSComctlLib.TreeView List3 
         Height          =   2535
         Left            =   120
         TabIndex        =   359
         Top             =   240
         Width           =   11655
         _ExtentX        =   20558
         _ExtentY        =   4471
         _Version        =   393217
         LabelEdit       =   1
         Appearance      =   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Courier New"
            Size            =   12.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.ListBox List1 
         BeginProperty Font 
            Name            =   "Courier New"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2370
         Left            =   120
         TabIndex        =   38
         Top             =   240
         Width           =   11655
      End
   End
   Begin VB.CheckBox Check10 
      Alignment       =   1  'Rechts ausgerichtet
      BackColor       =   &H00C0C0C0&
      Caption         =   "mit Bon"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   7920
      TabIndex        =   396
      Top             =   2400
      Visible         =   0   'False
      Width           =   1335
   End
   Begin Crystal.CrystalReport CrystalReport1 
      Left            =   10320
      Top             =   2400
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   348160
      Destination     =   1
      WindowControlBox=   -1  'True
      WindowMaxButton =   -1  'True
      WindowMinButton =   -1  'True
      PrintFileLinesPerPage=   60
   End
   Begin MSWinsockLib.Winsock Winsock22 
      Left            =   2880
      Top             =   120
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   393216
      Protocol        =   1
   End
   Begin VB.PictureBox Picture5 
      Appearance      =   0  '2D
      BackColor       =   &H00C0C0C0&
      BorderStyle     =   0  'Kein
      ForeColor       =   &H80000008&
      Height          =   315
      Left            =   480
      MouseIcon       =   "frmWKL20.frx":2648
      MousePointer    =   99  'Benutzerdefiniert
      Picture         =   "frmWKL20.frx":2952
      ScaleHeight     =   315
      ScaleWidth      =   435
      TabIndex        =   626
      ToolTipText     =   "Brief"
      Top             =   2055
      Visible         =   0   'False
      Width           =   435
   End
   Begin MSWinsockLib.Winsock WinsockTSE 
      Left            =   1920
      Top             =   120
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   393216
      RemoteHost      =   "127.0.0.1"
      RemotePort      =   42560
   End
   Begin VB.Label LabelTSS 
      Alignment       =   2  'Zentriert
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00404000&
      Height          =   255
      Left            =   9600
      TabIndex        =   628
      Top             =   2040
      Width           =   1215
   End
   Begin VB.Label Label47 
      Alignment       =   1  'Rechts
      BackColor       =   &H00C0C0C0&
      Caption         =   "Pfad"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   6.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FF0000&
      Height          =   255
      Left            =   120
      TabIndex        =   597
      Top             =   240
      Visible         =   0   'False
      Width           =   495
   End
   Begin VB.Label Label23 
      Alignment       =   2  'Zentriert
      Appearance      =   0  '2D
      BackColor       =   &H80000005&
      BorderStyle     =   1  'Fest Einfach
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   230
      Left            =   140
      TabIndex        =   588
      Top             =   2055
      Width           =   255
   End
   Begin VB.Label Label18 
      Alignment       =   1  'Rechts
      BackColor       =   &H00C0C0C0&
      Caption         =   "Bon"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00404000&
      Height          =   255
      Left            =   10800
      TabIndex        =   368
      Top             =   2040
      Width           =   855
   End
   Begin VB.Label Label27 
      Alignment       =   2  'Zentriert
      BackColor       =   &H00C0C0C0&
      Caption         =   "Label27"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00404000&
      Height          =   255
      Left            =   3360
      TabIndex        =   336
      Top             =   2040
      Width           =   6135
   End
   Begin VB.Label Label78 
      Alignment       =   2  'Zentriert
      BackColor       =   &H00C0C0C0&
      Caption         =   "00:00:00"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   375
      Left            =   2160
      TabIndex        =   249
      Top             =   5400
      Width           =   7215
   End
   Begin VB.Label Label20 
      BackColor       =   &H00C0C0C0&
      Caption         =   "00.00.0000"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00404000&
      Height          =   255
      Index           =   3
      Left            =   1080
      TabIndex        =   232
      Top             =   2040
      Width           =   975
   End
   Begin VB.Label Label20 
      BackColor       =   &H00C0C0C0&
      Caption         =   "00:00:00"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00404000&
      Height          =   255
      Index           =   0
      Left            =   2160
      TabIndex        =   231
      Top             =   2040
      Width           =   1095
   End
   Begin VB.Label Label7 
      Alignment       =   2  'Zentriert
      BackColor       =   &H00C0C0C0&
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000C0&
      Height          =   375
      Left            =   0
      TabIndex        =   71
      Top             =   8520
      Width           =   12015
   End
End
Attribute VB_Name = "frmWKL20"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Public sMerkmal     As String
Public gbMerkmal    As Boolean
Public bhoherpreis  As Boolean
Private bAbschluss  As Boolean
Dim isperre         As Integer
Dim iCheck          As Integer
Dim bsend           As Boolean
Dim byAWM           As Integer
Dim gsFremdKuerzel  As String
Dim gsUK            As String
Dim gindi           As Integer
Dim iTastpuffer     As Integer
Dim bmerkEC         As Boolean
Dim dSumDukaten     As Double
Dim iOldPreisKZ     As Integer
Dim iMerkBestPosi   As Integer
Dim bfromFrame36    As Boolean
Dim bfromFrame46    As Boolean

Dim cGewicht As String
Dim cPreisKILO As String
Dim cEndpreis As String
Dim gbNochOffen As Boolean
Dim gb28 As Boolean
Dim bFocusonList4 As Boolean
Dim glfnnr As Long
Dim mdeErr      As Boolean
Dim bErsterAnschlag As Boolean

Private Declare Sub keybd_event Lib "user32" ( _
  ByVal bVk As Byte, _
  ByVal bScan As Byte, _
  ByVal dwFlags As Long, _
  ByVal dwExtraInfo As Long)
 
Private Declare Function VkKeyScan Lib "user32" _
  Alias "VkKeyScanA" ( _
  ByVal cChar As Byte) As Integer
 
Private Declare Function MapVirtualKey Lib "user32" _
  Alias "MapVirtualKeyA" ( _
  ByVal wCode As Long, _
  ByVal wMapType As Long) As Long
 
Private Const KEYEVENTF_KEYUP = &H2
Private Const KEYEVENTF_EXTENDEDKEY = &H1

' Virtual KeyCodes
Private Enum eVirtualKeyCode
  VK_BAK = &H8
  VK_TAB = &H9
  VK_CLEAR = &HC
  VK_RETURN = &HD
  VK_SHIFT = &H10
  VK_CONTROL = &H11
  VK_MENU = &H12
  VK_PAUSE = &H13
  VK_CAPITAL = &H14
  VK_ESCAPE = &H1B
  VK_PRIOR = &H21
  VK_NEXT = &H22
  VK_END = &H23
  VK_HOME = &H24
  VK_LEFT = &H25
  VK_UP = &H26
  VK_RIGHT = &H27
  VK_DOWN = &H28
  VK_SELECT = &H29
  VK_SNAPSHOT = &H2C  ' NEU! Windows-Taste
  VK_INSERT = &H2D
  VK_DELETE = &H2E
  VK_HELP = &H2F
  VK_F1 = &H70
  VK_F2 = &H71
  VK_F3 = &H72
  VK_F4 = &H73
  VK_F5 = &H74
  VK_F6 = &H75
  VK_F7 = &H76
  VK_F8 = &H77
  VK_F9 = &H78
  VK_F10 = &H79
  VK_F11 = &H7A
  VK_F12 = &H7B
  VK_F13 = &H7C
  VK_F14 = &H7D
  VK_F15 = &H7E
  VK_F16 = &H7F
  VK_NUMLOCK = &H90
  VK_SCROLL = &H91
  VK_WIN = &H5B     ' NEU! Windows-Taste
  VK_APPS = &H5D    ' NEU! Taste für Kontextmenü
End Enum

' Text durch Simulieren von Tastenanschlägen
' an das aktive Control senden
Public Sub SendKeysEx(ByVal sText As String)
  Dim VK As eVirtualKeyCode
  Dim sChar As String
  Dim i As Integer
  Dim bShift As Boolean
  Dim bAlt As Boolean
  Dim bCtrl As Boolean
  Dim nScan As Long
  Dim nExtended As Long
 
  ' Jedes Zeichen einzeln senden
  For i = 1 To Len(sText)
    ' aktuelles Zeichen extrahieren
    sChar = Mid$(sText, i, 1)
 
    ' Sonderzeichen?
    bShift = False: bAlt = False: bCtrl = False
    If sChar = "{" Then
      If UCase$(Mid$(sText, i + 1, 9)) = "BACKSPACE" Then
        VK = VK_BAK
        i = i + 9
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "BS" Then
        VK = VK_BAK
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "BKSP" Then
        VK = VK_BAK
        i = i + 5
      ElseIf UCase$(Mid$(sText, i + 1, 5)) = "BREAK" Then
        VK = VK_PAUSE
        i = i + 6
      ElseIf UCase$(Mid$(sText, i + 1, 8)) = "CAPSLOCK" Then
        VK = VK_CAPITAL
        i = i + 9
      ElseIf UCase$(Mid$(sText, i + 1, 6)) = "DELETE" Then
        VK = VK_DELETE
        i = i + 7
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "DEL" Then
        VK = VK_DELETE
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "DOWN" Then
        VK = VK_DOWN
        i = i + 5
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "UP" Then
        VK = VK_UP
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "LEFT" Then
        VK = VK_LEFT
        i = i + 5
      ElseIf UCase$(Mid$(sText, i + 1, 5)) = "RIGHT" Then
        VK = VK_RIGHT
        i = i + 6
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "END" Then
        VK = VK_END
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 5)) = "ENTER" Then
        VK = VK_RETURN
        i = i + 6
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "HOME" Then
        VK = VK_HOME
        i = i + 5
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "ESC" Then
        VK = VK_ESCAPE
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "HELP" Then
        VK = VK_HELP
        i = i + 5
      ElseIf UCase$(Mid$(sText, i + 1, 6)) = "INSERT" Then
        VK = VK_INSERT
        i = i + 7
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "INS" Then
        VK = VK_INSERT
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 7)) = "NUMLOCK" Then
        VK = VK_NUMLOCK
        i = i + 8
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "PGUP" Then
        VK = VK_PRIOR
        i = i + 5
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "PGDN" Then
        VK = VK_NEXT
        i = i + 5
      ElseIf UCase$(Mid$(sText, i + 1, 10)) = "SCROLLLOCK" Then
        VK = VK_SCROLL
        i = i + 11
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "TAB" Then
        VK = VK_TAB
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F1" Then
        VK = VK_F1
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F2" Then
        VK = VK_F2
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F3" Then
        VK = VK_F3
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F4" Then
        VK = VK_F4
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F5" Then
        VK = VK_F5
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F6" Then
        VK = VK_F6
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F7" Then
        VK = VK_F7
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F8" Then
        VK = VK_F8
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 2)) = "F9" Then
        VK = VK_F9
        i = i + 3
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "F10" Then
        VK = VK_F10
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "F11" Then
        VK = VK_F11
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "F12" Then
        VK = VK_F12
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "F13" Then
        VK = VK_F13
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "F14" Then
        VK = VK_F14
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "F15" Then
        VK = VK_F15
        i = i + 4
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "F16" Then
        VK = VK_F16
        i = i + 4
 
      ' NEU! Windows-Taste
      ElseIf UCase$(Mid$(sText, i + 1, 3)) = "WIN" Then
        VK = VK_WIN
        i = i + 4
 
      ' NEU! Kontextmenü
      ElseIf UCase$(Mid$(sText, i + 1, 4)) = "APPS" Then
        VK = VK_APPS
        i = i + 5
 
      ' NEU! PrintScreen-Taste (DRUCK)
      ElseIf UCase$(Mid$(sText, i + 1, 5)) = "PRINT" Then
        VK = VK_SNAPSHOT
        i = i + 6
      End If
 
    ElseIf sChar = "+" Then
      ' Umschalttaste
      VK = VK_SHIFT
 
    ElseIf sChar = "%" Then
      ' ALT
      VK = VK_MENU
 
    ElseIf sChar = "^" Then
      ' STRG
      VK = VK_CONTROL
 
    Else
      ' Virtual KeyCode ermitteln...
      VK = VkKeyScan(Asc(sChar))
    End If
 
    nScan = MapVirtualKey(VK, 2)
    nExtended = 0
    If nScan = 0 Then nExtended = KEYEVENTF_EXTENDEDKEY
    nScan = MapVirtualKey(VK, 0)
 
    If VK <> VK_SHIFT Then
      ' Großbuchstabe...?
      bShift = (VK And &H100)
      bCtrl = (VK And &H200)
      bAlt = (VK And &H400)
      VK = (VK And &HFF)
    End If
 
    ' niederdrücken und wieder loslassen
    If bShift Then keybd_event VK_SHIFT, 0, 0, 0
    If bCtrl Then keybd_event VK_CONTROL, 0, 0, 0
    If bAlt Then keybd_event VK_MENU, 0, 0, 0
 
    keybd_event VK, nScan, nExtended, 0
    keybd_event VK, nScan, KEYEVENTF_KEYUP Or nExtended, 0
 
    ' Shift (Umsch)-Taste wieder loslassen
    If bShift Then keybd_event VK_SHIFT, 0, KEYEVENTF_KEYUP, 0
    If bCtrl Then keybd_event VK_CONTROL, 0, KEYEVENTF_KEYUP, 0
    If bAlt Then keybd_event VK_MENU, 0, KEYEVENTF_KEYUP, 0
  Next i
End Sub
'Dim glTimer3Count As Long
Public Sub PositionierenWKL20()
    On Error GoTo LOKAL_ERROR
    
    Frame1.Top = 2280
    Frame1.Left = 0
    Frame1.Height = 3255
    Frame1.Width = 11895
    
    Frame2.Top = 0
    Frame2.Left = 0
    Frame2.Height = 2055
    Frame2.Width = 11895
    
    Frame13.Top = 3720
    Frame13.Left = 240
    Frame13.Height = 2775
    Frame13.Width = 6735
    
    Frame14.Top = 0
    Frame14.Left = 0
    Frame14.Height = 5385
    Frame14.Width = 11895
    
    Frame15.Top = 2550
    Frame15.Width = 5895
    Frame15.Left = 3960
    Frame15.Height = 2175
    
    Frame16.Top = 3720
    Frame16.Left = 240
    Frame16.Height = 1095
    Frame16.Width = 6735
    
'    Frame16.Top = 3720
'    Frame16.Left = 240
'    Frame16.Height = 2775
'    Frame16.Width = 6735
    
    Frame23.Top = 0
    Frame23.Left = 0
    Frame23.Height = 2055
    Frame23.Width = 11895
    
    Frame29.Top = 0
    Frame29.Left = 0
    Frame29.Height = 2055
    Frame29.Width = 11895
    
    Frame3.Top = 5040
    Frame3.Left = 0
    Frame3.Height = 2535 '2055
    Frame3.Width = 11895
'    Frame3.BorderStyle = 1
    
    Frame4.Top = 7680 '7540 '7440
    Frame4.Left = 0
    Frame4.Height = 1215
    Frame4.Width = 11895
    
    Frame5.Height = 9000
    Frame5.Width = 12000
    Frame5.Top = 0
    Frame5.Left = 0
    
    Frame6.Top = 0
    Frame6.Left = 0
    Frame6.Height = 9000
    Frame6.Width = 12000
    
    Frame8.Top = 0
    Frame8.Left = 0
    Frame8.Height = 9000
    Frame8.Width = 12000
               
    Frame9.Top = 4560
    Frame9.Left = 0
    Frame9.Height = 3855
    Frame9.Width = 11895

    Frame10.Height = 6855
    Frame10.Width = 7215
    Frame10.Top = 360
    Frame10.Left = 2400
    
    Frame12.Height = 9000
    Frame12.Width = 12000
    Frame12.Top = 0
    Frame12.Left = 0
       
    Frame18.Top = 0
    Frame18.Left = 0
    Frame18.Height = 9000
    Frame18.Width = 12000

    Frame20.Height = 3495
    Frame20.Width = 9135
    Frame20.Top = 3600
    Frame20.Left = 240
    
    Frame21.Top = 7080
    Frame21.Width = 9135
    Frame21.Left = 240
    Frame21.Height = 1335
    
    Frame24.Top = 0
    Frame24.Left = 0
    Frame24.Height = 8895
    Frame24.Width = 11895
    
    Frame27.Height = 6135
    Frame27.Width = 11055
    Frame27.Top = 2400
    Frame27.Left = 360
       
    Frame33.Height = 7550 '6855
    Frame33.Width = 9735 '7215
    Frame33.Top = 90
    Frame33.Left = 1080 '2400
    
    List4.Height = 4935 '5295
    List4.Width = 11655
    List4.Top = 2760 ' 2400
    List4.Left = 120
    
    List2.Height = 870
    List2.Width = 11655
    List2.Top = 2400 '2160
    List2.Left = 120
    
    Frame26.Height = 9000
    Frame26.Width = 12000
    Frame26.Top = 0
    Frame26.Left = 0
    Frame26.ZOrder 0
    
    Frame30.Height = 9000
    Frame30.Width = 12000
    Frame30.Top = 0
    Frame30.Left = 0
    
    Frame7.Top = 0
    Frame7.Left = 4560
    Frame7.Height = 495
    Frame7.Width = 7215
    
    Frame40.BorderStyle = 0
'    Frame30.Left = 0
    
    Dim i As Integer
    Dim iLeft As Integer
    
'    MsgBox Screen.Height
    
    If Screen.Height >= 12000 Then

        Frame40.BorderStyle = 0
        Frame40.Height = 3100
        Frame40.Width = 18000
        Frame40.Top = 5400 '5160

        For i = 0 To 7
            SSCommand33(i).Height = 1700
            SSCommand33(i).Width = 1700
            SSCommand33(i).Top = 120
        Next i

        iLeft = 200
        For i = 0 To 7
            iLeft = iLeft + 1700 + 60
            SSCommand33(i).Left = iLeft
        Next i

        For i = 8 To 14
            SSCommand33(i).Height = 1100
            SSCommand33(i).Width = 2000
            SSCommand33(i).Top = 1880
        Next i

        SSCommand33(8).Left = 1800
        iLeft = 1800
        For i = 9 To 14
            iLeft = iLeft + 2000 + 60
            SSCommand33(i).Left = iLeft
        Next i

    Else
    
        Frame40.BorderStyle = 0
        Frame40.Height = 2055
        Frame40.Width = 9735
        Frame40.Top = 5400 '5160
    
        For i = 0 To 7
            SSCommand33(i).Height = 975
            SSCommand33(i).Width = 1020
            SSCommand33(i).Top = 120
        Next i
        
        SSCommand33(0).Left = 600
        iLeft = 600
        For i = 1 To 7
            iLeft = iLeft + 1060
            SSCommand33(i).Left = iLeft
        Next i
        
        For i = 8 To 14
            SSCommand33(i).Height = 735
            SSCommand33(i).Width = 1335
            SSCommand33(i).Top = 1200
        Next i
        
        SSCommand33(0).Left = 600
        iLeft = 0
        For i = 9 To 14
            iLeft = iLeft + 1336 + 60
            SSCommand33(i).Left = iLeft
        Next i
    
    End If
    
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "PositionierenWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub AktualisiereZeileZwischenSummeWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lAnzZeilen  As Long
    Dim cLBSatz     As String
    Dim cArtNr      As String
    Dim cPreis      As String
    Dim dPreis      As Double
    Dim dZwiSum     As Double
    
    lAnzZeilen = List1.ListCount
    dZwiSum = 0
    For lcount = 0 To lAnzZeilen - 1
        cLBSatz = List1.list(lcount)
        cArtNr = Mid(cLBSatz, 7, 6)
        If cArtNr <> "000000" Then
            cPreis = Mid(cLBSatz, 60, 9)
            cPreis = fnMoveComma2Point$(cPreis)
            dPreis = Val(cPreis)
            dZwiSum = dZwiSum + dPreis
        Else
            If dZwiSum <> 0 Then
                cPreis = Format$(dZwiSum, "#####0.00")
                cPreis = Space$(9 - Len(cPreis)) & cPreis
                Mid(cLBSatz, 60, 9) = cPreis
                If Len(cLBSatz) >= 154 Then
                    Mid(cLBSatz, 154, 1) = "N"
                Else
                    cLBSatz = cLBSatz & Space$(154 - Len(cLBSatz) - 1)
                    cLBSatz = cLBSatz & "N"
                End If
                
                List1.RemoveItem lcount
                List1.AddItem cLBSatz, lcount
            Else
                List1.RemoveItem lcount
            End If
        End If
    Next lcount
    
    List3.Nodes.Clear
    lAnzZeilen = List1.ListCount
    For lcount = 0 To lAnzZeilen - 1
        cLBSatz = ""
        cLBSatz = List1.list(lcount)
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
    Next lcount
    
    farbelist3
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AktualisiereZeileZwischenSummeWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub ArtikelausWarenkorbraus(sArtnrRaus As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lAnzZeilen  As Long
    Dim cLBSatz     As String
    Dim cArtNr      As String

    lAnzZeilen = List1.ListCount
    For lcount = 0 To lAnzZeilen - 1
        cLBSatz = List1.list(lcount)
        cArtNr = Mid(cLBSatz, 7, 6)
        If cArtNr = sArtnrRaus Then
            List1.RemoveItem lcount
            List3.Nodes.Remove lcount + 1
        End If
    Next lcount
    
    'neu 13.12.17
    AktualisiereListboxWKL20
    AktualisiereZeileZwischenSummeWKL20
    'neu ende
        
        
        
'    BerechneZwischenSummeWKL20
'
'    farbelist3
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ArtikelausWarenkorbraus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub AktualisiereZeileXMarkierung(iPos As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lAnzZeilen  As Long
    Dim cLBSatz     As String
    Dim cArtNr      As String
    Dim cPreis      As String
    Dim dPreis      As Double
    
    lAnzZeilen = List1.ListCount
    
    For lcount = 0 To lAnzZeilen - 1
        cLBSatz = List1.list(lcount)
        If lcount = iPos - 1 Then
            cLBSatz = "x" & Mid(cLBSatz, 2, Len(cLBSatz) - 1)
        End If
        
        List1.RemoveItem lcount
        List1.AddItem cLBSatz, lcount
            
    Next lcount
    
    List3.Nodes.Clear
    lAnzZeilen = List1.ListCount
    For lcount = 0 To lAnzZeilen - 1
        cLBSatz = ""
        cLBSatz = List1.list(lcount)
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
    Next lcount
    
    farbelist3
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AktualisiereZeileXMarkierung"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function checkGutschein() As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lAnzZeilen  As Long
    Dim cLBSatz     As String
    Dim cArtNr      As String
    
    checkGutschein = False
    
    lAnzZeilen = List1.ListCount
    
    For lcount = 0 To lAnzZeilen - 1
        cLBSatz = List1.list(lcount)
        cArtNr = Mid(cLBSatz, 7, 6)
        If cArtNr = "666666" Then
            checkGutschein = True
            Exit For
        End If
    Next lcount
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "checkGutschein"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Function alleGutscheineZeigen()
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lAnzZeilen  As Long
    Dim cLBSatz     As String
    Dim cArtNr      As String
    Dim cCode       As String
    Dim cPreis      As String
    Dim cPreisText  As String
    lAnzZeilen = List1.ListCount
    
    List6.Clear
    
    For lcount = 0 To lAnzZeilen - 1
        cLBSatz = List1.list(lcount)
        cArtNr = Mid(cLBSatz, 7, 6)
        If cArtNr = "666666" Then
        
            cCode = Trim$(Mid(cLBSatz, 24, 10))
            cPreis = Trim$(Mid(cLBSatz, 53, 7))
            
            List6.AddItem cCode & Space(10 - Len(cCode)) & cPreis
        End If
    Next lcount
    
    

    
   
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "alleGutscheineZeigen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Function
Private Sub BildeDatenStromWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim cDatenStrom As String
    Dim ctmp        As String
    Dim iRet        As Integer
    
'    If Mid(gECKarte.Datenstrom, 39, 4) <> "0159" Then
    
    cDatenStrom = "67" & String$(6, "0")
    ctmp = Text6(0).Text
    ctmp = Trim$(ctmp)
    ctmp = String$(10 - Len(ctmp), "0") & ctmp & String$(20, "0") & "0159"
    
    
    cDatenStrom = cDatenStrom & ctmp & vbCr
    
    
    ctmp = Text6(3).Text
    ctmp = Trim$(ctmp)
    ctmp = String$(2 - Len(ctmp), "0") & ctmp
    cDatenStrom = cDatenStrom & ctmp
    
    ctmp = Text6(2).Text
    ctmp = Trim$(ctmp)
    ctmp = String$(2 - Len(ctmp), "0") & ctmp
    cDatenStrom = cDatenStrom & ctmp
    
    ctmp = Text6(1).Text
    ctmp = Trim$(ctmp) & String$(1, "0")
    
    cDatenStrom = cDatenStrom & ctmp
    
    ctmp = Text6(0).Text
    ctmp = Trim$(ctmp)
    ctmp = String$(10 - Len(ctmp), "0") & ctmp
    
    cDatenStrom = cDatenStrom & ctmp & vbCrLf
    
    
    gECKarte.Datenstrom = cDatenStrom
    
    iRet = fnPruefeDatenstromECKarteWKL20()
    If iRet <> 0 Then
        LeereDatenECKarteWKL20
    Else
        LeseDatenECLastschriftWKL20
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BildeDatenStrom"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Function fnPruefeEingabeECKarte() As Integer


    On Error GoTo LOKAL_ERROR
    
    Dim ctmp        As String
    
    fnPruefeEingabeECKarte = 0
    
    ctmp = Text6(0).Text
    ctmp = Trim$(ctmp)
    If ctmp = "" Then
        fnPruefeEingabeECKarte = 1
        Exit Function
    End If
    
    ctmp = Text6(1).Text
    ctmp = Trim$(ctmp)
    If ctmp = "" Then
        fnPruefeEingabeECKarte = 2
        Exit Function
    End If
    
    ctmp = Text6(2).Text
    ctmp = Trim$(ctmp)
    If ctmp = "" Then
        fnPruefeEingabeECKarte = 3
        Exit Function
    End If
    
    If Val(ctmp) < 1 Or Val(ctmp) > 12 Then
        fnPruefeEingabeECKarte = 5
        Exit Function
    End If
    
    ctmp = String$(2 - Len(ctmp), "0") & ctmp
    Text6(2).Text = ctmp
    
    ctmp = Text6(3).Text
    ctmp = Trim$(ctmp)
    If ctmp = "" Then
        fnPruefeEingabeECKarte = 4
        Exit Function
    End If
    
    ctmp = String$(2 - Len(ctmp), "0") & ctmp
    Text6(3).Text = ctmp
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnPruefeEingabeECKarte"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Public Sub DeleteGutscheinWKL20(cGutschnr As String) 'geprüft
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL    As String
    Dim rsrs    As Recordset
    Dim sWert   As String
    
    If gbKL_LIVEGUTSCHEIN Then
    
    
    
        If fTestLogin_SQLDABA_Error = 0 Then 'ist alles OK? Datenbank erreichbar?
            'alles okay
            
        Else
        
            schreibeProtokollVPNTXT "Unterbrechung"
        
            Dim sTemp As String
            sTemp = "Bitte starten Sie diesen Rechner neu" & vbCrLf
            sTemp = sTemp & "oder schließen Sie das Schloss und starten Sie WinKiss neu."
        
            MsgBox sTemp, vbCritical + vbOKOnly, "Gutschein-Datenbank nicht erreichbar"
            Exit Sub
        End If
    
    
        Dim stConnect As String
        If gsKL_DSN <> "" Then
            stConnect = "ODBC;DSN=" & gsKL_DSN & ";UID=" & gsKL_BENUTZER & ";PWD=" & gsKL_PASSWORT & ""
        Else
            stConnect = "ODBC;DRIVER=SQL Server;SERVER=" & gsKL_ADRESSE & ";DATABASE=" & gsKL_DATENBANKNAME & ";UID=" & gsKL_BENUTZER & ";PWD=" & gsKL_PASSWORT & ""
        End If
        
        
        Dim dbEAN As DAO.Database
        Set dbEAN = OpenDatabase(gsKL_DATENBANKNAME, dbDriverNoPrompt, False, stConnect)
        
        
        cSQL = "Select * from GUTSCHEINE where GUTSCHNR = '" & cGutschnr & "'"
        cSQL = cSQL & " and EINL_DATUM > 0  "
        Set rsrs = dbEAN.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            MsgBox "Gutschein " & cGutschnr & " wurde bereits eingelöst!"
        Else
            cSQL = "Delete from GUTSCHEINE where GUTSCHNR = '" & cGutschnr & "'"
            dbEAN.Execute cSQL, dbSQLPassThrough + dbFailOnError
        End If
        
        dbEAN.Close
    Else
    
        sWert = "L"
        cSQL = "Select * from GUTSCH where GUTSCHNR = " & cGutschnr
        FnOpenrecordset rsrs, cSQL, 1, gdBase

        If Not rsrs.EOF Then
            rsrs.MoveFirst
            If Not IsNull(rsrs!DAT_EINL) Then
                MsgBox "Gutschein " & cGutschnr & " wurde bereits eingelöst!"
            Else
                rsrs.Edit
                rsrs!SYNStatus = "D"
                rsrs!Status = sWert
                rsrs.Update
            End If
        End If
        rsrs.Close: Set rsrs = Nothing
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DeleteGutscheinWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub DruckeGutscheinBonWKL20(cLBSatz As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzZeile       As Long
    Dim lcount          As Long
    Dim cDaten          As String
    Dim cEscapeSequenz  As String
    Dim aDeviceName     As String
    Dim ctmp            As String
    Dim cGutschnr       As String
    Dim cGPreis         As String
    
    Dim iStufe          As Integer
    Dim iLenZeile       As Integer
    ReDim cDruckZeile(1 To 1) As String
    
    If Not gbBonDruck Then
        GoTo ENDE
    End If
    
    iStufe = 0
    
    cGPreis = Mid(cLBSatz, 60, 9)
    ctmp = Mid(cLBSatz, 24, 8)
    ctmp = Trim(ctmp)
    cGutschnr = ctmp
    
    iLenZeile = 32
    'Drucker ist bereits auf BonDrucker geschaltet
    aDeviceName = gcBonDrucker
    
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************

    If gcBild <> "" Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcBild
        OpenDrawer aDeviceName, cEscapeSequenz
    End If

    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    

    Barcode_Gutschein Trim(ctmp)

    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    

    iStufe = 1
    '******************************************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "K.I.S.S. Warenwirtschaft"
    Else
        cDaten = gcBonText(0)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        iStufe = 2
    End If
    '******************************************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "Carsten Schröder"
    Else
        cDaten = gcBonText(1)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        iStufe = 3
    End If
    '******************************************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(4)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        iStufe = 3
    End If
    
    '***********************************************
    'Kopfdaten 4.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(12)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    '******************************************************************
    
    cDaten = String$(iLenZeile, "-")
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    iStufe = 4
    
    '******************************************************************
    'hier
    cDaten = "G U T S C H E I N V E R K A U F"
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    iStufe = 5
    '******************************************************************
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = " " & vbCrLf
        
    iStufe = 6
    '******************************************************************
        
    cDaten = "Wert Gutscheins:    " & gcWaehrung & cGPreis
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    iStufe = 7
    '******************************************************************
   
    cDaten = "Nummer Gutschein:" & Space(15 - Len(ctmp)) & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    iStufe = 8
    '******************************************************************
    gcFilNr = Trim(gcFilNr)
    cDaten = "Nummer der Filiale:" & Space(13 - Len(gcFilNr)) & gcFilNr
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    ctmp = "Kasse:                         " & gcKasNum
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    iStufe = 9
    '******************************************************************
    ctmp = Trim$(Text1(0).Text)
    ctmp = Trim$(ctmp)
    ctmp = Space$(3 - Len(ctmp)) & ctmp
    cDaten = "Bedienernummer:              " & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    iStufe = 10
    '******************************************************************
    ctmp = Trim$(Str$(gdBonNr))
    ctmp = Trim$(ctmp)
    ctmp = gcKasNum & "/" & ctmp
    ctmp = Space$(10 - Len(ctmp)) & ctmp
    
    cDaten = "Belegnummer:          " & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    iStufe = 11
    '******************************************************************
    ctmp = Format$(Now, "DD.MM.YYYY")
    cDaten = "Datum:                " & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    iStufe = 12
    '******************************************************************
    
    cDaten = String$(iLenZeile, "-")
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    If gbBonGu2J Then
        cDaten = "Gültigkeitsdauer 4 Jahre"
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        cDaten = "nach Ausstellungsdatum"
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    
    iStufe = 13
    '******************************************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "KEIN GÜLTIGER KASSENBON!"
    Else
        cDaten = gcBonText(2)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iStufe = 14
    End If
    
    '******************************************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(3)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iStufe = 15
    End If
    '******************************************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = ""
    Else
        cDaten = gcBonText(5)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iStufe = 15
    End If
    '******************************************************************
    
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = "." & vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
    iStufe = 16
    
    If gbAPI = True Then
        OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
    Else
        OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
    End If
    
    gdSumme = cGPreis
    
    SichernBonDaten cDruckZeile(), lAnzZeile, "", "", False, True
    
    Erase cDruckZeile
    iStufe = 17
    
    
    
    
''    '*****+++Barcode
'''    If gbBonDruck Then
''
''
''        Barcode_Gutschein cGutschnr
''
''
'''    End If
''
'BON_SCHNEIDEN:
'    'Kassenbon abschneiden
'    If gbAPI Then
'        aDeviceName = Printer.DeviceName
'        cEscapeSequenz = gcSchneiden
'        OpenDrawer aDeviceName, cEscapeSequenz
'    End If
    iStufe = 18
    
ENDE:

    '...und tschüß!
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeGutscheinBonWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub DruckeZweitenKassenbonNeu()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzZeile           As Long
    Dim lHeute              As Long
    Dim lPos                As Long
    Dim lStart              As Long
    Dim lZeile              As Long
    
    Dim aDeviceName         As String
    Dim cEscapeSequenz      As String
    Dim cSQL                As String
    Dim cFeld               As String
    Dim cZeile              As String
    Dim dDruckbon           As Double
    Dim cBetrag             As String
    Dim rsrs                As Recordset
    
    ReDim cDruckZeile(1 To 1) As String
    
    HoleNeueBonNrWKL20
    
    If gdBonNr <= 1000 Then
        Exit Sub
    Else
        dDruckbon = gdBonNr - 1
    End If

    lHeute = Fix(Now)
    
    cSQL = "Select * from KASSBON "
    cSQL = cSQL & "where DATUM = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    cSQL = cSQL & "and BONNR = " & dDruckbon & " "
'    cSQL = cSQL & "and UHRZEIT = '" & cUhrZeit & "' "
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!BONTEXT) Then
            cFeld = rsrs!BONTEXT
        Else
            cFeld = ""
        End If
    Else
        cFeld = ""
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If cFeld = "" Then
        Exit Sub
    End If
    
    
    If gbBonkopie = True Then
        lZeile = 1
        cZeile = "Kopie" & vbCrLf
        ReDim Preserve cDruckZeile(1 To lZeile) As String
        KonvertAnsiAscii cZeile
        cDruckZeile(lZeile) = cZeile
        
        lZeile = 2
    Else
        lZeile = 1

    End If
    

    KonvertAnsiAscii cFeld
    
    lStart = 1
    
    cZeile = ""
    Do While lStart < Len(cFeld)
        lPos = InStr(lStart, cFeld, vbCrLf)
        If lPos <> 0 Then
            cZeile = Mid(cFeld, lStart, lPos - lStart + 2)
            If Right(cZeile, 2) <> vbCrLf Then
                cZeile = cZeile & vbCrLf
            End If
            lZeile = lZeile + 1
            ReDim Preserve cDruckZeile(1 To lZeile) As String
            cDruckZeile(lZeile) = cZeile
        End If
        lStart = lPos + 2
        If lStart = 0 Then
            Exit Do
        End If
    Loop

    '****************************************
    '* jetzt den ausgewählten Bon drucken   *
    '****************************************
'''    setzedrucker gcBonDrucker
    
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit

    OpenDrawer aDeviceName, cEscapeSequenz
    
    'Bild neu
    If gcBild <> "" Then
        cEscapeSequenz = gcBild
        OpenDrawer aDeviceName, cEscapeSequenz
    End If
    
    'ende bild neu
    
    

    If gbAPI = True Then
        OpenDrawer3 aDeviceName, cDruckZeile(), lZeile
    Else
        OpenDrawer4 aDeviceName, cDruckZeile(), lZeile
    End If
    
    'Kassenbon abschneiden
    If gbAPI = True Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcSchneiden
        OpenDrawer aDeviceName, cEscapeSequenz
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeZweitenKassenbonNeu"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub ZeigeZweitenKassenBon(cAuswahl As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzZeile         As Long
    Dim lHeute            As Long
    Dim lWeekday          As Long
    Dim lSuchtag          As Long
    Dim lPos              As Long
    Dim lStart            As Long
    Dim lZeile            As Long
    
    Dim aDeviceName         As String
    Dim cEscapeSequenz      As String
    Dim cSQL                As String
    Dim cFeld               As String
    Dim cZeile              As String
    Dim cBonNr              As String
    Dim cUhrZeit            As String
    Dim cBetrag             As String
    Dim rsrs                As Recordset
    Dim cWoTag              As String
    Dim iCount              As Integer
    
    ReDim cDruckZeile(1 To 1) As String
    
    For iCount = 0 To 6
        If Option1(iCount).value = True Then
            cWoTag = Option1(iCount).Caption
            Exit For
        End If
    Next iCount
    cWoTag = Left(cWoTag, 2)
    
    cBonNr = Trim$(Left(cAuswahl, 6))
    cUhrZeit = Trim(Right(cAuswahl, 8))
    
    lHeute = Fix(Now)
    lWeekday = Weekday(lHeute, vbMonday)
    Select Case cWoTag
        Case Is = "MO"
            lSuchtag = 1
        Case Is = "DI"
            lSuchtag = 2
        Case Is = "MI"
            lSuchtag = 3
        Case Is = "DO"
            lSuchtag = 4
        Case Is = "FR"
            lSuchtag = 5
        Case Is = "SA"
            lSuchtag = 6
        Case Is = "SO"
            lSuchtag = 7
    End Select
    
    If lWeekday > lSuchtag Then                 'lHeute um Differenz reduzieren
        lHeute = lHeute - lWeekday + lSuchtag
    End If
    
    If lWeekday = lSuchtag Then  'nichts tun! lHeute ist okay
    End If
    
    If lWeekday < lSuchtag Then
        lHeute = lHeute - (lWeekday + 7) + lSuchtag
    End If

    cSQL = "Select * from KASSBON "
    cSQL = cSQL & "where DATUM = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    cSQL = cSQL & "and BONNR = " & cBonNr & " "
    cSQL = cSQL & "and UHRZEIT = '" & cUhrZeit & "' "
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!BONTEXT) Then
            cFeld = rsrs!BONTEXT
        Else
            cFeld = ""
        End If
        ''''''''''' Odayy Neu '''''''''''''''
         If Not IsNull(rsrs!QRCODE) Then
            R_QRCodeAlsImgPath = rsrs!QRCODE
         Else
            R_QRCodeAlsImgPath = ""
         End If
        ''''''''''' Odayy Neu '''''''''''''''
    Else
        cFeld = ""
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If cFeld = "" Then
        Exit Sub
    End If
    
    If Mid(cFeld, 5, 1) = "@" Then
        cFeld = Right(cFeld, Len(cFeld) - 7)
    End If
    
    
    lStart = 1
    
    
    List5.Clear
    
    If gbBonkopie = True Then
        cZeile = "Kopie"
        List5.AddItem cZeile
    End If
    
     
    Dim ZeilenZumTrimNachSignatur As Integer
    ZeilenZumTrimNachSignatur = 0
    
    cZeile = ""
    Do While lStart < Len(cFeld)
        lPos = InStr(lStart, cFeld, vbCrLf)
        If lPos <> 0 Then
            cZeile = Mid(cFeld, lStart, lPos - lStart + 2)
            If Right(cZeile, 2) <> vbCrLf Then
                cZeile = cZeile & vbCrLf
            End If
            lZeile = lZeile + 1
            cZeile = SwapStr(cZeile, Chr(13), "")
            cZeile = SwapStr(cZeile, Chr(10), "")
            If Trim(cZeile) = "TSE Signatur:" Then
              ZeilenZumTrimNachSignatur = 5
            End If
            If ZeilenZumTrimNachSignatur > 0 Then
              cZeile = LTrim(cZeile)
              ZeilenZumTrimNachSignatur = ZeilenZumTrimNachSignatur - 1
            End If
            List5.AddItem cZeile
        End If
        lStart = lPos + 2
        If lStart = 0 Then
            Exit Do
        End If
    Loop
    



Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ZeigeZweitenKassenBon"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub ZeigeletztenKassenBon(cBonNr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzZeile         As Long
    Dim lHeute            As Long
    Dim lPos              As Long
    Dim lStart            As Long
    Dim lZeile            As Long
    
    Dim aDeviceName         As String
    Dim cEscapeSequenz      As String
    Dim cSQL                As String
    Dim cFeld               As String
    Dim cZeile              As String
    Dim cBetrag             As String
    Dim rsrs                As Recordset
    Dim cWoTag              As String
    Dim iCount              As Integer
    
    ReDim cDruckZeile(1 To 1) As String
    
    lHeute = Fix(Now)
    
    cSQL = "Select * from KASSBON "
    cSQL = cSQL & "where DATUM = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    cSQL = cSQL & "and BONNR = " & cBonNr & " "
    cSQL = cSQL & " order by Uhrzeit desc "
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!BONTEXT) Then
            cFeld = rsrs!BONTEXT
        Else
            cFeld = ""
        End If
        
        '''''''''''' Odayy Neu '''''''''''''''
         If Not IsNull(rsrs!QRCODE) Then
            R_QRCodeAlsImgPath = rsrs!QRCODE
         Else
            R_QRCodeAlsImgPath = ""
         End If
        '''''''''''' Odayy Neu '''''''''''''''
    Else
        cFeld = ""
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If cFeld = "" Then
        Exit Sub
    End If
    
    If Mid(cFeld, 5, 1) = "@" Then
        cFeld = Right(cFeld, Len(cFeld) - 7)
    End If
    
    
    lStart = 1
    
    
    List5.Clear
    
'    If gbBonkopie = True Then
'        cZeile = "Kopie"
'        List5.AddItem cZeile
'    End If
    
    Dim ZeilenZumTrimNachSignatur As Integer
    ZeilenZumTrimNachSignatur = 0
    
    cZeile = ""
    Do While lStart < Len(cFeld)
        lPos = InStr(lStart, cFeld, vbCrLf)
        If lPos <> 0 Then
            cZeile = Mid(cFeld, lStart, lPos - lStart + 2)
            If Right(cZeile, 2) <> vbCrLf Then
                cZeile = cZeile & vbCrLf
            End If
            lZeile = lZeile + 1
            cZeile = SwapStr(cZeile, Chr(13), "")
            cZeile = SwapStr(cZeile, Chr(10), "")
            
            If Trim(cZeile) = "TSE Signatur:" Then
              ZeilenZumTrimNachSignatur = 5
            End If
            If ZeilenZumTrimNachSignatur > 0 Then
              cZeile = LTrim(cZeile)
              ZeilenZumTrimNachSignatur = ZeilenZumTrimNachSignatur - 1
            End If
            
            List5.AddItem cZeile
        End If
        lStart = lPos + 2
        If lStart = 0 Then
            Exit Do
        End If
    Loop


Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ZeigeletztenKassenBon"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub ErzeugeGutscheinWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lGutschnr   As Long
    Dim lbednu      As Long
    Dim lDatum      As Long
    Dim lKUNDNR     As Long
    Dim dWert       As Double
    Dim dAnz        As Double
    Dim dCount      As Double
    
    Dim ctmp        As String
    Dim cArtNr      As String
    Dim cBezeich    As String
    Dim cMin        As String
    Dim cMax        As String
    Dim cSQL        As String
    Dim sWert       As String
    Dim rsrs        As Recordset
    
    sWert = "A"
    dAnz = Label2(5).Caption
    cArtNr = "666666"
    For dCount = 1 To dAnz

        lGutschnr = NewGutschein
        If lGutschnr = 0 Then
            Exit Sub
        End If
        
        lbednu = Val(Text1(0).Text)
        lDatum = Fix(Now)
        ctmp = Text1(1).Text
        If InStr(ctmp, ",") = 0 Then
            If Len(ctmp) > 1 Then
                ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
            ElseIf Len(ctmp) = 1 Then
                ctmp = ",0" & Trim(ctmp)
            End If
        End If
        
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
        lKUNDNR = Val(Label2(7).Caption)
        
        Insert_Gutschein lGutschnr, lKUNDNR, dWert, lbednu, gcFilNr, gcKasNum, "ERSTGUTSCHEIN", lDatum, sWert
        

        
        cBezeich = "GUTSCHEIN " & Trim(Str$(lGutschnr))
        MoveGutschein2ListboxWKL20 dWert, cBezeich, gbGutscheinBeiVKversteuern
    Next dCount
    Ready4NextInputWKL20
    Text1(1).SetFocus

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ErzeugeGutscheinWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    Resume Next
End Sub
Private Sub ErfasseGutscheinWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lGutschnr   As Long
    Dim lbednu      As Long
    Dim lDatum      As Long
    Dim lKUNDNR     As Long
    
    Dim ctmp        As String
    Dim cArtNr      As String
    Dim cBezeich    As String
    Dim cMin        As String
    Dim cMax        As String
    Dim cSQL        As String
    Dim sWert       As String
    Dim dAnz        As Double
    Dim dCount      As Double
    Dim dWert       As Double
    Dim rsrs        As Recordset
    
    sWert = "A"
    
    dAnz = Label2(5).Caption
    cArtNr = "666666"
    For dCount = 1 To dAnz
        If gbabbruchG = True Then
            gbabbruchG = False
            Exit Sub
        End If
        frmWKLak.Show 1
        If glGutschNr > -1 Then
            lGutschnr = glGutschNr
            
            lbednu = Val(Text1(0).Text)
            lDatum = Fix(Now)
            ctmp = Text1(1).Text
            
            If Len(ctmp) = 1 Then
                ctmp = "01"
            End If
            If InStr(ctmp, ",") = 0 Then
                ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
            End If
            
            ctmp = fnMoveComma2Point$(ctmp)
            
            dWert = Val(ctmp)
            
            lKUNDNR = Val(Label2(7).Caption)
            
            Insert_Gutschein lGutschnr, lKUNDNR, dWert, lbednu, gcFilNr, gcKasNum, "ERSTGUTSCHEIN", lDatum, sWert
            
            cBezeich = "GUTSCHEIN " & Trim(Str$(lGutschnr))
            MoveGutschein2ListboxWKL20 dWert, cBezeich, gbGutscheinBeiVKversteuern
        End If
    Next dCount
    Ready4NextInputWKL20
    
    If Text1(1).Enabled And Text1(1).Visible Then
        Text1(1).SetFocus
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ErfasseGutscheinWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
   
End Sub
Private Function fnAktualisiereBestandWKL20(cArtNr As String, dMenge As Double, ia As Byte) As Double
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL                As String
    Dim dBestand            As Double
    Dim rsrs                As Recordset
    
    If Trim(cArtNr) <> "" Then
        cSQL = "Select BESTAND from ARTIKEL where ARTNR = " & cArtNr & " "
        FnOpenrecordset rsrs, cSQL, 1, gdBase
        
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            If Not IsNull(rsrs!BESTAND) Then
                dBestand = rsrs!BESTAND
            Else
                dBestand = 0
            End If
            dBestand = dBestand - dMenge
        End If
        rsrs.Close: Set rsrs = Nothing
        
        If gbLokalModus = False Then
            If dMenge < 0 Then
                Select Case ia
                    Case 1 'artikel suchen und minus = Storno
                        Bestandsveraenderung cArtNr, CLng(dBestand), "Storno Kasse"
                        ABinBESTAKT cArtNr, CLng(dMenge * -1), "Storno Kasse"
                    Case 2  'alle Rück
                        Bestandsveraenderung cArtNr, CLng(dBestand), "Rücknahme Kasse "
                        ABinBESTAKT cArtNr, CLng(dMenge * -1), "Rücknahme Kasse "
                    Case 3 'Einzelrück
                        Bestandsveraenderung cArtNr, CLng(dBestand), "Rücknahme Kasse"
                        ABinBESTAKT cArtNr, CLng(dMenge * -1), "Rücknahme Kasse"
                    Case 5  'alle Rück Beleg drucken
                        Bestandsveraenderung cArtNr, CLng(dBestand), "Rücknahme Kasse B"
                        ABinBESTAKT cArtNr, CLng(dMenge * -1), "Rücknahme Kasse B"
                End Select
            Else
                Bestandsveraenderung cArtNr, CLng(dBestand), "Kassiervorgang"
                ABinBESTAKT cArtNr, CLng(dMenge * -1), "Kassiervorgang"
            End If

        End If
        
        fnAktualisiereBestandWKL20 = dBestand
        
    End If

Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnAktualisiereBestandWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub AndersZahlungWKL20(iTaste As Integer)
    On Error GoTo LOKAL_ERROR
        
    Dim ctmp            As String
    Dim dSumme          As Double
    Dim dWert           As Double
    Dim bKommaVorhanden As Boolean
    
    giAndersZahlung = iTaste
    
    If gbDINA4VIS Then
        Check4.Visible = True
    Else
        Check4.Visible = False
    End If
    
    
    
    
'    Check4.Visible = True 'wird global gesteuert
    cmdBonKK.Visible = False
    chkEinzKarte.Visible = False
    chkEinzKarte.value = vbUnchecked
    
    Check15.Visible = False
    Check15.value = vbUnchecked
    
    Label28.Caption = ""
    Label28.Refresh
    
    Select Case iTaste
        Case Is = 5
            Label15.Caption = "Kreditverkauf"
            Check2.Visible = True
            
            If gbEcash Then
                Select Case gsEPartner
                    Case "ELP"
                        Check15.Visible = True
                    Case "ZV2"
                        Check15.Visible = True
                End Select
            End If
            
        Case Is = 6
            Label15.Caption = "Scheckverkauf"
        Case Is = 45
            Label15.Caption = "Auszahlung"
            Check4.Visible = False
            
            ''''''''''Oliver Alte TSE START
            'TSS Start
            'TSS.Start WinsockTSE
            ''''''''''Oliver Alte TSE ENDE
            
        Case Is = 46
            Label15.Caption = "Einzahlung"
            Check4.Visible = False
            
            If gbEcash = True Then
                chkEinzKarte.Visible = True
            End If
            
            ''''''''''Oliver Alte TSE START
            'TSS Start
            'TSS.Start WinsockTSE
            ''''''''''Oliver Alte TSE ENDE
            
        Case Is = 17
            Label15.Caption = "Kartenverkauf"
            
            Label28.Caption = "Drücken Sie 'OK'"
            Label28.Refresh
            
            If gbEcash Then
                Select Case gsEPartner
                    Case "ELP"
                        Check15.Visible = True
                    Case "ZV2"
                        Check15.Visible = True
                End Select
            End If
            
        Case Is = 47
            Label15.Caption = "Kollegenverkauf"
        Case Is = 69
            Label15.Caption = "EC Lastschrift"
        Case Else
            Check2.Visible = False
    End Select
    
    If iTaste <> 45 And iTaste <> 46 Then   '** Auszahlung und Einzahlung **
        BerechneZwischenSummeWKL20
        ctmp = Label2(6).Caption
        ctmp = fnMoveComma2Point$(ctmp)
        dSumme = Val(ctmp)
    Else
        ctmp = Text1(1).Text
        bKommaVorhanden = False
        
        If InStr(ctmp, ",") Then
            bKommaVorhanden = True
        End If
        
        ctmp = fnMoveComma2Point$(ctmp)
        dSumme = Val(ctmp)
        
        If Not bKommaVorhanden Then
            dSumme = dSumme / 100
        End If
    End If
        
    Label6(1).Caption = Format$(dSumme, "#####0.00")
    Frame10.Visible = True
    
    If gbBARDINA4 = True Then
        Check4.value = vbChecked
    Else
        Check4.value = vbUnchecked
    End If
    
    Command5(1).Caption = "Zurück"
'    Check4.Value = vbUnchecked
    
    Frame1.Visible = False
    Frame2.Visible = False
    Frame3.Visible = False
    Frame4.Visible = False
    Frame29.Visible = False
    Frame13.Visible = False
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AndersZahlungWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function fnHolePreisWarengruppeWKL20(cArtNr As String) As Double
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL        As String
    Dim rsrs        As Recordset
    
    fnHolePreisWarengruppeWKL20 = 0
    
    cSQL = "Select * from ARTIKEL where ARTNR = " & cArtNr & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!KVKPR1) Then
            fnHolePreisWarengruppeWKL20 = rsrs!KVKPR1
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnHolePreisWarengruppeWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function

Public Function fnPruefeKundenSperrungWKL20() As Long
    On Error GoTo LOKAL_ERROR
    
    Dim lKdNr           As Long
    Dim cECIdent        As String
    Dim cGesperrt       As String
    Dim rsrs            As Recordset
    Dim cSQL            As String
    
        
    fnPruefeKundenSperrungWKL20 = 0
    
    lKdNr = Val(Label2(7).Caption)
    
    cSQL = "Select * from Kunden where kundnr = " & lKdNr
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!GESPERRT) Then
            cGesperrt = rsrs!GESPERRT
        Else
            cGesperrt = "N"
        End If
        If cGesperrt = "J" Then
            fnPruefeKundenSperrungWKL20 = 1
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnPruefeKundenSperrungWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub InitBonListeWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim iWoTag      As Integer
    Dim iCount      As Integer
    
    Frame23.Enabled = False
    

    
    iWoTag = Weekday(Now, vbMonday)
     
    iWoTag = iWoTag - 1
    Option1(iWoTag).value = True
    
    Command11_Click 0

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "InitBonListeWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub InsertAFCBuchWKL20_neu()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    Dim cSQL        As String
    Dim ctmp        As String
    Dim cLBSatz     As String
    Dim cExtend     As String
    Dim cWasSuchteMan     As String
    Dim dLiNr       As Double
    Dim dEkpr       As Double
    Dim dWert       As Double
    Dim iFeld       As Integer
    Dim iDbNr       As Integer
    Dim rsrs        As Recordset
    Dim rsKJ        As Recordset
    Dim rsArt       As Recordset
    Dim cArtMWSt    As String
    
    '*** Kunden-Umsatz ****
    Dim dKdUmsatz   As Double
    Dim dKdBonus    As Double
    
    '*** KASSJOUR-Felder ****
    Dim cKJArtNr    As String
    Dim cKJBezeich  As String
    Dim cKJMenge    As String
    Dim cKJAZeit    As String
    Dim cKJKundNr   As String
    Dim cKJFiliale  As String
    Dim cKJKasNum   As String
    Dim cKJLiNr     As String
    Dim cKJLPZ      As String
    Dim cKJAGN      As String
    Dim cKJEAN      As String
    Dim cKJMwst     As String
    Dim cKJBelegNr  As String
    Dim cUmsOK      As String
    Dim cBonusOk    As String
    Dim cKJMopreis  As String
    
    Dim dKJEkpr     As Double
    Dim dKJVkpr     As Double
    Dim dKJPreis    As Double
    Dim dKJBest1    As Double
    Dim dVkPr       As Double
    Dim dKJPreis2   As Double
    Dim dSpanne     As Double
    Dim lKJADate    As Long
    Dim lKJBediener As Long
    Dim sArtnr      As String
    Dim IAbschluss  As Long
    Dim ierrz       As Integer
    Dim dGeldwert   As Double
    Dim sRechner    As String
    Dim sPreisKz    As String
    
    Dim lPos As Long
    
    Dim cpfaddb As String
        
    cpfaddb = gcDBPfad
    If Right$(cpfaddb, 1) <> "\" Then
        cpfaddb = cpfaddb & "\"
    End If
    
    
    ctmp = Trim$(Label2(7).Caption)
    If Val(ctmp) < 0 Then
        ctmp = "0"
    End If
    cKJKundNr = ctmp
    
    If Val(cKJKundNr) > 0 Then
        'dann nach Preiskz fragen
        sPreisKz = ermPREISKZ(cKJKundNr)
    End If

    
    
    
    sRechner = rechnername
    ierrz = 0
    
    IAbschluss = ermDIEaktuelleAbschlussNR(CByte(gcKasNum))
    lAnzSatz = List1.ListCount
    If lAnzSatz > 10 Then

        Label19(0).Caption = 0
        Label19(2).Caption = Trim$(Str$(lAnzSatz))
        Frame31.Visible = True
    End If
    
    cSQL = "Delete from AFCB" & sRechner & " "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Delete from KJ" & sRechner & " "
    gdBase.Execute cSQL, dbFailOnError
    
    For lAktSatz = 0 To lAnzSatz - 1
        If lAnzSatz > 10 Then
            Label19(0).Caption = Trim$(Str$(lAktSatz))
            Label19(0).Refresh
        End If
        iFeld = 1
        cKJArtNr = ""
        cKJBezeich = ""
        cKJMenge = ""
        dKJPreis = 0
        lKJADate = 0
        cKJAZeit = ""
        lKJBediener = 0
        cKJKundNr = ""
        cKJFiliale = ""
        cKJKasNum = ""
        cKJLiNr = ""
        cKJLPZ = ""
        cKJAGN = ""
        cKJEAN = ""
        cKJMwst = ""
        dKJEkpr = 0
        dKJVkpr = 0
        cKJBelegNr = ""
        dKJBest1 = 0
        
        
        cLBSatz = List1.list(lAktSatz)
        
'        MsgBox cLBSatz

        'Besonderheiten am Satzende

        'hier Besonders Merkmal - wird in Mopreis kassjour gespeichert
        
        If Len(cLBSatz) > 175 Then
            cKJMopreis = Mid(cLBSatz, 177, 8)
        Else
            cKJMopreis = "0"
        End If

        If Len(cLBSatz) > 157 Then
            cExtend = Mid(cLBSatz, 158, 18)
        Else
            cExtend = ""
        End If
        
        
        
        'Grund.cfg Teil1
        
        If FileExists(cpfaddb & "Grund.cfg") Then
        
            lPos = 0
            lPos = InStr(cLBSatz, "@Q")
        
            If lPos > 0 Then
                cWasSuchteMan = Trim(Mid(cLBSatz, lPos + 2, Len(cLBSatz) - lPos))
            End If
            
        End If
        'Ende Grund.cfg
        
        
        
        
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
        sArtnr = ctmp
        
        '***************************************************
        '* Zeile ZWISCHENSUMME darf nicht übernommen werden!
        '***************************************************
        
        If ctmp <> "000000" Then
            
            cSQL = "Select LPZ, AGN, EAN, EKPR, linr, MWST, UMS_OK, BONUS_OK, Spanne from Artikel where Artnr = " & ctmp
            Set rsArt = gdBase.OpenRecordset(cSQL)
            
'            FnOpenrecordset rsArt, cSQL, 1, gdBase

            If Not rsArt.EOF Then
                If Not IsNull(rsArt!LPZ) Then
                    cKJLPZ = rsArt!LPZ
                Else
                    cKJLPZ = ""
                End If
        
                If Not IsNull(rsArt!AGN) Then
                    cKJAGN = rsArt!AGN
                Else
                    cKJAGN = ""
                End If
                
                If Not IsNull(rsArt!EAN) Then
                    cKJEAN = rsArt!EAN
                Else
                    cKJEAN = ""
                End If
                
                If Not IsNull(rsArt!ekpr) Then
                    dEkpr = rsArt!ekpr
                Else
                    dEkpr = 0
                End If
                
                If Not IsNull(rsArt!linr) Then
                    dLiNr = rsArt!linr
                Else
                    dLiNr = 0
                End If
                
                If Not IsNull(rsArt!MWST) Then
                    cArtMWSt = rsArt!MWST
                Else
                    cArtMWSt = "V"
                End If
                
                
                'ist Preiskz = 6 also Netto dann mwst = O
                If Val(sPreisKz) = 6 Then
                    cArtMWSt = "O"
                End If
                
                
                If Not IsNull(rsArt!UMS_OK) Then
                    cUmsOK = rsArt!UMS_OK
                Else
                    cUmsOK = "J"
                End If
                
                If Not IsNull(rsArt!BONUS_OK) Then
                    cBonusOk = rsArt!BONUS_OK
                Else
                    cBonusOk = "J"
                End If
                
                If Not IsNull(rsArt!SPANNE) Then
                    dSpanne = rsArt!SPANNE
                Else
                    dSpanne = 0
                End If
                             
            Else
                dEkpr = 0
                dLiNr = 0
            End If
            
            rsArt.Close: Set rsArt = Nothing
            
            Set rsrs = gdBase.OpenRecordset("AFCB" & sRechner, dbOpenTable)
                        
            rsrs.AddNew
            rsrs!SYNStatus = "A"

            If ctmp = "666666" Then
                If gbGutscheinBeiVKversteuern = True Then
                    cBonusOk = "N"
                    cUmsOK = "J"
                    cArtMWSt = "V"
                Else
                    cBonusOk = "N"
                    cUmsOK = "N"
                    cArtMWSt = "O"
                End If
            End If

            ctmp = Mid(cLBSatz, 148, 3)
            ctmp = Trim$(ctmp)

            rsrs!abednu = Val(ctmp)
            lKJBediener = Val(ctmp)

            rsrs!AFLAG = 0
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If

           
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            rsrs!aMenge = Val(ctmp)
            cKJMenge = ctmp

            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            rsrs!APREIS = Val(ctmp)
            dKJPreis = rsrs!APREIS

            ctmp = Mid(cLBSatz, 7, 6)
            ctmp = Trim$(ctmp)
            rsrs!aartnr = Val(ctmp)
            cKJArtNr = ctmp

            ctmp = Mid(cLBSatz, 14, 35)
            ctmp = Trim$(ctmp)

            rsrs!ABEZEICH = ctmp
            cKJBezeich = ctmp

            rsrs!ADATE = Fix(Now)
            rsrs!AZEIT = Format$(Now, "HH:MM:SS")
            lKJADate = rsrs!ADATE
            cKJAZeit = rsrs!AZEIT

            rsrs!AMWSK = cArtMWSt
            cKJMwst = cArtMWSt

            If ctmp = "V" Then
                ctmp = Mid(cLBSatz, 104, 9)
            ElseIf ctmp = "E" Then
                ctmp = Mid(cLBSatz, 114, 9)
            Else
                ctmp = "0"
            End If
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            rsrs!AMWST = Val(ctmp)

            ctmp = Label2(7).Caption
            ctmp = Trim$(ctmp)
            If Val(ctmp) < 0 Then
                ctmp = "0"
            End If
            rsrs!AKUNUM = Val(ctmp)
            cKJKundNr = ctmp

            rsrs!BELEGNR = gdBonNr
            cKJBelegNr = rsrs!BELEGNR

            rsrs!kasnum = Val(gcKasNum)
            cKJFiliale = gcFilNr

            rsrs!BUCHFLAG = 0

            ctmp = Mid(cLBSatz, 50, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            rsrs!AALTPREIS = Format(Val(ctmp), "#####0.00")

            ctmp = Mid(cLBSatz, 128, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)

            If Val(ctmp) = 0 Then
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = Trim$(ctmp)
                ctmp = fnMoveComma2Point$(ctmp)
                
                rsrs!AVKPR = Format(Val(ctmp), "#####0.00")

                dKJVkpr = rsrs!AVKPR
            Else
                rsrs!AVKPR = Val(ctmp)
                dKJVkpr = rsrs!AVKPR
            End If

            If dEkpr = 0 Then
            
                If sArtnr = "666668" Or sArtnr = "666669" Then
                    If gdZeitungsSpanne <> 0 Then
                        dEkpr = EKausNettospanneerrechnen(gdZeitungsSpanne, Val(ctmp), cArtMWSt)
                    End If
                Else
                    If dSpanne <> 0 Then
                        dEkpr = EKausNettospanneerrechnen(dSpanne, Val(ctmp), cArtMWSt)
                    End If
                End If
            
            End If

            rsrs!ALEKPR = dEkpr
            dKJEkpr = dEkpr

            rsrs!linr = dLiNr
            cKJLiNr = Trim$(Str$(dLiNr))

            If gcKreditKarte <> "" Then
                rsrs!kk_art = gcKreditKarte
            Else
                rsrs!kk_art = gcZahlMittel
            End If

            ctmp = Mid(cLBSatz, 138, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)

            dKJBest1 = Val(ctmp)
            rsrs!BESTAND = Val(ctmp)
            rsrs!ZHLGGUTSCH = 0
            
'            'ist Preiskz = 6 also Netto dann ums_ok = N
'            If Val(sPreisKz) = 6 Then
'                cUmsOK = "N"
'            End If
            
            rsrs!UMS_OK = cUmsOK
            rsrs!BONUS_OK = cBonusOk
            rsrs!FILIALNR = Val(gcFilNr)
            rsrs.Update

            rsrs.Close: Set rsrs = Nothing

            'Grund.cfg Teil2
            If FileExists(cpfaddb & "Grund.cfg") Then
            
                Set rsKJ = gdBase.OpenRecordset("AFCBUCH_GRUND", dbOpenTable)
    
                rsKJ.AddNew
                rsKJ!BEZEICH = cKJBezeich
                rsKJ!Menge = Val(cKJMenge)
                rsKJ!ADATE = lKJADate
                rsKJ!AZEIT = cKJAZeit
            
                If IsNumeric(cWasSuchteMan) = True Then
                    rsKJ!EAN = cWasSuchteMan
                Else
                    rsKJ!EAN = cKJArtNr
                End If
                
                rsKJ.Update
                rsKJ.Close: Set rsKJ = Nothing

            End If
            'Ende Grund.cfg
            
            'doemer.cfg
            If FileExists(cpfaddb & "doemer.cfg") Then
                doemer_bestand_updaten cKJArtNr, Val(cKJMenge)
            End If
            'Ende doemer.cfg
            
            
            
            If glPaketLinr > 0 Then
            
                If glPaketLinr = Val(cKJLiNr) Then
                    Dim rsPaket As DAO.Recordset
                    Set rsPaket = gdBase.OpenRecordset("Paket", dbOpenTable)
        
                    rsPaket.AddNew
                    rsPaket!Preis = dKJPreis
                    rsPaket!SENDOK = False
                    rsPaket.Update
                    rsPaket.Close: Set rsPaket = Nothing
                End If
           
            End If
            
            
            
    

            Set rsKJ = gdBase.OpenRecordset("KJ" & sRechner, dbOpenTable)

            rsKJ.AddNew
            rsKJ!artnr = Val(cKJArtNr)
            rsKJ!BEZEICH = cKJBezeich
            rsKJ!Menge = Val(cKJMenge)
            rsKJ!Preis = dKJPreis
            rsKJ!ADATE = lKJADate
            rsKJ!AZEIT = cKJAZeit
            rsKJ!BEDIENER = lKJBediener
            rsKJ!Kundnr = Val(cKJKundNr)
            rsKJ!FILIALE = Val(cKJFiliale)
            rsKJ!kasnum = Val(gcKasNum)
            rsKJ!linr = Val(cKJLiNr)
            rsKJ!LPZ = Val(cKJLPZ)
            rsKJ!AGN = Val(cKJAGN)
            rsKJ!EAN = cKJEAN
            rsKJ!MWST = cKJMwst
            rsKJ!ekpr = dKJEkpr

            If Trim(cExtend) = "Fleischerbon" Then
                cUmsOK = "N"
            End If
            
'            'ist Preiskz = 6 also Netto dann ums_ok = N
'            If Val(sPreisKz) = 6 Then
'                cUmsOK = "N"
'            End If

            rsKJ!UMS_OK = cUmsOK
            rsKJ!MOPREIS = cKJMopreis
            rsKJ!ZbonNr = IAbschluss
            rsKJ!ABOK = False

            '//Aenderung : Tabelle Kassjour VKPR
            '//wenn ARTIKEL.kvkpr1= 0 Then KASSJOUR.VKPR = KASSJOUR.PREIS
            If dKJVkpr = 0 Then
                dKJPreis2 = rsKJ!Preis

                dVkPr = dKJPreis / cKJMenge
                rsKJ!vkpr = dVkPr
            Else
                rsKJ!vkpr = dKJVkpr
            End If

            rsKJ!BELEGNR = gdBonNr
            rsKJ!best1 = dKJBest1

            If gcKreditKarte <> "" Then
                rsKJ!kk_art = gcKreditKarte
            Else
                rsKJ!kk_art = gcZahlMittel
            End If
            rsKJ.Update
            rsKJ.Close: Set rsKJ = Nothing
            
            If gbGutscheinBeiVKversteuern = True Then
                If Val(cKJArtNr) <> 666666 Then
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                Else
                    'auch bei Gutschein
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                End If
            Else
                If Val(cKJArtNr) <> 666666 Then
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                End If
            End If
            
            If Len(cLBSatz) >= 154 Then
                If Mid(cLBSatz, 154, 1) <> "N" Then
                    dKdBonus = dKdBonus + dKJPreis
                End If
            Else
                'dKdBonus = dKdBonus + dKJPreis
            End If
        End If
    Next lAktSatz
    
    
    If gcZahlMittel = "BA" Then
        If gbGutscheinBeiVKversteuern = True Then
            cSQL = "Select sum(preis) as NICHTUMS from KJ" & sRechner & " where ums_OK = 'N' and kk_art = 'BA'  "
        Else
            cSQL = "Select sum(preis) as NICHTUMS from KJ" & sRechner & " where ums_OK = 'N' and kk_art = 'BA' and ARTNR <> 666666 "
        End If
        
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!NICHTUMS) Then
                insertNichtUmsBar lKJADate, cKJAZeit, cKJBelegNr, gcKasNum, CDbl(rsrs!NICHTUMS)
            End If
        End If
    End If
    
    
    
    
'''''''    'TODO TSE FINISH
'''''''    Dim dUmsatzVolleMwst As Double
'''''''    Dim dUmsatzErmMwst As Double
'''''''    Dim dUmsatzOhneMwst As Double
'''''''
'''''''    Dim dUmsatzGesamt As Double
'''''''
'''''''
'''''''
'''''''    dUmsatzVolleMwst = ermWertforTSS("V", "J", "AFCB" & sRechner)
'''''''    dUmsatzErmMwst = ermWertforTSS("E", "J", "AFCB" & sRechner)
'''''''    dUmsatzOhneMwst = ermWertforTSS("O", "J", "AFCB" & sRechner)
'''''''
'''''''    dUmsatzGesamt = dUmsatzVolleMwst + dUmsatzErmMwst + dUmsatzOhneMwst
'''''''
'''''''    If gcZahlMittel = "BA" Then
'''''''        TSS.Finish WinsockTSE, Beleg, dUmsatzVolleMwst, dUmsatzErmMwst, dUmsatzOhneMwst, "EUR", dUmsatzGesamt, 0
'''''''    Else
'''''''        TSS.Finish WinsockTSE, Beleg, dUmsatzVolleMwst, dUmsatzErmMwst, dUmsatzOhneMwst, "EUR", 0, dUmsatzGesamt
'''''''    End If
    

    
    
    
    
    cSQL = "Insert into AFCBUCH Select * from AFCB" & sRechner & " "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Insert into KASSJOUR Select * from KJ" & sRechner & " "
    gdBase.Execute cSQL, dbFailOnError
    
    'schieb mal auf den SQL Server
    
''    VKZAHLEN_Speichern "KJ" & sRechner
    
    'Ende schieb mal auf den SQL Server Ende
    
    'storno2Bed
    If gcIdentStornoBedienerNr1 <> "" And gcIdentStornoBedienerNr2 <> "" Then
        insertStorno2 lKJADate, cKJAZeit, cKJBelegNr, gcKasNum, CInt(gcIdentStornoBedienerNr1), CInt(gcIdentStornoBedienerNr2)
    
        gcIdentStornoBedienerNr1 = ""
        gcIdentStornoBedienerNr2 = ""
    End If
    
    If gcZahlMittel = "LS" Then
        insertLASTZAHLTE lKJADate, cKJAZeit, cKJBelegNr, gcKasNum, gcZahlMittel, gdSummeLAST
    End If
    
    If gcKreditKarte <> "" Then
        insertKKZAHLTE lKJADate, cKJAZeit, cKJBelegNr, gcKasNum, gcKreditKarte, gdSummeKK
    End If
    
    If gsABOPLUS_KARTE <> "" Then
        insertAboPlus_ums lKJADate, cKJAZeit, cKJBelegNr, gsABOPLUS_KARTE, gdABOPLUS_WERT
        gsABOPLUS_KARTE = ""
        gdABOPLUS_WERT = 0
    End If
    
    
    Frame31.Visible = False
    
    
    If Val(cKJKundNr) > 0 Then
        Plus_Bonus cKJKundNr, dKdUmsatz, dKdBonus
    End If
    

    If gbbonusausjetzt = True Then
    
        Dim Bonusneu        As String
        Dim Bonusalt        As String
        Dim cDatum          As String
        Dim czeit           As String
        
        Dim cVname          As String
        Dim cNName           As String
        
        ReDim cZeilen(0 To 9) As String
    
        cSQL = "Select Status, SYNStatus, Bonus, TBONUS, LASTDATE, LASTTIME from Kunden where kundnr = " & cKJKundNr
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            rsrs.Edit
            rsrs!Status = "E"
            rsrs!SYNStatus = "E"
            
            If Not IsNull(rsrs!BONUS) Then
                Bonusalt = Format(rsrs!BONUS, "##000.00 EUR")
                rsrs!BONUS = rsrs!BONUS - gdbonusHerabwert
                Bonusneu = Format(rsrs!BONUS, "##000.00 EUR")
            Else
                Bonusalt = "000.00 EUR"
                rsrs!BONUS = gdbonusHerabwert * (-1)
                Bonusneu = Format(rsrs!BONUS, "##000.00 EUR")
            End If
            
            If Not IsNull(rsrs!TBONUS) Then
                rsrs!TBONUS = CDbl(rsrs!TBONUS) - gdbonusHerabwert
            Else
                rsrs!TBONUS = gdbonusHerabwert * (-1)
            End If
            
            rsrs!LASTDATE = DateValue(Now)
            rsrs!LASTTIME = TimeValue(Now)
            rsrs.Update
            
            schreibeKBProtokoll Space(10 - Len(cKJKundNr)) & cKJKundNr & " Bonus reduziert jetzt: " & Bonusneu & " vorher: " & Bonusalt
            
            cDatum = DateValue(Now)
            czeit = TimeValue(Now)
            
            cVname = lookingForKundendaten(cKJKundNr).vorname
            cNName = lookingForKundendaten(cKJKundNr).nachname
            
            cZeilen(0) = "Bonus reduziert"
            cZeilen(1) = "-----------------"
            cZeilen(2) = "KundNr:  " & cKJKundNr
            cZeilen(3) = "Vorname: " & cVname
            cZeilen(4) = "Name:    " & cNName
            cZeilen(5) = "vorher:  " & Bonusalt
            cZeilen(6) = "jetzt:   " & Bonusneu
            cZeilen(7) = "Datum:   " & cDatum
            cZeilen(8) = "Zeit:    " & czeit
            
            DruckeArbeitszeitBelegWK20d cZeilen(), 8
            If gb2BONUSMESS Then
                DruckeArbeitszeitBelegWK20d cZeilen(), 8
            End If
        End If
        
        rsrs.Close: Set rsrs = Nothing

    End If
    
    gdbonusHerabwert = 0
    gbbonusausjetzt = False
    gbbonusHerab = False

Exit Sub
LOKAL_ERROR:
    If err.Number = 3260 Then
        If ierrz < 5 Then
            ierrz = ierrz + 1
            Pause (1)
            Resume
        Else
            Fehler.gsDescr = err.Description
            Fehler.gsNumber = err.Number
            Fehler.gsFormular = Me.name
            Fehler.gsFunktion = "InsertAFCBuchWKL20_neu"
            Fehler.gsFehlertext = "Nach 5 sec ist im Programmteil Kasse ist ein Fehler aufgetreten."
            
            Fehlermeldung1
            Exit Sub
        End If
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "InsertAFCBuchWKL20_neu"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
End Sub

Private Sub TSSBerechnung()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    Dim cSQL        As String
    Dim ctmp        As String
    Dim cLBSatz     As String
    Dim cExtend     As String
    Dim cWasSuchteMan     As String
    Dim dLiNr       As Double
    Dim dEkpr       As Double
    Dim dWert       As Double
    Dim iFeld       As Integer
    Dim iDbNr       As Integer
    Dim rsrs        As Recordset
    Dim rsKJ        As Recordset
    Dim rsArt       As Recordset
    Dim cArtMWSt    As String
    
    '*** Kunden-Umsatz ****
    Dim dKdUmsatz   As Double
    Dim dKdBonus    As Double
    
    '*** KASSJOUR-Felder ****
    Dim cKJArtNr    As String
    Dim cKJBezeich  As String
    Dim cKJMenge    As String
    Dim cKJAZeit    As String
    Dim cKJKundNr   As String
    Dim cKJFiliale  As String
    Dim cKJKasNum   As String
    Dim cKJLiNr     As String
    Dim cKJLPZ      As String
    Dim cKJAGN      As String
    Dim cKJEAN      As String
    Dim cKJMwst     As String
    Dim cKJBelegNr  As String
    Dim cUmsOK      As String
    Dim cBonusOk    As String
    Dim cKJMopreis  As String
    
    Dim dKJEkpr     As Double
    Dim dKJVkpr     As Double
    Dim dKJPreis    As Double
    Dim dKJBest1    As Double
    Dim dVkPr       As Double
    Dim dKJPreis2   As Double
    Dim dSpanne     As Double
    Dim lKJADate    As Long
    Dim lKJBediener As Long
    Dim sArtnr      As String
    Dim IAbschluss  As Long
    Dim ierrz       As Integer
    Dim dGeldwert   As Double
    Dim sRechner    As String
    Dim sPreisKz    As String
    
    Dim lPos As Long
    
    Dim cpfaddb As String
        
    cpfaddb = gcDBPfad
    If Right$(cpfaddb, 1) <> "\" Then
        cpfaddb = cpfaddb & "\"
    End If
    
    
    ctmp = Trim$(Label2(7).Caption)
    If Val(ctmp) < 0 Then
        ctmp = "0"
    End If
    cKJKundNr = ctmp
    
    If Val(cKJKundNr) > 0 Then
        'dann nach Preiskz fragen
        sPreisKz = ermPREISKZ(cKJKundNr)
    End If

    
    
    
    sRechner = rechnername
    ierrz = 0
    
'    IAbschluss = ermDIEaktuelleAbschlussNR(CByte(gcKasNum))
    lAnzSatz = List1.ListCount
'    If lAnzSatz > 10 Then
'
'        Label19(0).Caption = 0
'        Label19(2).Caption = Trim$(Str$(lAnzSatz))
'        Frame31.Visible = True
'    End If
    
    cSQL = "Delete from AFCB" & sRechner & " "
    gdBase.Execute cSQL, dbFailOnError
    
    
    
    For lAktSatz = 0 To lAnzSatz - 1
'        If lAnzSatz > 10 Then
'            Label19(0).Caption = Trim$(Str$(lAktSatz))
'            Label19(0).Refresh
'        End If
        iFeld = 1
        cKJArtNr = ""
        cKJBezeich = ""
        cKJMenge = ""
        dKJPreis = 0
        lKJADate = 0
        cKJAZeit = ""
        lKJBediener = 0
        cKJKundNr = ""
        cKJFiliale = ""
        cKJKasNum = ""
        cKJLiNr = ""
        cKJLPZ = ""
        cKJAGN = ""
        cKJEAN = ""
        cKJMwst = ""
        dKJEkpr = 0
        dKJVkpr = 0
        cKJBelegNr = ""
        dKJBest1 = 0
        
        
        cLBSatz = List1.list(lAktSatz)
        
'        MsgBox cLBSatz

        'Besonderheiten am Satzende

        'hier Besonders Merkmal - wird in Mopreis kassjour gespeichert
        
        If Len(cLBSatz) > 175 Then
            cKJMopreis = Mid(cLBSatz, 177, 8)
        Else
            cKJMopreis = "0"
        End If

        If Len(cLBSatz) > 157 Then
            cExtend = Mid(cLBSatz, 158, 18)
        Else
            cExtend = ""
        End If
        
        
        
'        'Grund.cfg Teil1
'
'        If FileExists(cpfaddb & "Grund.cfg") Then
'
'            lPos = 0
'            lPos = InStr(cLBSatz, "@Q")
'
'            If lPos > 0 Then
'                cWasSuchteMan = Trim(Mid(cLBSatz, lPos + 2, Len(cLBSatz) - lPos))
'            End If
'
'        End If
'        'Ende Grund.cfg
'
        
        
        
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
        sArtnr = ctmp
        
        '***************************************************
        '* Zeile ZWISCHENSUMME darf nicht übernommen werden!
        '***************************************************
        
        If ctmp <> "000000" Then
            
            cSQL = "Select LPZ, AGN, EAN, EKPR, linr, MWST, UMS_OK, BONUS_OK, Spanne from Artikel where Artnr = " & ctmp
            Set rsArt = gdBase.OpenRecordset(cSQL)
            
'            FnOpenrecordset rsArt, cSQL, 1, gdBase

            If Not rsArt.EOF Then
                If Not IsNull(rsArt!LPZ) Then
                    cKJLPZ = rsArt!LPZ
                Else
                    cKJLPZ = ""
                End If
        
                If Not IsNull(rsArt!AGN) Then
                    cKJAGN = rsArt!AGN
                Else
                    cKJAGN = ""
                End If
                
                If Not IsNull(rsArt!EAN) Then
                    cKJEAN = rsArt!EAN
                Else
                    cKJEAN = ""
                End If
                
                If Not IsNull(rsArt!ekpr) Then
                    dEkpr = rsArt!ekpr
                Else
                    dEkpr = 0
                End If
                
                If Not IsNull(rsArt!linr) Then
                    dLiNr = rsArt!linr
                Else
                    dLiNr = 0
                End If
                
                If Not IsNull(rsArt!MWST) Then
                    cArtMWSt = rsArt!MWST
                Else
                    cArtMWSt = "V"
                End If
                
                
                'ist Preiskz = 6 also Netto dann mwst = O
                If Val(sPreisKz) = 6 Then
                    cArtMWSt = "O"
                End If
                
                
                If Not IsNull(rsArt!UMS_OK) Then
                    cUmsOK = rsArt!UMS_OK
                Else
                    cUmsOK = "J"
                End If
                
                If Not IsNull(rsArt!BONUS_OK) Then
                    cBonusOk = rsArt!BONUS_OK
                Else
                    cBonusOk = "J"
                End If
                
                If Not IsNull(rsArt!SPANNE) Then
                    dSpanne = rsArt!SPANNE
                Else
                    dSpanne = 0
                End If
                             
            Else
                dEkpr = 0
                dLiNr = 0
            End If
            
            rsArt.Close: Set rsArt = Nothing
            
            Set rsrs = gdBase.OpenRecordset("AFCB" & sRechner, dbOpenTable)
                        
            rsrs.AddNew
            rsrs!SYNStatus = "A"

            If ctmp = "666666" Then
                If gbGutscheinBeiVKversteuern = True Then
                    cBonusOk = "N"
                    cUmsOK = "J"
                    cArtMWSt = "V"
                Else
                    cBonusOk = "N"
                    cUmsOK = "N"
                    cArtMWSt = "O"
                End If
            End If

            ctmp = Mid(cLBSatz, 148, 3)
            ctmp = Trim$(ctmp)

            rsrs!abednu = Val(ctmp)
            lKJBediener = Val(ctmp)

            rsrs!AFLAG = 0
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If

           
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            rsrs!aMenge = Val(ctmp)
            cKJMenge = ctmp

            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            rsrs!APREIS = Val(ctmp)
            dKJPreis = rsrs!APREIS

            ctmp = Mid(cLBSatz, 7, 6)
            ctmp = Trim$(ctmp)
            rsrs!aartnr = Val(ctmp)
            cKJArtNr = ctmp

            ctmp = Mid(cLBSatz, 14, 35)
            ctmp = Trim$(ctmp)

            rsrs!ABEZEICH = ctmp
            cKJBezeich = ctmp

            rsrs!ADATE = Fix(Now)
            rsrs!AZEIT = Format$(Now, "HH:MM:SS")
            lKJADate = rsrs!ADATE
            cKJAZeit = rsrs!AZEIT

            rsrs!AMWSK = cArtMWSt
            cKJMwst = cArtMWSt

            If ctmp = "V" Then
                ctmp = Mid(cLBSatz, 104, 9)
            ElseIf ctmp = "E" Then
                ctmp = Mid(cLBSatz, 114, 9)
            Else
                ctmp = "0"
            End If
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            rsrs!AMWST = Val(ctmp)

            ctmp = Label2(7).Caption
            ctmp = Trim$(ctmp)
            If Val(ctmp) < 0 Then
                ctmp = "0"
            End If
            rsrs!AKUNUM = Val(ctmp)
            cKJKundNr = ctmp

            rsrs!BELEGNR = gdBonNr
            cKJBelegNr = rsrs!BELEGNR

            rsrs!kasnum = Val(gcKasNum)
            cKJFiliale = gcFilNr

            rsrs!BUCHFLAG = 0

            ctmp = Mid(cLBSatz, 50, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            rsrs!AALTPREIS = Format(Val(ctmp), "#####0.00")

            ctmp = Mid(cLBSatz, 128, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)

            If Val(ctmp) = 0 Then
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = Trim$(ctmp)
                ctmp = fnMoveComma2Point$(ctmp)
                
                rsrs!AVKPR = Format(Val(ctmp), "#####0.00")

                dKJVkpr = rsrs!AVKPR
            Else
                rsrs!AVKPR = Val(ctmp)
                dKJVkpr = rsrs!AVKPR
            End If

            If dEkpr = 0 Then
            
                If sArtnr = "666668" Or sArtnr = "666669" Then
                    If gdZeitungsSpanne <> 0 Then
                        dEkpr = EKausNettospanneerrechnen(gdZeitungsSpanne, Val(ctmp), cArtMWSt)
                    End If
                Else
                    If dSpanne <> 0 Then
                        dEkpr = EKausNettospanneerrechnen(dSpanne, Val(ctmp), cArtMWSt)
                    End If
                End If
            
            End If

            rsrs!ALEKPR = dEkpr
            dKJEkpr = dEkpr

            rsrs!linr = dLiNr
            cKJLiNr = Trim$(Str$(dLiNr))

            If gcKreditKarte <> "" Then
                rsrs!kk_art = gcKreditKarte
            Else
                rsrs!kk_art = gcZahlMittel
            End If

            ctmp = Mid(cLBSatz, 138, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)

            dKJBest1 = Val(ctmp)
            rsrs!BESTAND = Val(ctmp)
            rsrs!ZHLGGUTSCH = 0
            
'            'ist Preiskz = 6 also Netto dann ums_ok = N
'            If Val(sPreisKz) = 6 Then
'                cUmsOK = "N"
'            End If
            
            rsrs!UMS_OK = cUmsOK
            rsrs!BONUS_OK = cBonusOk
            rsrs!FILIALNR = Val(gcFilNr)
            rsrs.Update

            rsrs.Close: Set rsrs = Nothing

'            'Grund.cfg Teil2
'            If FileExists(cpfaddb & "Grund.cfg") Then
'
'                Set rsKJ = gdBase.OpenRecordset("AFCBUCH_GRUND", dbOpenTable)
'
'                rsKJ.AddNew
'                rsKJ!BEZEICH = cKJBezeich
'                rsKJ!Menge = Val(cKJMenge)
'                rsKJ!ADATE = lKJADate
'                rsKJ!AZEIT = cKJAZeit
'
'                If IsNumeric(cWasSuchteMan) = True Then
'                    rsKJ!EAN = cWasSuchteMan
'                Else
'                    rsKJ!EAN = cKJArtNr
'                End If
'
'                rsKJ.Update
'                rsKJ.Close: Set rsKJ = Nothing
'
'            End If
'            'Ende Grund.cfg
            
'            'doemer.cfg
'            If FileExists(cpfaddb & "doemer.cfg") Then
'                doemer_bestand_updaten cKJArtNr, Val(cKJMenge)
'            End If
'            'Ende doemer.cfg
            
            
            
'            If glPaketLinr > 0 Then
'
'                If glPaketLinr = Val(cKJLiNr) Then
'                    Dim rsPaket As DAO.Recordset
'                    Set rsPaket = gdBase.OpenRecordset("Paket", dbOpenTable)
'
'                    rsPaket.AddNew
'                    rsPaket!Preis = dKJPreis
'                    rsPaket!SENDOK = False
'                    rsPaket.Update
'                    rsPaket.Close: Set rsPaket = Nothing
'                End If
'
'            End If
            
            
            
    

            
            
            
        End If
    Next lAktSatz
    
    
'    If gcZahlMittel = "BA" Then
'        If gbGutscheinBeiVKversteuern = True Then
'            cSQL = "Select sum(preis) as NICHTUMS from KJ" & sRechner & " where ums_OK = 'N' and kk_art = 'BA'  "
'        Else
'            cSQL = "Select sum(preis) as NICHTUMS from KJ" & sRechner & " where ums_OK = 'N' and kk_art = 'BA' and ARTNR <> 666666 "
'        End If
'
'        Set rsRS = gdBase.OpenRecordset(cSQL)
'        If Not rsRS.EOF Then
'            If Not IsNull(rsRS!NICHTUMS) Then
'                insertNichtUmsBar lKJADate, cKJAZeit, cKJBelegNr, gcKasNum, CDbl(rsRS!NICHTUMS)
'            End If
'        End If
'    End If
'
    
    
    ''''''''''Oliver Alte TSE START
    
    'TODO TSE FINISH
'    Dim dUmsatzVolleMwst As Double
'    Dim dUmsatzErmMwst As Double
'    Dim dUmsatzOhneMwst As Double
'
'    Dim dUmsatzGesamt As Double
'
'
'
'    dUmsatzVolleMwst = ermWertforTSS("V", "J", "AFCB" & sRechner)
'    dUmsatzErmMwst = ermWertforTSS("E", "J", "AFCB" & sRechner)
'    dUmsatzOhneMwst = ermWertforTSS("O", "J", "AFCB" & sRechner)
'
'    dUmsatzGesamt = dUmsatzVolleMwst + dUmsatzErmMwst + dUmsatzOhneMwst
'
'    If gcZahlMittel = "BA" Then
'        TSS.Finish WinsockTSE, Beleg, dUmsatzVolleMwst, dUmsatzErmMwst, dUmsatzOhneMwst, "EUR", dUmsatzGesamt, 0
'    Else
'        TSS.Finish WinsockTSE, Beleg, dUmsatzVolleMwst, dUmsatzErmMwst, dUmsatzOhneMwst, "EUR", 0, dUmsatzGesamt
'    End If
    
''''''''''Oliver Alte TSE ENDE
    
   

Exit Sub
LOKAL_ERROR:
    If err.Number = 3260 Then
        If ierrz < 5 Then
            ierrz = ierrz + 1
            Pause (1)
            Resume
        Else
            Fehler.gsDescr = err.Description
            Fehler.gsNumber = err.Number
            Fehler.gsFormular = Me.name
            Fehler.gsFunktion = "TSSBerechnung"
            Fehler.gsFehlertext = "Nach 5 sec ist im Programmteil Kasse ist ein Fehler aufgetreten."
            
            Fehlermeldung1
            Exit Sub
        End If
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "TSSBerechnung"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
        
'        Resume Next
    End If
End Sub



Private Sub InsertAFCBuchWKL20Fleischer()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    Dim cSQL        As String
    Dim ctmp        As String
    Dim cLBSatz     As String
    Dim cExtend     As String
    Dim dLiNr       As Double
    Dim dEkpr       As Double
    Dim dWert       As Double
    Dim iFeld       As Integer
    Dim iDbNr       As Integer
    Dim rsrs        As Recordset
    Dim rsKJ        As Recordset
    Dim rsArt       As Recordset
    Dim cArtMWSt    As String
    Dim bOk As Boolean
    
    '*** Kunden-Umsatz ****
    Dim dKdUmsatz   As Double
    Dim dKdBonus    As Double
    
    '*** KASSJOUR-Felder ****
    Dim cKJArtNr    As String
    Dim cKJBezeich  As String
    Dim cKJMenge    As String
    Dim cKJAZeit    As String
    Dim cKJKundNr   As String
    Dim cKJFiliale  As String
    Dim cKJKasNum   As String
    Dim cKJLiNr     As String
    Dim cKJLPZ      As String
    Dim cKJAGN      As String
    Dim cKJEAN      As String
    Dim cKJMwst     As String
    Dim cKJBelegNr  As String
    Dim cUmsOK      As String
    Dim cBonusOk    As String
    Dim cKJMopreis  As String
    
    Dim dKJEkpr     As Double
    Dim dKJVkpr     As Double
    Dim dKJPreis    As Double
    Dim dKJBest1    As Double
    Dim dVkPr       As Double
    
    Dim dSpanne     As Double
    Dim lKJADate    As Long
    Dim lKJBediener As Long
    Dim sArtnr      As String
    Dim IAbschluss  As Long
    Dim ierrz       As Integer
    ierrz = 0
    
    bOk = False
    IAbschluss = ermDIEaktuelleAbschlussNR(CByte(gcKasNum))
    lAnzSatz = List1.ListCount
    If lAnzSatz > 10 Then

        Label19(0).Caption = 0
        Label19(2).Caption = Trim$(Str$(lAnzSatz))
        Frame31.Visible = True
    End If
    
    
    
    For lAktSatz = 0 To lAnzSatz - 1
        If lAnzSatz > 10 Then
            Label19(0).Caption = Trim$(Str$(lAktSatz))
            Label19(0).Refresh
        End If
        iFeld = 1
        cKJArtNr = ""
        cKJBezeich = ""
        cKJMenge = ""
        dKJPreis = 0
        lKJADate = 0
        cKJAZeit = ""
        lKJBediener = 0
        cKJKundNr = ""
        cKJFiliale = ""
        cKJKasNum = ""
        cKJLiNr = ""
        cKJLPZ = ""
        cKJAGN = ""
        cKJEAN = ""
        cKJMwst = ""
        dKJEkpr = 0
        dKJVkpr = 0
        cKJBelegNr = ""
        dKJBest1 = 0
        
        
        cLBSatz = List1.list(lAktSatz)

        'Besonderheiten am Satzende

        'hier Besonders Merkmal - wird in Mopreis kassjour gespeichert
        
        If Len(cLBSatz) > 175 Then
            cKJMopreis = Mid(cLBSatz, 177, 8)
        Else
            cKJMopreis = "0"
        End If
'        MsgBox cKJMopreis

        
        If Len(cLBSatz) > 157 Then
            cExtend = Mid(cLBSatz, 158, 18)
        Else
            cExtend = ""
        End If
        
        
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
        sArtnr = ctmp
        
        '***************************************************
        '* Zeile ZWISCHENSUMME darf nicht übernommen werden!
        '***************************************************
        
        If ctmp <> "000000" Then
            
            cSQL = "Select * from Artikel where Artnr = " & ctmp
            Set rsArt = gdBase.OpenRecordset(cSQL)
            If Not rsArt.EOF Then
                iFeld = 2
                If Not IsNull(rsArt!LPZ) Then
                    cKJLPZ = rsArt!LPZ
                Else
                    cKJLPZ = ""
                End If
                
                iFeld = 3
                If Not IsNull(rsArt!AGN) Then
                    cKJAGN = rsArt!AGN
                Else
                    cKJAGN = ""
                End If
                
                iFeld = 4
                If Not IsNull(rsArt!EAN) Then
                    cKJEAN = rsArt!EAN
                Else
                    cKJEAN = ""
                End If
                
                iFeld = 5
                If Not IsNull(rsArt!ekpr) Then
                    dEkpr = rsArt!ekpr
                Else
                    dEkpr = 0
                End If
                
                iFeld = 6
                If Not IsNull(rsArt!linr) Then
                    dLiNr = rsArt!linr
                Else
                    dLiNr = 0
                End If
                
                iFeld = 7
                If Not IsNull(rsArt!MWST) Then
                    cArtMWSt = rsArt!MWST
                Else
                    cArtMWSt = "V"
                End If
                
                iFeld = 8
                If Not IsNull(rsArt!UMS_OK) Then
                    cUmsOK = rsArt!UMS_OK
                Else
                    cUmsOK = "J"
                End If
                
                iFeld = 9
                If Not IsNull(rsArt!BONUS_OK) Then
                    cBonusOk = rsArt!BONUS_OK
                Else
                    cBonusOk = "J"
                End If
                
                If Not IsNull(rsArt!SPANNE) Then
                    dSpanne = rsArt!SPANNE
                Else
                    dSpanne = 0
                End If
                             
            Else
                dEkpr = 0
                dLiNr = 0
            End If
            
            rsArt.Close: Set rsArt = Nothing
            
            

            
            If ctmp = "666666" Then
                cBonusOk = "N"
                cUmsOK = "N"
                cArtMWSt = "O"
            End If
            
            iFeld = 7
            ctmp = Mid(cLBSatz, 148, 3)
            ctmp = Trim$(ctmp)

            lKJBediener = Val(ctmp)
            
            iFeld = 8

            
            iFeld = 9
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)

            cKJMenge = ctmp
            
            iFeld = 10
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)

            dKJPreis = Val(ctmp)
            
            iFeld = 11
            ctmp = Mid(cLBSatz, 7, 6)
            ctmp = Trim$(ctmp)
            cKJArtNr = ctmp
            
            iFeld = 12
            ctmp = Mid(cLBSatz, 14, 35)
            ctmp = Trim$(ctmp)
            If cExtend <> "" Then
                If Len(ctmp) > 15 Then
                    ctmp = Left(ctmp, 15)
                End If
                ctmp = ctmp & " @" & cExtend
            End If

            cKJBezeich = ctmp
            
            iFeld = 13

            
            iFeld = 14

            lKJADate = Fix(Now)
            cKJAZeit = Format$(Now, "HH:MM:SS")
            

            cKJMwst = cArtMWSt
            
            iFeld = 16
            If ctmp = "V" Then
                ctmp = Mid(cLBSatz, 104, 9)
            ElseIf ctmp = "E" Then
                ctmp = Mid(cLBSatz, 114, 9)
            Else
                ctmp = "0"
            End If
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            iFeld = 17
            ctmp = Label2(7).Caption
            ctmp = Trim$(ctmp)
            If Val(ctmp) < 0 Then
                ctmp = "0"
            End If
            cKJKundNr = ctmp
            
            iFeld = 18
            cKJBelegNr = gdBonNr
            
            iFeld = 19
            cKJFiliale = gcFilNr
            
            iFeld = 20
            
            iFeld = 21
            ctmp = Mid(cLBSatz, 50, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            iFeld = 22
            ctmp = Mid(cLBSatz, 128, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            If Val(ctmp) = 0 Then
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = Trim$(ctmp)
                ctmp = fnMoveComma2Point$(ctmp)
                dKJVkpr = Val(ctmp)
            Else
                dKJVkpr = Val(ctmp)
            End If
            
            If dEkpr = 0 Then
                If dSpanne <> 0 Then
                    dEkpr = EKausNettospanneerrechnen(dSpanne, Val(ctmp), cArtMWSt)
                End If
            End If
            
            iFeld = 23
            ctmp = fnMoveComma2Point$(CStr(dEkpr))
            dKJEkpr = Val(ctmp)
            
            iFeld = 24
            cKJLiNr = Trim$(Str$(dLiNr))
            
            iFeld = 25
            If gcKreditKarte <> "" Then

            Else

            End If
            
            iFeld = 26
            ctmp = Mid(cLBSatz, 138, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)

            dKJBest1 = Val(ctmp)
            
            If dKJVkpr = 0 Then
                dKJVkpr = dKJPreis / cKJMenge
            End If
            
            If gcKreditKarte <> "" Then

            Else
                gcKreditKarte = gcZahlMittel
            End If
            
            
            
            
            
            
            
            
            
            
            
            
            cSQL = " Insert into Kassjour ( "
            
            cSQL = cSQL & " artnr"
            cSQL = cSQL & " ,BEZEICH"
            cSQL = cSQL & " ,Menge"
            cSQL = cSQL & " ,Preis"
            cSQL = cSQL & " ,adate"
            
            cSQL = cSQL & " ,azeit"
            cSQL = cSQL & " ,BEDIENER"
            cSQL = cSQL & " ,kundnr"
            cSQL = cSQL & " ,Filiale"
            cSQL = cSQL & " ,KASNUM"
            
            cSQL = cSQL & " ,linr"
            cSQL = cSQL & " ,LPZ"
            cSQL = cSQL & " ,AGN"
            cSQL = cSQL & " ,EAN"
            cSQL = cSQL & " ,MWST"
            
            cSQL = cSQL & " ,ekpr"
            cSQL = cSQL & " ,UMS_OK"
            cSQL = cSQL & " ,MOPREIS"
            cSQL = cSQL & " ,ZBONNR"
            cSQL = cSQL & " ,ABOK"

            cSQL = cSQL & " ,vkpr"
            cSQL = cSQL & " ,BELEGNR"
            cSQL = cSQL & " ,best1"
            cSQL = cSQL & " ,KK_ART"
            cSQL = cSQL & " )"
            
            cSQL = cSQL & " values  "
            
            cSQL = cSQL & " ( " & Val(cKJArtNr) & " "
            cSQL = cSQL & " , '" & cKJBezeich & "' "
            cSQL = cSQL & " , " & Val(cKJMenge) & " "
            
            cSQL = cSQL & " , '" & dKJPreis & "' "
            
            cSQL = cSQL & " , " & lKJADate & " "
            cSQL = cSQL & " , '" & cKJAZeit & "' "
            cSQL = cSQL & " , " & lKJBediener & " "
            cSQL = cSQL & " , " & Val(cKJKundNr) & " "
            cSQL = cSQL & " , " & Val(cKJFiliale) & " "
            cSQL = cSQL & " , " & Val(gcKasNum) & " "
            
            cSQL = cSQL & " , " & Val(cKJLiNr) & " "
            cSQL = cSQL & " , " & Val(cKJLPZ) & " "
            cSQL = cSQL & " , " & Val(cKJAGN) & " "
            cSQL = cSQL & " , '" & cKJEAN & "' "
            cSQL = cSQL & " , '" & cKJMwst & "' "
            
            cSQL = cSQL & " , '" & dKJEkpr & "' "
            
            cSQL = cSQL & " , '" & cUmsOK & "' "
            cSQL = cSQL & " , " & cKJMopreis & " "
            cSQL = cSQL & " , " & IAbschluss & " "
            cSQL = cSQL & " , " & -1 & " "
            
            

            cSQL = cSQL & " , '" & dKJVkpr & "' "
            cSQL = cSQL & " , " & gdBonNr & " "
            cSQL = cSQL & " , " & dKJBest1 & " "
            cSQL = cSQL & " , '" & gcKreditKarte & "' "
            
            cSQL = cSQL & " )"
'            MsgBox cSQL
            gdBase.Execute cSQL, dbFailOnError
            
            
            cSQL = "Select * from AFCAUFBON where AARTNR = -1"
            FnOpenrecordset rsrs, cSQL, 1, gdBase

            rsrs.AddNew
            rsrs!aMenge = Val(cKJMenge)
            rsrs!aartnr = Val(cKJArtNr)
            rsrs!AZEIT = Format$(Now, "HH:MM:SS")
            rsrs.Update
            rsrs.Close: Set rsrs = Nothing
            
            If Val(cKJArtNr) <> 666666 Then
                If cUmsOK <> "N" Then
                    dKdUmsatz = dKdUmsatz + dKJPreis
                End If
            End If
            
            If Len(cLBSatz) >= 154 Then
                If Mid(cLBSatz, 154, 1) <> "N" Then
                    dKdBonus = dKdBonus + dKJPreis
                End If
            Else
                'dKdBonus = dKdBonus + dKJPreis
            End If
        End If
    Next lAktSatz
    
    If Val(cKJKundNr) > 0 Then
        Plus_Bonus cKJKundNr, dKdUmsatz, dKdBonus
    End If

Exit Sub
LOKAL_ERROR:
    If err.Number = 3260 Then
        If ierrz < 5 Then
            ierrz = ierrz + 1
            Pause (1)
            Resume
        Else
            Fehler.gsDescr = err.Description
            Fehler.gsNumber = err.Number
            Fehler.gsFormular = Me.name
            Fehler.gsFunktion = "InsertAFCBuchWKL20Fleischer"
            Fehler.gsFehlertext = "Nach 5 sec ist im Programmteil Kasse ist ein Fehler aufgetreten."
            
            Fehlermeldung1
            Exit Sub
        End If
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "InsertAFCBuchWKL20Fleischer"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
        Resume Next
    End If
End Sub
Private Sub InsertKollVerkWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim dLiNr           As Double
    Dim dEkpr           As Double
    Dim dWert           As Double
    Dim ctmp            As String
    Dim cLBSatz         As String
    Dim cSQL            As String
    Dim cExtend         As String
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim rsrs            As Recordset
    Dim rsKJ            As Recordset
    Dim rsArt           As Recordset
    Dim iFeld           As Integer
    Dim iDbNr           As Integer
    Dim dKdUmsatz       As Double
    Dim dKdBonus        As Double
    Dim cKJArtNr        As String
    Dim cKJBezeich      As String
    Dim cKJMenge        As String
    Dim cUmsOK          As String
    Dim cKJAZeit        As String
    Dim cKJKundNr       As String
    Dim cKJFiliale      As String
    Dim cKJKasNum       As String
    Dim cKJLiNr         As String
    Dim cKJLPZ          As String
    Dim cKJAGN          As String
    Dim cKJEAN          As String
    Dim cKJMwst         As String
    Dim cKJBelegNr      As String
    Dim dKJEkpr         As Double
    Dim dKJVkpr         As Double
    Dim dKJBest1        As Double
    Dim dKJPreis        As Double
    Dim lKJADate        As Long
    Dim lKJBediener     As Long
    
    cSQL = "Select * from KOLLVERK"
    FnOpenrecordset rsKJ, cSQL, 1, gdBase
    
    lAnzSatz = List1.ListCount
    
    If lAnzSatz > 10 Then
        Label19(0).Caption = 0
        Label19(2).Caption = Trim$(Str$(lAnzSatz))
        Frame31.Visible = True
    End If

    For lAktSatz = 0 To lAnzSatz - 1
        
        If lAnzSatz > 10 Then
            Label19(0).Caption = Trim$(Str$(lAktSatz))
            Label19(0).Refresh
        End If
        
        iFeld = 1
        cKJArtNr = ""
        cKJBezeich = ""
        cKJMenge = ""
        dKJPreis = 0
        lKJADate = 0
        cKJAZeit = ""
        lKJBediener = 0
        cKJKundNr = ""
        cKJFiliale = ""
        cKJKasNum = ""
        cKJLiNr = ""
        cKJLPZ = ""
        cKJAGN = ""
        cKJEAN = ""
        cKJMwst = ""
        dKJEkpr = 0
        dKJVkpr = 0
        cKJBelegNr = ""
        dKJBest1 = 0
        
        cLBSatz = List1.list(lAktSatz)
        
        Dim cKJMopreis  As String
        If Len(cLBSatz) > 175 Then
            cKJMopreis = Mid(cLBSatz, 177, 8)
        Else
            cKJMopreis = "0"
        End If
        
        If Len(cLBSatz) > 157 Then
            cExtend = Mid(cLBSatz, 156, 18)
        Else
            cExtend = ""
        End If
        
        If Len(cLBSatz) > 156 Then
            cUmsOK = Mid(cLBSatz, 157, 1)
        Else
            cUmsOK = "J"
        End If
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
        
        '***************************************************
        '* Zeile ZWISCHENSUMME darf nicht übernommen werden!
        '***************************************************
        
        If ctmp <> "000000" Then
        
            cSQL = "Select * from Artikel where Artnr = " & ctmp
            FnOpenrecordset rsArt, cSQL, 1, gdBase
            

            If Not rsArt.EOF Then
                
                iFeld = 2
                If Not IsNull(rsArt!LPZ) Then
                    cKJLPZ = rsArt!LPZ
                Else
                    cKJLPZ = ""
                End If
                
                iFeld = 3
                If Not IsNull(rsArt!AGN) Then
                    cKJAGN = rsArt!AGN
                Else
                    cKJAGN = ""
                End If
                
                iFeld = 4
                If Not IsNull(rsArt!EAN) Then
                    cKJEAN = rsArt!EAN
                Else
                    cKJEAN = ""
                End If
                
                iFeld = 5
                If Not IsNull(rsArt!lekpr) Then
                    dEkpr = rsArt!lekpr
                Else
                    dEkpr = 0
                End If
                
                iFeld = 6
                If Not IsNull(rsArt!linr) Then
                    dLiNr = rsArt!linr
                Else
                    dLiNr = 0
                End If
                
            Else
                dEkpr = 0
                dLiNr = 0
            End If
            rsArt.Close: Set rsArt = Nothing
            
            iFeld = 7
            ctmp = Mid(cLBSatz, 148, 3)
            ctmp = Trim$(ctmp)
            lKJBediener = Val(ctmp)
            
            iFeld = 8
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            cKJMenge = ctmp
            
            iFeld = 10
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJPreis = Val(ctmp)
            
            iFeld = 11
            ctmp = Mid(cLBSatz, 7, 6)
            ctmp = Trim$(ctmp)
            cKJArtNr = ctmp
            
            iFeld = 12
            ctmp = Mid(cLBSatz, 14, 35)
            ctmp = Trim$(ctmp)
            If cExtend <> "" Then
                If Len(ctmp) > 15 Then
                    ctmp = Left(ctmp, 15)
                End If
                ctmp = ctmp & " @" & cExtend
            End If
            cKJBezeich = ctmp
            
            iFeld = 13
            
            iFeld = 14
            lKJADate = Fix(Now)
            cKJAZeit = Format$(Now, "HH:MM:SS")
            
            iFeld = 15
            ctmp = Mid(cLBSatz, 72, 1)
            ctmp = Trim$(ctmp)
            cKJMwst = ctmp
            
            iFeld = 16
            If ctmp = "V" Then
                ctmp = Mid(cLBSatz, 104, 9)
            ElseIf ctmp = "E" Then
                ctmp = Mid(cLBSatz, 114, 9)
            Else
                ctmp = "0"
            End If
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            iFeld = 17
            ctmp = Label2(7).Caption
            ctmp = Trim$(ctmp)
            If Val(ctmp) < 0 Then
                ctmp = "0"
            End If
            cKJKundNr = ctmp
            
            iFeld = 18
            cKJBelegNr = gdBonNr
            
            iFeld = 19
            cKJFiliale = gcFilNr
            
            iFeld = 20
            
            iFeld = 21
            ctmp = Mid(cLBSatz, 50, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            iFeld = 22
            ctmp = Mid(cLBSatz, 128, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJVkpr = Val(ctmp)
            
            iFeld = 23
            dKJEkpr = dEkpr
            
            iFeld = 24
            cKJLiNr = Trim$(Str$(dLiNr))
            
            iFeld = 25
            
            iFeld = 26
            ctmp = Mid(cLBSatz, 138, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            dKJBest1 = Val(ctmp)
            
            
            
            rsKJ.AddNew
            
            iFeld = 26
            rsKJ!artnr = Val(cKJArtNr)
            iFeld = 27
            rsKJ!BEZEICH = cKJBezeich
            iFeld = 28
            rsKJ!Menge = Val(cKJMenge)
            iFeld = 29
            rsKJ!Preis = dKJPreis
            iFeld = 30
            rsKJ!ADATE = lKJADate
            iFeld = 31
            rsKJ!AZEIT = cKJAZeit
            iFeld = 32
            rsKJ!BEDIENER = lKJBediener
            iFeld = 33
            rsKJ!Kundnr = Val(cKJKundNr)
            iFeld = 34
            rsKJ!FILIALE = Val(cKJFiliale)
            iFeld = 35
            rsKJ!kasnum = Val(gcKasNum)
            iFeld = 36
            rsKJ!linr = Val(cKJLiNr)
            iFeld = 37
            rsKJ!LPZ = Val(cKJLPZ)
            iFeld = 38
            rsKJ!AGN = Val(cKJAGN)
            iFeld = 39
            rsKJ!EAN = cKJEAN
            iFeld = 40
            rsKJ!MWST = cKJMwst
            iFeld = 41
            rsKJ!ekpr = dKJEkpr
            iFeld = 42
            rsKJ!MOPPREIS = cKJMopreis
            
            If Val(cKJMenge) = 0 Then
                cKJMenge = 1
            End If
            
            If dKJVkpr = 0 Then
                dKJVkpr = dKJPreis / Val(cKJMenge)
            End If
            
            rsKJ!vkpr = dKJVkpr
            iFeld = 43
            rsKJ!BELEGNR = gdBonNr
            iFeld = 44
            rsKJ!best1 = dKJBest1
            
            rsKJ!SENDOK = False
            
            rsKJ.Update
            
            
            
            
            If gbGutscheinBeiVKversteuern = True Then
                If Val(cKJArtNr) <> 666666 Then
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                Else
                    'auch bei Gutschein
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                End If
            Else
                If Val(cKJArtNr) <> 666666 Then
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                End If
            End If
            
'das war mal
'            If Val(cKJArtNr) <> 666666 Then
'                If cUmsOK <> "N" Then
'                    dKdUmsatz = dKdUmsatz + dKJPreis
'                End If
'            End If
            
            If Len(cLBSatz) >= 154 Then
                If Mid(cLBSatz, 154, 1) <> "N" Then
                    dKdBonus = dKdBonus + dKJPreis
                End If
            Else
                dKdBonus = dKdBonus + dKJPreis
            End If
        End If
        
    Next lAktSatz
    
    rsKJ.Close
  
    Frame31.Visible = False
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "InsertKollVerkWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Sub InsertRetoureWKL20(sretGrund As String)
    On Error GoTo LOKAL_ERROR
    
    Dim dLiNr           As Double
    Dim dEkpr           As Double
    Dim dWert           As Double
    Dim ctmp            As String
    Dim cLBSatz         As String
    Dim cSQL            As String
    Dim cExtend         As String
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim rsKJ            As Recordset
    Dim rsArt           As Recordset
    Dim iDbNr           As Integer
    Dim iFeld           As Integer
    Dim dKdUmsatz       As Double
    Dim dKdBonus        As Double
    Dim cKJArtNr        As String
    Dim cKJBezeich      As String
    Dim cKJMenge        As String
    Dim cUmsOK          As String
    Dim cKJAZeit        As String
    Dim cKJKundNr       As String
    Dim cKJFiliale      As String
    Dim cKJKasNum       As String
    Dim cKJLiNr         As String
    Dim cKJLPZ          As String
    Dim cKJAGN          As String
    Dim cKJEAN          As String
    Dim cKJMwst         As String
    Dim cKJBelegNr      As String
    Dim dKJBest1        As Double
    Dim dKJPreis        As Double
    Dim dKJEkpr         As Double
    Dim dKJVkpr         As Double
    Dim lKJADate        As Long
    Dim lKJBediener     As Long
    
    cSQL = "Select * from Retoure"
    FnOpenrecordset rsKJ, cSQL, 1, gdBase
    
    lAnzSatz = List1.ListCount
    
    If lAnzSatz > 10 Then
        Label19(0).Caption = 0
        Label19(2).Caption = Trim$(Str$(lAnzSatz))
        Frame31.Visible = True
    End If

    For lAktSatz = 0 To lAnzSatz - 1
        If lAnzSatz > 10 Then
            Label19(0).Caption = Trim$(Str$(lAktSatz))
            Label19(0).Refresh
        End If
        
        iFeld = 1
        cKJArtNr = ""
        cKJBezeich = ""
        cKJMenge = ""
        dKJPreis = 0
        lKJADate = 0
        cKJAZeit = ""
        lKJBediener = 0
        cKJKundNr = ""
        cKJFiliale = ""
        cKJKasNum = ""
        cKJLiNr = ""
        cKJLPZ = ""
        cKJAGN = ""
        cKJEAN = ""
        cKJMwst = ""
        dKJEkpr = 0
        dKJVkpr = 0
        cKJBelegNr = ""
        dKJBest1 = 0
        
        cLBSatz = List1.list(lAktSatz)
        
        Dim cKJMopreis  As String
        
        If Len(cLBSatz) > 175 Then
            cKJMopreis = Mid(cLBSatz, 177, 8)
        Else
            cKJMopreis = "0"
        End If
        
        If Len(cLBSatz) > 157 Then
            cExtend = Mid(cLBSatz, 156, 18)
        Else
            cExtend = ""
        End If
        
        If Len(cLBSatz) > 156 Then
            cUmsOK = Mid(cLBSatz, 157, 1)
        Else
            cUmsOK = "J"
        End If
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
        
        '***************************************************
        '* Zeile ZWISCHENSUMME darf nicht übernommen werden!
        '***************************************************
        
        If ctmp <> "000000" Then
        
            cSQL = "Select * from Artikel where Artnr = " & ctmp
            FnOpenrecordset rsArt, cSQL, 1, gdBase


            If Not rsArt.EOF Then
                iFeld = 2
                If Not IsNull(rsArt!LPZ) Then
                    cKJLPZ = rsArt!LPZ
                Else
                    cKJLPZ = ""
                End If
                
                iFeld = 3
                If Not IsNull(rsArt!AGN) Then
                    cKJAGN = rsArt!AGN
                Else
                    cKJAGN = ""
                End If
                
                iFeld = 4
                If Not IsNull(rsArt!EAN) Then
                    cKJEAN = rsArt!EAN
                Else
                    cKJEAN = ""
                End If
                
                iFeld = 5
                If Not IsNull(rsArt!lekpr) Then
                    dEkpr = rsArt!lekpr
                Else
                    dEkpr = 0
                End If
                
                iFeld = 6
                If Not IsNull(rsArt!linr) Then
                    dLiNr = rsArt!linr
                Else
                    dLiNr = 0
                End If
                
            Else
                dEkpr = 0
                dLiNr = 0
            End If
            rsArt.Close: Set rsArt = Nothing
            
            iFeld = 7
            ctmp = Mid(cLBSatz, 148, 3)
            ctmp = Trim$(ctmp)
            lKJBediener = Val(ctmp)
            
            iFeld = 8
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            cKJMenge = ctmp
            
            iFeld = 10
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJPreis = Val(ctmp)
            
            iFeld = 11
            ctmp = Mid(cLBSatz, 7, 6)
            ctmp = Trim$(ctmp)
            cKJArtNr = ctmp
            
            iFeld = 12
            ctmp = Mid(cLBSatz, 14, 35)
            ctmp = Trim$(ctmp)
            If cExtend <> "" Then
                If Len(ctmp) > 15 Then
                    ctmp = Left(ctmp, 15)
                End If
                ctmp = ctmp & " @" & cExtend
            End If
            cKJBezeich = ctmp
            
            iFeld = 13
            
            iFeld = 14
            lKJADate = Fix(Now)
            cKJAZeit = Format$(Now, "HH:MM:SS")
            
            iFeld = 15
            ctmp = Mid(cLBSatz, 72, 1)
            ctmp = Trim$(ctmp)
            cKJMwst = ctmp
            
            iFeld = 16
            If ctmp = "V" Then
                ctmp = Mid(cLBSatz, 104, 9)
            ElseIf ctmp = "E" Then
                ctmp = Mid(cLBSatz, 114, 9)
            Else
                ctmp = "0"
            End If
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            iFeld = 17
            ctmp = Label2(7).Caption
            ctmp = Trim$(ctmp)
            If Val(ctmp) < 0 Then
                ctmp = "0"
            End If
            cKJKundNr = ctmp
            
            iFeld = 18
            cKJBelegNr = gdBonNr
            
            iFeld = 19
            cKJFiliale = gcFilNr
            
            iFeld = 20
            iFeld = 21
            ctmp = Mid(cLBSatz, 50, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            iFeld = 22
            ctmp = Mid(cLBSatz, 128, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJVkpr = Val(ctmp)
            
            iFeld = 23
            dKJEkpr = dEkpr
            
            iFeld = 24
            cKJLiNr = Trim$(Str$(dLiNr))
            
            iFeld = 25
            
            iFeld = 26
            ctmp = Mid(cLBSatz, 138, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJBest1 = Val(ctmp)
            
            rsKJ.AddNew
            
            iFeld = 26
            rsKJ!artnr = Val(cKJArtNr)
            iFeld = 27
            rsKJ!BEZEICH = cKJBezeich
            iFeld = 28
            rsKJ!Menge = Val(cKJMenge)
            iFeld = 29
            rsKJ!Preis = dKJPreis
            iFeld = 30
            rsKJ!ADATE = lKJADate
            iFeld = 31
            rsKJ!AZEIT = cKJAZeit
            iFeld = 32
            rsKJ!BEDIENER = lKJBediener
            iFeld = 33
            rsKJ!Kundnr = Val(cKJKundNr)
            iFeld = 34
            rsKJ!FILIALE = Val(cKJFiliale)
            iFeld = 35
            rsKJ!kasnum = Val(gcKasNum)
            iFeld = 36
            rsKJ!linr = Val(cKJLiNr)
            iFeld = 37
            rsKJ!LPZ = Val(cKJLPZ)
            iFeld = 38
            rsKJ!AGN = Val(cKJAGN)
            iFeld = 39
            rsKJ!EAN = cKJEAN
            iFeld = 40
            rsKJ!MWST = cKJMwst
            iFeld = 41
            rsKJ!ekpr = dKJEkpr
            iFeld = 42
            rsKJ!vkpr = dKJVkpr
            iFeld = 43
            rsKJ!BELEGNR = gdBonNr
            iFeld = 44
            rsKJ!best1 = dKJBest1
            rsKJ!MOPPREIS = cKJMopreis
            rsKJ!SENDOK = False
            
            rsKJ!AENGRUND = sretGrund
            
            rsKJ.Update
            
            
            
            If gbGutscheinBeiVKversteuern = True Then
                If Val(cKJArtNr) <> 666666 Then
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                Else
                    'auch bei Gutschein
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                End If
            Else
                If Val(cKJArtNr) <> 666666 Then
                    If cUmsOK <> "N" Then
                        dKdUmsatz = dKdUmsatz + dKJPreis
                    End If
                End If
            End If
            

'das war mal
'            If Val(cKJArtNr) <> 666666 Then
'                If cUmsOK <> "N" Then
'                    dKdUmsatz = dKdUmsatz + dKJPreis
'                End If
'            End If
            
            If Len(cLBSatz) >= 154 Then
                If Mid(cLBSatz, 154, 1) <> "N" Then
                    dKdBonus = dKdBonus + dKJPreis
                End If
            Else
                dKdBonus = dKdBonus + dKJPreis
            End If
        End If
        
    Next lAktSatz
    rsKJ.Close
    Frame31.Visible = False
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "InsertRetoureWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Function InsertKUNDENBESTELLUNGWKL20() As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim dEkpr           As Double
    Dim ctmp            As String
    Dim cLBSatz         As String
    Dim cSQL            As String
    Dim cExtend         As String
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim rsKJ            As Recordset
    Dim rsArt           As Recordset
    Dim rsEX            As Recordset
    Dim iFeld           As Integer
    Dim cKJArtNr        As String
    Dim cKJBezeich      As String
    Dim cKJMenge        As String
    Dim cKJAZeit        As String
    Dim cKJKundNr       As String
    Dim cKJFiliale      As String
    Dim cKJMwst         As String
    Dim dKJPreis        As Double
    Dim dKJEkpr         As Double
    Dim dKJVkpr         As Double
    Dim lKJADate        As Long
    Dim lKJBediener     As Long
    Dim i               As Integer
    Dim iRet            As Integer
    Dim bEX             As Boolean
    Dim bNichtgefuehrt  As Boolean
    Dim sExdat          As String
    Dim bSpeichern      As Boolean
    Dim lAnzZeile       As Long
    Dim lLinr           As Long
    
    InsertKUNDENBESTELLUNGWKL20 = False
    
    lAnzZeile = 0
    ReDim gcArrArtNr(1 To 1) As String
    
    cSQL = "Select * from KUNDBEST"
    FnOpenrecordset rsKJ, cSQL, 1, gdBase
    
    lAnzSatz = List1.ListCount
    
    If lAnzSatz > 10 Then
        Label19(0).Caption = 0
        Label19(2).Caption = Trim$(Str$(lAnzSatz))
        Frame31.Visible = True
    End If

    For lAktSatz = 0 To lAnzSatz - 1

            
        If lAnzSatz > 10 Then
            Label19(0).Caption = Trim$(Str$(lAktSatz))
            Label19(0).Refresh
        End If
        
        cKJArtNr = ""
        cKJBezeich = ""
        cKJMenge = ""
        dKJPreis = 0
        lKJADate = 0
        cKJAZeit = ""
        lKJBediener = 0
        cKJKundNr = ""
        cKJFiliale = ""
        cKJMwst = ""
        dKJEkpr = 0
        dKJVkpr = 0
        
        cLBSatz = List1.list(lAktSatz)
        
        If Len(cLBSatz) > 157 Then
            cExtend = Mid(cLBSatz, 156, 18)
        Else
            cExtend = ""
        End If
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
                
        If ctmp <> "000000" Then
        
            cSQL = "Select * from Artikel where Artnr = " & ctmp
            FnOpenrecordset rsArt, cSQL, 1, gdBase

            dEkpr = 0
            bEX = False
            bNichtgefuehrt = False
            sExdat = ""
            bSpeichern = True
            
            If Not rsArt.EOF Then
                If Not IsNull(rsArt!lekpr) Then
                    dEkpr = rsArt!lekpr
                End If
                
                lLinr = 0
                If Not IsNull(rsArt!linr) Then
                    lLinr = rsArt!linr
                End If
                
                If Not IsNull(rsArt!GEFUEHRT) Then
                    If rsArt!GEFUEHRT = "N" Then
                        bNichtgefuehrt = True
                    End If
                End If
            End If
            rsArt.Close: Set rsArt = Nothing
            
            iFeld = 7
            ctmp = Mid(cLBSatz, 148, 3)
            ctmp = Trim$(ctmp)
            lKJBediener = Val(ctmp)
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            cKJMenge = ctmp
            
            iFeld = 10
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJPreis = Val(ctmp)
            
            iFeld = 11
            ctmp = Mid(cLBSatz, 7, 6)
            ctmp = Trim$(ctmp)
            cKJArtNr = ctmp
            
            iFeld = 12
            ctmp = Mid(cLBSatz, 14, 35)
            ctmp = Trim$(ctmp)
            If cExtend <> "" Then
                If Len(ctmp) > 15 Then
                    ctmp = Left(ctmp, 15)
                End If
                ctmp = ctmp & " @" & cExtend
            End If
            cKJBezeich = ctmp
            
            iFeld = 14
            lKJADate = Fix(Now)
            cKJAZeit = Format$(Now, "HH:MM:SS")
            
            iFeld = 15
            ctmp = Mid(cLBSatz, 72, 1)
            ctmp = Trim$(ctmp)
            cKJMwst = ctmp
            
            iFeld = 17
            ctmp = Label2(7).Caption
            ctmp = Trim$(ctmp)
            If Val(ctmp) < 0 Then
                ctmp = "0"
            End If
            cKJKundNr = ctmp
            
            iFeld = 19
            cKJFiliale = gcFilNr
            
            iFeld = 22
            ctmp = Mid(cLBSatz, 128, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJVkpr = Val(ctmp)
            
            iFeld = 23
            dKJEkpr = dEkpr
            
            
            
            
            
            cSQL = "select * from artlief where artnr = " & cKJArtNr
            cSQL = cSQL & " and linr = " & lLinr
            Set rsEX = gdBase.OpenRecordset(cSQL)
            
            If Not rsEX.EOF Then
                If Not IsNull(rsEX!RKZ) Then
                    If rsEX!RKZ = "J" Then
                        bEX = True

                        If Not IsNull(rsEX!EXDAT) Then
                            sExdat = Format(rsEX!EXDAT, "DD.MM.YYYY")
                        End If

                    End If
                End If
            End If
            rsEX.Close: Set rsEX = Nothing
            
            
            
            
            
            
            'bist du ex?
            If bEX Then
                If Trim(sExdat) = "" Then
                    ctmp = "Achtung Artikel ist vom Hersteller aus dem Sortiment genommen!" & vbCrLf & vbCrLf
                Else
                    ctmp = "Achtung Artikel ist seit dem " & sExdat & " vom Hersteller aus dem Sortiment genommen!" & vbCrLf & vbCrLf
                End If
                ctmp = ctmp & "Wollen Sie den Artikel wirklich bestellen?" & vbCrLf
    
                iRet = MsgBox(ctmp, vbQuestion + vbYesNo + vbDefaultButton2, "Winkiss Frage:")
                
                If iRet = vbNo Then
                    bSpeichern = False
                    
                    'diesen Artikel auch nicht drucken
                    'also ins nichtDruckarray
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve gcArrArtNr(1 To lAnzZeile) As String
                    gcArrArtNr(lAnzZeile) = cKJArtNr
                    
                End If
            End If
            
            
            
            
            
            'bist du geführt = Nein?
            If bNichtgefuehrt Then
                
                ctmp = "Achtung, dieser Artikel wird standardmäßig nicht geführt!" & vbCrLf & vbCrLf
                ctmp = ctmp & "Bitte leiten Sie diese Information weiter!" & vbCrLf
    
                MsgBox ctmp, vbInformation + vbOKOnly, "Winkiss Hinweis:"
                
            End If
            
            
            
            
            
            
            If bSpeichern Then
            
                InsertKUNDENBESTELLUNGWKL20 = True
                rsKJ.AddNew
                rsKJ!artnr = Val(cKJArtNr)
                rsKJ!BEZEICH = cKJBezeich
                rsKJ!BestelltMenge = Val(cKJMenge)
                rsKJ!BestelltPreis = dKJPreis
                rsKJ!Bestelltam = lKJADate
                rsKJ!Bestelltum = cKJAZeit
                rsKJ!BEDNU = lKJBediener
                rsKJ!Kundnr = Val(cKJKundNr)
                rsKJ!FILIALE = Val(cKJFiliale)
                rsKJ!MWST = cKJMwst
                rsKJ!ekpr = dKJEkpr
                rsKJ!vkpr = dKJVkpr
                rsKJ!StatusARTIKEL = "INBESTELLUNG"
                rsKJ!statusKunde = "BESTELLT"
                rsKJ!SENDOK = False
                
                If gbMBBLOCKFrage Then
                    ctmp = "Artikel sperren? (" & cKJBezeich & ")" & vbCrLf & vbCrLf
                    
                    ctmp = ctmp & gsSperrFrage
                    
'                    ctmp = ctmp & "(Ja: Keine weitere Lieferung mehr (MB wird auf 0 gesetzt))" & vbCrLf
'                    ctmp = ctmp & "(Nein: MB bleibt unverändert)" & vbCrLf
                    
                    iRet = MsgBox(ctmp, vbQuestion + vbYesNo + vbDefaultButton2, "Winkiss Frage:")
                    If iRet = vbYes Then
                        rsKJ!MBBLOCK = True
                        
                        
                        'Insert into MBORDER
                        
                        Dim iMB As Integer
                        iMB = 0
                        
                        cSQL = "Delete from MBORDER where artnr = " & cKJArtNr & " "
                        gdBase.Execute cSQL, dbFailOnError
        
                        cSQL = " Insert into MBORDER (ARTNR,MB,LASTDATE,SENDOK) values "
                        cSQL = cSQL & " (" & cKJArtNr & " "
                        cSQL = cSQL & " , " & iMB & " "
                        cSQL = cSQL & " , '" & DateValue(Now) & "'"
                        cSQL = cSQL & " , false ) "
                        gdBase.Execute cSQL, dbFailOnError
    
                        cSQL = "Update ARTIKEL set ARTIKEL.minbest = " & iMB & " where artnr = " & cKJArtNr & " "
                        gdBase.Execute cSQL, dbFailOnError
                        
                    Else
                        rsKJ!MBBLOCK = False
                    End If
                Else
                    rsKJ!MBBLOCK = False
                End If
                
                rsKJ.Update
                
            End If
        End If
        
    Next lAktSatz
    rsKJ.Close
    
    Frame31.Visible = False
    
Exit Function
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "InsertKUNDENBESTELLUNGWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Function
Private Sub InsertKUNDEN_Auslieferung_WKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim dEkpr           As Double
    Dim ctmp            As String
    Dim cLBSatz         As String
    Dim cSQL            As String
    Dim cExtend         As String
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim rsKJ            As Recordset
    Dim rsArt           As Recordset
    Dim iFeld           As Integer
    Dim cKJArtNr        As String
    Dim cKJBezeich      As String
    Dim cKJMenge        As String
    Dim cKJAZeit        As String
    Dim cKJKundNr       As String
    Dim cKJFiliale      As String
    Dim cKJMwst         As String
    Dim dKJPreis        As Double
    Dim dKJEkpr         As Double
    Dim dKJVkpr         As Double
    Dim lKJADate        As Long
    Dim lKJBediener     As Long
    Dim i               As Integer
    
    ReDim gcArrArtNr(1 To 1) As String
    
    cSQL = "Select * from KUNDAUSLIEF"
'    FnOpenrecordset rsKJ, cSQL, 2, gdBase
    FnOpenrecordset rsKJ, cSQL, 1, gdBase
    
    lAnzSatz = List1.ListCount
    
    If lAnzSatz > 10 Then
        Label19(0).Caption = 0
        Label19(2).Caption = Trim$(Str$(lAnzSatz))
        Frame31.Visible = True
    End If

    For lAktSatz = 0 To lAnzSatz - 1
        If lAnzSatz > 10 Then
            Label19(0).Caption = Trim$(Str$(lAktSatz))
            Label19(0).Refresh
        End If
        
        cKJArtNr = ""
        cKJBezeich = ""
        cKJMenge = ""
        dKJPreis = 0
        lKJADate = 0
        cKJAZeit = ""
        lKJBediener = 0
        cKJKundNr = ""
        cKJFiliale = ""
        cKJMwst = ""
        dKJEkpr = 0
        dKJVkpr = 0
        
        cLBSatz = List1.list(lAktSatz)
        
        If Len(cLBSatz) > 157 Then
            cExtend = Mid(cLBSatz, 156, 18)
        Else
            cExtend = ""
        End If
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
        
        '***************************************************
        '* Zeile ZWISCHENSUMME darf nicht übernommen werden!
        '***************************************************
        
        If ctmp <> "000000" Then
        
            cSQL = "Select * from Artikel where Artnr = " & ctmp
            FnOpenrecordset rsArt, cSQL, 1, gdBase

            dEkpr = 0
            
            If Not rsArt.EOF Then
                If Not IsNull(rsArt!lekpr) Then
                    dEkpr = rsArt!lekpr
                End If
                
            End If
            rsArt.Close: Set rsArt = Nothing
            
            iFeld = 7
            ctmp = Mid(cLBSatz, 148, 3)
            ctmp = Trim$(ctmp)
            lKJBediener = Val(ctmp)
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            cKJMenge = ctmp
            
            iFeld = 10
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJPreis = Val(ctmp)
            
            iFeld = 11
            ctmp = Mid(cLBSatz, 7, 6)
            ctmp = Trim$(ctmp)
            cKJArtNr = ctmp
            
            iFeld = 12
            ctmp = Mid(cLBSatz, 14, 35)
            ctmp = Trim$(ctmp)
            If cExtend <> "" Then
                If Len(ctmp) > 15 Then
                    ctmp = Left(ctmp, 15)
                End If
                ctmp = ctmp & " @" & cExtend
            End If
            cKJBezeich = ctmp
            
            iFeld = 14
            lKJADate = Fix(Now)
            cKJAZeit = Format$(Now, "HH:MM:SS")
            
            iFeld = 15
            ctmp = Mid(cLBSatz, 72, 1)
            ctmp = Trim$(ctmp)
            cKJMwst = ctmp
            
            iFeld = 17
            ctmp = Label2(7).Caption
            ctmp = Trim$(ctmp)
            If Val(ctmp) < 0 Then
                ctmp = "0"
            End If
            cKJKundNr = ctmp
            
            iFeld = 19
            cKJFiliale = gcFilNr
            
            iFeld = 22
            ctmp = Mid(cLBSatz, 128, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            dKJVkpr = Val(ctmp)
            
            iFeld = 23
            dKJEkpr = dEkpr
            
            rsKJ.AddNew
            
            rsKJ!artnr = Val(cKJArtNr)
            rsKJ!BEZEICH = cKJBezeich
            rsKJ!BestelltMenge = Val(cKJMenge)
            rsKJ!BestelltPreis = dKJPreis
            rsKJ!Bestelltam = lKJADate
            rsKJ!Bestelltum = cKJAZeit
            rsKJ!BEDNU = lKJBediener
            rsKJ!Kundnr = Val(cKJKundNr)
            rsKJ!FILIALE = Val(cKJFiliale)
            rsKJ!MWST = cKJMwst
            rsKJ!ekpr = dKJEkpr
            rsKJ!vkpr = dKJVkpr
            rsKJ!StatusARTIKEL = "INBESTELLUNG"
            rsKJ!statusKunde = "BESTELLT"
            rsKJ!SENDOK = False
            
            rsKJ.Update
        End If
        
    Next lAktSatz
    rsKJ.Close
    
    Frame31.Visible = False
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "InsertKUNDEN_Auslieferung_WKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Function KUNDENBESTELLUNGOK() As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim cArtNr      As String
    Dim cSQL        As String
    Dim rsrs        As Recordset
    Dim lAktSatz    As Long
    Dim cLBSatz     As String

    KUNDENBESTELLUNGOK = True
    
    loeschNEW "KUNDBERR", gdBase
    CreateTable "KUNDBERR", gdBase
    
    For lAktSatz = 0 To List1.ListCount - 1
        cLBSatz = List1.list(lAktSatz)
        
        cArtNr = Mid(cLBSatz, 7, 6)
        cArtNr = Trim$(cArtNr)
        
        cSQL = "Select * from KUNDBEST where artnr = " & cArtNr
        cSQL = cSQL & " and bestelltam > " & CLng(DateValue(Now) - 14)
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            
            cSQL = "Insert into KUNDBERR Select * from KUNDBEST where artnr = " & cArtNr
            cSQL = cSQL & " and bestelltam > " & CLng(DateValue(Now) - 14)
            gdBase.Execute cSQL, dbFailOnError
            KUNDENBESTELLUNGOK = False
            
        End If
        rsrs.Close: Set rsrs = Nothing
    Next lAktSatz

Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "KUNDENBESTELLUNGOK"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Function
Private Sub AktualisiereListboxWKL20_wegenNOKUNDENBONUS_AG_RAB()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    Dim dRab        As Double
    Dim cLBSatz     As String
    Dim cArtNr      As String
    Dim ctmp        As String

    List3.Nodes.Clear
    
    lAnzSatz = List1.ListCount
    
    If lAnzSatz = 0 Then
        Exit Sub
    End If
    
    dRab = Val(Label2(3).Caption)
    
    
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cArtNr = Mid(cLBSatz, 7, 6)
        
        If cArtNr = "666666" Then
            ctmp = "N"
        Else
            If dRab > 0 Then
                ctmp = "N"
            Else
                ctmp = ermBonusfähigkeitArtikel(cArtNr)
            End If
        End If
    
        If Len(cLBSatz) > 154 Then  'musste wegen erst Gutschein dann Kundenbindung mit KuRabatt fehler verändert werden 18.12.14
    
            Mid(cLBSatz, 154, 1) = ctmp      'Erzielten Verkaufpreis setzen
        
        End If
        
        List1.RemoveItem lAktSatz
        List1.AddItem cLBSatz, lAktSatz
        
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
                
    Next lAktSatz
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AktualisiereListboxWKL20_wegenNOKUNDENBONUS_AG_RAB"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    Resume Next
End Sub
Private Sub AktualisiereListboxWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    Dim dWert       As Double
    Dim dMenge      As Double
    Dim dGRabatt    As Double
    Dim dEPreis     As Double
    Dim dGPreis     As Double
    Dim cLBSatz     As String
    Dim cArtRabatt  As String
    Dim cLPreis     As String
    Dim ctmp        As String
    Dim cArtNr      As String
    Dim bRabattOk   As Boolean
    Dim cZeile1     As String
    Dim cZeile2     As String
    
    List3.Nodes.Clear
    
    lAnzSatz = List1.ListCount
    
    If lAnzSatz = 0 Then
        Exit Sub
    End If
    
    ctmp = Label2(3).Caption
    ctmp = fnMoveComma2Point$(ctmp)
    dGRabatt = Val(ctmp)
    dGRabatt = (100 - dGRabatt) / 100
    
    For lAktSatz = 0 To lAnzSatz - 1
        bRabattOk = True
        cLBSatz = List1.list(lAktSatz)
        
        
        cZeile1 = Mid(cLBSatz, 14, 20)
        
        If Val(Right(cLBSatz, 2)) = 0 Then
            cArtNr = Mid(cLBSatz, 7, 6)
            If cArtNr = "666666" Then
                bRabattOk = False
            End If
            If bRabattOk Then
                If Mid(cLBSatz, 6, 1) = "*" Then
                    bRabattOk = False
                End If
            End If
            If bRabattOk Then
                cArtRabatt = Mid(cLBSatz, 124, 3)
                dWert = Val(cArtRabatt)
                If dWert = 0 Then                   'Hole den Listenpreis/Sonderpreis
                    cLPreis = Mid(cLBSatz, 74, 9)
                    cLPreis = Trim$(cLPreis)
                    cLPreis = fnMoveComma2Point$(cLPreis)
                    dWert = Val(cLPreis)
                    dWert = dWert * dGRabatt        'Berechne den neuen Einzelpreis
                    
                    'Neu 04.11.2016 Für coslive Fil 20
                    dWert = Round(dWert, 2)
                    
                    
                    
                    dEPreis = dWert
                    
                    '03.04.2014
                    ctmp = Format$(dWert, "#####0.000")
                    ctmp = Space$(9 - Len(ctmp)) & ctmp
                    Mid(cLBSatz, 50, 9) = ctmp
                    
                    
                    If Left(cLBSatz, 1) = "x" Then
                        ctmp = Mid(cLBSatz, 2, 4)
                    Else
                        ctmp = Mid(cLBSatz, 1, 5)
                    End If
                    
                    'Berechne den neuen Gesamtpreis
                    ctmp = Trim$(ctmp)
                    dWert = Val(ctmp)
                    dMenge = Val(ctmp)
                    dGPreis = dWert * dEPreis
                    ctmp = Format$(dGPreis, "#####0.00")
                    ctmp = Space$(9 - Len(ctmp)) & ctmp
                    
                    
                    
        
                    cZeile2 = gcWaehrung & " " & Trim$(ctmp)
                    cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                    
                    
                    
                    
                    
                    Mid(cLBSatz, 60, 9) = ctmp
                    Mid(cLBSatz, 94, 9) = ctmp      'Erzielten Verkaufpreis setzen
                    ctmp = Mid(cLBSatz, 72, 1)      'Berechne den neuen MWST-Betrag
                    If ctmp = "V" Then
                        dWert = dGPreis * (gdMWStV / 100)
                        ctmp = Format$(dWert, "#####0.00")
                        ctmp = Space$(9 - Len(ctmp)) & ctmp
                        Mid(cLBSatz, 104, 9) = ctmp
                    ElseIf ctmp = "E" Then
                        dWert = dGPreis * (gdMWStE / 100)
                        ctmp = Format$(dWert, "#####0.00")
                        ctmp = Space$(9 - Len(ctmp)) & ctmp
                        Mid(cLBSatz, 114, 9) = ctmp
                    End If
                    List1.RemoveItem lAktSatz
                    List1.AddItem cLBSatz, lAktSatz
                    
                    List3.Nodes.Add Text:=Left(cLBSatz, 68)
                End If
            End If
        End If
        BerechneZwischenSummeWKL20
        
        
        Dim len1 As Byte
        Dim len2 As Byte
        
        len1 = Len(Trim(cZeile2))
        len2 = Len(Trim(Label2(6).Caption))

        If gbKDEXM = True Then
            cZeile2 = CStr(dMenge) & " x " & Format$(dEPreis, "#####0.00") & " " & gcWaehrung
        Else
            If len1 + len2 > 17 Then
                cZeile2 = "ZS " & Label2(6).Caption
            Else
                cZeile2 = Trim(cZeile2) & Space(20 - len1 - len2 - 3) & "ZS " & Label2(6).Caption
            End If
        End If
        
        ZeigeKundenDisplay cZeile1, cZeile2, cLBSatz, Label2(6).Caption
        
        
        
    Next lAktSatz
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AktualisiereListboxWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub AktualisiereListboxWKL20aufGrundPreisKZand()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    
    Dim dWert       As Double
    Dim dGRabatt    As Double
    Dim dEPreis     As Double
    Dim dGPreis     As Double
    
    Dim cLBSatz     As String
    Dim cArtRabatt  As String
    Dim cLPreis     As String
    Dim ctmp        As String
    Dim cArtNr      As String
    Dim dFaktorV    As Double
    Dim dFaktorE    As Double
    Dim cMWST       As String
    Dim cUmsOK      As String
    
    dFaktorV = 1 + (gdMWStV / 100)
    dFaktorE = 1 + (gdMWStE / 100)
    
    Dim cSQL As String
    Dim rsrs As Recordset
    
    Dim bRabattOk   As Boolean
    
    List3.Nodes.Clear
    
    lAnzSatz = List1.ListCount
    
    If lAnzSatz = 0 Then
        Exit Sub
    End If
    
    ctmp = Label2(3).Caption
    ctmp = fnMoveComma2Point$(ctmp)
    dGRabatt = Val(ctmp)
    dGRabatt = (100 - dGRabatt) / 100
    
    For lAktSatz = 0 To lAnzSatz - 1
        
        cLBSatz = List1.list(lAktSatz)
        If Val(Right(cLBSatz, 2)) = 0 Then
            cArtNr = Mid(cLBSatz, 7, 6)
            
            cSQL = "Select * from artikel where artnr = " & cArtNr
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
            
                If Not IsNull(rsrs!MWST) Then
                    cMWST = rsrs!MWST
                Else
                    cMWST = "V"
                End If
                
                cUmsOK = "J"
            
                Select Case Val(Label8(3).Caption)
                    Case Is = 0
                        If Not IsNull(rsrs!KVKPR1) Then
                            dEPreis = rsrs!KVKPR1
                        Else
                            dEPreis = 0
                        End If
                    Case Is = 1
                        If Not IsNull(rsrs!vkpr) Then
                            dEPreis = rsrs!vkpr
                        Else
                            dEPreis = 0
                        End If
                    Case Is = 2
                    
                        'Achtung augepasst - jetzt den größten aus der Artlief nehmen
                    
                        dEPreis = ermMaxLEKPR(cArtNr)
                        
                        If dEPreis = 0 Then
                            If Not IsNull(rsrs!lekpr) Then
                                dEPreis = rsrs!lekpr
                            Else
                                dEPreis = 0
                            End If
                        End If
                        
                        If cMWST = "V" Then
                            dEPreis = dEPreis * dFaktorV
                        End If
                        If cMWST = "E" Then
                            dEPreis = dEPreis * dFaktorE
                        End If
                    Case Is = 3
                        If Not IsNull(rsrs!ekpr) Then
                            dEPreis = rsrs!ekpr
                        Else
                            dEPreis = 0
                        End If
                        If cMWST = "V" Then
                            dEPreis = dEPreis * dFaktorV
                        End If
                        If cMWST = "E" Then
                            dEPreis = dEPreis * dFaktorE
                        End If
                    Case Is = 4 'Spez kvk
                        dEPreis = LeseSpezpreis(CLng(cArtNr), 0)
                        If dEPreis = 0 Then
                            If Not IsNull(rsrs!KVKPR1) Then
                                dEPreis = rsrs!KVKPR1
                            Else
                                dEPreis = 0
                            End If
                        End If
                    Case Is = 5 'lvk m A
                        If rsrs!RABATT_OK = "N" Then
                            If Not IsNull(rsrs!KVKPR1) Then
                                dEPreis = rsrs!KVKPR1
                            Else
                                dEPreis = 0
                            End If
                        Else
                            If Not IsNull(rsrs!vkpr) Then
                                dEPreis = rsrs!vkpr
                            Else
                                dEPreis = 0
                            End If
                        End If
                    Case Is = 6 'Netto-KVK
                        If Not IsNull(rsrs!KVKPR1) Then
                            dEPreis = rsrs!KVKPR1
                        Else
                            dEPreis = 0
                        End If
                        If cMWST = "V" Then
                            dEPreis = dEPreis * 100 / (100 + gdMWStV)
                        End If
                        If cMWST = "E" Then
                            dEPreis = dEPreis * 100 / (100 + gdMWStE)
                        End If
                        
                        cMWST = "O"
                        
'                        cUmsOK = "N"
                End Select
            End If
            rsrs.Close: Set rsrs = Nothing
            
            
            If dEPreis > 0 Then
            
            
'                If Len(cLBSatz) > 155 Then
'                    Mid(cLBSatz, 156, 1) = cUmsOK
'                End If
'
            
                Mid(cLBSatz, 72, 1) = cMWST
            
            
                ctmp = Format$(dEPreis, "#####0.00")
                ctmp = Space$(9 - Len(ctmp)) & ctmp
                Mid(cLBSatz, 50, 9) = ctmp
                Mid(cLBSatz, 74, 9) = ctmp
                
                If Left(cLBSatz, 1) = "x" Then
                    ctmp = Mid(cLBSatz, 2, 4)
                Else
                    ctmp = Mid(cLBSatz, 1, 5)
                End If
                      'Berechne den neuen Gesamtpreis
                ctmp = Trim$(ctmp)
                dWert = Val(ctmp)
                
                
                
                'mit gerundetem Epreis rechnen 22.08.2016
                Dim dRoundEpreis As Double
                
                dRoundEpreis = Round(dEPreis, 2)
                
                dGPreis = dWert * dRoundEpreis
                
                
                
'                dGPreis = dWert * dEPreis
                ctmp = Format$(dGPreis, "#####0.00")
                ctmp = Space$(9 - Len(ctmp)) & ctmp
                Mid(cLBSatz, 60, 9) = ctmp
                Mid(cLBSatz, 94, 9) = ctmp      'Erzielten Verkaufpreis setzen
                ctmp = Mid(cLBSatz, 72, 1)      'Berechne den neuen MWST-Betrag
                If ctmp = "V" Then
                    dWert = dGPreis * (gdMWStV / 100)
                    ctmp = Format$(dWert, "#####0.00")
                    ctmp = Space$(9 - Len(ctmp)) & ctmp
                    Mid(cLBSatz, 104, 9) = ctmp
                ElseIf ctmp = "E" Then
                    dWert = dGPreis * (gdMWStE / 100)
                    ctmp = Format$(dWert, "#####0.00")
                    ctmp = Space$(9 - Len(ctmp)) & ctmp
                    Mid(cLBSatz, 114, 9) = ctmp
                End If
                List1.RemoveItem lAktSatz
                List1.AddItem cLBSatz, lAktSatz
                
                List3.Nodes.Add Text:=Left(cLBSatz, 68)
            End If
        End If
        BerechneZwischenSummeWKL20
    Next lAktSatz
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AktualisiereListboxWKL20aufGrundPreisKZand"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function AktualisiereEinzelArtikelAufGrundPreisKZ(cArtNr As String) As Double
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    
    Dim dWert       As Double
    Dim dGRabatt    As Double
    Dim dEPreis     As Double
    Dim dGPreis     As Double
    
    Dim cLBSatz     As String
    Dim cArtRabatt  As String
    Dim cLPreis     As String
    Dim ctmp        As String
    Dim dFaktorV    As Double
    Dim dFaktorE    As Double
    Dim cMWST       As String
    
    dFaktorV = 1 + (gdMWStV / 100)
    dFaktorE = 1 + (gdMWStE / 100)
    
    Dim cSQL As String
    Dim rsrs As Recordset
    
    Dim bRabattOk   As Boolean
    
    
    
    ctmp = Label2(3).Caption
    ctmp = fnMoveComma2Point$(ctmp)
    dGRabatt = Val(ctmp)
    dGRabatt = (100 - dGRabatt) / 100
    
    dEPreis = 0
            
    cSQL = "Select * from artikel where artnr = " & cArtNr
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
    
        If Not IsNull(rsrs!MWST) Then
            cMWST = rsrs!MWST
        Else
            cMWST = "V"
        End If
    
        Select Case Val(Label8(3).Caption)
            Case Is = 0
                If Not IsNull(rsrs!KVKPR1) Then
                    dEPreis = rsrs!KVKPR1
                Else
                    dEPreis = 0
                End If
            Case Is = 1
                If Not IsNull(rsrs!vkpr) Then
                    dEPreis = rsrs!vkpr
                Else
                    dEPreis = 0
                End If
            Case Is = 2
            
                'Achtung augepasst - jetzt den größten aus der Artlief nehmen
            
                dEPreis = ermMaxLEKPR(cArtNr)
                
                If dEPreis = 0 Then
                    If Not IsNull(rsrs!lekpr) Then
                        dEPreis = rsrs!lekpr
                    Else
                        dEPreis = 0
                    End If
                End If
                
                If cMWST = "V" Then
                    dEPreis = dEPreis * dFaktorV
                End If
                If cMWST = "E" Then
                    dEPreis = dEPreis * dFaktorE
                End If
            Case Is = 3
                If Not IsNull(rsrs!ekpr) Then
                    dEPreis = rsrs!ekpr
                Else
                    dEPreis = 0
                End If
                If cMWST = "V" Then
                    dEPreis = dEPreis * dFaktorV
                End If
                If cMWST = "E" Then
                    dEPreis = dEPreis * dFaktorE
                End If
            Case Is = 4 'Spez kvk
                dEPreis = LeseSpezpreis(CLng(cArtNr), 0)
                If dEPreis = 0 Then
                    If Not IsNull(rsrs!KVKPR1) Then
                        dEPreis = rsrs!KVKPR1
                    Else
                        dEPreis = 0
                    End If
                End If
            Case Is = 5 'lvk m A
                If rsrs!RABATT_OK = "N" Then
                    If Not IsNull(rsrs!KVKPR1) Then
                        dEPreis = rsrs!KVKPR1
                    Else
                        dEPreis = 0
                    End If
                Else
                    If Not IsNull(rsrs!vkpr) Then
                        dEPreis = rsrs!vkpr
                    Else
                        dEPreis = 0
                    End If
                End If
            Case Is = 6 'Netto-KVK
                If Not IsNull(rsrs!KVKPR1) Then
                    dEPreis = rsrs!KVKPR1
                Else
                    dEPreis = 0
                End If
                If cMWST = "V" Then
                    dEPreis = dEPreis * 100 / (100 + gdMWStV)
                End If
                If cMWST = "E" Then
                    dEPreis = dEPreis * 100 / (100 + gdMWStE)
                End If
        End Select
    End If
    rsrs.Close: Set rsrs = Nothing
            
    AktualisiereEinzelArtikelAufGrundPreisKZ = dEPreis
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AktualisiereEinzelArtikelAufGrundPreisKZ"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub AktualisiereListboxWKL20ARTRAB()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    
    Dim dWert       As Double
    Dim dGRabatt    As Double
    Dim dEPreis     As Double
    Dim dGPreis     As Double
    
    Dim cLBSatz     As String
    Dim cArtRabatt  As String
    Dim cLPreis     As String
    Dim ctmp        As String
    Dim cArtNr      As String
    Dim dArtRab     As Double
    
    Dim bRabattOk   As Boolean
    
    List3.Nodes.Clear
    lAnzSatz = List1.ListCount
    
    If lAnzSatz = 0 Then
        Exit Sub
    End If
    
    For lAktSatz = 0 To lAnzSatz - 1
        bRabattOk = True
        cLBSatz = List1.list(lAktSatz)
        If Val(Right(cLBSatz, 2)) = 0 Then
            cArtNr = Mid(cLBSatz, 7, 6)
            If cArtNr = "666666" Then
                bRabattOk = False
            End If
            If bRabattOk Then
                If Mid(cLBSatz, 6, 1) = "*" Then
                    bRabattOk = False
                End If
            End If
            
            If bRabattOk Then
                

                gsGesRabforNetto = Left$(gsGesRabforNetto, 3)
                If Right(gsGesRabforNetto, 1) = "," Then
                    gsGesRabforNetto = Left$(gsGesRabforNetto, 2)
                End If
                Mid(cLBSatz, 124, 3) = "   "
                Mid(cLBSatz, 124, 3) = gsGesRabforNetto
                List1.RemoveItem lAktSatz
                List1.AddItem cLBSatz, lAktSatz
                List3.Nodes.Add Text:=Left(cLBSatz, 68)
            End If
        End If
    Next lAktSatz
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AktualisiereListboxWKL20ARTRAB"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub BarZahlungWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim dSumme  As Double
    Dim dWert   As Double
    Dim dEuro   As Double
    
    Dim ctmp    As String
    Dim cPfad   As String
    Dim iFileNr As Integer
    Dim i       As Integer
    
    cPfad = gcDBPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    BerechneZwischenSummeWKL20
    
    ctmp = Label2(6).Caption
    ctmp = fnMoveComma2Point$(ctmp)
    dSumme = Val(ctmp)

    Frame33.Enabled = True
    Frame33.Visible = True
    
    If gbEinfacheZollErstattung = True Then
    
        For i = 0 To 10
            dZollEr(i) = 0
        Next i
    
        txtZollEr.Visible = True
        lblZollER.Visible = True
        txtZollEr.Text = ""
        List7.Visible = True
        List7.Clear
    Else
        txtZollEr.Visible = False
        lblZollER.Visible = False
        List7.Visible = False
    End If
    

    
    dSumDukaten = 0
    
    cmdBon.Visible = False
    
    
    
    If gbBARDINA4 Then
        Check3.value = vbChecked
    Else
        Check3.value = vbUnchecked
    End If
    Command33(1).Caption = "Zurück"
    
    If bsend = True Then
        senddata "zu zahlen: " & Format$(dSumme, "#####0.00 ")
    End If
    
    Label333(1).Caption = Format$(dSumDukaten, "#####0.00")
    Label333(1).Refresh
    
    Label333(0).Caption = Format$(dSumme, "#####0.00")
    Label333(0).Refresh
    
    Label333(2).Caption = Format$(dSumme, "#####0.00")
    Label333(3).Caption = "0,00" 'zurück
    Text333.Enabled = True
    Text333.Text = ""
    Text333.SetFocus
    
    Command33(0).Enabled = True
    Command33(0).Visible = True
    Command33(1).Visible = True
    
    
    Label333(3).Visible = True
    Frame1.Visible = False
    Frame2.Visible = False
    Frame3.Visible = False
    
    
    Check6.Enabled = True
    cboNoEuro.Enabled = True
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BarzahlungWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub zeigwaehrung(sWK As String)
On Error GoTo LOKAL_ERROR

Dim cPfad       As String
Dim i           As Integer
Dim balleVor    As Boolean
balleVor = True

cPfad = gcDBPfad
If Right(cPfad, 1) <> "\" Then
    cPfad = cPfad & "\"
End If


Select Case UCase(sWK)

    Case "EUR"
        gsFremdKuerzel = ""
        
        If gbGeld Then
        
            If Screen.Height >= 12000 Then
                For i = 0 To 14
                    SSCommand33(i).Picture = LoadPicture(cPfad & "Picture\EUR\" & i & "g.jpg")
                    SSCommand33(i).Font.Size = 2
                    SSCommand33(i).Font.Bold = False
                    
                    SSCommand33(i).BevelWidth = 2
                    SSCommand33(i).Caption = ""
                Next i
            Else
                For i = 0 To 14
                    SSCommand33(i).Picture = LoadPicture(cPfad & "Picture\EUR\" & i & "k.jpg")
                    SSCommand33(i).Font.Size = 2
                    SSCommand33(i).Font.Bold = False
                    
                    SSCommand33(i).BevelWidth = 2
                    SSCommand33(i).Caption = ""
                Next i
            End If
        Else
            For i = 0 To 14
                SSCommand33(i).Picture = Nothing
                SSCommand33(i).Font.Size = 14
                SSCommand33(i).Font.Bold = True
                SSCommand33(i).Font3D = 2
                SSCommand33(i).BevelWidth = 2
            Next i
            
            SSCommand33(0).Caption = "0,01"
            SSCommand33(1).Caption = "0,02"
            SSCommand33(2).Caption = "0,05"
            SSCommand33(3).Caption = "0,10"
            SSCommand33(4).Caption = "0,20"
            SSCommand33(5).Caption = "0,50"
            SSCommand33(6).Caption = "1"
            SSCommand33(7).Caption = "2"
            SSCommand33(8).Caption = "5"
            SSCommand33(9).Caption = "10"
            SSCommand33(10).Caption = "20"
            SSCommand33(11).Caption = "50"
            SSCommand33(12).Caption = "100"
            SSCommand33(13).Caption = "200"
            SSCommand33(14).Caption = "500"
        End If

        SSCommand33(0).Tag = "0,01"
        SSCommand33(1).Tag = "0,02"
        SSCommand33(2).Tag = "0,05"
        SSCommand33(3).Tag = "0,10"
        SSCommand33(4).Tag = "0,20"
        SSCommand33(5).Tag = "0,50"
        SSCommand33(6).Tag = "1"
        SSCommand33(7).Tag = "2"
        SSCommand33(8).Tag = "5"
        SSCommand33(9).Tag = "10"
        SSCommand33(10).Tag = "20"
        SSCommand33(11).Tag = "50"
        SSCommand33(12).Tag = "100"
        SSCommand33(13).Tag = "200"
        
        SSCommand33(14).Enabled = True
        SSCommand33(14).Tag = "500"
        
    Case "SFR"
        gsFremdKuerzel = "SFR"

        If FileExists(cPfad & "Picture\SFR\13s.jpg") Then
            For i = 0 To 13
                SSCommand33(i).Picture = LoadPicture(cPfad & "Picture\SFR\" & i & "s.jpg")
                SSCommand33(i).Font.Size = 2
                SSCommand33(i).Font.Bold = True
                
                SSCommand33(i).Caption = ""
                SSCommand33(i).BevelWidth = 2
            Next i
        Else
            For i = 0 To 13
                SSCommand33(i).Picture = Nothing
                SSCommand33(i).Font.Size = 14
                SSCommand33(i).Font.Bold = True
                SSCommand33(i).Font3D = 2
                SSCommand33(i).BevelWidth = 2
            Next i
            
            SSCommand33(0).Caption = "0,01"
            SSCommand33(1).Caption = "0,05"
            SSCommand33(2).Caption = "0,10"
            SSCommand33(3).Caption = "0,20"
            SSCommand33(4).Caption = "0,50"
            SSCommand33(5).Caption = "1"
            SSCommand33(6).Caption = "2"
            SSCommand33(7).Caption = "5"
            SSCommand33(8).Caption = "10"
            SSCommand33(9).Caption = "20"
            SSCommand33(10).Caption = "50"
            SSCommand33(11).Caption = "100"
            SSCommand33(12).Caption = "200"
            SSCommand33(13).Caption = "1000"
        End If
        
        SSCommand33(0).Tag = "0,01"
        SSCommand33(1).Tag = "0,05"
        SSCommand33(2).Tag = "0,10"
        SSCommand33(3).Tag = "0,20"
        SSCommand33(4).Tag = "0,50"
        SSCommand33(5).Tag = "1"
        SSCommand33(6).Tag = "2"
        SSCommand33(7).Tag = "5"
        SSCommand33(8).Tag = "10"
        SSCommand33(9).Tag = "20"
        SSCommand33(10).Tag = "50"
        SSCommand33(11).Tag = "100"
        SSCommand33(12).Tag = "200"
        SSCommand33(13).Tag = "1000"
        
        SSCommand33(14).Caption = "0"
        SSCommand33(14).Tag = "0"
        SSCommand33(14).Picture = Nothing
        SSCommand33(14).Font.Size = 2
        SSCommand33(14).Font.Bold = False
        SSCommand33(14).Font3D = 2
        SSCommand33(14).BevelWidth = 2
        SSCommand33(14).Enabled = False
        
    Case "DEM"
        gsFremdKuerzel = "DEM"

        If FileExists(cPfad & "Picture\DEM\14DM.jpg") Then
            For i = 0 To 14
                SSCommand33(i).Picture = LoadPicture(cPfad & "Picture\DEM\" & i & "DM.jpg")
                SSCommand33(i).Font.Size = 2
                SSCommand33(i).Font.Bold = True
                
                SSCommand33(i).Caption = ""
                SSCommand33(i).BevelWidth = 2
            Next i
        Else
            For i = 0 To 14
                SSCommand33(i).Picture = Nothing
                SSCommand33(i).Font.Size = 14
                SSCommand33(i).Font.Bold = True
                SSCommand33(i).Font3D = 2
                SSCommand33(i).BevelWidth = 2
        
            Next i
            SSCommand33(0).Caption = "0,01"
            SSCommand33(1).Caption = "0,02"
            SSCommand33(2).Caption = "0,05"
            SSCommand33(3).Caption = "0,10"
            SSCommand33(4).Caption = "0,50"
            SSCommand33(5).Caption = "1"
            SSCommand33(6).Caption = "2"
            SSCommand33(7).Caption = "5"
            SSCommand33(8).Caption = "10"
            SSCommand33(9).Caption = "20"
            SSCommand33(10).Caption = "50"
            SSCommand33(11).Caption = "100"
            SSCommand33(12).Caption = "200"
            SSCommand33(13).Caption = "500"
    
            SSCommand33(14).Enabled = True
            SSCommand33(14).Caption = "1000"
        End If

        SSCommand33(0).Tag = "0,01"
        SSCommand33(1).Tag = "0,02"
        SSCommand33(2).Tag = "0,05"
        SSCommand33(3).Tag = "0,10"
        SSCommand33(4).Tag = "0,50"
        SSCommand33(5).Tag = "1"
        SSCommand33(6).Tag = "2"
        SSCommand33(7).Tag = "5"
        SSCommand33(8).Tag = "10"
        SSCommand33(9).Tag = "20"
        SSCommand33(10).Tag = "50"
        SSCommand33(11).Tag = "100"
        SSCommand33(12).Tag = "200"
        SSCommand33(13).Tag = "500"

        SSCommand33(14).Enabled = True
        SSCommand33(14).Tag = "1000"
End Select

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "zeigwaehrung"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub cboNoEuro_Click()
On Error GoTo LOKAL_ERROR
    
    Dim sUK     As String
    Dim sWK     As String
    Dim sWB     As String
    Dim cSatz   As String
    
    cSatz = cboNoEuro.Text
    cSatz = Trim(cSatz)
   
    If cSatz = "bitte auswählen" Then
        NoFremdMoneyAuswahl
        SSCommand2_Click 14
    Else
        cboNoEuro.Enabled = False
    
        sWK = Mid(cSatz, 1, 6)
        sWK = Trim(sWK)
        Label88(1).Caption = sWK
        Label88(4).Caption = sWK
        
        gsFWK = sWK
        
        sWB = Mid(cSatz, 19, 30)
        sWB = Trim(sWB)

        
        sUK = Mid(cSatz, 8, 10)
        sUK = Trim(sUK)
        gsUK = sUK
        
        If gsUK <> "0" Then
            RechneNochFürFremdW
        End If

        Label88(1).Visible = True
        Label88(0).Visible = True
        Label88(2).Visible = True
        Label88(3).Visible = True
        Label88(4).Visible = True
        Text88.Visible = True
        Text88.SetFocus
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cboNoEuro_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check1_Click()
On Error GoTo LOKAL_ERROR

If Check1.value = vbChecked Then

    grd1.ColWidth(6) = 2500
    grd1.Refresh
Else
    grd1.ColWidth(6) = 0
    grd1.Refresh
End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check1_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check15_Click()
On Error GoTo LOKAL_ERROR
    
    If Check15.value = vbChecked Then
        Frame16.Visible = True
        
        fuellecbo_Verfall
    Else
        Frame16.Visible = False
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check15_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub fuellecbo_Verfall()
    On Error GoTo LOKAL_ERROR
    
    Dim j As Integer
    Dim m As Integer
    
    For m = Month(DateValue(Now)) To 12
        cboVerfall.AddItem m & "/" & Year(DateValue(Now))
    Next m
    
    For j = Year(DateValue(Now)) + 1 To Year(DateValue(Now)) + 10
        For m = 1 To 12
            cboVerfall.AddItem m & "/" & j
        Next m
    Next j
    
    cboVerfall.Text = Month(DateValue(Now)) & "/" & Year(DateValue(Now))
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fuellecbo_Verfall"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check2_Click()
    On Error GoTo LOKAL_ERROR
    
    If Check2.value = vbChecked Then
        Frame13.Visible = True
    Else
        Frame13.Visible = False
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check2_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check3_Click()
On Error GoTo LOKAL_ERROR

    Dim iRet As Integer
    
    If gbBARDINA4 = False Then
        If Check3.value = vbChecked Then
            iRet = MsgBox("Möchten Sie wirklich im DIN A4 Format drucken?", vbQuestion + vbYesNo, "Winkiss Frage:")
            If iRet <> vbYes Then
                Check3.value = vbUnchecked
            Else
                schreibeFilProt "setzt Haken (Druck als DIN A4)", "SCHALTER2Prot"
            End If
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check3_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check4_Click()
On Error GoTo LOKAL_ERROR
    Dim iRet As Integer
    
    If gbBARDINA4 = False Then
        If Check4.value = vbChecked Then
            iRet = MsgBox("Möchten Sie wirklich im DIN A4 Format drucken?", vbQuestion + vbYesNo + vbDefaultButton2, "Winkiss Frage:")
            If iRet <> vbYes Then
                Check4.value = vbUnchecked
            Else
                schreibeFilProt "setzt Haken (Druck als DIN A4)", "SCHALTER1Prot"
            End If
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check4_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub

Private Sub Check5_Click()
On Error GoTo LOKAL_ERROR

    If Check5.value = vbChecked Then
        Check17.Visible = True
        Check17.value = vbUnchecked
    Else
        Check17.Visible = False
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check5_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check6_Click()
    On Error GoTo LOKAL_ERROR

    If Check6.value = vbChecked Then
        cboNoEuro.Visible = True
        cbofuellenNE cboNoEuro
    Else
        cboNoEuro.Visible = False
    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check6_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check7_Click()
On Error GoTo LOKAL_ERROR

If Check7.value = vbChecked Then

    grd1.ColWidth(7) = 1500
    grd1.Refresh
Else
    grd1.ColWidth(7) = 0
    grd1.Refresh

End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check7_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub
Private Sub Check8_Click()
On Error GoTo LOKAL_ERROR

If Check8.value = vbChecked Then

    grd1.ColWidth(5) = 3500
    grd1.Refresh
Else
    grd1.ColWidth(5) = 0
    grd1.Refresh

End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check8_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check11_Click()
On Error GoTo LOKAL_ERROR

If Check11.value = vbChecked Then

    grd1.ColWidth(8) = 3500
    grd1.Refresh
Else
    grd1.ColWidth(8) = 0
    grd1.Refresh

End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check11_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Check12_Click()
On Error GoTo LOKAL_ERROR

If Check12.value = vbChecked Then

    grd1.ColWidth(9) = 3500
    grd1.Refresh
Else
    grd1.ColWidth(9) = 0
    grd1.Refresh

End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check12_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub cmdBon_Click()
    On Error GoTo LOKAL_ERROR
    
    cmdBon.Enabled = False
    
    ZeigeletztenKassenBon (ermMaxBonnrInKassbon)
    gbQRFlag = True
    DruckeZweitBonAusListe List5, False
    
    Text1(3).Text = ""
    Text1(3).SetFocus
    
    Command33_Click 1
        
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdBon_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub cmdBonKK_Click()
On Error GoTo LOKAL_ERROR
    
    cmdBonKK.Enabled = False
    ZeigeletztenKassenBon (ermMaxBonnrInKassbon)
    
    DruckeZweitBonAusListe List5, False
    
    
    If gb2BONKA = True Then '2.Bon bei Kartenzahlung
        DruckeZweitBonAusListe List5, False
    End If
    
    Text1(4).Text = ""
    Text1(4).SetFocus
    
    Command5_Click 1
        
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdBonKK_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub cmdFoto_Click()
    On Error GoTo LOKAL_ERROR
    
    Dim cLBSatz As String
    gcArtNrFiliale = ""

    If List4.Nodes.Count = 0 Then
        
        frmWKL114.Show 1
    Else
        If List4.SelectedItem Is Nothing Then
            MsgBox "Bitte einen Eintrag in der Liste auswählen!", vbCritical, "Winkiss Hinweis:"
            List4.SetFocus
        Else
    
            cLBSatz = List4.SelectedItem.Text
            cLBSatz = Left(cLBSatz, 6)
            cLBSatz = Trim$(cLBSatz)
            gcArtNrFiliale = cLBSatz
            frmWKL114.Show 1
            
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdFoto_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub cmdNew_Click()
    On Error GoTo LOKAL_ERROR
    
    Dim cLBSatz As String
    Dim iRet As Integer
    Dim sSQL As String
    
    If gbKUDU Then
        frmWKL101.Show 1
        
        If gcKundenNr = "" Then
            Exit Sub
        End If
        
        Label1(27).Caption = "Karte/KdNr/Name"
        Text3(3).Text = gcKundenNr
        Screen.MousePointer = 0
        SucheKundenKasseWKL20
        grd1.Row = glSelect
        grd1.Col = 0
        
        
        
        
        
        
        
        
        
        If gbDSDRUCKEN Then
            If DS_Noch_Nicht_Unterschrieben(gcKundenNr) Then
            
                MsgBox "Datenschutzblatt wurde noch NICHT unterschrieben!", vbInformation, "Unterschrift erforderlich:"
            
                If gcListenDrucker <> gcBonDrucker Then
                    setzedrucker gcListenDrucker

                    DatenschutzblattKundeDrucken gcKundenNr, True
                    Pause 2
                    setzedrucker gcBonDrucker
                    
                    iRet = MsgBox("Wurde das Datenschutzblatt unterschrieben?", vbQuestion + vbYesNo + vbDefaultButton2, "Winkiss Frage:")
                    If iRet = vbYes Then
                        sSQL = "Update Kunden set ds = true"
                        sSQL = sSQL & " , Status = 'E' "
                        sSQL = sSQL & " , SynStatus = 'E' "
                        sSQL = sSQL & " where kundnr = " & gcKundenNr
                        gdBase.Execute sSQL, dbFailOnError
                    End If
                    
                End If
            Else
                If gbDSMeldungErfolg = True Then
                    MsgBox "Datenschutzblatt wurde unterschrieben!", vbInformation, "OK"
                End If
            End If
        End If
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        PublicHoleKundenDatenWKL20 gcKundenNr
        Label2(7).Caption = gcKundenNr
        Label2(7).Visible = True
        Label1(7).Visible = True
        Label1(19).Visible = True
        
        Frame1.Visible = True
        If gbLeiste2Start = True Then
            Frame23.Visible = True
            Frame2.Visible = False
        Else
            Frame2.Visible = True
            Frame23.Visible = False
        End If
        
        bFocusonList4 = True
        
        Frame33.Visible = False
        Frame6.Visible = False
        Frame8.Visible = False
        Frame9.Visible = False
        
        Frame3.Visible = True
        Frame4.Visible = True
        gbNumTaste = True

        Me.Refresh
        DoEvents
        Text1(1).SetFocus
        gcKundenNr = ""
    Else
        iKasse = 1
        glSelect = 1
        gcBedKUNEU = gcBedienerNr
        
        setzedrucker gcListenDrucker
        
        frmWKL13.Show 1
        
        setzedrucker gcBonDrucker
        
        
        If gcKundenNr = "" Then
            Exit Sub
        End If
        
        Label1(27).Caption = "Karte/KdNr/Name"
        Text3(3).Text = gcKundenNr
        Screen.MousePointer = 0
        SucheKundenKasseWKL20
        grd1.Row = glSelect
        grd1.Col = 0
        
        cLBSatz = frmWKL20.grd1.Text
        cLBSatz = Trim$(cLBSatz)
        
        
        
        
        
        If gbDSDRUCKEN Then
            If DS_Noch_Nicht_Unterschrieben(gcKundenNr) Then
            
                MsgBox "Datenschutzblatt wurde noch NICHT unterschrieben!", vbInformation, "Unterschrift erforderlich:"
            
                If gcListenDrucker <> gcBonDrucker Then
                    setzedrucker gcListenDrucker

                    DatenschutzblattKundeDrucken gcKundenNr, True
                    Pause 2
                    setzedrucker gcBonDrucker
                    
                    iRet = MsgBox("Wurde das Datenschutzblatt unterschrieben?", vbQuestion + vbYesNo + vbDefaultButton2, "Winkiss Frage:")
                    If iRet = vbYes Then
                        sSQL = "Update Kunden set ds = true"
                        sSQL = sSQL & " , Status = 'E' "
                        sSQL = sSQL & " , SynStatus = 'E' "
                        sSQL = sSQL & " where kundnr = " & gcKundenNr
                        gdBase.Execute sSQL, dbFailOnError
                    End If
                    
                End If
            Else
                If gbDSMeldungErfolg = True Then
                    MsgBox "Datenschutzblatt wurde unterschrieben!", vbInformation, "OK"
                End If
            End If
        End If
        
        
        
        
        
        
        
        
        
        
        PublicHoleKundenDatenWKL20 gcKundenNr
        Label2(7).Caption = gcKundenNr
        Label2(7).Visible = True
        Label1(7).Visible = True
        Label1(19).Visible = True
        
        Frame1.Visible = True
        If gbLeiste2Start = True Then
            Frame23.Visible = True
            Frame2.Visible = False
        Else
            Frame2.Visible = True
            Frame23.Visible = False
        End If
        Frame3.Visible = True
        Frame4.Visible = True
        Frame33.Visible = False
        Frame6.Visible = False
        Frame8.Visible = False
        Frame9.Visible = False
        gbNumTaste = True
        giDlgZustand = giUPD
        Text1(1).SetFocus
        gcKundenNr = ""
        
        gcBedKUNEU = ""
    End If
    
    setzedrucker gcBonDrucker
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdNew_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Combo1_GotFocus()
On Error GoTo LOKAL_ERROR
    
    Combo1.BackColor = glSelBack1
    Label3(5).Caption = 97
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Combo1_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Combo1_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    
            If KeyCode = vbKeyReturn Then
                Command4_Click 5
            End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Combo1_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Combo1_LostFocus()
On Error GoTo LOKAL_ERROR

    Combo1.BackColor = vbWhite
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Combo1_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Combo2_Click()
On Error GoTo LOKAL_ERROR
    
    Command11_Click 0
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Combo2_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command1_KeyUp(index As Integer, KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    Select Case index
    
        Case 55
            If KeyCode = vbKeyF2 Then
                frmWKL49.Show 1
            End If
    End Select
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command1_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Command15_Click()

End Sub

Private Sub Command16_Click()

End Sub

Private Sub Command2_Click(index As Integer)
On Error GoTo LOKAL_ERROR
    
    Select Case index
        Case 17
            Text1(0).Text = ""
            indentmitKarte
    End Select

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command2_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Command3_Click()
    On Error GoTo LOKAL_ERROR
    
    Frame26.Visible = False
    Text1(1).Text = "nicht gefunden"
    Text1(1).SetFocus
    
    bfromFrame36 = True

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command3_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command33_Click(index As Integer)
    On Error GoTo LOKAL_ERROR

    Dim cOffen          As String
    Dim cZeile1         As String
    Dim cZeile2         As String
    Dim ctmp            As String
    Dim dOffen          As Double
    Dim dGegeben        As Double
    Dim dGegebenFW      As Double
    Dim dZurueck        As Double
    Dim dWert           As Double
    Dim bKommaVorhanden As Boolean
    Dim iFehlerstufe    As Integer
    Dim i               As Integer
    Dim ctmpFremd       As String
    
    Screen.MousePointer = 11
    
    Command33(0).Enabled = False
    
    dZurueck = 0
    gdZurueck = 0
    gdGegeben = 0
    dGegeben = 0
    dGegebenFW = 0
    gdSumme = 0
    dOffen = 0
    dWert = 0
    ctmpFremd = ""

    If index = 1 Or index = 0 Then
        For i = 0 To 12
            SSCommand2(i).Enabled = True
        Next i
        SSCommand2(15).Enabled = True
        SSCommand2(16).Enabled = True
        
        For i = 0 To 15
            SSCommand33(i).Enabled = True
        Next i
    End If
    
    iFehlerstufe = 1

    Select Case index
        Case 0  '** OK **
        
            KillProtokollKassErr
            Kasstime = TimeValue(Now)
            Kasstime = SwapStr(Kasstime, ":", "")
            lKasstimeBegin = CLng(Kasstime)
            schreibeProtokollKassErr "Kassiervorgang startet: Bon Nr.: " & Label18.Caption
        
            'Was wurde so gegeben?
            ctmp = ""
            ctmp = Trim$(Text333.Text) 'wurde gegeben EUR Basiswährung
            
            If Len(ctmp) > 8 Then
                gbNochOffen = True
                Screen.MousePointer = 0
                Command33(0).Enabled = True
                
                Text333.Text = ""
                Text333.SetFocus
                anzeige "artikel", "", Label27
                Exit Sub
            End If
            
            ctmpFremd = ""
            If gsUK <> "0" Then 'wurde auch fremdwährung gegeben?
                ctmpFremd = Trim(Text88.Text) 'wurde gegeben fremdwährung
            End If
            
            If gbPBARGeld = True Then
            
                If ctmp = "" And ctmpFremd = "" Then
                    gbNochOffen = True
                    Screen.MousePointer = 0
                    Command33(0).Enabled = True
                    
                    Text333.Text = ""
                    anzeige "artikel", "", Label27
                    Exit Sub
                
                End If
            
            End If
            
            If ctmp = "" And ctmpFremd = "" Then   '//passender Betrag EUR BASIS
            
            Else
                schreibeProtokollKassErr "Funktion Zurückrechnen Beginn: Bon Nr.: " & Label18.Caption
                If Zurückrechnen = False Then
                    gbNochOffen = True
                    Screen.MousePointer = 0
                    Command33(0).Enabled = True
                    Text333.Text = ""
                    anzeige "artikel", "", Label27
                    Exit Sub
                End If
                schreibeProtokollKassErr "Funktion Zurückrechnen Ende: Bon Nr.: " & Label18.Caption
            End If
            
            gbNochOffen = False
            
             'Summe in BASISWÄHRUNG EUR
            ctmp = ""
            ctmp = Trim$(Label333(0).Caption)
            ctmp = fnMoveComma2Point$(ctmp)
            dOffen = Val(ctmp)
            
            'Noch offen Position BASISWÄHRUNG EUR
            cOffen = Label333(2).Caption
            
'            Command33(0).Enabled = False
            Command33(1).Enabled = False
        
            ctmp = ""
            ctmp = Trim$(Text333.Text) 'wurde gegeben EUR Basiswährung
            
            If gsUK <> "0" Then 'wurde auch fremdwährung gegeben?
                ctmpFremd = Trim(Text88.Text) 'wurde gegeben fremdwährung
            End If
            

            If bsend = True Then
               senddata "gegeben: " & Format$(ctmp, "#####0.00 ")
            End If
            
            If ctmp = "" And ctmpFremd = "" Then   '//passender Betrag EUR BASIS
            
                'was ist passend?
                
                If ((dOffen > 0) And (cOffen = "0,00")) Or cOffen = dOffen Then
                    Text333.Text = Format$(dOffen, "#####0.00")
                End If
                
                
                ctmp = ""
                ctmp = Trim$(Text333.Text)
            End If
            
            iFehlerstufe = 2
            
            'bearbeite Basiswährung
            bKommaVorhanden = False
            If InStr(ctmp, ",") Then bKommaVorhanden = True
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            If Not bKommaVorhanden Then
                dWert = dWert / 100
            End If
            
            Text333.Text = Format$(dWert, "#####0.00")
            dGegeben = dWert
            
            gdGegeben = dGegeben 'Gegeben Basiswährung
            
            
            'bearbeite eventuell Fremdwährung
            If gsUK <> "0" Then
                If ctmpFremd <> "" Then
                    bKommaVorhanden = False
                    If InStr(ctmpFremd, ",") Then bKommaVorhanden = True
                    ctmpFremd = fnMoveComma2Point$(ctmpFremd)
                    dWert = 0
                    dWert = Val(ctmpFremd)
                    If Not bKommaVorhanden Then
                        dWert = dWert / 100
                    End If
                    
                    Text88.Text = Format$(dWert, "#####0.00")
                    dGegebenFW = dWert
                    
                    gdGegebenFW = dGegebenFW 'Gegeben Fremdwährung
                    
                    'gsFWK Kürzel für Fremdwährung
                    'gsuk Umtauschkurs
                    
                End If
            End If
            gdSumme = dOffen    'Summe Endbetrag Basiswährung

            ctmp = ""
            ctmp = Trim$(Label333(3).Caption) 'zurück Basiswährung
            ctmp = fnMoveComma2Point$(ctmp)
            dZurueck = Val(ctmp)
            gdZurueck = dZurueck
            
            cZeile1 = Trim$(dGegeben)
            If Len(cZeile1) > 10 Then
                cZeile1 = Format$(cZeile1, "#####0.00")
                cZeile1 = "Gegeben:" & cZeile1
            Else
                cZeile1 = Space$(11 - Len(cZeile1)) & cZeile1
                cZeile1 = Format$(cZeile1, "#####0.00")
                cZeile1 = "Gegeben: " & cZeile1
            End If
            iFehlerstufe = 8
            
            cZeile2 = Trim$(dZurueck)
            If Len(cZeile2) > 10 Then
                cZeile2 = Trim$(dZurueck)
                cZeile2 = Format$(cZeile2, "#####0.00")
                cZeile2 = "Rückgeld:" & cZeile2
            Else
                cZeile2 = Space$(10 - Len(cZeile2)) & cZeile2
                cZeile2 = Format$(cZeile2, "#####0.00")
                cZeile2 = "Rückgeld: " & cZeile2
            End If
            
            iFehlerstufe = 9
            
            If gbDisplay Or gbZweitMoni Then
                schreibeProtokollKassErr "Funktion ZeigeKundenDisplay Beginn: Bon Nr.: " & Label18.Caption
                ZeigeKundenDisplay cZeile1, cZeile2
                schreibeProtokollKassErr "Funktion ZeigeKundenDisplay Ende: Bon Nr.: " & Label18.Caption
            End If
            
            iFehlerstufe = 10
            
            For i = 0 To 15
                SSCommand33(i).Enabled = False
            Next i
            
            iFehlerstufe = 11
            Frame4.Visible = False
            
            Command33(0).Visible = False
            
            schreibeProtokollKassErr "Funktion HoleNeueBonNrWKL20 Beginn: Bon Nr.: " & Label18.Caption
'           HoleNeueBonNrWKL20 'neu an dieser Stelle
            HoleNeueBonNrWKL20_NEU 'hier wird die verwendete Bonnummer auch eingetragen
            schreibeProtokollKassErr "Funktion HoleNeueBonNrWKL20 Ende: Bon Nr.: " & Label18.Caption
            'Odayy TSE
            
            schreibeProtokollKassErr "Funktion DruckeKassenBonWKL20 Beginn: Bon Nr.: " & Label18.Caption
            DruckeKassenBonWKL20    'Barbon
            schreibeProtokollKassErr "Funktion DruckeKassenBonWKL20 Ende: Bon Nr.: " & Label18.Caption
            
            If Check3.value = vbChecked Then 'also dina4 druck
                schreibeProtokollKassErr "Funktion DruckeKassenBonDinA4 Beginn: Bon Nr.: " & Label18.Caption
                DruckeKassenBonDinA4 "Barzahlung", gbDINA4RECHFU
                OeffneSchubladeExplizitWKL20
            End If
            
            iFehlerstufe = 12
            
            gdBonNr = -1
            gcKreditKarte = ""
            dZurueck = 0
            gdZurueck = 0
            
            iFehlerstufe = 13
            
            Text333.Enabled = False

            Kasstime = TimeValue(Now)
            Kasstime = SwapStr(Kasstime, ":", "")
            lKasstimeEnde = CLng(Kasstime)
            
            Dim lDiff As Long
            lDiff = 0
            If CInt(Right(lKasstimeBegin, 2)) >= 55 Then
                lDiff = 1
            Else
                lDiff = lKasstimeEnde - lKasstimeBegin
            End If
            
            iFehlerstufe = 14
            
            schreibeProtokollKassErr "Kassiervorgang endet: Bon Nr.: " & Label18.Caption
            
            If lDiff > 4 Then
                abinsProtokoll CStr(lDiff)
            End If
            
            iFehlerstufe = 15
            
            Command33(1).Enabled = True '** "SCHLIEßEN" aktivieren
            Command33(1).Caption = "Schließen"
            
            If Check3.value = vbChecked Then
                If Datendrin("ANGEBOTNOW", gdBase) Then
                
                    If Modul6.FindFile(gcDBPfad, "alrs3s.rpt") Then
                        If gbDINA4RECHFU Then
                            If Modul6.FindFile(gcDBPfad, "alrs3sfu.rpt") Then
                                reportbildschirm "alr", "alrs3sfu"
                            Else
                                MsgBox "Ihre spezielle Druckansicht(alrs3sfu.rpt) muss angepasst werden, bitte rufen Sie die Hotline (Thomas Heinz, 0511 9559112) an!", vbOKOnly, "Winkiss Hinweis:"
                            End If
                        Else
                            reportbildschirm "alr", "alrs3s"
                        End If
                    Else
                        If gbDINA4RECHFU Then
                            reportbildschirm "alr", "alrs3fu"
                        Else
                            reportbildschirm "alr", "alrs3"
                        End If
                    End If
                    setzedrucker gcBonDrucker
                End If
            Else
                Text1(3).Text = ""
                Text1(3).SetFocus
            End If
            
            'umgelegt wegen Fehler
            'das führte bei 10x 5,00 Gutschein zum Fehler
            'zu schnelles Betätigen der schon eingeblendeten Taste cmdBon
            
            If gbBONWAHL = False Then
                cmdBon.Visible = False
            Else
                cmdBon.Visible = True
                cmdBon.Enabled = True
        '        gbBONNEIN = True
            End If
        Case 1  '** Schließen oder Zurück**
            SchließenAufSchließen
    End Select
    Screen.MousePointer = 0
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Command33_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & index & " " & iFehlerstufe
        
        Fehlermeldung1
        Resume Next
    End If

End Sub
Public Sub kundenauswahlausblend(Optional bGesRabObacht As Boolean = False)
On Error GoTo LOKAL_ERROR

    If chk_Kunde_halten.value = vbChecked Then
        Exit Sub
    End If

    Label1(7).Visible = False
    Label1(7).Caption = ""
    Label1(19).Visible = False
    Label1(19).Caption = ""
    Label2(7).Caption = "0"
    Label2(7).Visible = False
    
    'Gesamtrabatt
    
    If bGesRabObacht = True Then
    
        
    
    Else
    
        Label2(3).Caption = "0,00"
        Label2(3).Visible = False
        Label2(4).Visible = False
        Label1(3).Visible = False
    End If
    'ende gesrab
    
    Label1(11).Visible = False
    Label1(12).Visible = False
    Label1(13).Visible = False
    Label1(14).Visible = False
    Label1(15).Visible = False
    Label1(17).Visible = False
    Label1(28).Visible = False
    
    Label1(11).Caption = ""
    Label1(12).Caption = ""
    Label1(13).Caption = ""
    Label1(14).Caption = ""
    Label1(15).Caption = ""
    Label1(17).Caption = ""
    Label1(18).Caption = ""
    
    Label8(3).Caption = "0"
    giPreisKz = 0
    
'    SchalteCommand1WKL20
    Command1(0).Enabled = bmerkEC
    
    Picture1(1).Visible = False
    Picture1(2).Visible = False
    Picture1(3).Visible = False
    Picture1(4).Visible = False
    Picture1(5).Visible = False
    
'    Command1(5).Enabled = True
'    Command1(17).Enabled = True

    gbbonusHerab = False
    gbbonusausjetzt = False
    gdbonusHerabwert = 0
    
    Timer2.Enabled = False
    Picture4.Tag = ""
    Picture4.Visible = False

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "kundenauswahlausblend"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SchließenAufSchließen()
On Error GoTo LOKAL_ERROR

    Dim i As Integer
    
    If bsend = True Then
        senddata "Vielen Dank für Ihren Einkauf"
    End If
    
    If cboNoEuro.Visible = True Then
        zeigwaehrung "EUR"
    End If
    
    Check6.value = vbUnchecked
    cboNoEuro.Visible = False
    
    
    Label88(1).Caption = ""
    Text88.Text = ""
    Label88(1).Visible = False
    Label88(0).Visible = False
    
    Label88(2).Visible = False
    Label88(3).Visible = False
    Label88(4).Visible = False
    Text88.Visible = False
    gsFWK = ""
    gsUK = "0"
    
    Frame10.Visible = False
    Frame33.Visible = False
    Screen.MousePointer = 11
    Frame1.Visible = True
    If gbLeiste2Start = True Then
        Frame23.Visible = True
        Frame2.Visible = False
    Else
        Frame2.Visible = True
        Frame23.Visible = False
    End If
    Frame3.Visible = True
    Frame4.Visible = True
    
    If Command33(1).Caption = "Schließen" Then
        List1.Clear
        List3.Nodes.Clear
        Label41(1).Caption = 0
        Label2(6).Caption = "0,00"
        LeereDialogModul20

        If gsiGESRAB > 0 Then
            zeigeZwangsrabatt
        End If
        
        If gbDisplay Or gbZweitMoni Then
            InitKundenDisplayModul20
        End If
    End If
        
    gbNumTaste = True
    Text1(0).Text = gcBedienerNr
    Text1(1).SetFocus
    Command33(0).Visible = True
    gcKreditKarte = ""
    gcZahlMittel = ""

    If gbBEDLEER = True Then
        If Command33(1).Caption = "Schließen" Then
            Text1(0).Text = ""
            Label1(8).Caption = ""
            Text1(0).SetFocus
            indentmitKarte
        End If
    End If
    
    If Command33(1).Caption = "Zurück" Then
        'mach die Automatik_Bonus_Geschichte rückgängig
        If glBONUSAA_Artnr > 0 Then
            'suche_und_lösche_Bonusartikel
            If sind_bestimmte_Artnr_drin(glBONUSAA_Artnr) Then
                'dann lösch diese raus
                sind_bestimmte_Artnr_drin_then_del (glBONUSAA_Artnr)
                
                'setze den Kundenbonus wieder hoch
                If Val(Label2(7).Caption) > 0 Then
                
                    Dim rsrs As Recordset
                    Set rsrs = gdBase.OpenRecordset("Select * from Kunden where kundnr = " & Val(Label2(7).Caption))
                    If Not rsrs.EOF Then
                        rsrs.Edit
                        rsrs!Status = "E"
                        rsrs!SYNStatus = "E"
                        
                        If Not IsNull(rsrs!BONUS) Then
                            
                            rsrs!BONUS = rsrs!BONUS + (giAnzBonus_Erreicht * gdBonusGrenze)
                        End If
                        
                        If Not IsNull(rsrs!TBONUS) Then
                            rsrs!TBONUS = CDbl(rsrs!TBONUS) + (giAnzBonus_Erreicht * gdBonusGrenze)
                        End If
                        
                        rsrs!LASTDATE = DateValue(Now)
                        rsrs!LASTTIME = TimeValue(Now)
                        rsrs.Update
                        
                    End If
                    rsrs.Close
                End If
            
            End If
            
            BerechneZwischenSummeWKL20
        End If
    End If
            
'    If gbDisplay Then
'        InitKundenDisplayModul20
'    End If
    
    For i = 0 To 15
        SSCommand33(i).Enabled = True
    Next i

Exit Sub
LOKAL_ERROR:
   
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SchließenAufSchließen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    Resume Next
  
End Sub
Private Sub sind_bestimmte_Artnr_drin_then_del(lSuch_Artnr As Long)
On Error GoTo LOKAL_ERROR

    Dim lAnzSatz            As Long
    Dim lAnzSatzwirdkleiner As Long
    Dim lAktSatz            As Long
    Dim ctmp                As String
    Dim cLBSatz             As String
    Dim lartnr              As Long
    Dim iZeile              As Integer
    Dim i                   As Integer
    
    lAnzSatz = frmWKL20.List1.ListCount
    
    For i = 1 To lAnzSatz
    
        lAnzSatzwirdkleiner = frmWKL20.List1.ListCount
    
        For lAktSatz = 0 To lAnzSatzwirdkleiner - 1
        
            cLBSatz = frmWKL20.List1.list(lAktSatz)
            
            ctmp = Mid(cLBSatz, 7, 6)
            lartnr = CLng(Trim$(ctmp))
            
            If lSuch_Artnr = lartnr Then
                iZeile = CInt(lAktSatz)
                iZeile = iZeile + 1
                EinzelPosStorno_bestimmte_Zeile iZeile
                Exit For
                
            End If
        Next lAktSatz
    
    Next i
    
'    AktualisiereZeileZwischenSummeWKL20
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "sind_bestimmte_Artnr_drin_then_del"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Kasse auf."
    
    Fehlermeldung1
'    Resume Next
End Sub
Private Sub SchließenNachBarbon()
On Error GoTo LOKAL_ERROR

    Dim i As Integer

    If cboNoEuro.Visible = True Then
        zeigwaehrung "EUR"
    End If
    
    Check6.value = vbUnchecked
    cboNoEuro.Visible = False
    
    Label88(1).Caption = ""
    Text88.Text = ""
    Label88(1).Visible = False
    Label88(0).Visible = False
    
    Label88(2).Visible = False
    Label88(3).Visible = False
    Label88(4).Visible = False
    Text88.Visible = False
    gsFWK = ""
    gsUK = "0"
    
'    Frame33.Visible = False
    
    Screen.MousePointer = 11
    Frame1.Visible = True
    If gbLeiste2Start = True Then
        Frame23.Visible = True
        Frame2.Visible = False
    Else
        Frame2.Visible = True
        Frame23.Visible = False
    End If
    Frame3.Visible = True
    Frame4.Visible = True
    
    If Command33(1).Caption = "Schließen" Then
        List1.Clear
        List3.Nodes.Clear
        Label41(1).Caption = 0
        Label2(6).Caption = "0,00"
        LeereDialogModul20

        
        If gsiGESRAB > 0 Then
            zeigeZwangsrabatt
        End If
        
       
    End If
        
    gbNumTaste = True
    Text1(0).Text = gcBedienerNr
    Text1(1).SetFocus
    Command33(0).Visible = True
    gcKreditKarte = ""
    gcZahlMittel = ""

    If gbBEDLEER = True Then
        If Command33(1).Caption = "Schließen" Then
            Text1(0).Text = ""
            Label1(8).Caption = ""
            Text1(0).SetFocus
            indentmitKarte
        End If
    End If
            
    If gbDisplay Then
        InitKundenDisplayModul20
    End If
    
    For i = 0 To 15
        SSCommand33(i).Enabled = True
    Next i
    
    Screen.MousePointer = 0

Exit Sub
LOKAL_ERROR:
   
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SchließenNachBarbon"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub BerechneZwischenSummeWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim cLBSatz         As String
    Dim cFeld           As String
    Dim dWert           As Double
    Dim dZwiSum         As Double
    Dim iMenge          As Long
    Dim igesMenge       As Long
    Dim ctmp            As String
    
    igesMenge = 0
    dZwiSum = 0
    lAnzSatz = List1.ListCount
    
    If gbParknetto Then
    
        Dim cMWST As String
        Dim dArtRab As Double
        Dim dwert12 As Double
    
        For lAktSatz = 0 To lAnzSatz - 1
            cLBSatz = List1.list(lAktSatz)
            
            cMWST = Mid(cLBSatz, 72, 1)
            
            iMenge = 0
            If Left(cLBSatz, 1) = "x" Then
                iMenge = CInt(Mid(cLBSatz, 2, 4))
            Else
                iMenge = CInt(Mid(cLBSatz, 1, 5))
            End If
            igesMenge = igesMenge + iMenge
            
            'Mid(cLBSatz, 74, 9) voller Preis
            'ctmp = Mid(cLBSatz, 124, 3) artikelrab
            If Mid(cLBSatz, 7, 6) <> "000000" Then
                
                cFeld = Mid(cLBSatz, 74, 9)
                cFeld = Trim$(cFeld)
                cFeld = fnMoveComma2Point$(cFeld)
                dWert = Val(cFeld)
                dWert = nettoR(dWert, cMWST)
                dWert = Format$(dWert, "#####0.00")
                dWert = dWert * iMenge
                ctmp = Mid(cLBSatz, 124, 3) 'artikelrab
                If Val(ctmp) <> 0 Then
                    dArtRab = Val(ctmp)
                    
                    dwert12 = dWert - (dWert * dArtRab / 100)
                Else
                    dwert12 = dWert
                End If
                dWert = dwert12
                
                dZwiSum = dZwiSum + dWert
            End If
        Next lAktSatz
    Else
        For lAktSatz = 0 To lAnzSatz - 1
            cLBSatz = List1.list(lAktSatz)
            
            iMenge = 0
            If Left(cLBSatz, 1) = "x" Then
                iMenge = CInt(Mid(cLBSatz, 2, 4))
            Else
                iMenge = CLng(Mid(cLBSatz, 1, 5))
            End If
            igesMenge = igesMenge + iMenge
            
            If Mid(cLBSatz, 7, 6) <> "000000" Then
                cFeld = Mid(cLBSatz, 60, 9)
                cFeld = Trim$(cFeld)
                cFeld = fnMoveComma2Point$(cFeld)
                dWert = Val(cFeld)
                dZwiSum = dZwiSum + dWert
            End If
        Next lAktSatz
    End If
    
    Label2(6).Caption = Format$(dZwiSum, "######0.00")
    Label2(6).Refresh
    
    Label41(1).Caption = igesMenge
    Label41(1).Refresh
    
    If dZwiSum > 100000 Then
        cFeld = "Die Kasse hat einen ausserordentlich hohen Preis festgestellt." & vbCrLf
        cFeld = cFeld & "Bitte überprüfen Sie die Artikel-Positionen!"
        MsgBox cFeld, vbCritical, "PREIS FALSCH?"
    End If
    
    If gbHandelsspanne_Ausblenden = False Then
        HandelsspanneWarenkorb_anzeigen Shape3, Label39(0)
    End If
    
    Dim dBvoher As Double
    Dim dBonusjetzt As Double
    Dim dBonisum As Double
            
    dBvoher = 0
    dBonusjetzt = 0


    If Label2(7).Caption <> "0" And Label2(7).Caption <> "" Then

        dBonusjetzt = ermittleBonusjetzt
        dBvoher = ermittleBonusVorher(frmWKL20.Label2(7).Caption)
        
        dBonisum = dBvoher + dBonusjetzt
        Label1(14).Caption = Format(dBonisum, "###0.00")
        
        If Check7.value = vbChecked Then
            Label1(14).Visible = True
        Else
            Label1(14).Visible = False
        End If
    Else
    
        gbbonusHerab = False
        gbbonusausjetzt = False
        gdbonusHerabwert = 0
    
    End If
    

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BerechneZwischenSummeWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
'    Resume Next
    
End Sub
Private Sub DruckeKassenBonWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim cLBSatz         As String
    Dim ctmp            As String
    
    Dim dWert           As Double
    Dim dFaktor         As Double
    Dim dGPreis         As Double
    Dim dVPreis         As Double
    Dim dMWSt           As Double
    Dim dMWStVoll       As Double
    Dim dMWStErm        As Double
    Dim bDebug          As Boolean
    
    bDebug = False
    
    dMWStVoll = gdMWStV
    dMWStErm = gdMWStE
    
    dFaktor = 1
    If Label2(3).Visible Then
        ctmp = Label2(3).Caption
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
        dFaktor = (100 - dWert) / 100
    End If
    
    lAnzSatz = List1.ListCount
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        If bDebug Then
            MsgBox Len(cLBSatz) & vbCrLf & cLBSatz
            MsgBox "Menge = " & Mid(cLBSatz, 1, 5)
            MsgBox "ArtNr = " & Mid(cLBSatz, 7, 6)
            MsgBox "Bezeich = " & Mid(cLBSatz, 14, 35)
            MsgBox "EPreis nach Rabatt = " & Mid(cLBSatz, 50, 9)
            MsgBox "GPreis = " & Mid(cLBSatz, 60, 9)
            MsgBox "MWST-Kz = " & Mid(cLBSatz, 72, 1)
            MsgBox "Listenpreis/Sonderpreis = " & Mid(cLBSatz, 74, 9)
            MsgBox "Betrag ArtRabatt = " & Mid(cLBSatz, 84, 9)
            MsgBox "erzielter VK-Preis = " & Mid(cLBSatz, 94, 9)
            MsgBox "Betrag volle MWST = " & Mid(cLBSatz, 104, 9)
            MsgBox "Betrag erm. MWST = " & Mid(cLBSatz, 114, 9)
            MsgBox "ArtRabatt % = " & Mid(cLBSatz, 124, 3)
            MsgBox "Listen-VK = " & Mid(cLBSatz, 128, 9)
            MsgBox "Restmenge = " & Mid(cLBSatz, 138, 9)
        End If
                
        ctmp = Mid(cLBSatz, 60, 9)
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
                
        dVPreis = dWert * dFaktor
        ctmp = Format$(dVPreis, "#####0.00")
        ctmp = Space$(9 - Len(ctmp)) & ctmp
        Mid(cLBSatz, 94, 9) = ctmp
        
        ctmp = Mid(cLBSatz, 72, 1)
        If ctmp = "V" Then
            dMWSt = dVPreis * (dMWStVoll / 100)
            ctmp = Format$(dMWSt, "#####0.00")
            ctmp = Space$(9 - Len(ctmp)) & ctmp
            Mid(cLBSatz, 104, 9) = ctmp
        ElseIf ctmp = "E" Then
            dMWSt = dGPreis * (dMWStErm / 100)
            ctmp = Format$(dMWSt, "#####0.00")
            ctmp = Space$(9 - Len(ctmp)) & ctmp
            Mid(cLBSatz, 114, 9) = ctmp
        Else
            dMWSt = 0
        End If
        
        List1.RemoveItem lAktSatz
        List3.Nodes.Remove lAktSatz + 1
        List1.AddItem cLBSatz, lAktSatz
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
        
        If bDebug Then
            cLBSatz = List1.list(lAktSatz)
            MsgBox Len(cLBSatz) & vbCrLf & cLBSatz
            MsgBox Mid(cLBSatz, 1, 5)
            MsgBox Mid(cLBSatz, 7, 6)
            MsgBox Mid(cLBSatz, 14, 35)
            MsgBox Mid(cLBSatz, 50, 9)
            MsgBox Mid(cLBSatz, 60, 9)
            MsgBox Mid(cLBSatz, 72, 1)
            MsgBox Mid(cLBSatz, 74, 9)
            MsgBox Mid(cLBSatz, 84, 9)
            MsgBox Mid(cLBSatz, 94, 9)
            MsgBox Mid(cLBSatz, 104, 9)
            MsgBox Mid(cLBSatz, 114, 9)
            MsgBox Mid(cLBSatz, 124, 3)
            MsgBox Mid(cLBSatz, 128, 9)
            MsgBox "Restmenge = " & Mid(cLBSatz, 138, 9)
        End If
    Next lAktSatz
    
    If gbBONNEIN = False Then
        gbBonDruck = True
    Else
        gbBonDruck = False
    End If
   

    Dim cPfad As String
    Dim iZaehler As Integer

    cPfad = gcDBPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    iZaehler = 1
    
    Do While FileExists(cPfad & "KASSSTOP_ALLE.TXT")
        Pause 1
        gsAnzeigeText = "Die Kasse wird für ein paar Sekunden unterbrochen," & vbCrLf
        gsAnzeigeText = gsAnzeigeText & "da an einem anderen Rechner ein KASSENABSCHLUSS durchgeführt wird." & vbCrLf

        
        MsgBox gsAnzeigeText, vbInformation, iZaehler & ". Meldung"
        Pause 1
        iZaehler = iZaehler + 1
    Loop

    If Check3.value = vbChecked Or Check4.value = vbChecked Then
        'ich möchte nur den Bon speichern, damit dieser unter 2.Bon verfügbar ist.
        gbBonDruck = False
        SendeDaten2DruckerNeuWKL20
        
    End If
    
    Dim dTempBonNr As Double
    dTempBonNr = gdBonNr


    If Check3.value = vbUnchecked And Check4.value = vbUnchecked Then
        schreibeProtokollKassErr "       Funktion SendeDaten2DruckerNeuWKL20 Beginn: Bon Nr.: " & Label18.Caption
       
        TSSBerechnung
        'Odayy TSE 2
        SendeDaten2DruckerNeuWKL20
        schreibeProtokollKassErr "       Funktion SendeDaten2DruckerNeuWKL20 Ende: Bon Nr.: " & Label18.Caption
    End If
    
    If gdBonNr = 0 Then
        gdBonNr = dTempBonNr
    End If
    
    giZahlArt = giZahlArt
    
    If giZahlArt = 8 Then
        schreibeProtokollKassErr "       Funktion UpdateAFCStatWKL20 Beginn: Bon Nr.: " & Label18.Caption
        UpdateAFCStatWKL20
        schreibeProtokollKassErr "       Funktion UpdateAFCStatWKL20 Ende: Bon Nr.: " & Label18.Caption
    End If
    
    If giZahlArt <> giKOLLEGE Then
        schreibeProtokollKassErr "       Funktion InsertAFCBuchWKL20 Beginn: Bon Nr.: " & Label18.Caption
        
        'Todo TSE
        
        
        InsertAFCBuchWKL20_neu
        
        schreibeProtokollKassErr "       Funktion InsertAFCBuchWKL20 Ende: Bon Nr.: " & Label18.Caption
    Else
        schreibeProtokollKassErr "       Funktion InsertKollVerkWKL20 Beginn: Bon Nr.: " & Label18.Caption
        InsertKollVerkWKL20
        schreibeProtokollKassErr "       Funktion InsertKollVerkWKL20 Ende: Bon Nr.: " & Label18.Caption
    End If
    
    If CheckofP = True Then
        InsertProvision
    End If
    
    If CheckofX = True Then
        InsertXMarkierung
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeKassenBonWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
'    Resume Next
End Sub
Private Sub DruckeKassenBonDinA4(cZahlart As String, bReFuss As Boolean)
    On Error GoTo LOKAL_ERROR
    
    Dim cFirma          As String
    Dim cVname          As String
    Dim cNName          As String
    Dim cTitel          As String
    Dim cPlz            As String
    Dim cStadt          As String
    Dim cStrasse        As String
    Dim cAnrede         As String
    Dim cPrintFiTiAnVoNa As String
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim cLBSatz         As String
    Dim rs              As Recordset
    Dim rsrs            As Recordset
    Dim sSQL            As String
    Dim dUSTV           As Double
    Dim dUSTE           As Double
    Dim cSQL            As String
    
    loeschNEW "ANGEBOTNOW", gdBase
    CreateTable "ANGEBOTNOW", gdBase
    
    loeschNEW "DAGKOPF", gdBase
    CreateTable "DAGKOPF", gdBase
    
    Dim cFirmName       As String
    Dim cFirmAdress     As String
    Dim cFirmBank       As String
    Dim cFirmKomm       As String
    Dim cSteuernr       As String
    Dim cKommentar      As String
    
    If bReFuss Then
        loeschNEW "REFUSS", gdBase
        CreateTableT2 "REFUSS", gdBase
    
        cSQL = "Select * from FIRMA"
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!Steuernr) Then
                cSteuernr = rsrs!Steuernr
            Else
                cSteuernr = ""
            End If
            If Not IsNull(rsrs!name) Then
                cFirmName = rsrs!name
            Else
                cFirmName = ""
            End If
            If Not IsNull(rsrs!strasse) Then
                cFirmAdress = rsrs!strasse
            Else
                cFirmAdress = ""
            End If
            If Not IsNull(rsrs!Plz) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & "   " & rsrs!Plz
                Else
                    cFirmAdress = rsrs!Plz
                End If
            End If
            If Not IsNull(rsrs!Ort) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & " " & rsrs!Ort
                Else
                    cFirmAdress = rsrs!Ort
                End If
            End If
            If Not IsNull(rsrs!BankName) Then
                cFirmBank = rsrs!BankName
            Else
                cFirmBank = ""
            End If
            If Not IsNull(rsrs!BLZ) Then
                If rsrs!BLZ <> "" Then
                    cFirmBank = cFirmBank & "  BLZ " & rsrs!BLZ
                End If
            End If
            
            If Not IsNull(rsrs!Konto) Then
                If rsrs!Konto <> "" Then
                    cFirmBank = cFirmBank & "  Konto: " & rsrs!Konto
                End If
            End If
            
            If Not IsNull(rsrs!BIC) Then
                If rsrs!BIC <> "" Then
                    cFirmBank = cFirmBank & "  BIC " & rsrs!BIC
                End If
            End If
            
            If Not IsNull(rsrs!IBAN) Then
                If rsrs!IBAN <> "" Then
                    cFirmBank = cFirmBank & "  IBAN: " & rsrs!IBAN
                End If
            End If
            If Not IsNull(rsrs!Tel) Then
                cFirmKomm = "Tel.: " & rsrs!Tel
            Else
                cFirmKomm = ""
            End If
            If Not IsNull(rsrs!Fax) Then
                If cFirmKomm <> "" Then
                    cFirmKomm = cFirmKomm & "  Fax: " & rsrs!Fax
                Else
                    cFirmKomm = "Fax: " & rsrs!Fax
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
        Else
            cFirmName = ""
            cFirmAdress = ""
            cFirmBank = ""
            cFirmKomm = ""
            cSteuernr = ""
        End If
        
        cSQL = "Insert into REFUSS ( "
        cSQL = cSQL & " STEUERNR"
        cSQL = cSQL & ", FIRMNAME"
        cSQL = cSQL & ", FIRMADRESS"
        cSQL = cSQL & ", FIRMBANK"
        cSQL = cSQL & ", FIRMKOMM"
        cSQL = cSQL & ") values ("
        cSQL = cSQL & " '" & cSteuernr & "'"
        cSQL = cSQL & ", '" & cFirmName & "'"
        cSQL = cSQL & ", '" & cFirmAdress & "'"
        cSQL = cSQL & ", '" & cFirmBank & "'"
        cSQL = cSQL & ", '" & cFirmKomm & "'"
        cSQL = cSQL & ") "
        gdBase.Execute cSQL, dbFailOnError

    End If
    
    cSQL = "Select * from ANGEBOTNOW"
    FnOpenrecordset rs, cSQL, 1, gdBase
    
    Dim ctmp As String

    lAnzSatz = List1.ListCount
    For lAktSatz = 0 To lAnzSatz - 1
        
        cLBSatz = List1.list(lAktSatz)

        rs.AddNew
        rs!artnr = Mid(cLBSatz, 7, 6)
        rs!Status = Mid(cLBSatz, 6, 1)
        rs!BEZEICH = Mid(cLBSatz, 14, 35)
        rs!vkpr = Mid(cLBSatz, 50, 9)
        rs!KVKPR1 = Mid(cLBSatz, 128, 9)
        
        
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If
        
        
        rs!ANZAHL = ctmp
        rs!MWST = Mid(cLBSatz, 72, 1)
        If rs!KVKPR1 = "0" Then
            rs!KVKPR1 = rs!vkpr
        End If
'        rs!lfnr = 0
        rs!lfnr = Val(Label18.Caption) 'belegnr
        rs!posinr = lAktSatz + 1
        rs!BEDNR = CByte(gcBedienerNr)
        
        If Len(cLBSatz) > 175 Then
            rs!MOPREIS = Mid(cLBSatz, 177, 8)
        Else
            rs!MOPREIS = 0
        End If
        
        rs.Update
        
    Next lAktSatz
    
    rs.Close: Set rs = Nothing

    dUSTV = ermUstv("ANGEBOTNOW")
    dUSTE = ermUste("ANGEBOTNOW")
    
    If Label2(7).Caption <> "0" Or Label2(7).Caption <> "" Then
        
        cFirma = lookingForKundendaten(Trim(Label2(7).Caption)).firma
        cVname = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
        cNName = lookingForKundendaten(Trim(Label2(7).Caption)).nachname
        cTitel = lookingForKundendaten(Trim(Label2(7).Caption)).titel
        cPlz = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
        cStadt = lookingForKundendaten(Trim(Label2(7).Caption)).Ort
        cStrasse = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
        cAnrede = lookingForKundendaten(Trim(Label2(7).Caption)).anrede
        
        cPrintFiTiAnVoNa = ""
        
        If cFirma <> "" Then
            cPrintFiTiAnVoNa = cFirma
        End If
        
        cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & vbCrLf
        
        If cAnrede <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cAnrede & Space(1)
        End If
        
        
        If cTitel <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cTitel & Space(1)
        End If
        
        If cVname <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cVname & Space(1)
        End If
        
        If cNName <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cNName
        End If
        
        sSQL = "Insert into DAGKOPF (kundnr,PrintFiTiAnVoNa,name,vorname,titel,plz,stadt,strasse,Firma,anrede,datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        sSQL = sSQL & Label2(7).Caption
        sSQL = sSQL & ", '" & cPrintFiTiAnVoNa & "' "
        sSQL = sSQL & ", '" & cNName & "' "
        sSQL = sSQL & ", '" & cVname & "' "
        sSQL = sSQL & ", '" & cTitel & "' "
        sSQL = sSQL & ", '" & cPlz & "' "
        sSQL = sSQL & ", '" & cStadt & "' "
        sSQL = sSQL & ", '" & cStrasse & "' "
        sSQL = sSQL & ", '" & cFirma & "' "
        sSQL = sSQL & ", '" & cAnrede & "' "
        sSQL = sSQL & " , '" & cZahlart & "' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
        
    Else
    
        sSQL = "Insert into DAGKOPF (datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        
        sSQL = sSQL & "  '" & cZahlart & "' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
    
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeKassenBonDinA4"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub DruckeEinAuszBonDinA4(cZahlart As String, bReFuss As Boolean, cBetrag As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cFirma          As String
    Dim cVname          As String
    Dim cNName          As String
    Dim cTitel          As String
    Dim cPlz            As String
    Dim cStadt          As String
    Dim cStrasse        As String
    Dim cAnrede         As String
    Dim cPrintFiTiAnVoNa As String
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim cLBSatz         As String
    Dim rs              As Recordset
    Dim rsrs            As Recordset
    Dim sSQL            As String
    Dim dUSTV           As Double
    Dim dUSTE           As Double
    Dim cSQL            As String
    
    loeschNEW "ANGEBOTNOW", gdBase
    CreateTable "ANGEBOTNOW", gdBase
    
    loeschNEW "DAGKOPF", gdBase
    CreateTable "DAGKOPF", gdBase
    
    Dim cFirmName       As String
    Dim cFirmAdress     As String
    Dim cFirmBank       As String
    Dim cFirmKomm       As String
    Dim cSteuernr       As String
    Dim cKommentar      As String
    
    If bReFuss Then
        loeschNEW "REFUSS", gdBase
        CreateTableT2 "REFUSS", gdBase
    
        cSQL = "Select * from FIRMA"
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!Steuernr) Then
                cSteuernr = rsrs!Steuernr
            Else
                cSteuernr = ""
            End If
            If Not IsNull(rsrs!name) Then
                cFirmName = rsrs!name
            Else
                cFirmName = ""
            End If
            If Not IsNull(rsrs!strasse) Then
                cFirmAdress = rsrs!strasse
            Else
                cFirmAdress = ""
            End If
            If Not IsNull(rsrs!Plz) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & "   " & rsrs!Plz
                Else
                    cFirmAdress = rsrs!Plz
                End If
            End If
            If Not IsNull(rsrs!Ort) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & " " & rsrs!Ort
                Else
                    cFirmAdress = rsrs!Ort
                End If
            End If
            If Not IsNull(rsrs!BankName) Then
                cFirmBank = rsrs!BankName
            Else
                cFirmBank = ""
            End If
            If Not IsNull(rsrs!BLZ) Then
                If rsrs!BLZ <> "" Then
                    cFirmBank = cFirmBank & "  BLZ " & rsrs!BLZ
                End If
            End If
            
            If Not IsNull(rsrs!Konto) Then
                If rsrs!Konto <> "" Then
                    cFirmBank = cFirmBank & "  Konto: " & rsrs!Konto
                End If
            End If
            
            If Not IsNull(rsrs!BIC) Then
                If rsrs!BIC <> "" Then
                    cFirmBank = cFirmBank & "  BIC " & rsrs!BIC
                End If
            End If
            
            If Not IsNull(rsrs!IBAN) Then
                If rsrs!IBAN <> "" Then
                    cFirmBank = cFirmBank & "  IBAN: " & rsrs!IBAN
                End If
            End If
            If Not IsNull(rsrs!Tel) Then
                cFirmKomm = "Tel.: " & rsrs!Tel
            Else
                cFirmKomm = ""
            End If
            If Not IsNull(rsrs!Fax) Then
                If cFirmKomm <> "" Then
                    cFirmKomm = cFirmKomm & "  Fax: " & rsrs!Fax
                Else
                    cFirmKomm = "Fax: " & rsrs!Fax
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
        Else
            cFirmName = ""
            cFirmAdress = ""
            cFirmBank = ""
            cFirmKomm = ""
            cSteuernr = ""
        End If
        
        cSQL = "Insert into REFUSS ( "
        cSQL = cSQL & " STEUERNR"
        cSQL = cSQL & ", FIRMNAME"
        cSQL = cSQL & ", FIRMADRESS"
        cSQL = cSQL & ", FIRMBANK"
        cSQL = cSQL & ", FIRMKOMM"
        cSQL = cSQL & ") values ("
        cSQL = cSQL & " '" & cSteuernr & "'"
        cSQL = cSQL & ", '" & cFirmName & "'"
        cSQL = cSQL & ", '" & cFirmAdress & "'"
        cSQL = cSQL & ", '" & cFirmBank & "'"
        cSQL = cSQL & ", '" & cFirmKomm & "'"
        cSQL = cSQL & ") "
        gdBase.Execute cSQL, dbFailOnError

    End If
    
    cSQL = "Select * from ANGEBOTNOW"
    FnOpenrecordset rs, cSQL, 1, gdBase

    rs.AddNew
    rs!artnr = 0
    rs!Status = ""
    rs!BEZEICH = cZahlart
    rs!vkpr = cBetrag
    rs!KVKPR1 = cBetrag
    rs!ANZAHL = 1
    rs!MWST = ""
    
    rs!lfnr = 0
    rs!posinr = 1
    rs!BEDNR = CByte(gcBedienerNr)
    rs.Update
        
    rs.Close: Set rs = Nothing

    dUSTV = ermUstv("ANGEBOTNOW")
    dUSTE = ermUste("ANGEBOTNOW")
    
    If Label2(7).Caption <> "0" Or Label2(7).Caption <> "" Then
        
        cFirma = lookingForKundendaten(Trim(Label2(7).Caption)).firma
        cVname = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
        cNName = lookingForKundendaten(Trim(Label2(7).Caption)).nachname
        cTitel = lookingForKundendaten(Trim(Label2(7).Caption)).titel
        cPlz = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
        cStadt = lookingForKundendaten(Trim(Label2(7).Caption)).Ort
        cStrasse = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
        cAnrede = lookingForKundendaten(Trim(Label2(7).Caption)).anrede
        
        cPrintFiTiAnVoNa = ""
        
        If cFirma <> "" Then
            cPrintFiTiAnVoNa = cFirma
        End If
        
        cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & vbCrLf
        
        If cAnrede <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cAnrede & Space(1)
        End If
        
        
        If cTitel <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cTitel & Space(1)
        End If
        
        If cVname <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cVname & Space(1)
        End If
        
        If cNName <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cNName
        End If
        
        sSQL = "Insert into DAGKOPF (kundnr,PrintFiTiAnVoNa,name,vorname,titel,plz,stadt,strasse,Firma,anrede,datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        sSQL = sSQL & Label2(7).Caption
        sSQL = sSQL & ", '" & cPrintFiTiAnVoNa & "' "
        sSQL = sSQL & ", '" & cNName & "' "
        sSQL = sSQL & ", '" & cVname & "' "
        sSQL = sSQL & ", '" & cTitel & "' "
        sSQL = sSQL & ", '" & cPlz & "' "
        sSQL = sSQL & ", '" & cStadt & "' "
        sSQL = sSQL & ", '" & cStrasse & "' "
        sSQL = sSQL & ", '" & cFirma & "' "
        sSQL = sSQL & ", '" & cAnrede & "' "
        sSQL = sSQL & " , '" & cZahlart & "' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
        
    Else
    
        sSQL = "Insert into DAGKOPF (datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        
        sSQL = sSQL & "  '" & cZahlart & "' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
    
    End If
    
   
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeEinAuszBonDinA4"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub DruckeKassenZweitBonDinA4(cWoTag As String, cAuswahl As String, cZahlart As String, bReFuss As Boolean)
    On Error GoTo LOKAL_ERROR
    
    Dim cFirma          As String
    Dim cVname          As String
    Dim cNName          As String
    Dim cTitel          As String
    Dim cPlz            As String
    Dim cStadt          As String
    Dim cStrasse        As String
    Dim cAnrede         As String
    Dim cPrintFiTiAnVoNa As String
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim cLBSatz         As String
    Dim rs              As Recordset
    Dim sSQL            As String
    Dim dUSTV           As Double
    Dim dUSTE           As Double
    
    loeschNEW "ANGEBOTNOW", gdBase
    CreateTable "ANGEBOTNOW", gdBase
    loeschNEW "DAGKOPF", gdBase
    CreateTable "DAGKOPF", gdBase
    
    '******
    Dim lAnzZeile         As Long
    Dim lHeute            As Long
    Dim lWeekday          As Long
    Dim lSuchtag          As Long
    Dim lPos              As Long
    Dim lStart            As Long
    Dim lZeile            As Long
    
    Dim aDeviceName       As String
    Dim cEscapeSequenz    As String
    Dim cSQL              As String
    Dim cFeld             As String
    Dim cZeile            As String
    Dim cBonNr            As String
    Dim cUhrZeit          As String
    Dim cBetrag           As String
    Dim cKundnr           As String
    Dim rsrs              As Recordset
    
    ReDim cDruckZeile(1 To 1) As String
    
    cBonNr = Trim$(Left(cAuswahl, 6))
    cUhrZeit = Right(cAuswahl, 5)
    cKundnr = Trim(Mid(cAuswahl, 22, 9))
    
    lHeute = Fix(Now)
    lWeekday = Weekday(lHeute, vbMonday)
    Select Case cWoTag
        Case Is = "MO"
            lSuchtag = 1
        Case Is = "DI"
            lSuchtag = 2
        Case Is = "MI"
            lSuchtag = 3
        Case Is = "DO"
            lSuchtag = 4
        Case Is = "FR"
            lSuchtag = 5
        Case Is = "SA"
            lSuchtag = 6
        Case Is = "SO"
            lSuchtag = 7
    End Select
    
    If lWeekday > lSuchtag Then                 'lHeute um Differenz reduzieren
        lHeute = lHeute - lWeekday + lSuchtag
    End If
    
    If lWeekday = lSuchtag Then  'nichts tun! lHeute ist okay
    End If
    
    If lWeekday < lSuchtag Then
        lHeute = lHeute - (lWeekday + 7) + lSuchtag
    End If
    cSQL = "Select * from ANGEBOTNOW "
    FnOpenrecordset rs, cSQL, 1, gdBase
    
    cSQL = "Select * from Kassjour "
    cSQL = cSQL & "where adate = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    cSQL = cSQL & "and BELEGNR = " & cBonNr & " "
    
    If cKundnr <> "" Then
        cSQL = cSQL & "and Kundnr = " & cKundnr & " "
    End If
    lAktSatz = 0
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
       
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            lAktSatz = lAktSatz + 1
             
            cZahlart = rsrs!kk_art
            
            rs.AddNew
            rs!artnr = rsrs!artnr
            rs!BEZEICH = rsrs!BEZEICH
            If Not IsNull(rsrs!Menge) Then
                If Val(rsrs!Menge) <> 0 Then
                    rs!vkpr = rsrs!Preis / rsrs!Menge
                Else
                    rs!vkpr = rsrs!Preis
                End If
            Else
                rs!vkpr = rsrs!Preis
            End If
            rs!ANZAHL = rsrs!Menge
            rs!MWST = rsrs!MWST
            rs!KVKPR1 = rsrs!vkpr
            rs!lfnr = cBonNr
            rs!posinr = lAktSatz
            rs!BEDNR = rsrs!BEDIENER
            rs!MOPREIS = rsrs!MOPREIS
            
            rs.Update
            
            rsrs.MoveNext
        Loop
    End If

    rsrs.Close: Set rsrs = Nothing
    rs.Close: Set rs = Nothing
    
    
'    cSQL = "Select kundnr from Kassjour "
'    cSQL = cSQL & "where adate = " & Trim$(Str$(lHeute)) & " "
'    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
'    cSQL = cSQL & "and BELEGNR = " & cBonNr & " "
'
'    FnOpenrecordset rsrs, cSQL, 1, gdBase
'    If Not rsrs.EOF Then
'
'        If Not IsNull(rsrs!Kundnr) Then
'            cKundnr = rsrs!Kundnr
'        Else
'            cKundnr = "0"
'        End If
'
'    End If
'
'    rsrs.Close: Set rsrs = Nothing
    
    
    cKundnr = Trim(cKundnr)
    
    If cKundnr = "" Then
        cKundnr = "0"
    End If

    dUSTV = ermUstv("ANGEBOTNOW")
    dUSTE = ermUste("ANGEBOTNOW")

    
    If cKundnr <> "0" Then
        
        cFirma = lookingForKundendaten(Trim(cKundnr)).firma
        cVname = lookingForKundendaten(Trim(cKundnr)).vorname
        cNName = lookingForKundendaten(Trim(cKundnr)).nachname
        cTitel = lookingForKundendaten(Trim(cKundnr)).titel
        cPlz = lookingForKundendaten(Trim(cKundnr)).Plz
        cStadt = lookingForKundendaten(Trim(cKundnr)).Ort
        cStrasse = lookingForKundendaten(Trim(cKundnr)).strasse
        cAnrede = lookingForKundendaten(Trim(cKundnr)).anrede
        
        cPrintFiTiAnVoNa = ""
        
        If cFirma <> "" Then
            cPrintFiTiAnVoNa = cFirma
        End If
        
        cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & vbCrLf
        
        If cAnrede <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cAnrede & Space(1)
        End If
        
        If cTitel <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cTitel & Space(1)
        End If
        
        If cVname <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cVname & Space(1)
        End If
        
        If cNName <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cNName
        End If
        
        sSQL = "Insert into DAGKOPF (kundnr,PrintFiTiAnVoNa,name,vorname,titel,plz,stadt,strasse,Firma,anrede,datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        sSQL = sSQL & cKundnr
        sSQL = sSQL & ", '" & cPrintFiTiAnVoNa & "' "
        sSQL = sSQL & ", '" & cNName & "' "
        sSQL = sSQL & ", '" & cVname & "' "
        sSQL = sSQL & ", '" & cTitel & "' "
        sSQL = sSQL & ", '" & cPlz & "' "
        sSQL = sSQL & ", '" & cStadt & "' "
        sSQL = sSQL & ", '" & cStrasse & "' "
        sSQL = sSQL & ", '" & cFirma & "' "
        sSQL = sSQL & ", '" & cAnrede & "' "
        sSQL = sSQL & " , '" & cZahlart & "' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
        
    Else
    
        sSQL = "Insert into DAGKOPF (datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        sSQL = sSQL & "  '" & cZahlart & "' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
    End If
    
    Dim cFirmName       As String
    Dim cFirmAdress     As String
    Dim cFirmBank       As String
    Dim cFirmKomm       As String
    Dim cSteuernr       As String
    Dim cKommentar      As String
    
    If bReFuss Then
        loeschNEW "REFUSS", gdBase
        CreateTableT2 "REFUSS", gdBase
    
        cSQL = "Select * from FIRMA"
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!Steuernr) Then
                cSteuernr = rsrs!Steuernr
            Else
                cSteuernr = ""
            End If
            If Not IsNull(rsrs!name) Then
                cFirmName = rsrs!name
            Else
                cFirmName = ""
            End If
            If Not IsNull(rsrs!strasse) Then
                cFirmAdress = rsrs!strasse
            Else
                cFirmAdress = ""
            End If
            If Not IsNull(rsrs!Plz) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & "   " & rsrs!Plz
                Else
                    cFirmAdress = rsrs!Plz
                End If
            End If
            If Not IsNull(rsrs!Ort) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & " " & rsrs!Ort
                Else
                    cFirmAdress = rsrs!Ort
                End If
            End If
            If Not IsNull(rsrs!BankName) Then
                cFirmBank = rsrs!BankName
            Else
                cFirmBank = ""
            End If
            If Not IsNull(rsrs!BLZ) Then
                If rsrs!BLZ <> "" Then
                    cFirmBank = cFirmBank & "  BLZ " & rsrs!BLZ
                End If
            End If
            
            If Not IsNull(rsrs!Konto) Then
                If rsrs!Konto <> "" Then
                    cFirmBank = cFirmBank & "  Konto: " & rsrs!Konto
                End If
            End If
            
            If Not IsNull(rsrs!BIC) Then
                If rsrs!BIC <> "" Then
                    cFirmBank = cFirmBank & "  BIC " & rsrs!BIC
                End If
            End If
            
            If Not IsNull(rsrs!IBAN) Then
                If rsrs!IBAN <> "" Then
                    cFirmBank = cFirmBank & "  IBAN: " & rsrs!IBAN
                End If
            End If
            If Not IsNull(rsrs!Tel) Then
                cFirmKomm = "Tel.: " & rsrs!Tel
            Else
                cFirmKomm = ""
            End If
            If Not IsNull(rsrs!Fax) Then
                If cFirmKomm <> "" Then
                    cFirmKomm = cFirmKomm & "  Fax: " & rsrs!Fax
                Else
                    cFirmKomm = "Fax: " & rsrs!Fax
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
        Else
            cFirmName = ""
            cFirmAdress = ""
            cFirmBank = ""
            cFirmKomm = ""
            cSteuernr = ""
        End If
        
        cSQL = "Insert into REFUSS ( "
        cSQL = cSQL & " STEUERNR"
        cSQL = cSQL & ", FIRMNAME"
        cSQL = cSQL & ", FIRMADRESS"
        cSQL = cSQL & ", FIRMBANK"
        cSQL = cSQL & ", FIRMKOMM"
        cSQL = cSQL & ") values ("
        cSQL = cSQL & " '" & cSteuernr & "'"
        cSQL = cSQL & ", '" & cFirmName & "'"
        cSQL = cSQL & ", '" & cFirmAdress & "'"
        cSQL = cSQL & ", '" & cFirmBank & "'"
        cSQL = cSQL & ", '" & cFirmKomm & "'"
        cSQL = cSQL & ") "
        gdBase.Execute cSQL, dbFailOnError
    End If
    
    If Modul6.FindFile(gcDBPfad, "alrs3s.rpt") Then
        If gbDINA4RECHFU Then
            If Modul6.FindFile(gcDBPfad, "alrs3sfu.rpt") Then
                reportbildschirm "alr", "alrs3sfu"
            Else
                MsgBox "Ihre spezielle Druckansicht(alrs3sfu.rpt) muss angepasst werden, bitte rufen Sie die Hotline (Thomas Heinz, 0511 9559112) an!", vbOKOnly, "Winkiss Hinweis:"
            End If
        Else
            reportbildschirm "alr", "alrs3s"
        End If
    Else
        If gbDINA4RECHFU Then
            reportbildschirm "alr", "alrs3fu"
        Else
            reportbildschirm "alr", "alrs3"
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 3134 Then
        schreibeProtokollDINA4Err "DruckeKassenZweitBonDinA4 Insert into Syntaxfehler"
        schreibeProtokollDINA4Err sSQL
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "DruckeKassenZweitBonDinA4"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
    
End Sub
Private Sub DruckeKassenZweitBonDinA4_Netto(cWoTag As String, cAuswahl As String, cZahlart As String, bReFuss As Boolean)
    On Error GoTo LOKAL_ERROR
    
    Dim cFirma          As String
    Dim cVname          As String
    Dim cNName          As String
    Dim cTitel          As String
    Dim cPlz            As String
    Dim cStadt          As String
    Dim cStrasse        As String
    Dim cAnrede         As String
    Dim cPrintFiTiAnVoNa As String
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim cLBSatz         As String
    Dim rs              As Recordset
    Dim sSQL            As String
    Dim dUSTV           As Double
    Dim dUSTE           As Double
    
    loeschNEW "ANGEBOTNOW", gdBase
    CreateTable "ANGEBOTNOW", gdBase
    loeschNEW "DAGKOPF", gdBase
    CreateTable "DAGKOPF", gdBase
    
    '******
    Dim lAnzZeile         As Long
    Dim lHeute            As Long
    Dim lWeekday          As Long
    Dim lSuchtag          As Long
    Dim lPos              As Long
    Dim lStart            As Long
    Dim lZeile            As Long
    
    Dim aDeviceName       As String
    Dim cEscapeSequenz    As String
    Dim cSQL              As String
    Dim cFeld             As String
    Dim cZeile            As String
    Dim cBonNr            As String
    Dim cUhrZeit          As String
    Dim cBetrag           As String
    Dim cKundnr           As String
    Dim rsrs              As Recordset
    
    ReDim cDruckZeile(1 To 1) As String
    
    cBonNr = Trim$(Left(cAuswahl, 6))
    cUhrZeit = Right(cAuswahl, 5)
    
    lHeute = Fix(Now)
    lWeekday = Weekday(lHeute, vbMonday)
    Select Case cWoTag
        Case Is = "MO"
            lSuchtag = 1
        Case Is = "DI"
            lSuchtag = 2
        Case Is = "MI"
            lSuchtag = 3
        Case Is = "DO"
            lSuchtag = 4
        Case Is = "FR"
            lSuchtag = 5
        Case Is = "SA"
            lSuchtag = 6
        Case Is = "SO"
            lSuchtag = 7
    End Select
    
    If lWeekday > lSuchtag Then                 'lHeute um Differenz reduzieren
        lHeute = lHeute - lWeekday + lSuchtag
    End If
    
    If lWeekday = lSuchtag Then  'nichts tun! lHeute ist okay
    End If
    
    If lWeekday < lSuchtag Then
        lHeute = lHeute - (lWeekday + 7) + lSuchtag
    End If
    cSQL = "Select * from ANGEBOTNOW "
    FnOpenrecordset rs, cSQL, 1, gdBase
    
    cSQL = "Select * from Kassjour "
    cSQL = cSQL & "where adate = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    cSQL = cSQL & "and BELEGNR = " & cBonNr & " "
    lAktSatz = 0
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
       
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            lAktSatz = lAktSatz + 1
            rs.AddNew
            rs!artnr = rsrs!artnr
            rs!BEZEICH = rsrs!BEZEICH
            If Not IsNull(rsrs!Menge) Then
                If Val(rsrs!Menge) <> 0 Then
                    rs!vkpr = rsrs!Preis / rsrs!Menge
                Else
                    rs!vkpr = rsrs!Preis
                End If
            Else
                rs!vkpr = rsrs!Preis
            End If
            rs!ANZAHL = rsrs!Menge
            rs!MWST = rsrs!MWST
            rs!KVKPR1 = rsrs!vkpr
            rs!lfnr = rsrs!BELEGNR
            rs!posinr = lAktSatz
            rs!BEDNR = rsrs!BEDIENER
            rs!MOPREIS = rsrs!MOPREIS
            
            rs.Update
            
            rsrs.MoveNext
        Loop
    End If

    rsrs.Close: Set rsrs = Nothing
    rs.Close: Set rs = Nothing
    
    
    cSQL = "Update ANGEBOTNOW "
    cSQL = cSQL & " set "
    cSQL = cSQL & " vkpr = ((vkpr/(100 + " & gdMWStV & "))*100)"
    cSQL = cSQL & " where MWST = 'V' "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Update ANGEBOTNOW "
    cSQL = cSQL & " set "
    cSQL = cSQL & " vkpr = ((vkpr/(100 + " & gdMWStE & "))*100)"
    cSQL = cSQL & " where MWST = 'E' "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Update ANGEBOTNOW "
    cSQL = cSQL & " set "
    cSQL = cSQL & " KVKPR1 = ((KVKPR1/(100 + " & gdMWStV & "))*100)"
    cSQL = cSQL & " where MWST = 'V' "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Update ANGEBOTNOW "
    cSQL = cSQL & " set "
    cSQL = cSQL & " KVKPR1 = ((KVKPR1/(100 + " & gdMWStE & "))*100)"
    cSQL = cSQL & " where MWST = 'E' "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Select kundnr from Kassjour "
    cSQL = cSQL & "where adate = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    cSQL = cSQL & "and BELEGNR = " & cBonNr & " "
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!Kundnr) Then
            cKundnr = rsrs!Kundnr
        Else
            cKundnr = "0"
        End If
    End If
    
    rsrs.Close: Set rsrs = Nothing
    
    cKundnr = Trim(cKundnr)
    
    If cKundnr = "" Then
        cKundnr = "0"
    End If

    dUSTV = ermUstv("ANGEBOTNOW")
    dUSTE = ermUste("ANGEBOTNOW")

    If cKundnr <> "0" Then
        cFirma = lookingForKundendaten(Trim(cKundnr)).firma
        cVname = lookingForKundendaten(Trim(cKundnr)).vorname
        cNName = lookingForKundendaten(Trim(cKundnr)).nachname
        cTitel = lookingForKundendaten(Trim(cKundnr)).titel
        cPlz = lookingForKundendaten(Trim(cKundnr)).Plz
        cStadt = lookingForKundendaten(Trim(cKundnr)).Ort
        cStrasse = lookingForKundendaten(Trim(cKundnr)).strasse
        cAnrede = lookingForKundendaten(Trim(cKundnr)).anrede
        
        cPrintFiTiAnVoNa = ""
        
        If cFirma <> "" Then
            cPrintFiTiAnVoNa = cFirma
        End If
        
        cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & vbCrLf
        
        If cAnrede <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cAnrede & Space(1)
        End If
        
        If cTitel <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cTitel & Space(1)
        End If
        
        If cVname <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cVname & Space(1)
        End If
        
        If cNName <> "" Then
            cPrintFiTiAnVoNa = cPrintFiTiAnVoNa & cNName
        End If
        
        sSQL = "Insert into DAGKOPF (kundnr,PrintFiTiAnVoNa,name,vorname,titel,plz,stadt,strasse,Firma,anrede,datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        sSQL = sSQL & cKundnr
        sSQL = sSQL & ", '" & cPrintFiTiAnVoNa & "' "
        sSQL = sSQL & ", '" & cNName & "' "
        sSQL = sSQL & ", '" & cVname & "' "
        sSQL = sSQL & ", '" & cTitel & "' "
        sSQL = sSQL & ", '" & cPlz & "' "
        sSQL = sSQL & ", '" & cStadt & "' "
        sSQL = sSQL & ", '" & cStrasse & "' "
        sSQL = sSQL & ", '" & cFirma & "' "
        sSQL = sSQL & ", '" & cAnrede & "' "
        sSQL = sSQL & " , '" & cZahlart & "' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
        
    Else
    
        sSQL = "Insert into DAGKOPF (datname,bedname,USTV,USTE)"
        sSQL = sSQL & " values ( "
        sSQL = sSQL & "  '' "
        sSQL = sSQL & " , '" & gcBediener & "' "
        sSQL = sSQL & " , '" & dUSTV & "' "
        sSQL = sSQL & " , '" & dUSTE & "' "
        sSQL = sSQL & " ) "
        gdBase.Execute sSQL, dbFailOnError
    End If
    
    Dim cFirmName       As String
    Dim cFirmAdress     As String
    Dim cFirmBank       As String
    Dim cFirmKomm       As String
    Dim cSteuernr       As String
    Dim cKommentar      As String
    
    If bReFuss Then
        loeschNEW "REFUSS", gdBase
        CreateTableT2 "REFUSS", gdBase
    
        cSQL = "Select * from FIRMA"
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!Steuernr) Then
                cSteuernr = rsrs!Steuernr
            Else
                cSteuernr = ""
            End If
            If Not IsNull(rsrs!name) Then
                cFirmName = rsrs!name
            Else
                cFirmName = ""
            End If
            If Not IsNull(rsrs!strasse) Then
                cFirmAdress = rsrs!strasse
            Else
                cFirmAdress = ""
            End If
            If Not IsNull(rsrs!Plz) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & "   " & rsrs!Plz
                Else
                    cFirmAdress = rsrs!Plz
                End If
            End If
            If Not IsNull(rsrs!Ort) Then
                If cFirmAdress <> "" Then
                    cFirmAdress = cFirmAdress & " " & rsrs!Ort
                Else
                    cFirmAdress = rsrs!Ort
                End If
            End If
            If Not IsNull(rsrs!BankName) Then
                cFirmBank = rsrs!BankName
            Else
                cFirmBank = ""
            End If
            If Not IsNull(rsrs!BLZ) Then
                If rsrs!BLZ <> "" Then
                    cFirmBank = cFirmBank & "  BLZ " & rsrs!BLZ
                End If
            End If
            
            If Not IsNull(rsrs!Konto) Then
                If rsrs!Konto <> "" Then
                    cFirmBank = cFirmBank & "  Konto: " & rsrs!Konto
                End If
            End If
            
            If Not IsNull(rsrs!BIC) Then
                If rsrs!BIC <> "" Then
                    cFirmBank = cFirmBank & "  BIC " & rsrs!BIC
                End If
            End If
            
            If Not IsNull(rsrs!IBAN) Then
                If rsrs!IBAN <> "" Then
                    cFirmBank = cFirmBank & "  IBAN: " & rsrs!IBAN
                End If
            End If
            If Not IsNull(rsrs!Tel) Then
                cFirmKomm = "Tel.: " & rsrs!Tel
            Else
                cFirmKomm = ""
            End If
            If Not IsNull(rsrs!Fax) Then
                If cFirmKomm <> "" Then
                    cFirmKomm = cFirmKomm & "  Fax: " & rsrs!Fax
                Else
                    cFirmKomm = "Fax: " & rsrs!Fax
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
        Else
            cFirmName = ""
            cFirmAdress = ""
            cFirmBank = ""
            cFirmKomm = ""
            cSteuernr = ""
        End If
        
        cSQL = "Insert into REFUSS ( "
        cSQL = cSQL & " STEUERNR"
        cSQL = cSQL & ", FIRMNAME"
        cSQL = cSQL & ", FIRMADRESS"
        cSQL = cSQL & ", FIRMBANK"
        cSQL = cSQL & ", FIRMKOMM"
        cSQL = cSQL & ") values ("
        cSQL = cSQL & " '" & cSteuernr & "'"
        cSQL = cSQL & ", '" & cFirmName & "'"
        cSQL = cSQL & ", '" & cFirmAdress & "'"
        cSQL = cSQL & ", '" & cFirmBank & "'"
        cSQL = cSQL & ", '" & cFirmKomm & "'"
        cSQL = cSQL & ") "
        gdBase.Execute cSQL, dbFailOnError
    End If
    
    
    If gbDINA4RECHFU Then
        If Modul6.FindFile(gcDBPfad, "alrs3fuNettoS.rpt") Then
            reportbildschirm "alr", "alrs3fuNettoS"
        Else
            reportbildschirm "alr", "alrs3fuNetto"
        End If
    Else
        If Modul6.FindFile(gcDBPfad, "alrs3NettoS.rpt") Then
            reportbildschirm "alr", "alrs3NettoS"
        Else
            reportbildschirm "alr", "alrs3Netto"
        End If
    End If
    
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 3134 Then
        schreibeProtokollDINA4Err "DruckeKassenZweitBonDinA4_Netto Insert into Syntaxfehler"
        schreibeProtokollDINA4Err sSQL
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "DruckeKassenZweitBonDinA4_Netto"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
    
End Sub
Private Sub Drucke_Zoll_DinA4(cWoTag As String, cAuswahl As String, cZahlart As String, dVolle As Double, dErm As Double)
    On Error GoTo LOKAL_ERROR
    
    Dim cKULand         As String
    Dim cKUName         As String
    Dim cKUVorname      As String
    Dim cKUTitel        As String
    Dim cKUPlz          As String
    Dim cKUStadt        As String
    Dim cKUStrasse      As String
    Dim cKUNamegesamt   As String
    Dim cGesamtpreis    As String
    Dim lHeute          As Long
    Dim lWeekday        As Long
    Dim lSuchtag        As Long
    Dim cSQL            As String
    Dim cBonNr          As String
    Dim cUhrZeit        As String
    Dim cKundnr         As String
    Dim rsrs            As Recordset
    Dim cZOLL_EURO      As String
    Dim cZOLL_CENT      As String
    Dim cEURO_Wort      As String
    Dim cBELEG_Ort      As String
    Dim cBELEG_DATUM    As String
    
    Dim cMWST_V         As String
    Dim cMWST_E         As String
    Dim cMWST_SATZ_V    As String
    Dim cMWST_SATZ_E    As String
    
    cBonNr = Trim$(Left(cAuswahl, 6))
    cUhrZeit = Right(cAuswahl, 8)
    cKundnr = Trim(Mid(cAuswahl, 24, 7))
    cGesamtpreis = Trim(Mid(cAuswahl, 9, 8))
    
    If cKundnr = "" Then cKundnr = "0"
   
    lHeute = Fix(Now)
    lWeekday = Weekday(lHeute, vbMonday)
    Select Case cWoTag
        Case Is = "MO"
            lSuchtag = 1
        Case Is = "DI"
            lSuchtag = 2
        Case Is = "MI"
            lSuchtag = 3
        Case Is = "DO"
            lSuchtag = 4
        Case Is = "FR"
            lSuchtag = 5
        Case Is = "SA"
            lSuchtag = 6
        Case Is = "SO"
            lSuchtag = 7
    End Select
    
    If lWeekday > lSuchtag Then                 'lHeute um Differenz reduzieren
        lHeute = lHeute - lWeekday + lSuchtag
    End If
    
    If lWeekday = lSuchtag Then  'nichts tun! lHeute ist okay
    End If
    
    If lWeekday < lSuchtag Then
        lHeute = lHeute - (lWeekday + 7) + lSuchtag
    End If
    
    
    cBELEG_DATUM = Format(lHeute, "DD.MM.YYYY")
    
    cMWST_E = "0,00 "
    cMWST_SATZ_E = Format(gdMWStE, "#####0.00") & " %"
    
    cMWST_V = "0,00 "
    cMWST_SATZ_V = Format(gdMWStV, "#####0.00") & " %"
    
    cMWST_V = Format(dVolle, "#####0.00") & " "
    
    cMWST_E = Format(dErm, "#####0.00") & " "
    
'    cSQL = "Select sum(preis) * " & gdMWStV & " / (100 + " & gdMWStV & ") as MWSTV from Kassjour "
'    cSQL = cSQL & "where adate = " & Trim$(Str$(lHeute)) & " "
'    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
'    cSQL = cSQL & "and BELEGNR = " & cBonNr & " "
'    cSQL = cSQL & "and UMS_OK = 'J' "
'    cSQL = cSQL & "and MWST = 'V' "
'
'    If Len(cUhrZeit) = 8 Then
'        cSQL = cSQL & "and left(azeit,5) = '" & Left(cUhrZeit, 5) & "' "
'    End If
'    FnOpenrecordset rsrs, cSQL, 1, gdBase
'
'    cMWST_V = "0,00 "
'    cMWST_SATZ_V = Format(gdMWStV, "#####0.00") & " %"
'    If Not rsrs.EOF Then
'        If Not IsNull(rsrs!MWSTV) Then
'            cMWST_V = Format(rsrs!MWSTV, "#####0.00") & " "
'
'        End If
'    End If
'    rsrs.Close: Set rsrs = Nothing
    
'    cSQL = "Select sum(preis) * " & gdMWStE & " / (100 + " & gdMWStE & ") as MWSTE from Kassjour "
'    cSQL = cSQL & "where adate = " & Trim$(Str$(lHeute)) & " "
'    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
'    cSQL = cSQL & "and BELEGNR = " & cBonNr & " "
'    cSQL = cSQL & "and UMS_OK = 'J' "
'    cSQL = cSQL & "and MWST = 'E' "
'    If Len(cUhrZeit) = 8 Then
'        cSQL = cSQL & "and left(azeit,5) = '" & Left(cUhrZeit, 5) & "' "
'    End If
'    FnOpenrecordset rsrs, cSQL, 1, gdBase
'
'    cMWST_E = "0,00 "
'    cMWST_SATZ_E = Format(gdMWStE, "#####0.00") & " %"
'    If Not rsrs.EOF Then
'        If Not IsNull(rsrs!MWSTE) Then
'            cMWST_E = Format(rsrs!MWSTE, "#####0.00") & " "
'        End If
'    End If
'    rsrs.Close: Set rsrs = Nothing
    
    If gbZOLLmMWST = False Then
        cMWST_E = ""
        cMWST_V = ""
        cMWST_SATZ_V = ""
        cMWST_SATZ_E = ""
    End If
    
    
    If cGesamtpreis <> "" Then
        cZOLL_EURO = Left(cGesamtpreis, InStr(1, cGesamtpreis, ",") - 1)
        cEURO_Wort = inWorten(cZOLL_EURO)
        
        cZOLL_EURO = Left(cGesamtpreis, InStr(1, cGesamtpreis, ",") - 1)
        cZOLL_CENT = Right(cGesamtpreis, Len(cGesamtpreis) - InStr(1, cGesamtpreis, ","))
        
        
    End If
    
    Dim cFirmName       As String
    Dim cFirmPlzOrt     As String
    Dim cFirmStrasse    As String
    
    cKULand = ""
    cKUName = ""
    cKUVorname = ""
    cKUTitel = ""
    cKUNamegesamt = ""
    
    cKUPlz = ""
    cKUStadt = ""
    cKUStrasse = ""
    
    If cKundnr <> "0" Then
        cKUVorname = lookingForKundendaten(Trim(cKundnr)).vorname
        cKUName = lookingForKundendaten(Trim(cKundnr)).nachname
        cKUTitel = lookingForKundendaten(Trim(cKundnr)).titel
        
        cKULand = lookingForKundendaten(Trim(cKundnr)).LAND
        cKULand = Welches_Land(cKULand)
        
        If cKUTitel <> "" Then
            If cKUVorname <> "" Then
                cKUNamegesamt = cKUTitel & " " & cKUVorname & " " & cKUName
            Else
                cKUNamegesamt = cKUTitel & " " & cKUName
            End If
        Else
            If cKUVorname <> "" Then
                cKUNamegesamt = cKUVorname & " " & cKUName
            Else
                cKUNamegesamt = cKUName
            End If
        End If
    
        cKUPlz = lookingForKundendaten(Trim(cKundnr)).Plz
        cKUStadt = lookingForKundendaten(Trim(cKundnr)).Ort
        cKUStrasse = lookingForKundendaten(Trim(cKundnr)).strasse
    End If
    
    loeschNEW "ZOLL", gdBase
    CreateTableT2 "ZOLL", gdBase

    cSQL = "Select * from FIRMA"
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
    
        cFirmName = ""
        cFirmStrasse = ""
        cFirmPlzOrt = ""
        cBELEG_Ort = ""
        
        If Not IsNull(rsrs!name) Then
            cFirmName = rsrs!name
        End If
        If Not IsNull(rsrs!strasse) Then
            cFirmStrasse = rsrs!strasse
        End If
        
        If Not IsNull(rsrs!Plz) Then
            cFirmPlzOrt = rsrs!Plz
        End If
        
        If Not IsNull(rsrs!Ort) Then
            cFirmPlzOrt = cFirmPlzOrt & " " & rsrs!Ort
        End If
        
        If Not IsNull(rsrs!Ort) Then
            cBELEG_Ort = rsrs!Ort
        End If
        
        rsrs.Close: Set rsrs = Nothing
    Else
        cFirmName = ""
        cFirmStrasse = ""
        cFirmPlzOrt = ""
    End If
        
    cSQL = "Insert into Zoll ( "
    cSQL = cSQL & " FIRM_NAME"
    cSQL = cSQL & ", FIRM_STRASSE"
    cSQL = cSQL & ", FIRM_PLZORT"
    cSQL = cSQL & ", KU_kundnr  "
    cSQL = cSQL & ", KU_NameGesamt "
    cSQL = cSQL & ", KU_PlzOrt  "
    cSQL = cSQL & ", KU_strasse  "
    cSQL = cSQL & ", KU_Land  "
    cSQL = cSQL & ", ZOLL_EURO  "
    cSQL = cSQL & ", ZOLL_CENT  "
    cSQL = cSQL & ", EURO_Wort  "
    cSQL = cSQL & ", BELEG_Ort  "
    cSQL = cSQL & ", BELEG_DATUM  "
    
    cSQL = cSQL & ", MWST_E  "
    cSQL = cSQL & ", MWST_V  "
    cSQL = cSQL & ", MWST_SATZ_E  "
    cSQL = cSQL & ", MWST_SATZ_V  "
    cSQL = cSQL & ", BELEG_NR  "
    cSQL = cSQL & ", BELEG_ArtBez "
    
    cSQL = cSQL & ") values ("
    cSQL = cSQL & " '" & cFirmName & "'"
    cSQL = cSQL & ", '" & cFirmStrasse & "'"
    cSQL = cSQL & ", '" & cFirmPlzOrt & "'"
    cSQL = cSQL & ", '" & cKundnr & "'"
    cSQL = cSQL & ", '" & cKUNamegesamt & "'"
    cSQL = cSQL & ", '" & cKUPlz & Space(1) & cKUStadt & "'"
    cSQL = cSQL & ", '" & cKUStrasse & "'"
    cSQL = cSQL & ", '" & cKULand & "'"
    cSQL = cSQL & ", '" & cZOLL_EURO & "'"
    cSQL = cSQL & ", '" & cZOLL_CENT & "'"
    cSQL = cSQL & ", '" & cEURO_Wort & "'"
    cSQL = cSQL & ", '" & cBELEG_Ort & "'"
    cSQL = cSQL & ", '" & cBELEG_DATUM & "'"
    
    cSQL = cSQL & ", '" & cMWST_E & "'"
    cSQL = cSQL & ", '" & cMWST_V & "'"
    cSQL = cSQL & ", '" & cMWST_SATZ_E & "'"
    cSQL = cSQL & ", '" & cMWST_SATZ_V & "'"
    cSQL = cSQL & ", '" & cBonNr & "'"
    cSQL = cSQL & ", '" & gsZOLLARTBEZ & "'"
    cSQL = cSQL & ") "
    gdBase.Execute cSQL, dbFailOnError
    
    If gbZOLLonlyFirstPage Then
        If gbZOLLPrintDirekt Then
            reportbildschirmToPrinter "aWKL20z_1"
        Else
            reportbildschirm "alr", "aWKL20z_1"
        End If
    Else
        If gbZOLLPrintDirekt Then
            reportbildschirmToPrinter "aWKL20z"
        Else
            reportbildschirm "alr", "aWKL20z"
        End If
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Drucke_Zoll_DinA4"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub DruckeKassenBonRückgabeWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim bDebug          As Boolean
    bDebug = False
    
    SendeDaten2DruckerRückgabeWKL20

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeKassenBonRückgabeWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub DruckeKassenBonKundenbestellungWKL20(cUeberstring As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cKunde          As String
    Dim bDebug          As Boolean
    bDebug = False
    
    cKunde = "0"
    
    If Label2(7).Caption <> "0" And Label2(7).Visible Then
        cKunde = Trim(Label2(7).Caption)
    End If
    
    SendeDaten2DruckerKUNDENBESTELLUNGWKL20 cKunde, "", "", "", "", cUeberstring
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeKassenBonKundenbestellungWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub DruckeKassenBonRetoureWKL20(cRetGrund As String)
    On Error GoTo LOKAL_ERROR
    
    Dim bDebug          As Boolean
    bDebug = False
    
    SendeDaten2DruckerRetoureWKL20 cRetGrund
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeKassenBonRetoureWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function fnDruckeKassenBonECLastWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
   
    Dim cLBSatz         As String
    Dim ctmp            As String
    
    Dim dWert           As Double
    Dim dFaktor         As Double
    Dim dGPreis         As Double
    Dim dVPreis         As Double
    Dim dMWSt           As Double
    Dim dMWStVoll       As Double
    Dim dMWStErm        As Double
    Dim dStartzeit      As Double
    Dim dJetztZeit      As Double
    Dim dSekunde        As Double
    
    Dim bDebug          As Boolean
    
    Dim iRet            As Integer

    fnDruckeKassenBonECLastWKL20 = 0
    
    bDebug = False
    dMWStVoll = gdMWStV
    dMWStErm = gdMWStE
    
    If Label2(3).Visible Then
        ctmp = Label2(3).Caption
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
        dFaktor = (100 - dWert) / 100
    End If
    
    lAnzSatz = List1.ListCount
    
    For lAktSatz = 0 To lAnzSatz - 1
    
        cLBSatz = List1.list(lAktSatz)
        
        If bDebug Then
            MsgBox Len(cLBSatz) & vbCrLf & cLBSatz
            MsgBox "Menge = " & Mid(cLBSatz, 1, 5)
            MsgBox "ArtNr = " & Mid(cLBSatz, 7, 6)
            MsgBox "Bezeich = " & Mid(cLBSatz, 14, 35)
            MsgBox "EPreis nach Rabatt = " & Mid(cLBSatz, 50, 9)
            MsgBox "GPreis = " & Mid(cLBSatz, 60, 9)
            MsgBox "MWST-Kz = " & Mid(cLBSatz, 72, 1)
            MsgBox "Listenpreis/Sonderpreis = " & Mid(cLBSatz, 74, 9)
            MsgBox "Betrag ArtRabatt = " & Mid(cLBSatz, 84, 9)
            MsgBox "erzielter VK-Preis = " & Mid(cLBSatz, 94, 9)
            MsgBox "Betrag volle MWST = " & Mid(cLBSatz, 104, 9)
            MsgBox "Betrag erm. MWST = " & Mid(cLBSatz, 114, 9)
            MsgBox "ArtRabatt % = " & Mid(cLBSatz, 124, 3)
            MsgBox "Listen-VK = " & Mid(cLBSatz, 128, 9)
            MsgBox "Restmenge = " & Mid(cLBSatz, 138, 9)
        End If
                
        ctmp = Mid(cLBSatz, 60, 9)
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
                
        dVPreis = dWert * dFaktor
        ctmp = Format$(dVPreis, "#####0.00")
        ctmp = Space$(9 - Len(ctmp)) & ctmp
        Mid(cLBSatz, 94, 9) = ctmp
        
        
        ctmp = Mid(cLBSatz, 72, 1)
        
        If ctmp = "V" Then
            dMWSt = dVPreis * (dMWStVoll / 100)
            ctmp = Format$(dMWSt, "#####0.00")
            ctmp = Space$(9 - Len(ctmp)) & ctmp
            Mid(cLBSatz, 104, 9) = ctmp
        ElseIf ctmp = "E" Then
            dMWSt = dGPreis * (dMWStErm / 100)
            ctmp = Format$(dMWSt, "#####0.00")
            ctmp = Space$(9 - Len(ctmp)) & ctmp
            Mid(cLBSatz, 114, 9) = ctmp
        Else
            dMWSt = 0
        End If
        
        List1.RemoveItem lAktSatz
        List3.Nodes.Remove lAktSatz + 1
        List1.AddItem cLBSatz, lAktSatz
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
        
        If bDebug Then
            cLBSatz = List1.list(lAktSatz)
            MsgBox Len(cLBSatz) & vbCrLf & cLBSatz
            MsgBox Mid(cLBSatz, 1, 5)
            MsgBox Mid(cLBSatz, 7, 6)
            MsgBox Mid(cLBSatz, 14, 35)
            MsgBox Mid(cLBSatz, 50, 9)
            MsgBox Mid(cLBSatz, 60, 9)
            MsgBox Mid(cLBSatz, 72, 1)
            MsgBox Mid(cLBSatz, 74, 9)
            MsgBox Mid(cLBSatz, 84, 9)
            MsgBox Mid(cLBSatz, 94, 9)
            MsgBox Mid(cLBSatz, 104, 9)
            MsgBox Mid(cLBSatz, 114, 9)
            MsgBox Mid(cLBSatz, 124, 3)
            MsgBox Mid(cLBSatz, 128, 9)
            MsgBox "Restmenge = " & Mid(cLBSatz, 138, 9)
        End If
        
    Next lAktSatz
    
    ctmp = Label11(3).Caption
    ctmp = fnMoveComma2Point$(ctmp)
    gdSummeLAST = Val(ctmp)
    
    ctmp = Label11(3).Caption
    ctmp = fnMoveComma2Point$(ctmp)
    gdSumme = Val(ctmp)
    gdGegeben = gdSumme
    
    SendeDaten2DruckerLastSchriftWKL20
    SendeDaten2DruckerNeuWKL20
    
    '**********************************************************
    'Zwei Sekunden warten auf Abschluß des Ausdrucks        *
    '********************************************************
    dSekunde = 24 * 60
    dSekunde = dSekunde * 60
    dSekunde = 1 / dSekunde

    dStartzeit = Time
    dJetztZeit = dStartzeit
    
    Do While dJetztZeit - dStartzeit < dSekunde * 2
        dJetztZeit = Time
    Loop
    
    iRet = MsgBox("Wurden die Kassenbons korrekt ausgedruckt?", vbQuestion + vbYesNo, "DRUCK OK?")
    If iRet <> vbYes Then
        fnDruckeKassenBonECLastWKL20 = 1
        Command10(0).Enabled = True
    Else
        giZahlArt = giZahlArt
        If gbGutschein Then
            frmWK20g.Kassieren
            Unload frmWK20g
        Else
            UpdateAFCStatAndersWKL20
            InsertAFCBuchWKL20_neu
            If CheckofP = True Then
                InsertProvision
            End If
            If CheckofX = True Then
                InsertXMarkierung
            End If
        End If
        bAbschluss = True
    End If
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeKassenBonECLastWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub KassierenUnterbrechenWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim rsrs        As Recordset
    
    Dim lLfdNr      As Long
    Dim lLbZeile    As Long
    
    Dim cSQL        As String
    Dim cBedNr      As String
    Dim cZSum       As String
    Dim cGRabatt    As String
    Dim cKdName     As String
    Dim cKdnr       As String
    Dim sArtnr      As String
    Dim cLbText     As String
    Dim iRet        As Integer
    
    Dim iStufe      As Integer
    Dim cZeitJetzt  As String
    
    cZeitJetzt = Format$(Now, "HH:MM:SS")
    
    iStufe = 1
    If List1.ListCount = 0 Then
        MsgBox "Kassiervorgang unterbrechen nicht möglich: keine Positionen vorhanden!", vbCritical, "STOP"
        Text1(1).SetFocus
        Exit Sub
    End If
    If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
        MsgBox "Kassiervorgang unterbrechen nicht möglich: keine Bediener-Nr vorhanden!", vbCritical, "STOP"
        Text1(0).SetFocus
        Exit Sub
    Else
        iRet = fnLogonBedienerWKL20%()
        If iRet <> 0 Then
            Text1(0).SetFocus
            Exit Sub
        End If
    End If
    
    
    iStufe = 2
    
    cBedNr = Text1(0).Text
    cZSum = Label2(6).Caption
    
    If Label2(3).Visible = True Then
        cGRabatt = Label2(3).Caption
    Else
        cGRabatt = "0,00"
    End If
    
    iStufe = 3
    
    If Label1(7).Visible = True Then
        cKdName = Label1(7).Caption
    Else
        cKdName = ""
    End If
    
    iStufe = 4
    If Label2(7).Visible = True Then
        cKdnr = Label2(7).Caption
    Else
        cKdnr = ""
    End If
    
    iStufe = 5
    
    lLfdNr = 0
    
    cSQL = "Select max(LFDNR) as MAX_LFDNR from BONPAUSE"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!MAX_LFDNR) Then
            lLfdNr = rsrs!MAX_LFDNR
        End If
    End If
    lLfdNr = lLfdNr + 1
    rsrs.Close: Set rsrs = Nothing
    
    If gbPark Then
        'Ja drucken
        gdSumme = CDbl(Label2(6).Caption)
        If gbParknetto Then
            SendeDaten2DruckerParknetto lLfdNr
        Else
            SendeDaten2DruckerPark lLfdNr
        End If
        gdSumme = 0
    End If
    
    iStufe = 6
    
    cSQL = "Select * from BONPAUSE where LFDNR = -1"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    For lLbZeile = 0 To List1.ListCount - 1
        cLbText = List1.list(lLbZeile)
        
        sArtnr = Mid(cLbText, 7, 6)
        sArtnr = Trim$(sArtnr)
        
        rsrs.AddNew
        iStufe = 61
        rsrs!LFDNR = lLfdNr
        iStufe = 62
        rsrs!BEDNR = cBedNr
        iStufe = 63
        rsrs!ZSUM = cZSum
        iStufe = 64
        rsrs!GRABATT = cGRabatt
        iStufe = 65
        rsrs!KdName = Left(Trim(cKdName), 35)
        iStufe = 66
        rsrs!KdNr = cKdnr
        iStufe = 67
        rsrs!LBZEILE = lLbZeile
        iStufe = 68
        rsrs!lbtext = cLbText
        iStufe = 69
'        rsrs!art = cArt
        rsrs!ADATE = Fix(Now)
        rsrs!AZEIT = cZeitJetzt
        rsrs.Update
        
        If giFarbebeiPark > 0 And giFarbebeiPark < 20 Then
            cSQL = "Update ARTIKEL set AWM = " & giFarbebeiPark & " where Artnr = " & sArtnr
            gdBase.Execute cSQL, dbFailOnError
            
        End If
        
    Next lLbZeile
    rsrs.Close: Set rsrs = Nothing
    
    iStufe = 7
    'Alles gespeichert, nun Basiswerte und Dialog zurücksetzen
    
    Frame1.Visible = True
    
    If gbLeiste2Start = True Then
        Frame23.Visible = True
        Frame2.Visible = False
    Else
        Frame2.Visible = True
        Frame23.Visible = False
    End If
    
    Frame3.Visible = True
    Frame4.Visible = True
    Frame29.Visible = False
    Frame33.Visible = False
    
    iStufe = 8
    
    List1.Clear
    List3.Nodes.Clear
    Label41(1).Caption = 0
    Label2(6).Caption = "0,00"

    LeereDialogModul20
        
    gbNumTaste = True
    Text1(0).Text = gcBedienerNr
    gcKreditKarte = ""
    gcZahlMittel = ""
    
    iStufe = 10

    If gbBEDLEER = True Then
        Label1(8).Caption = ""
        Text1(0).SetFocus
        Text1(0).Text = ""
        indentmitKarte
    End If
    
    iStufe = 11
            
    InitKundenDisplayModul20

    
Exit Sub
LOKAL_ERROR:

    If err.Number = 5 And iStufe = 9 Then
        Resume Next
    ElseIf err.Number = 5 And iStufe = 10 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "KassierenUnterbrechenWKL20"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
        
        Fehlermeldung1
    End If
    
End Sub
Private Sub KassierenUnterbrechenWKL20_ArtAuswahl()
    On Error GoTo LOKAL_ERROR
    
    Dim rsrs        As Recordset
    
    Dim lLfdNr      As Long
    Dim lLbZeile    As Long
    
    Dim cSQL        As String
    Dim cBedNr      As String
    Dim cZSum       As String
    Dim cGRabatt    As String
    Dim cKdName     As String
    Dim cKdnr       As String
    Dim cLbText     As String
    Dim iRet        As Integer
    
    Dim iStufe      As Integer
    
    iStufe = 1
    If List1.ListCount = 0 Then
        MsgBox "Artikelauswahl nicht möglich: keine Positionen vorhanden!", vbCritical, "STOP"
        Text1(1).SetFocus
        Exit Sub
    End If
    If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
        MsgBox "Artikelauswahl nicht möglich: keine Bediener-Nr vorhanden!", vbCritical, "STOP"
        Text1(0).SetFocus
        Exit Sub
    Else
        iRet = fnLogonBedienerWKL20%()
        If iRet <> 0 Then
            Text1(0).SetFocus
            Exit Sub
        End If
    End If
    
    iStufe = 2
    
    cBedNr = Text1(0).Text
    cZSum = Label2(6).Caption
    
    If Label2(3).Visible = True Then
        cGRabatt = Label2(3).Caption
    Else
        cGRabatt = "0,00"
    End If
    
    iStufe = 3
    
    If Label1(7).Visible = True Then
        cKdName = Label1(7).Caption
    Else
        cKdName = ""
    End If
    
    iStufe = 4
    If Label2(7).Visible = True Then
        cKdnr = Label2(7).Caption
    Else
        cKdnr = ""
    End If
    
    iStufe = 5
    
    lLfdNr = 0
    
    cSQL = "Select max(LFDNR) as MAX_LFDNR from ARTAUSWAHL"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!MAX_LFDNR) Then
            lLfdNr = rsrs!MAX_LFDNR
        End If
    End If
    lLfdNr = lLfdNr + 1
    rsrs.Close: Set rsrs = Nothing
    
    If gbPark Then
        'Ja drucken
        gdSumme = CDbl(Label2(6).Caption)
        
        
        SendeDaten2Drucker_ArtAuswahl lLfdNr
       
        gdSumme = 0
    End If
    
    
    
    iStufe = 6
    
    cSQL = "Select * from ARTAUSWAHL where LFDNR = -1"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    For lLbZeile = 0 To List1.ListCount - 1
        cLbText = List1.list(lLbZeile)
        
        rsrs.AddNew
        iStufe = 61
        rsrs!LFDNR = lLfdNr
        iStufe = 62
        rsrs!BEDNR = cBedNr
        iStufe = 63
        rsrs!ZSUM = cZSum
        iStufe = 64
        rsrs!GRABATT = cGRabatt
        iStufe = 65
        rsrs!KdName = Left(Trim(cKdName), 35)
        iStufe = 66
        rsrs!KdNr = cKdnr
        iStufe = 67
        rsrs!LBZEILE = lLbZeile
        iStufe = 68
        rsrs!lbtext = cLbText
        iStufe = 69
'        rsrs!art = cART
        rsrs!ADATE = Fix(Now)
        rsrs.Update
        
    Next lLbZeile
    rsrs.Close: Set rsrs = Nothing
    
    iStufe = 7
    'Alles gespeichert, nun Basiswerte und Dialog zurücksetzen
    
    Frame1.Visible = True
    
    If gbLeiste2Start = True Then
        Frame23.Visible = True
        Frame2.Visible = False
    Else
        Frame2.Visible = True
        Frame23.Visible = False
    End If
    
    Frame3.Visible = True
    Frame4.Visible = True
    Frame29.Visible = False
    Frame33.Visible = False
    
    iStufe = 8
    
    List1.Clear
    List3.Nodes.Clear
    Label41(1).Caption = 0
    Label2(6).Caption = "0,00"

    LeereDialogModul20
        
    gbNumTaste = True
    Text1(0).Text = gcBedienerNr
    gcKreditKarte = ""
    gcZahlMittel = ""
    
    iStufe = 10

    If gbBEDLEER = True Then
        Label1(8).Caption = ""
        Text1(0).SetFocus
        Text1(0).Text = ""
        indentmitKarte
    End If
    
    iStufe = 11
            
    InitKundenDisplayModul20

    
Exit Sub
LOKAL_ERROR:

    If err.Number = 5 And iStufe = 9 Then
        Resume Next
    ElseIf err.Number = 5 And iStufe = 10 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "KassierenUnterbrechenWKL20_ArtAuswahl"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
        
        Fehlermeldung1
    End If
    
End Sub
Private Sub inBonstorno()
    On Error GoTo LOKAL_ERROR
    
    Dim rsrs        As Recordset
    
    Dim lLfdNr      As Long
    Dim lLbZeile    As Long
    
    Dim cSQL        As String
    Dim cBedNr      As String
    Dim cZSum       As String
    Dim cGRabatt    As String
    Dim cKdName     As String
    Dim cKdnr       As String
    Dim cLbText     As String
    Dim iRet        As Integer
    
    Dim iStufe      As Integer
    
    iStufe = 1
    If List1.ListCount = 0 Then
        MsgBox "Kassiervorgang unterbrechen nicht möglich: keine Positionen vorhanden!", vbCritical, "STOP"
        Text1(1).SetFocus
        Exit Sub
    End If
    If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
        MsgBox "Kassiervorgang unterbrechen nicht möglich: keine Bediener-Nr vorhanden!", vbCritical, "STOP"
        Text1(0).SetFocus
        Exit Sub
    Else
        iRet = fnLogonBedienerWKL20%()
        If iRet <> 0 Then
            Text1(0).SetFocus
            Exit Sub
        End If
    End If
    
    iStufe = 2
    
    cBedNr = Text1(0).Text
    
    cZSum = Label2(6).Caption
    
    If Label2(3).Visible = True Then
        cGRabatt = Label2(3).Caption
    Else
        cGRabatt = "0,00"
    End If
    
    iStufe = 3
    
    If Label1(7).Visible = True Then
        cKdName = Label1(7).Caption
    Else
        cKdName = ""
    End If
    
    iStufe = 4
    If Label2(7).Visible = True Then
        cKdnr = Label2(7).Caption
    Else
        cKdnr = ""
    End If
    
    iStufe = 5
    
    lLfdNr = 0
    
    cSQL = "Select max(LFDNR) as MAX_LFDNR from BONSTORNO"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!MAX_LFDNR) Then
            lLfdNr = rsrs!MAX_LFDNR
        End If
    End If
    lLfdNr = lLfdNr + 1
    rsrs.Close: Set rsrs = Nothing
    
    iStufe = 6
    
    cSQL = "Select * from BONSTORNO where LFDNR = -1"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    For lLbZeile = 0 To List1.ListCount - 1
        cLbText = List1.list(lLbZeile)
        
        rsrs.AddNew
        iStufe = 61
        rsrs!LFDNR = lLfdNr
        iStufe = 62
        rsrs!BEDNR = cBedNr
        iStufe = 63
        rsrs!ZSUM = cZSum
        iStufe = 64
        rsrs!GRABATT = cGRabatt
        iStufe = 65
        rsrs!KdName = cKdName
        iStufe = 66
        rsrs!KdNr = cKdnr
        iStufe = 67
        rsrs!LBZEILE = lLbZeile
        iStufe = 68
        rsrs!lbtext = cLbText
        iStufe = 69
        rsrs.Update
        
    Next lLbZeile
    rsrs.Close: Set rsrs = Nothing
    
    iStufe = 7
    'Alles gespeichert, nun Basiswerte und Dialog zurücksetzen
    
    Frame1.Visible = True
    If gbLeiste2Start = True Then
        Frame23.Visible = True
        Frame2.Visible = False
    Else
        Frame2.Visible = True
        Frame23.Visible = False
    End If
    Frame3.Visible = True
    Frame4.Visible = True
    Frame29.Visible = False
    Frame23.Visible = False
    Frame33.Visible = False
    
    iStufe = 8
    
    List1.Clear
    List3.Nodes.Clear
    Label41(1).Caption = 0
    Label2(6).Caption = "0,00"

    LeereDialogModul20
        
    gbNumTaste = True
    Text1(0).Text = gcBedienerNr
    Text1(1).SetFocus
    gcKreditKarte = ""
    gcZahlMittel = ""
    
    iStufe = 10

    If gbBEDLEER = True Then
        Label1(8).Caption = ""
        Text1(0).SetFocus
        Text1(0).Text = ""
        indentmitKarte
    End If
    
    iStufe = 11
            
    InitKundenDisplayModul20

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "inBonstorno"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
    
    Fehlermeldung1
    
End Sub
'Private Sub KorrigiereVKMengeWKL20()
'    On Error GoTo LOKAL_ERROR
'
'    Dim cLBSatz         As String
'    Dim cMenge          As String
'    Dim cArtNr          As String
'
'    Dim lAnzSatz        As Long
'    Dim lAktSatz        As Long
'    Dim lVkMenge        As Long
'    Dim sSQL            As String
'
'    Dim rsrs            As Recordset
'
'    lAnzSatz = List1.ListCount
'
'    For lAktSatz = 0 To lAnzSatz - 1
'        cLBSatz = List1.list(lAktSatz)
'        cMenge = Left(cLBSatz, 5)
'        cMenge = Trim(cMenge)
'
'        cArtNr = Mid(cLBSatz, 7, 6)
'        cArtNr = Trim$(cArtNr)
'
'        sSQL = "Select * from Artikel where artnr = " & cArtNr
''        FnOpenrecordset rsrs, sSQL, 2, gdBase
'        FnOpenrecordset rsrs, sSQL, 1, gdBase
'
'        If Not rsrs.EOF Then
'            If Not IsNull(rsrs!VKMENGE) Then
'                lVkMenge = rsrs!VKMENGE
'            Else
'                lVkMenge = 0
'            End If
'
'            lVkMenge = lVkMenge - Val(cMenge)
'
'            rsrs.Edit
'            rsrs!VKMENGE = lVkMenge
'            rsrs.Update
'        End If
'        rsrs.Close: Set rsrs = Nothing
'    Next lAktSatz
'
'Exit Sub
'LOKAL_ERROR:
'    Fehler.gsDescr = err.Description
'    Fehler.gsNumber = err.Number
'    Fehler.gsFormular = Me.name
'    Fehler.gsFunktion = "KorrigiereVKMengeWKL20"
'    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
'
'    Fehlermeldung1
'End Sub
Private Sub LeseDatenECLastschriftWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim cDatum      As String
    Dim czeit       As String
    Dim cBedNr      As String
    Dim cZeile      As String
    
    cDatum = Format$(Now, "DD.MM.YYYY")
    czeit = Format$(Now, "HH:MM")
    cBedNr = Text1(0).Text
    
    cZeile = cDatum & " " & czeit & "   " & cBedNr
    
    List11.Clear
    
    List11.AddItem "Lastschriftbeleg Nr. " & gECKarte.LastSchriftNr
    List11.AddItem cZeile
    List11.AddItem " "
    List11.AddItem "Hiermit ermächtige ich"
    List11.AddItem " "
    List11.AddItem gFirma.FirmaName
    List11.AddItem gFirma.strasse
    List11.AddItem gFirma.Plz & " " & gFirma.Ort
    List11.AddItem " "
    List11.AddItem "zum Einzug von " & Label11(3).Caption
    List11.AddItem "von meinem Konto " & gECKarte.Konto1
    List11.AddItem "BANKLEITZAHL " & gECKarte.BLZ
    List11.AddItem "(" & gECKarte.BankName
    List11.AddItem " in " & gECKarte.BankOrt & ")"
    List11.AddItem " "
    List11.AddItem "Für den Fall der Nichteinlösung"
    List11.AddItem "weise ich meine Bank"
    List11.AddItem "unwiderruflich an, "
    List11.AddItem gFirma.FirmaName
    List11.AddItem "auf Anforderung meinen Namen"
    List11.AddItem "und meine Anschrift vollständig"
    List11.AddItem "mitzuteilen. Insofern soll"
    List11.AddItem gFirma.FirmaName
    List11.AddItem "ein eigener Anspruch zustehen."
    List11.AddItem "Wichtig! Bei Nichteinlösung des"
    List11.AddItem "Kaufbetrages fallen Bearbeitungs-"
    List11.AddItem "und Bankgebühren in Höhe von"
    List11.AddItem "30,- Euro an, diese sind von mir"
    List11.AddItem "zu tragen."
    List11.AddItem " "
    
    '***neu
    
    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
    
        List11.AddItem "KundenNr: " & frmWKL20!Label2(7).Caption
        List11.AddItem Left(lookingForKundendaten(Trim(frmWKL20!Label2(7).Caption)).vorname, 32)
        List11.AddItem Left(lookingForKundendaten(Trim(frmWKL20!Label2(7).Caption)).nachname, 32)
        List11.AddItem Left(lookingForKundendaten(Trim(frmWKL20!Label2(7).Caption)).strasse, 32)
        List11.AddItem Left(lookingForKundendaten(Trim(frmWKL20!Label2(7).Caption)).Plz & " " & lookingForKundendaten(Trim(Label2(7).Caption)).Ort, 32)
        List11.AddItem " "
    Else
    
        List11.AddItem "--------------------------------"
        List11.AddItem " "
        List11.AddItem "Name/Vorname:"
        List11.AddItem " "
        List11.AddItem " "
        List11.AddItem " "
        List11.AddItem "Straße:"
        List11.AddItem " "
        List11.AddItem " "
        List11.AddItem " "
        List11.AddItem "Plz/Ort:"
        List11.AddItem " "
        List11.AddItem " "
        List11.AddItem " "
        
    End If
    
    'neu Ende
    
    
    List11.AddItem "Unterschrift des Kontoinhabers"

    List11.AddItem " "
    List11.AddItem " "
    List11.AddItem " "
    List11.AddItem " "
    Label11(0).Visible = False
    Label11(4).Caption = "Kunde / Kontoinhaber: " & gECKarte.KontoInhaber
    Label11(4).Visible = True
    
    Label13(0).Visible = True
    Label13(1).Visible = True
    Label13(2).Visible = True
    
    Command10(0).Enabled = True
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "LeseDatenECLastschriftWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub LeseWarengruppenWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim rsrs        As Recordset
    Dim lWgNr       As Long
    Dim dArtNr      As Long
    Dim cSQL        As String
    Dim cBezeich    As String
    Dim cFaktor     As String
    Dim cSG         As String
    Dim CBildname   As String
    Dim cPfad       As String
    Dim i           As Integer
    
    cPfad = gcDBPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    If FileExists(cPfad & "nichtbel.jpg") Then
        For i = 18 To 29
            Set Command1(i).Picture = LoadPicture(cPfad & "nichtbel.jpg")
            Command1(i).Caption = ""
            Command1(i).PictureAlign = PictureCenter
        Next i
    End If
                   
    
    cSQL = "Select * from WARENGRU where wgnr < 13 order by WGNR "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!WGNR) Then
                lWgNr = rsrs!WGNR
            Else
                lWgNr = -1
            End If
            
            If Not IsNull(rsrs!artnr) Then
                dArtNr = rsrs!artnr
            Else
                dArtNr = -1
            End If
            
            If Not IsNull(rsrs!BEZEICH) Then
                cBezeich = rsrs!BEZEICH
            Else
                cBezeich = ""
            End If
            
            If Not IsNull(rsrs!Faktor) Then
                cFaktor = rsrs!Faktor
            Else
                cFaktor = "+"
            End If
            
            If Not IsNull(rsrs!SGROESSE) Then
                cSG = rsrs!SGROESSE
            Else
                cSG = "14"
            End If
            
            If Not IsNull(rsrs!BNAME) Then
                CBildname = rsrs!BNAME
            Else
                CBildname = ""
            End If
            
            gWarenGruppe(lWgNr + 17).dArtNr = dArtNr
            If cBezeich <> "" Then
                gWarenGruppe(lWgNr + 17).cBezeich = cBezeich
            End If
            gWarenGruppe(lWgNr + 17).cFaktor = cFaktor
            
            If CBildname <> "" Then
                If Modul6.FindFile(cPfad & "Picture", CBildname) Then
                    Set Command1(lWgNr + 17).Picture = LoadPicture(cPfad & "Picture/" & CBildname)
                    Command1(lWgNr + 17).Caption = ""
                Else
                    Command1(lWgNr + 17).PictureVisible = False
                    Command1(lWgNr + 17).Caption = gWarenGruppe(lWgNr + 17).cBezeich
                    Command1(lWgNr + 17).FontSize = cSG
                End If
            Else
                Command1(lWgNr + 17).PictureVisible = False
                Command1(lWgNr + 17).Caption = gWarenGruppe(lWgNr + 17).cBezeich
                Command1(lWgNr + 17).FontSize = cSG
                
            End If
            
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "LeseWarengruppenWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub LeseWarengruppenWKL20T2()
    On Error GoTo LOKAL_ERROR
    
    Dim rsrs        As Recordset
    
    Dim lWgNr       As Long
    Dim dArtNr      As Long
    
    Dim cSQL        As String
    Dim cBezeich    As String
    Dim cFaktor     As String
    Dim cSG         As String
    Dim CBildname   As String
    Dim cPfad       As String
    Dim i           As Integer
    
    cPfad = gcDBPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    If FileExists(cPfad & "nichtbel.jpg") Then
        For i = 120 To 171
            Set Command1(i).Picture = LoadPicture(cPfad & "nichtbel.jpg")
            Command1(i).Caption = ""
            Command1(i).PictureAlign = PictureCenter
        Next i
    End If
    
    cSQL = "Select * from WARENGRU where wgnr > 12 order by WGNR "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!WGNR) Then
                lWgNr = rsrs!WGNR
            Else
                lWgNr = -1
            End If
            
            If Not IsNull(rsrs!artnr) Then
                dArtNr = rsrs!artnr
            Else
                dArtNr = -1
            End If
            
            If Not IsNull(rsrs!BEZEICH) Then
                cBezeich = rsrs!BEZEICH
            Else
                cBezeich = ""
            End If
            
            If Not IsNull(rsrs!Faktor) Then
                cFaktor = rsrs!Faktor
            Else
                cFaktor = "+"
            End If
            
            If Not IsNull(rsrs!SGROESSE) Then
                cSG = rsrs!SGROESSE
            Else
                cSG = "14"
            End If
            If cSG = "" Then cSG = "14"
            
            If Not IsNull(rsrs!BNAME) Then
                CBildname = rsrs!BNAME
            Else
                CBildname = ""
            End If
            
            gWarenGruppe(lWgNr + 107).dArtNr = dArtNr
            If cBezeich <> "" Then
                gWarenGruppe(lWgNr + 107).cBezeich = cBezeich
            End If
            gWarenGruppe(lWgNr + 107).cFaktor = cFaktor
            
            If CBildname <> "" Then
                If Modul6.FindFile(cPfad & "Picture", CBildname) Then
                
                Set Command1(lWgNr + 107).Picture = LoadPicture(cPfad & "Picture/" & CBildname)
                Command1(lWgNr + 107).Caption = ""
                Else
                    
                    Command1(lWgNr + 107).PictureVisible = False
                    Command1(lWgNr + 107).Caption = gWarenGruppe(lWgNr + 107).cBezeich
                    Command1(lWgNr + 107).FontSize = cSG
                End If
            Else
                Command1(lWgNr + 107).PictureVisible = False
                Command1(lWgNr + 107).Caption = gWarenGruppe(lWgNr + 107).cBezeich
                Command1(lWgNr + 107).FontSize = cSG
            End If
            
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "LeseWarengruppenWKL20T2"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub MoveGutschein2ListboxWKL20(dWert As Double, cBezeich As String, bUmsatzSofort As Boolean)
    On Error GoTo LOKAL_ERROR
    
    Dim dEinzelpreis    As Double
    Dim dGesamtPreis    As Double
    Dim dVerkaufsPreis  As Double
    Dim dMenge          As Double
    Dim dRestMenge      As Double
    Dim dMWStV          As Double
    Dim dMWStE          As Double
    
    Dim cFeld           As String
    Dim cLBSatz         As String
    Dim cMWStKz         As String
    Dim cArtNr          As String
    
    Dim bDebug          As Boolean
    
    If List1.ListCount = 0 Then
    
        'nur Anzeige
        HoleNeueBonNrWKL20
        
        Label18.Caption = gdBonNr
        Label18.Refresh
        
    End If
    
    If bUmsatzSofort = True Then
        cMWStKz = "V"
    Else
        cMWStKz = "O"
    End If

    dEinzelpreis = dWert
    dGesamtPreis = dEinzelpreis
    
    'MENGE
    dMenge = 1
    cFeld = Format$(dMenge, "####0")
    cFeld = Space$(5 - Len(cFeld)) & cFeld
    cLBSatz = cFeld & " "
    
    'ARTIKELNUMMER
    cArtNr = "666666"
    cFeld = cArtNr
    cFeld = Space$(6 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    'ARTIKELBEZEICHNUNG
    cFeld = cBezeich
    cFeld = cFeld & Space$(35 - Len(cFeld))
    cLBSatz = cLBSatz & cFeld & " "
    
    'EINZELPREIS NACH RABATT
    cFeld = Format$(dEinzelpreis, "#####0.00")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    'GESAMTPREIS AUS EINZELPREIS x MENGE
    cFeld = Format$(dGesamtPreis, "#####0.00")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & "   "
    
    'MWST-KENNZEICHEN
    cFeld = cMWStKz
    cLBSatz = cLBSatz & cFeld & " "
            
    'LISTENPREIS bzw. SONDERPREIS
    cFeld = Format$(dEinzelpreis, "#####0.00")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
            
    'ERMAESSIGNUNGSBETRAG BEI ARTIKELRABATT
    cFeld = "0,00"
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    'ERZIELTER VERKAUFSPREIS
    dVerkaufsPreis = dGesamtPreis
    cFeld = Format$(dVerkaufsPreis, "#####0.00")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    'BETRAG VOLLE MWST
    If cMWStKz = "V" Then
        dMWStV = dGesamtPreis * (gdMWStV / 100)
    Else
        dMWStV = 0
    End If
    cFeld = Format$(dMWStV, "#####0.00")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    'BETRAG ERMÄSSIGTE MWST
    If cMWStKz = "E" Then
        dMWStE = dGesamtPreis * (gdMWStE / 100)
    Else
        dMWStE = 0
    End If
    cFeld = Format$(dMWStE, "#####0.00")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    'ARTIKELRABATT IN PROZENT
    cFeld = "0"
    cFeld = Space$(3 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    'VERKAUFSPREIS LAUT ARTIKELDATEI
    cFeld = Format$(dEinzelpreis, "#####0.00")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    '4.Gutschein Nur Plus
    dRestMenge = fnAktualisiereBestandWKL20(cArtNr, dMenge, 4)
    
    cFeld = Format$(dRestMenge, "########0")
    cFeld = Space$(9 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    cFeld = Text1(0).Text
    cFeld = Trim$(cFeld)
    cFeld = Space$(3 - Len(cFeld)) & cFeld
    cLBSatz = cLBSatz & cFeld & " "
    
    cLBSatz = cLBSatz & "J"
    
    List1.AddItem cLBSatz
    List3.Nodes.Add Text:=Left(cLBSatz, 68)
    
    gbAutomaticClick = True
    List1.Selected(List1.ListCount - 1) = True
    
    If bDebug Then
        MsgBox Len(cLBSatz) & vbCrLf & cLBSatz
        MsgBox "Menge = " & Mid(cLBSatz, 1, 5)
        MsgBox "ArtNr = " & Mid(cLBSatz, 7, 6)
        MsgBox "Bezeich = " & Mid(cLBSatz, 14, 35)
        MsgBox "EPreis nach Rabatt = " & Mid(cLBSatz, 50, 9)
        MsgBox "GPreis = " & Mid(cLBSatz, 60, 9)
        MsgBox "MWST-Kz = " & Mid(cLBSatz, 72, 1)
        MsgBox "Listenpreis/Sonderpreis = " & Mid(cLBSatz, 74, 9)
        MsgBox "Betrag ArtRabatt = " & Mid(cLBSatz, 84, 9)
        MsgBox "erzielter VK-Preis = " & Mid(cLBSatz, 94, 9)
        MsgBox "Betrag volle MWST = " & Mid(cLBSatz, 104, 9)
        MsgBox "Betrag erm. MWST = " & Mid(cLBSatz, 114, 9)
        MsgBox "ArtRabatt % = " & Mid(cLBSatz, 124, 3)
        MsgBox "Listen-VK = " & Mid(cLBSatz, 128, 9)
        MsgBox "Restmenge = " & Mid(cLBSatz, 138, 9)
    End If
    
    BerechneZwischenSummeWKL20
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MoveGutschein2ListboxWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub OeffneSchubladeExplizitWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim dAktZeit        As Double
    Dim dNeuZeit        As Double
    
    Dim lRet            As Long
    Dim lDatum          As Long
    
    Dim cSQL            As String
    Dim aDeviceName     As String
    Dim cEscapeSequenz  As String
    
    Dim rsrs            As Recordset
    
'    setzedrucker gcBonDrucker
    lDatum = Fix(Now)                   'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    
    If gbLadeCom Then
        OpenDrawerViaComPortModul20
    Else
    
        If gbAPI = False Then
            dAktZeit = Time
            lRet = Shell("Command.com /C " & gcPfad & "LADE.EXE", 6)
            dNeuZeit = Time
            Do While dNeuZeit - dAktZeit < (2 / 86400)
                dNeuZeit = Time
            Loop
        Else
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcLade
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
        
    End If
    cSQL = "Select ADATE, KASNUM, GELDFACH from AFCSTAT where ADATE = " & Trim$(Str$(lDatum)) & " and KASNUM = " & gcKasNum & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If rsrs.EOF Then
        rsrs.AddNew
    Else
        rsrs.Edit
    End If
    
    'Datum und Kassennummer setzen
    rsrs!ADATE = lDatum
    rsrs!kasnum = Val(gcKasNum)
    
    If IsNull(rsrs!GELDFACH) = True Then
        rsrs!GELDFACH = 1
    Else
        rsrs!GELDFACH = rsrs!GELDFACH + 1
    End If
    
    rsrs.Update
    rsrs.Close: Set rsrs = Nothing

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "OeffneSchubladeExplizitWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SchalteCommand1WKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim iFileNr     As Integer
    Dim iIndex      As Integer
    
    Dim cWerte      As String
    Dim cIndex      As String
    
    Dim lPos        As Long
    Dim lStart      As Long
    
    iFileNr = FreeFile
    Open gcPfad & "BUTTONS.CFG" For Binary As #iFileNr
    If LOF(iFileNr) = 0 Then
        Close iFileNr
        Kill gcPfad & "BUTTONS.CFG"
    Else
        cWerte = Space$(LOF(iFileNr))
        Get #iFileNr, 1, cWerte
        Close iFileNr
        lStart = 1
        Do While lStart < Len(cWerte)
            lPos = InStr(lStart, cWerte, vbCrLf)
            If lPos <> 0 Then
                cIndex = Mid(cWerte, lStart, lPos - lStart)
                If cIndex = "" Then
                    Exit Do
                End If
                iIndex = Val(cIndex)
                Command1(iIndex).Enabled = False
                lStart = lPos + 2
            Else
                lStart = Len(cWerte) + 1
            End If
        Loop
    End If
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SchalteCommand1WKL20"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
        
    End If
End Sub
Private Sub SchreibeDaten2KreditWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL        As String
    Dim cLBSatz     As String
    Dim ctmp        As String
    Dim iPreisKz    As String
    Dim fMehrfach() As String
    
    Dim rsrs        As Recordset
    
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long
    
    Dim dWert       As Double
    Dim iAdressID   As Integer
    Dim cAdressID   As String
    
    Dim sFirma      As String
    Dim sAnrede     As String
    Dim sName       As String
    Dim sVorname    As String
    Dim sStrasse    As String
    Dim sPlz        As String
    Dim sOrt        As String
    Dim sTitel      As String
    
    Randomize
    If Check2.value = vbChecked Then
        
        iAdressID = Int((999 * Rnd) + 1)   ' Zufallszahl im Bereich von 1 bis 999
        cAdressID = gcFilNr & CStr(iAdressID)
        iAdressID = CInt(cAdressID)
        
        sFirma = Text2(5).Text
        sAnrede = Text2(6).Text
        sName = Text2(0).Text
        sVorname = Text2(1).Text
        sStrasse = Text2(2).Text
        sPlz = Text2(3).Text
        sOrt = Text2(4).Text
        sTitel = Text2(7).Text
        
        cSQL = "Insert into ZAdress (AdressID,Firma,Anrede,Name,Vorname,Strasse,Plz,Ort,Titel) values (" & iAdressID & " , '" & sFirma & "','" & sAnrede & "','" & sName & "','" & sVorname & "','" & sStrasse & "','" & sPlz & "','" & sOrt & "','" & sTitel & "')"
        gdBase.Execute cSQL, dbFailOnError
    End If
    
    ctmp = Label2(7).Caption
    ctmp = Trim$(ctmp)
    
    iPreisKz = 0
    cSQL = "Select PREISKZ from KUNDEN where KUNDNR = " & ctmp & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!PREISKZ) Then
            iPreisKz = rsrs!PREISKZ
        End If
    End If
    rsrs.Close: Set rsrs = Nothing   'Änderung 151205
    
    
    lAnzSatz = List1.ListCount
    
    Dim sSQL        As String
    Dim lartnr      As Long
    Dim iMenge      As Long
    Dim ekpr        As Single
    Dim vkpr        As Single
    Dim lKUNDNR     As Long
    Dim cMWST       As String
    Dim cBezeich    As String
    Dim GVKPR       As Single
    Dim AVKPR       As Single
    
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        ctmp = Mid(cLBSatz, 7, 6)
        ctmp = Trim$(ctmp)
        lartnr = Val(ctmp)
        
        
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If
        
        
        ctmp = Trim$(ctmp)
        iMenge = Val(ctmp)
        
        ekpr = 0
        
        ctmp = Mid(cLBSatz, 50, 9)
        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        vkpr = Val(ctmp)
        
        ctmp = Label2(7).Caption
        ctmp = Trim$(ctmp)
        lKUNDNR = Val(ctmp)
          
        ctmp = Mid(cLBSatz, 72, 1)
        cMWST = Trim$(ctmp)
        
        ctmp = Mid(cLBSatz, 14, 35)
        cBezeich = Trim$(ctmp)
       
        
        ctmp = Mid(cLBSatz, 60, 9)
        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        GVKPR = Val(ctmp)
        
        ctmp = Mid(cLBSatz, 74, 9)
        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        AVKPR = Val(ctmp)
        
        sSQL = "Insert into KREDIT "
        sSQL = sSQL & " ( FLAG,ARTNR,MENGE,ekpr,vkpr,KUNDNR,MWST,BEZEICH,GVKPR,ADATE,AVKPR,PREISKZ"
        If Check2.value = vbChecked Then
            sSQL = sSQL & " ,AdressID "
        End If
        sSQL = sSQL & " )"
        
        sSQL = sSQL & " values "
        sSQL = sSQL & " ( " & lAktSatz & "," & lartnr
        sSQL = sSQL & " , " & iMenge
        sSQL = sSQL & " , '" & ekpr & "'"
        sSQL = sSQL & " , '" & vkpr & "'"
        sSQL = sSQL & " , " & lKUNDNR
        sSQL = sSQL & " , '" & cMWST & "'"
        sSQL = sSQL & " , '" & cBezeich & "'"
        sSQL = sSQL & " , '" & GVKPR & "'"
        sSQL = sSQL & " , " & CLng(DateValue(Now))
        sSQL = sSQL & " , '" & AVKPR & "'"
        sSQL = sSQL & " , " & iPreisKz
        If Check2.value = vbChecked Then
            sSQL = sSQL & " , " & iAdressID
        End If
        sSQL = sSQL & ")"
        gdBase.Execute sSQL, dbFailOnError
        
        
    Next lAktSatz
   
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SchreibeDaten2KreditWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    Resume Next
End Sub
Private Function fnSchreibeDTADatenWKL20() As Integer
    On Error GoTo LOKAL_ERROR
    
    
    Dim lAnzSatz        As Long
    Dim lDatum          As Long
    Dim cSQL            As String
    Dim cEmpfaenger     As String
    Dim cText           As String
    Dim cUhrZeit        As String
    Dim dBetrag         As Double
    Dim rsrs            As Recordset
    
    fnSchreibeDTADatenWKL20 = 0
    
    lDatum = Fix(Now)
    cUhrZeit = Format$(Now, "HH:MM:SS")
    
    cText = Label11(3).Caption
    cText = fnMoveComma2Point$(cText)
    dBetrag = Val(cText)
    cText = ""
    
    cSQL = "Select count(*) as ANZ_SATZ from DTA"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!ANZ_SATZ) Then
            lAnzSatz = rsrs!ANZ_SATZ
        Else
            lAnzSatz = 0
        End If
    Else
        lAnzSatz = 0
    End If
    rsrs.Close: Set rsrs = Nothing
    
    lAnzSatz = lAnzSatz + 1
    
    cSQL = "Select * from DTA where BELEGNR = -1"
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    rsrs.AddNew
    rsrs!Empfaenger = "EC-KARTE"
    rsrs!Betrag = dBetrag
    rsrs!TextA = "5"
    rsrs!BLZ = gECKarte.BLZ
    rsrs!EKONTO = gECKarte.Konto1
    rsrs!BELEGNR = lAnzSatz
    rsrs!Datum = lDatum
    rsrs!Uhrzeit = cUhrZeit
    rsrs!SENDOK = False
    rsrs!FILIALE = CInt(gcFilNr)
    rsrs!zweck1 = gdBonNr
    rsrs.Update
    
    rsrs.Close: Set rsrs = Nothing

    cSQL = "Select * from DTA where BELEGNR = " & Trim$(Str$(lAnzSatz)) 'Lesen, ob Satz wirklich angekommen
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If rsrs.EOF Then
        fnSchreibeDTADatenWKL20 = 1
    End If
    rsrs.Close: Set rsrs = Nothing
        
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SchreibeDTADatenWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub Drucke_Preisänderungsbon(bEinmalig As Boolean, sAlterPreis As String, sNeuerPreis As String, sArtnr As String, sBediener As String)
On Error GoTo LOKAL_ERROR

    Dim cDatum      As String
    Dim czeit       As String
    ReDim cZeilen(0 To 40) As String
    Dim rsrs        As DAO.Recordset
    Dim iZeilenZahl As Integer
    Dim cBez        As String
    Dim sArt        As String
    Dim iÜberlänge  As Integer
    Dim sSQL        As String
    
    iZeilenZahl = 0
    cZeilen(iZeilenZahl) = "Preisänderung wurde vorgenommen!"
    
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "--------------------------------"
    
    iZeilenZahl = iZeilenZahl + 1
    
    If Len(sBediener) > 25 Then
        cZeilen(iZeilenZahl) = Left(cBez, 25)
    Else
        cZeilen(iZeilenZahl) = cBez
    End If
    
    cZeilen(iZeilenZahl) = "durch: " & sBediener
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "Artikel: " & sArtnr
    cBez = fnArtBezSuchen(sArtnr)
    
    iZeilenZahl = iZeilenZahl + 1
    If Len(cBez) > 32 Then
        cZeilen(iZeilenZahl) = Left(cBez, 32)
    Else
        cZeilen(iZeilenZahl) = cBez
    End If
    
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "alter Preis: " & Format(sAlterPreis, "#####0.00")
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "neuer Preis: " & Format(sNeuerPreis, "#####0.00")
    
    If bEinmalig Then
        iZeilenZahl = iZeilenZahl + 1
        sArt = "Nur für diesen Kaufvorgang"
        cZeilen(iZeilenZahl) = sArt
    Else
        iZeilenZahl = iZeilenZahl + 1
        sArt = "Preisveränderung: dauerhaft"
        cZeilen(iZeilenZahl) = sArt
    End If
    
    cDatum = DateValue(Now)
    czeit = TimeValue(Now)
    
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = Space(32)
    
'    cZeilen(iZeilenZahl) = "--------------------------------"
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "Die gesamte Auswertung aller "
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "Preisänderungen können Sie unter"
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "Kasse/Protokolle/allgemeine "
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "Kassenvorgänge einsehen."
    
    iZeilenZahl = iZeilenZahl + 1
    cZeilen(iZeilenZahl) = "Datum/Zeit: " & Format(cDatum, "DD.MM.YY") & "    " & czeit
    
    
    
    sSQL = "Insert into PREISEDITKASSE (ARTNR,BEZEICH,ADATE,AZEIT,FILIALE,SENDOK,ALTERPREIS,NEUERPREIS,BEDNAME,ART) "
    sSQL = sSQL & " values (" & sArtnr & ""
    sSQL = sSQL & ", '" & cBez & "'"
    sSQL = sSQL & ", '" & cDatum & "'"
    sSQL = sSQL & ", '" & czeit & "'"
    sSQL = sSQL & "," & CByte(gcFilNr) & ""
    sSQL = sSQL & ",False "
    sSQL = sSQL & ", '" & sAlterPreis & "'"
    sSQL = sSQL & ", '" & sNeuerPreis & "'"
    sSQL = sSQL & ", '" & sBediener & "'"
    sSQL = sSQL & ", '" & sArt & "'"
    sSQL = sSQL & " )"
    gdBase.Execute sSQL, dbFailOnError

    If gbNoBonPÄ = False Then
        'Drucke den Beleg
        DruckeNeuenPreisBelegWK20d cZeilen(), iZeilenZahl
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Drucke_Preisänderungsbon"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SchreibeNeuenPreisWKL20(cNeuerPreis As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lAnz        As Long
    Dim ctmp        As String
    Dim cMWST       As String
    Dim cLBSatz     As String
    Dim dWert       As Double
    Dim dSumme      As Double
    Dim cNeuerP     As String
    Dim cMopreis    As String
    Dim iDiff       As Integer
    Dim lNeuBest    As Long
    Dim cBonusOk    As String
    Dim cUmsOK      As String
    
    If InStr(cNeuerPreis, ",") = 0 Then
        cNeuerPreis = "00" & cNeuerPreis
        cNeuerPreis = Left(cNeuerPreis, Len(cNeuerPreis) - 2) & "," & Right(cNeuerPreis, 2)
    End If
    
    cMWST = Label17(8).Caption
    
    ctmp = fnMoveComma2Point(cNeuerPreis)
    cNeuerP = ctmp
    dWert = Val(ctmp)
    
    ctmp = Format$(dWert, "#####0.00")
    Text8(0).Text = ctmp
    
    Label17(3).Caption = Format$(dWert, "#####0.000")
    Label17(5).Caption = ctmp
    
    lAnz = Val(Text8(6).Text)
    If lAnz <> iMerkBestPosi Then
        iDiff = lAnz - iMerkBestPosi
        
        lNeuBest = ermBESTAND(Label17(0).Caption)
        lNeuBest = lNeuBest - iDiff
        
        If iDiff < 0 Then
            Bestandsveraenderung Label17(0).Caption, lNeuBest, "Rücknahme Kasse C"
            ABinBESTAKT Label17(0).Caption, CLng(iDiff * -1), "Rücknahme Kasse C"
        Else
            Bestandsveraenderung Label17(0).Caption, lNeuBest, "Kassiervorgang"
            ABinBESTAKT Label17(0).Caption, CLng(iDiff * -1), "Kassiervorgang"
        End If
    End If
    dSumme = dWert * lAnz
    ctmp = Format$(dSumme, "#####0.00")
    Label17(4).Caption = ctmp
    Label17(9).Caption = ctmp
    
    Label17(6).Caption = "0"
    Label17(7).Caption = "0,00"
    
    Select Case cMWST
        Case Is = "V"
            dWert = dSumme * (gdMWStV / 100)
            ctmp = Format$(dWert, "#####0.00")
            Label17(10).Caption = ctmp
            Label17(11).Caption = "0,00"
        Case Is = "E"
            dWert = dSumme * (gdMWStE / 100)
            ctmp = Format$(dWert, "#####0.00")
            Label17(11).Caption = ctmp
            Label17(10).Caption = "0,00"
        Case Is = "O"
            Label17(10).Caption = "0,00"
            Label17(11).Caption = "0,00"
    End Select
    
    'Jetzt den neuen Listbox-Satz bauen
    cLBSatz = ""
    
    ctmp = Text8(6).Text
    ctmp = Trim$(ctmp)
    ctmp = Space$(5 - Len(ctmp)) & ctmp
    cLBSatz = ctmp
    
    If Label17(15).Caption = "0" Then
        If Text8(5).Text = "p" Then
            cLBSatz = cLBSatz & "p"
        Else
            cLBSatz = cLBSatz & " "
        End If
    Else
        If Text8(5).Text = "p" Then
            cLBSatz = cLBSatz & "p"
        Else
            cLBSatz = cLBSatz & "*"
        End If
    End If
    
    ctmp = Label17(0).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(6 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    If ctmp = "666666" Then
        updateGutsch cNeuerP
    End If
    
    ctmp = Text4.Text
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(35 - Len(ctmp))
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(3).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(4).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & "   "
    
    ctmp = Label17(8).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(1 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(5).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(7).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(9).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(10).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(11).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(6).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(3 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(12).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(13).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
'    ctmp = Label17(14).Caption
'    ctmp = Trim$(ctmp)
'    ctmp = Space$(3 - Len(ctmp)) & ctmp
'    cLBSatz = cLBSatz & ctmp & " "

    ctmp = Text8(10).Text
    ctmp = Trim$(ctmp)
    ctmp = Space$(3 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    ctmp = Label17(15).Caption
    ctmp = Trim$(ctmp)
    ctmp = Space$(1 - Len(ctmp)) & ctmp
    cLBSatz = cLBSatz & ctmp & " "
    
    
    cBonusOk = Trim(Label16(22).Caption)
    cUmsOK = Trim(Label16(31).Caption)
    
    If cBonusOk = "J" Then 'Hier die Frage nach spez Bonusregeln
        If gbKUBONUS_WENN = False Then
        
            If gsiKUBONUS_SCHWELLE > 0 Then
            
                'Nun, ist der kvk um x% kleiner als der LVK dann kein Bonus
                
                Dim dKVK_Boni As Double
                Dim dLVK_Boni As Double
                Dim dErg_Boni As Double
                
                dKVK_Boni = 0
                dLVK_Boni = 0
                
                dKVK_Boni = Text8(0).Text
            
                dLVK_Boni = ermVKPR(Label17(0).Caption)

                If dLVK_Boni > 0 Then
                    dErg_Boni = 100 - ((dKVK_Boni * 100) / dLVK_Boni)
                    If dErg_Boni >= gsiKUBONUS_SCHWELLE Then
                        cBonusOk = "N"
                    End If
                End If
            End If
        End If
    End If
    
    
    
    
    
    
    cBonusOk = Space$(1 - Len(cBonusOk)) & cBonusOk
    cLBSatz = cLBSatz & cBonusOk & " "
    
    'UMS_OK
    cLBSatz = cLBSatz & cUmsOK & " "
    
    
    
    lAnz = gindi ' List3.SelectedItem.Index
    gindi = 0
    
    
    List1.RemoveItem lAnz - 1
    
    'zum Schluss kommt dieses Besondere Merkmal an den Satz von Posi 176 8 stellen
    If Text8(4).Text <> "" Then
        ctmp = Trim$(Text8(4).Text)
        cLBSatz = cLBSatz & Space$(176 - Len(cLBSatz))
        cLBSatz = cLBSatz & ctmp
    End If
    
    
    
    List1.AddItem cLBSatz ', lanz - 1

    Dim lcount As Long

    List3.Nodes.Clear
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
    
        cLBSatz = ""
        cLBSatz = List1.list(lcount)
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
    
    Next lcount
    
    farbelist3
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SchreibeNeuenPreisWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
'    Resume Next
    
End Sub


Private Sub updateGutsch(cPreis As String)
    On Error GoTo LOKAL_ERROR
    
    Dim sTmp As String
    Dim sSQL As String
    
    sTmp = Label17(1).Caption
    sTmp = Trim$(sTmp)
    sTmp = Trim(Mid(sTmp, 11, Len(sTmp) - 9))
    
    sSQL = "Update Gutsch set Wert = " & cPreis
    sSQL = sSQL & " where gutschnr = " & sTmp
    schreibeProtokollDabaAblauf sSQL: gdBase.Execute sSQL, dbFailOnError

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "updateGutsch"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SetzeRetourArtikelWKL20(cRetourGrund As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lAnz        As Long
    Dim lcount      As Long
    Dim cLBSatz     As String
    Dim cErsatz     As String
    Dim sLEKPR      As String
    Dim sSUMLEKPR   As String
    Dim cArtNr      As String
    Dim lanz1       As Long
    Dim ctmp        As String
    
    If gbRETVK = True Then
        'bleibt alles beim VK
    Else
        'hier wird der VK mit dem EK ersetzt
        cErsatz = "     0,00"
        lAnz = List1.ListCount
        For lcount = 0 To lAnz - 1
            cLBSatz = List1.list(lcount)
            
            cArtNr = Mid(cLBSatz, 7, 6)
            sLEKPR = ermPREIS(cArtNr, "LEKPR")
            sLEKPR = Format$(sLEKPR, "#####0.00 ")
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            lanz1 = CLng(ctmp)
            sSUMLEKPR = CStr(lanz1 * sLEKPR)
            sSUMLEKPR = Format$(sSUMLEKPR, "#####0.00 ")
            
            Mid(cLBSatz, 50, 9) = "         "
            Mid(cLBSatz, 50, 9) = sLEKPR ' cErsatz 'hier einzelekpr
            Mid(cLBSatz, 60, 9) = "         "
            Mid(cLBSatz, 60, 9) = sSUMLEKPR ' cErsatz 'hier zeilensumme ekpr
            Mid(cLBSatz, 74, 9) = "         "
            Mid(cLBSatz, 74, 9) = sLEKPR ' cErsatz 'hier
            Mid(cLBSatz, 84, 9) = "         "
            Mid(cLBSatz, 84, 9) = cErsatz
            Mid(cLBSatz, 94, 9) = "         "
            Mid(cLBSatz, 94, 9) = cErsatz
            Mid(cLBSatz, 104, 9) = "         "
            Mid(cLBSatz, 104, 9) = cErsatz
            Mid(cLBSatz, 114, 9) = "         "
            Mid(cLBSatz, 114, 9) = cErsatz
            Mid(cLBSatz, 128, 9) = "         "
            Mid(cLBSatz, 128, 9) = cErsatz
            
            
            List1.RemoveItem lcount
            List1.AddItem cLBSatz, lcount
            
            List3.Nodes.Remove lcount + 1
            List3.Nodes.Add Text:=Left(cLBSatz, 68)
        Next lcount
    End If
    
    BerechneZwischenSummeWKL20
    DruckeKassenBonRetoureWKL20 cRetourGrund
    
    InsertRetoureWKL20 cRetourGrund
    LeereDialogModul20
    Label2(6).Caption = "0,00"
    
    List1.Clear
    List3.Nodes.Clear
    Label41(1).Caption = 0
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SetzeRetourArtikelWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SetzeAufBelegArtikelWKL20()
    On Error GoTo LOKAL_ERROR
    
    BerechneZwischenSummeWKL20
    DruckeKassenBonRückgabeWKL20
    
    Artikelzurück
    
    LeereDialogModul20
    Label2(6).Caption = "0,00"
    
    List1.Clear
    List3.Nodes.Clear
    Label41(1).Caption = 0
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SetzeAufBelegArtikelWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub KBOhneKBBelegArtikelWKL20(cFeldbez1 As String, cFeld1 As String, cFeldbez2 As String, cFeld2 As String)
    On Error GoTo LOKAL_ERROR
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "KBOhneKBBelegArtikelWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Kundenbestellung(iNachCheck As Integer)
    On Error GoTo LOKAL_ERROR
    
    If iNachCheck <> 3 Then
        BerechneZwischenSummeWKL20
        
        If InsertKUNDENBESTELLUNGWKL20 Then
            DruckeKassenBonKundenbestellungWKL20 "K U N D E N B E S T E L L U N G"
        End If
      
    End If
    
    Artikelzurück
    
    LeereDialogModul20
    
    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
    Label1(3).Visible = False
    Label2(3).Caption = "0,00"
    Label2(3).Visible = False
    Label2(4).Visible = False
    
    Label2(6).Caption = "0,00"

    List1.Clear
    List3.Nodes.Clear
    Label41(1).Caption = 0

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Kundenbestellung"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Kundenauslieferung()
    On Error GoTo LOKAL_ERROR
    
    BerechneZwischenSummeWKL20
    
    InsertKUNDEN_Auslieferung_WKL20
    DruckeKassenBonKundenbestellungWKL20 "-Kunden---Auslieferung----------"
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Kundenauslieferung"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Artikelzurück()
On Error GoTo LOKAL_ERROR
    
    Dim lRet As Long
    Dim lcount As Long
    Dim cLBSatz As String
    Dim cZiel As String
    Dim cFeld As String
    Dim dWert As Double
    Dim cArtNr As String
    Dim dRestMenge As Double
    Dim cBezeich As String
    Dim iAktiverSatz As Integer
    Dim cZeile1 As String
    Dim cZeile2 As String
    Dim iStufe As Integer
    Dim iStufe2 As Integer
    Dim ibignde As Integer
    
    ibignde = 0
    Do While List1.ListCount > 0
        
        lcount = 0
        'Wenn Zeile Zwischensumme, dann raus damit!
        cLBSatz = List1.list(lcount)

        If Mid(cLBSatz, 7, 6) = "000000" Then
            
            List1.RemoveItem 0
            List3.Nodes.Remove 1
        Else
            iAktiverSatz = 0
            cLBSatz = List1.list(0)
            cBezeich = Mid(cLBSatz, 14, 35)
            
            cBezeich = Trim$(cBezeich)
            cFeld = Left(cLBSatz, 5)
            
            cFeld = Trim$(cFeld)
            cFeld = fnMoveComma2Point$(cFeld)
            
            dWert = Val(cFeld)
            dWert = dWert * (-1)
            cArtNr = Mid(cLBSatz, 7, 6)
            
            '2.Von Kasse zurück Plus und Minus möglich
            dRestMenge = fnAktualisiereBestandWKL20(cArtNr, dWert, 5)
            
            cFeld = Format$(dWert, "####0")
            cFeld = Space$(5 - Len(cFeld)) & cFeld
            cZiel = cFeld
            
            cFeld = Mid(cLBSatz, 60, 9)
            cFeld = Trim$(cFeld)
            cFeld = fnMoveComma2Point$(cFeld)
            
            List1.RemoveItem 0
            List3.Nodes.Remove 1
            gbAutomaticClick = True
            BerechneZwischenSummeWKL20
            
            cZeile1 = "Position storniert"
            cZeile2 = Space$(19)
            
            ZeigeKundenDisplay cZeile1, cZeile2
            
        End If
    Loop
            
            
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Artikelzurück"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub
Private Sub AnlistenBonDatenNeu(cWoTag As String, cKK_art As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lHeute      As Long
    Dim lWeekday    As Long
    Dim lSuchtag    As Long
    Dim lcount      As Long
    
    Dim cSQL        As String
    Dim cFeld       As String
    Dim cLBSatz     As String
    Dim dWert       As Double
    Dim rsrs        As Recordset
    Dim cName       As String
    
    List12.Clear
    lHeute = Fix(Now)
    lWeekday = Weekday(lHeute, vbMonday)
    
    Select Case cWoTag
        Case Is = "MO"
            lSuchtag = 1
        Case Is = "DI"
            lSuchtag = 2
        Case Is = "MI"
            lSuchtag = 3
        Case Is = "DO"
            lSuchtag = 4
        Case Is = "FR"
            lSuchtag = 5
        Case Is = "SA"
            lSuchtag = 6
        Case Is = "SO"
            lSuchtag = 7
    End Select
    
    If lWeekday > lSuchtag Then         'lHeute um Differenz reduzieren
        lHeute = lHeute - lWeekday + lSuchtag
    End If
    
    If lWeekday = lSuchtag Then         'nichts tun! lHeute ist okay
    End If
    
    If lWeekday < lSuchtag Then
        lHeute = lHeute - (lWeekday + 7) + lSuchtag
    End If

    cSQL = "Select * from KASSBON "
    cSQL = cSQL & "where DATUM = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    If cKK_art <> "0" Then
        cSQL = cSQL & "and KK_Art = '" & cKK_art & "' "
    End If
    
    If gbUmsAnz = False Then
        cSQL = cSQL & "and BONNR > 0 "
    End If
    
    cSQL = cSQL & "order by DATUM desc, UHRZEIT desc, BONNR desc "
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
        
        
            If Not IsNull(rsrs!BONNR) Then
                dWert = rsrs!BONNR
            Else
                dWert = 0
            End If
            
            
            
            cFeld = Format$(dWert, "#####0")
            cFeld = Space$(6 - Len(cFeld)) & cFeld
            cLBSatz = cFeld & " "
            
            
            If Not IsNull(rsrs!Betrag) Then
                dWert = rsrs!Betrag
            Else
                dWert = 0
            End If
            cFeld = Format$(dWert, "#####0.00")
            cFeld = Space$(9 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld & " "
            
            If Not IsNull(rsrs!kk_art) Then
                cFeld = rsrs!kk_art
            Else
                cFeld = "  "
            End If
            cFeld = Space$(4 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld
            
            If Not IsNull(rsrs!Kundnr) Then
                cFeld = rsrs!Kundnr
            Else
                cFeld = "0"
            End If
            If cFeld = "" Then cFeld = "0"
            
            If cFeld = "0" Then
                cLBSatz = cLBSatz & Space(31)
            Else
                cName = WhatIsXfromKu(rsrs!Kundnr, "Name")
                cFeld = Space$(9 - Len(cFeld)) & cFeld & " " & Left(cName, 20) & Space$(20 - Len(Left(cName, 20)))
                cLBSatz = cLBSatz & cFeld & " "
            End If
            

            If Not IsNull(rsrs!Uhrzeit) Then
                cFeld = rsrs!Uhrzeit
            Else
                cFeld = "00:00"
            End If
            cFeld = Space$(9 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld
            
            List12.AddItem cLBSatz
            
            rsrs.MoveNext
        Loop
    Else
    
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    
    If gbLokalModus = True Then
    
        If gbAutoLokalModus = True Then
        
            setThegdbaseNew
        
            cSQL = "Select * from KASSBON "
            cSQL = cSQL & "where DATUM = " & Trim$(Str$(lHeute)) & " "
            cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
            cSQL = cSQL & "order by DATUM desc, UHRZEIT desc, BONNR desc "
            
            FnOpenrecordset rsrs, cSQL, 1, gdBase
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                Do While Not rsrs.EOF
                
                    If Not IsNull(rsrs!BONNR) Then
                        dWert = rsrs!BONNR
                    Else
                        dWert = 0
                    End If
                    
                    
                    
                    cFeld = Format$(dWert, "#####0")
                    cFeld = Space$(6 - Len(cFeld)) & cFeld
                    cLBSatz = cFeld & " "
                    
                    
                    If Not IsNull(rsrs!Betrag) Then
                        dWert = rsrs!Betrag
                    Else
                        dWert = 0
                    End If
                    cFeld = Format$(dWert, "#####0.00")
                    cFeld = Space$(9 - Len(cFeld)) & cFeld
                    cLBSatz = cLBSatz & cFeld & " "
                    
                    If Not IsNull(rsrs!kk_art) Then
                        cFeld = rsrs!kk_art
                    Else
                        cFeld = "  "
                    End If
                    cFeld = Space$(4 - Len(cFeld)) & cFeld
                    cLBSatz = cLBSatz & cFeld
                    
                    If Not IsNull(rsrs!Kundnr) Then
                        cFeld = rsrs!Kundnr
                    Else
                        cFeld = "0"
                    End If
                    If cFeld = "" Then cFeld = "0"
                    
                    If cFeld = "0" Then
                        cLBSatz = cLBSatz & Space(31)
                    Else
                        cName = WhatIsXfromKu(rsrs!Kundnr, "Name")
                        cFeld = Space$(9 - Len(cFeld)) & cFeld & " " & Left(cName, 20) & Space$(20 - Len(Left(cName, 20)))
                        cLBSatz = cLBSatz & cFeld & " "
                    End If
                    
        
                    If Not IsNull(rsrs!Uhrzeit) Then
                        cFeld = rsrs!Uhrzeit
                    Else
                        cFeld = "00:00"
                    End If
                    cFeld = Space$(9 - Len(cFeld)) & cFeld
                    cLBSatz = cLBSatz & cFeld
                
                
                
                
                
                
                
                
''                    If Not IsNull(rsrs!BONNR) Then
''                        dWert = rsrs!BONNR
''                    Else
''                        dWert = 0
''                    End If
''                    cFeld = Format$(dWert, "#####0")
''                    cFeld = Space$(6 - Len(cFeld)) & cFeld
''                    cLBSatz = cFeld & " "
''
''                    If Not IsNull(rsrs!Betrag) Then
''                        dWert = rsrs!Betrag
''                    Else
''                        dWert = 0
''                    End If
''                    cFeld = Format$(dWert, "#####0.00")
''                    cFeld = Space$(9 - Len(cFeld)) & cFeld
''                    cLBSatz = cLBSatz & cFeld & " "
''
''                    If Not IsNull(rsrs!Uhrzeit) Then
''                        cFeld = rsrs!Uhrzeit
''                    Else
''                        cFeld = "00:00"
''                    End If
''                    cFeld = Space$(9 - Len(cFeld)) & cFeld
''                    cLBSatz = cLBSatz & cFeld
                    
                    List12.AddItem cLBSatz
                    
                    rsrs.MoveNext
                Loop
            Else
            
            End If
            rsrs.Close: Set rsrs = Nothing
            
            setThegdbaseLokal
        End If
    End If
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "AnlistenBonDatenNeu"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Function ermMaxBonnrInKassbon() As String
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL    As String
    Dim rsrs    As Recordset
    Dim lHeute  As Long
    
    lHeute = Fix(Now)
    ermMaxBonnrInKassbon = ""
    
'    cSQL = "Select max(Bonnr) as maxBon from KASSBON "
    cSQL = "Select Bonnr as maxBon from KASSBON "
    cSQL = cSQL & "where DATUM = " & Trim$(Str$(lHeute)) & " "
    cSQL = cSQL & "and KASNUM = " & gcKasNum & " "
    cSQL = cSQL & " order by uhrzeit desc "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!maxBon) Then
            ermMaxBonnrInKassbon = rsrs!maxBon
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermMaxBonnrInKassbon"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Function
Private Sub UpdateAFCStatWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lStornoAnz      As Long
    Dim lAktSatz        As Long
    Dim lAnzSatz        As Long
    Dim lDatum          As Long
    Dim cErzielterPreis As String
    Dim ctmp            As String
    Dim cNormal         As String
    Dim cPosSumme       As String
    Dim cArtRabatt      As String
    Dim cLBSatz         As String
    Dim cArtNr          As String
    Dim cSQL            As String
    Dim cUmsOK          As String
    
    Dim dUmsBar         As Double      'umsatzrelevante Summe des Verkaufs
    Dim dNichtUmsBar    As Double      'nicht umsatzrelevante Summe des Verkaufs (ohne Gutscheine)
    Dim dSPreisAnz      As Double      'Anzahl Positionen mit Sonderpreis
    Dim dSPreisGes      As Double      'Summe aller Positionen mit Sonderpreis
    Dim dKundenZahl     As Double      'Konstante 1
    Dim dArtRabAnz      As Double      'Anzahl Positionen mit Artikelrabatt
    Dim dArtRabGes      As Double      'Summe des gegebenen Artikelrabatts
    Dim dGesRabAnz      As Double      'Anzahl Positionen mit Gesamtrabatt
    Dim dGesRabGes      As Double      'Summe des gegebenen Gesamtrabatts
    Dim dWertGutschein  As Double
    Dim dStornoWert     As Double
    Dim dRückBarDuka    As Double
   
    Dim rsrs            As Recordset
    
    
    '**********************
    '* feste Werte setzen
    '**********************
    
    dRückBarDuka = 0
    dKundenZahl = 0
    lDatum = Fix(Now)
    
    '*******************************************************************************
    '*** ACHTUNG! Gutschein-Verkäufe dürfen nicht in den UMSATZ laufen !!!       ***
    '*** ACHTUNG! Zwischensummen dürfen nicht in den UMSATZ laufen !!!           ***
    '*** ACHTUNG! Artikel mit UMS_OK = 'N' dürfen nicht in den UMSATZ laufen !!! ***
    '*******************************************************************************
    
    '**********************
    '* zu zahlende Summe
    '**********************
    dUmsBar = 0
    dWertGutschein = 0
    dNichtUmsBar = 0
    
    '********************************************
    '* jede Position des Kassenbons untersuchen
    '********************************************
    
    lAnzSatz = List1.ListCount
    
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        'MsgBox cLbSatz
        '********************************************
        '* Artikelnummer herausfiltern
        '********************************************
        cArtNr = Mid(cLBSatz, 7, 6)
        
        '********************************************
        '* Kennzeichen Umsatz_Ok
        '********************************************
        If Len(cLBSatz) > 155 Then
            cUmsOK = Mid(cLBSatz, 156, 1)
        Else
            cUmsOK = "J"
        End If
        
        '*********************************************************************
        '*** ACHTUNG! Zwischensummen dürfen nicht in den UMSATZ laufen !!! ***
        '*********************************************************************
        
        If cArtNr <> "000000" Then
        
            '********************************************
            '* Position ist ein Artikel
            '********************************************
        
            '*****************************************************
            '* Stückpreis, zu dem eigentlich verkauft wird
            '* (Wert aus Datenbank)
            '*****************************************************
            cNormal = Mid(cLBSatz, 128, 9)
            cNormal = Trim$(cNormal)
            cNormal = fnMoveComma2Point$(cNormal)
            
            '*********************************************************
            '* Preis, zu dem verkauft wurde
            '* (Preis aus Datenbank durch Sonderpreis überschrieben?)
            '*********************************************************
            ctmp = Mid(cLBSatz, 74, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            '****************************************************
            '* Preis, den der Kunde für diesen Artikel zahlt
            '* (mit Menge ausmultipliziert)
            '****************************************************
            cErzielterPreis = Mid(cLBSatz, 60, 9)
            cErzielterPreis = Trim$(cErzielterPreis)
            cErzielterPreis = fnMoveComma2Point$(cErzielterPreis)
            
            '********************************************
            '* Handelt es sich um einen Gutschein?
            '********************************************
            
            
            If gbGutscheinBeiVKversteuern = True Then
            
                If cArtNr <> "666666" Then
                    '*************************************************
                    '* Wenn kein Gutschein, handelt es sich um einen
                    '* Artikel, der umsatzrelevant ist?
                    '* Wenn ja, dann ist der Kunde wirklich ein Kunde
                    '*************************************************
                    If cUmsOK <> "N" Then
                        dUmsBar = dUmsBar + Val(cErzielterPreis)
                        dKundenZahl = 1
                    Else
                        dNichtUmsBar = dNichtUmsBar + Val(cErzielterPreis)
                    End If
                Else
                
                    '*************************************************
                    '* Wenn ein Gutschein,
                    '* dann umsatzrelevant
                    '* Wenn ja, dann ist der Kunde wirklich ein Kunde
                    '*************************************************
                    If cUmsOK <> "N" Then
                        dUmsBar = dUmsBar + Val(cErzielterPreis)
                        dKundenZahl = 1
'                    Else
'                        dNichtUmsBar = dNichtUmsBar + Val(cErzielterPreis)
                    End If
                    
                    dWertGutschein = dWertGutschein + Val(cErzielterPreis)
                End If
            
            Else
                If cArtNr <> "666666" Then
                    '*************************************************
                    '* Wenn kein Gutschein, handelt es sich um einen
                    '* Artikel, der umsatzrelevant ist?
                    '* Wenn ja, dann ist der Kunde wirklich ein Kunde
                    '*************************************************
                    If cUmsOK <> "N" Then
                        dUmsBar = dUmsBar + Val(cErzielterPreis)
                        dKundenZahl = 1
                    Else
                        dNichtUmsBar = dNichtUmsBar + Val(cErzielterPreis)
                    End If
                Else
                    
                    dWertGutschein = dWertGutschein + Val(cErzielterPreis)
                End If
            End If
            
            '********************************************
            '* ErzielterPreis abzgl. Rabatte
            '********************************************
            cPosSumme = Mid(cLBSatz, 94, 9)
            cPosSumme = Trim$(cPosSumme)
            cPosSumme = fnMoveComma2Point$(cPosSumme)
            
            '********************************************
            '* Artikelrabatt in Währung
            '********************************************
            cArtRabatt = Mid(cLBSatz, 124, 3)
            cArtRabatt = Trim$(cArtRabatt)
            cArtRabatt = fnMoveComma2Point$(cArtRabatt)
            
            '************************************************
            '* Anzahl und Summe von Sonderpreisen berechnen
            '************************************************
            '//2002
            If Val(ctmp) <> Val(cNormal) Then
                If cNormal = 0 Then
                    dSPreisAnz = 0
                    dSPreisGes = 0
                Else
                    dSPreisAnz = dSPreisAnz + 1
                    dSPreisGes = dSPreisGes + Val(cPosSumme)
                End If
            End If
            
            '************************************************
            '* Anzahl und Summe von Artikelrabatten berechnen
            '************************************************
            If Val(cArtRabatt) <> 0 Then
                ctmp = Mid(cLBSatz, 84, 9)
                ctmp = Trim$(ctmp)
                ctmp = fnMoveComma2Point$(ctmp)
                
                dArtRabAnz = dArtRabAnz + 1
                dArtRabGes = dArtRabGes + Val(ctmp)
            End If
            
            '************************************************
            '* Bei negativem Preis ist ein Storno erfolgt
            '************************************************
            If Val(cErzielterPreis) < 0 Then
            
                If IstArtikelnichtStornierfähig(cArtNr) = False Then
                    dStornoWert = dStornoWert + Val(cErzielterPreis)
                    lStornoAnz = lStornoAnz + 1
                End If
                
            End If
        End If
    Next lAktSatz
    
    '************************************************
    '* Betrag der Gesamtrabatte ermitteln
    '* (nur 1x für den ganze Kassenbon!)
    '************************************************
    If Label2(3).Visible Then
        dGesRabGes = fnHoleGesamtRabattModul20#()
        dGesRabGes = (Fix((dGesRabGes * 100) + 0.5)) / 100
        dGesRabAnz = 1
    End If
    

    
    
    
    'Achtung wenn dukatenumsatz dann vom Barumsatz abziehen
        
    If dSumDukaten > 0 Then
        If dSumDukaten >= dUmsBar Then
            dRückBarDuka = dUmsBar - dSumDukaten
            dSumDukaten = dUmsBar
            
            dUmsBar = 0
        Else
            dUmsBar = dUmsBar - dSumDukaten
        End If
    End If
    
    cSQL = "Select * from AFCSTAT where ADATE = " & Trim$(Str$(lDatum)) & " and KASNUM = " & gcKasNum & " "
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.Edit
        
        '********************************
        '* Datum und Kassennummer setzen
        '********************************
        rsrs!ADATE = lDatum
        rsrs!kasnum = Val(gcKasNum)
        
        '********************************
        '* Bar-Umsatz setzen
        '********************************
        
        If Not IsNull(rsrs!UMS_BAR) Then
            rsrs!UMS_BAR = rsrs!UMS_BAR + dUmsBar
        Else
            rsrs!UMS_BAR = dUmsBar
        End If
        
        
'        If gbGutscheinBeiVKversteuern = True Then
'            '********************************
'            '* Gutschein umsatz setzen
'            '********************************
'            If Not IsNull(rsrs!ZHLGGUTSCH) Then
'                rsrs!ZHLGGUTSCH = rsrs!ZHLGGUTSCH + dWertGutschein
'            Else
'                rsrs!ZHLGGUTSCH = dWertGutschein
'            End If
'        End If
        
        
        '********************************
        '* Dukaten umsatz setzen
        '********************************
        If Not IsNull(rsrs!DUKA) Then
            rsrs!DUKA = rsrs!DUKA + dSumDukaten
        Else
            rsrs!DUKA = dSumDukaten
        End If
        
        '********************************
        '* Anzahl Sonderpreise setzen
        '********************************
        If Not IsNull(rsrs!SPREIS_ANZ) Then
            rsrs!SPREIS_ANZ = rsrs!SPREIS_ANZ + dSPreisAnz
        Else
            rsrs!SPREIS_ANZ = dSPreisAnz
        End If
        
        '********************************
        '* Betrag Sonderpreise setzen
        '********************************
        If Not IsNull(rsrs!SPREIS_GES) Then
            rsrs!SPREIS_GES = rsrs!SPREIS_GES + dSPreisGes
        Else
            rsrs!SPREIS_GES = dSPreisGes
        End If
        
        '********************************
        '* Anzahl Kunden setzen
        '********************************
        If Not IsNull(rsrs!Kundenzahl) Then
            rsrs!Kundenzahl = rsrs!Kundenzahl + dKundenZahl
        Else
            rsrs!Kundenzahl = dKundenZahl
        End If
        
        '********************************
        '* Anzahl Artikel-Rabatte setzen
        '********************************
        If Not IsNull(rsrs!ARTRAB_ANZ) Then
            rsrs!ARTRAB_ANZ = rsrs!ARTRAB_ANZ + dArtRabAnz
        Else
            rsrs!ARTRAB_ANZ = dArtRabAnz
        End If
        
        '********************************
        '* Betrag Artikel-Rabatte setzen
        '********************************
        If Not IsNull(rsrs!ARTRAB_GES) Then
            rsrs!ARTRAB_GES = rsrs!ARTRAB_GES + dArtRabGes
        Else
            rsrs!ARTRAB_GES = dArtRabGes
        End If
        
        '********************************
        '* Anzahl Gesamt-Rabatte setzen
        '********************************
        If Not IsNull(rsrs!GESRAB_ANZ) Then
            rsrs!GESRAB_ANZ = rsrs!GESRAB_ANZ + dGesRabAnz
        Else
            rsrs!GESRAB_ANZ = dGesRabAnz
        End If
        
        '********************************
        '* Betrag Gesamt-Rabatte setzen
        '********************************
        If Not IsNull(rsrs!GESRAB_GES) Then
            rsrs!GESRAB_GES = rsrs!GESRAB_GES + dGesRabGes
        Else
            rsrs!GESRAB_GES = dGesRabGes
        End If
        
        '******************************************
        '* Betrag Gutscheinverkäufe in Bar setzen
        '******************************************
        If Not IsNull(rsrs!GUTSCHBAR) Then
            rsrs!GUTSCHBAR = rsrs!GUTSCHBAR + Format(dWertGutschein, "######0.00") 'Hier ist Format() neu 21.10.13
        Else
            rsrs!GUTSCHBAR = Format(dWertGutschein, "######0.00") 'Hier ist Format() neu 21.10.13
        End If
        
        '******************************************
        '* Wert der Gutscheinverkäufe setzen
        '******************************************
        If Not IsNull(rsrs!GUTSCHEIN) Then
            rsrs!GUTSCHEIN = rsrs!GUTSCHEIN + dWertGutschein
        Else
            rsrs!GUTSCHEIN = dWertGutschein
        End If
        
        
        '******************************************
        '* Wert des Barverkaufes setzen
        '******************************************
        If gbGutscheinBeiVKversteuern = True Then

            If Not IsNull(rsrs!BARVERKAUF) Then
                rsrs!BARVERKAUF = rsrs!BARVERKAUF + dUmsBar + dNichtUmsBar + dRückBarDuka - dWertGutschein
            Else
                rsrs!BARVERKAUF = dUmsBar + dNichtUmsBar + dRückBarDuka - dWertGutschein
            End If
        Else
            If Not IsNull(rsrs!BARVERKAUF) Then
                rsrs!BARVERKAUF = rsrs!BARVERKAUF + dUmsBar + dNichtUmsBar + dRückBarDuka
            Else
                rsrs!BARVERKAUF = dUmsBar + dNichtUmsBar + dRückBarDuka
            End If
        End If
        
        
        
        
        
        
        
        '******************************************
        '* Wert der Stornos setzen
        '******************************************
        If Not IsNull(rsrs!STORNO_GES) Then
            rsrs!STORNO_GES = rsrs!STORNO_GES + dStornoWert
        Else
            rsrs!STORNO_GES = dStornoWert
        End If
        
        '******************************************
        '* Anzahl der Stornos setzen
        '******************************************
        If Not IsNull(rsrs!STORNO_ANZ) Then
            rsrs!STORNO_ANZ = rsrs!STORNO_ANZ + lStornoAnz
        Else
            rsrs!STORNO_ANZ = lStornoAnz
        End If
        
        '******************************************
        '* Bonnummer setzen
        '******************************************
'        If gdBonNr < CLng(rsrs!BELEGNR) Then
'
'        Else
'            rsrs!BELEGNR = gdBonNr
'        End If




        If Not IsNull(rsrs!BELEGNR) Then
            If gdBonNr < CLng(rsrs!BELEGNR) Then
                
            Else
                rsrs!BELEGNR = gdBonNr
            End If
        Else
            rsrs!BELEGNR = gdBonNr
        End If
        
    Else
        rsrs.AddNew
        
        'Datum und Kassennummer setzen
        rsrs!ADATE = lDatum
        rsrs!kasnum = Val(gcKasNum)
        
        rsrs!UMS_BAR = dUmsBar
        rsrs!DUKA = dSumDukaten
        
        
        
        rsrs!SPREIS_ANZ = dSPreisAnz
        rsrs!SPREIS_GES = dSPreisGes
        rsrs!Kundenzahl = dKundenZahl
        rsrs!ARTRAB_ANZ = dArtRabAnz
        rsrs!ARTRAB_GES = dArtRabGes
        rsrs!GESRAB_ANZ = dGesRabAnz
        rsrs!GESRAB_GES = dGesRabGes
        rsrs!GUTSCHBAR = dWertGutschein
        rsrs!GUTSCHEIN = dWertGutschein
        
        If gbGutscheinBeiVKversteuern = True Then

            rsrs!BARVERKAUF = dUmsBar + dNichtUmsBar + dRückBarDuka - dWertGutschein
        Else
            rsrs!BARVERKAUF = dUmsBar + dNichtUmsBar + dRückBarDuka
        End If
        
        
        
        rsrs!BELEGNR = gdBonNr
        rsrs!STORNO_GES = dStornoWert
        rsrs!STORNO_ANZ = lStornoAnz

    End If
    
    rsrs.Update
    rsrs.Close: Set rsrs = Nothing
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "UpdateAFCStatWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub UpdateAFCStatAndersWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lAktSatz        As Long
    Dim lAnzSatz        As Long
    Dim lDatum          As Long
    Dim lStornoAnz      As Long
    Dim cErzielterPreis As String
    Dim ctmp            As String
    Dim cNormal         As String
    Dim cPosSumme       As String
    Dim cArtRabatt      As String
    Dim cLBSatz         As String
    Dim cArtNr          As String
    Dim cSQL            As String
    Dim cUmsOK          As String
    
    Dim dUmsatz         As Double      'Summe des Verkaufs ohne Gutscheine
    Dim dUmsatz2        As Double      'Summe des Verkaufs inkl. Gutscheine
    Dim dNichtUmsatz    As Double      'nicht umsatzrelevante Verkäufe (ohne Gutscheine)
    Dim dSPreisAnz      As Double      'Anzahl Positionen mit Sonderpreis
    Dim dSPreisGes      As Double      'Summe aller Positionen mit Sonderpreis
    Dim dKundenZahl     As Double      'Konstante 1
    Dim dArtRabAnz      As Double      'Anzahl Positionen mit Artikelrabatt
    Dim dArtRabGes      As Double      'Summe des gegebenen Artikelrabatts
    Dim dGesRabAnz      As Double      'Anzahl Positionen mit Gesamtrabatt
    Dim dGesRabGes      As Double      'Summe des gegebenen Gesamtrabatts
    Dim dWertGutschein  As Double
    Dim dStornoWert     As Double
    Dim rsrs            As Recordset
    Dim derFehler       As Boolean
    
    derFehler = True

    lDatum = Fix(Now)
    
    
    
    'feste Werte setzen
    dKundenZahl = 0
    dNichtUmsatz = 0
    
    'Gesamtsumme ermitteln
    ctmp = Label6(1).Caption
    ctmp = Trim$(ctmp)
    ctmp = fnMoveComma2Point$(ctmp)
    dUmsatz2 = Val(ctmp)
    
    lAnzSatz = List1.ListCount
    
    dUmsatz = 0
    dWertGutschein = 0
    
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        '//2002
        If Len(cLBSatz) > 156 Then
            cUmsOK = Mid(cLBSatz, 156, 1)
        Else
            cUmsOK = "J"
        End If

        
        cArtNr = Mid(cLBSatz, 7, 6)
        
        cNormal = Mid(cLBSatz, 128, 9)
        cNormal = Trim$(cNormal)
        cNormal = fnMoveComma2Point$(cNormal)
        
        ctmp = Mid(cLBSatz, 74, 9)
        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        
        cPosSumme = Mid(cLBSatz, 94, 9)
        cPosSumme = Trim$(cPosSumme)
        cPosSumme = fnMoveComma2Point$(cPosSumme)
        
        cArtRabatt = Mid(cLBSatz, 124, 3)
        cArtRabatt = Trim$(cArtRabatt)
        cArtRabatt = fnMoveComma2Point$(cArtRabatt)
        
        cErzielterPreis = Mid(cLBSatz, 60, 9)
        cErzielterPreis = Trim$(cErzielterPreis)
        cErzielterPreis = fnMoveComma2Point$(cErzielterPreis)
        
        
        
        
        If gbGutscheinBeiVKversteuern = True Then
            
            If cArtNr <> "666666" Then
                '*************************************************
                '* Wenn kein Gutschein, handelt es sich um einen
                '* Artikel, der umsatzrelevant ist?
                '* Wenn ja, dann ist der Kunde wirklich ein Kunde
                '*************************************************
                If cUmsOK <> "N" Then
                    dUmsatz = dUmsatz + Val(cErzielterPreis)
                    dKundenZahl = 1
                Else
                    dNichtUmsatz = dNichtUmsatz + Val(cErzielterPreis)
                End If
            Else
            
                '*************************************************
                '* Wenn ein Gutschein,
                '* dann umsatzrelevant
                '* Wenn ja, dann ist der Kunde wirklich ein Kunde
                '*************************************************
                If cUmsOK <> "N" Then
                    dUmsatz = dUmsatz + Val(cErzielterPreis)
                    dKundenZahl = 1
'                    Else
'                        dNichtUmsBar = dNichtUmsBar + Val(cErzielterPreis)
                End If
                
                dWertGutschein = dWertGutschein + Val(cErzielterPreis)
            End If
        
        Else
            If cArtNr <> "666666" Then
                If cUmsOK <> "N" Then
                    dUmsatz = dUmsatz + Val(cErzielterPreis)
                    dKundenZahl = 1
                Else
                    dNichtUmsatz = dNichtUmsatz + Val(cErzielterPreis)
                End If
            Else
                dWertGutschein = dWertGutschein + Val(cErzielterPreis)
            End If
        End If
    
        
        
        
        
        
        
        
        
        
        '//2002
        If Val(ctmp) <> Val(cNormal) Then
            If cNormal = 0 Then
                dSPreisAnz = 0
                dSPreisGes = 0
            Else
                dSPreisAnz = dSPreisAnz + 1
                dSPreisGes = dSPreisGes + Val(cPosSumme)
            End If
        End If
        
        If Val(cArtRabatt) <> 0 Then
            ctmp = Mid(cLBSatz, 84, 9)
            ctmp = Trim$(ctmp)
            ctmp = fnMoveComma2Point$(ctmp)
            
            dArtRabAnz = dArtRabAnz + 1
            dArtRabGes = dArtRabGes + Val(ctmp)
        ElseIf Label2(3).Visible Then
            dGesRabAnz = dGesRabAnz + 1
        End If
        
        If Val(cErzielterPreis) < 0 Then
            If IstArtikelnichtStornierfähig(cArtNr) = False Then
                dStornoWert = dStornoWert + Val(cErzielterPreis)
                lStornoAnz = lStornoAnz + 1
            End If
        End If
        
    Next lAktSatz
    
    If Label2(3).Visible Then
        dGesRabGes = fnHoleGesamtRabattModul20#()
    End If
    
    cSQL = "Select * from AFCSTAT where ADATE = " & Trim$(Str$(lDatum)) & " and KASNUM = " & gcKasNum & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.Edit
    Else
        rsrs.AddNew
    End If
        
    Select Case giZahlArt
        '1
        '5
        '6
        '45
        '46
        '17 Kartenverkauf
        
        Case Is = 1     'EC-Lastschrift
        
            derFehler = False
            
            If Not IsNull(rsrs!UMS_LAST) Then
                rsrs!UMS_LAST = rsrs!UMS_LAST + dUmsatz
            Else
                rsrs!UMS_LAST = dUmsatz
            End If
            
            If Not IsNull(rsrs!GUTSCHLAST) Then
                rsrs!GUTSCHLAST = rsrs!GUTSCHLAST + dWertGutschein
            Else
                rsrs!GUTSCHLAST = dWertGutschein
            End If
        
        Case Is = 5     'Kreditverkauf
        
            derFehler = False
            
            If Not IsNull(rsrs!UMS_Kred) Then
                rsrs!UMS_Kred = rsrs!UMS_Kred + dUmsatz
            Else
                rsrs!UMS_Kred = dUmsatz
            End If
            If Not IsNull(rsrs!GUTSCHKRE) Then
                rsrs!GUTSCHKRE = rsrs!GUTSCHKRE + dWertGutschein
            Else
                rsrs!GUTSCHKRE = dWertGutschein
            End If
            
        Case Is = 6     'Scheck
        
            derFehler = False
            
            If Not IsNull(rsrs!UMS_SCHECK) Then
                rsrs!UMS_SCHECK = rsrs!UMS_SCHECK + dUmsatz
            Else
                rsrs!UMS_SCHECK = dUmsatz
            End If
            If Not IsNull(rsrs!SCHVERKAUF) Then
                rsrs!SCHVERKAUF = rsrs!SCHVERKAUF + dUmsatz + dNichtUmsatz
            Else
                rsrs!SCHVERKAUF = dUmsatz + dNichtUmsatz
            End If
            If Not IsNull(rsrs!GUTSCHSCH) Then
                rsrs!GUTSCHSCH = rsrs!GUTSCHSCH + dWertGutschein
            Else
                rsrs!GUTSCHSCH = dWertGutschein
            End If
            If Not IsNull(rsrs!ANZSCHECK) Then
                rsrs!ANZSCHECK = rsrs!ANZSCHECK + dKundenZahl
            Else
                rsrs!ANZSCHECK = dKundenZahl
            End If
        Case Is = 45 '9     'Auszahlung
        
            derFehler = False
        
'            HoleNeueBonNrWKL20
            If Not IsNull(rsrs!AUSZAHLUNG) Then
                rsrs!AUSZAHLUNG = rsrs!AUSZAHLUNG + dUmsatz2
            Else
                rsrs!AUSZAHLUNG = dUmsatz2
            End If
        Case Is = 46 '10    'Einzahlung
        
            derFehler = False
            
'            HoleNeueBonNrWKL20
            If Not IsNull(rsrs!EINZAHLUNG) Then
                rsrs!EINZAHLUNG = rsrs!EINZAHLUNG + dUmsatz2
            Else
                rsrs!EINZAHLUNG = dUmsatz2
            End If
        Case Is = 17    'Kreditkarte
        
            derFehler = False
            
            If Not IsNull(rsrs!UMS_KARTE) Then
                rsrs!UMS_KARTE = rsrs!UMS_KARTE + dUmsatz
                schreibeProtokollUNITXT CStr(dUmsatz), "Kartenzahlung"
            Else
                rsrs!UMS_KARTE = dUmsatz
                schreibeProtokollUNITXT CStr(dUmsatz), "Kartenzahlung"
            End If
            
            If Not IsNull(rsrs!GUTSCHKAR) Then
                rsrs!GUTSCHKAR = rsrs!GUTSCHKAR + dWertGutschein
                schreibeProtokollUNITXT CStr(dWertGutschein), "Kartenzahlung"
            Else
                rsrs!GUTSCHKAR = dWertGutschein
                schreibeProtokollUNITXT CStr(dWertGutschein), "Kartenzahlung"
            End If
            
            If Not IsNull(rsrs!NUMSKARTE) Then
                rsrs!NUMSKARTE = rsrs!NUMSKARTE + dNichtUmsatz
                schreibeProtokollUNITXT CStr(dNichtUmsatz), "Kartenzahlung"
            Else
                rsrs!NUMSKARTE = dNichtUmsatz
                schreibeProtokollUNITXT CStr(dNichtUmsatz), "Kartenzahlung"
            End If
    End Select
    'Datum und Kassennummer setzen
    rsrs!ADATE = lDatum
    rsrs!kasnum = Val(gcKasNum)
    
    If Not IsNull(rsrs!SPREIS_ANZ) Then
        rsrs!SPREIS_ANZ = rsrs!SPREIS_ANZ + dSPreisAnz
    Else
        rsrs!SPREIS_ANZ = dSPreisAnz
    End If
    If Not IsNull(rsrs!SPREIS_GES) Then
        rsrs!SPREIS_GES = rsrs!SPREIS_GES + dSPreisGes
    Else
        rsrs!SPREIS_GES = dSPreisGes
    End If
    If giZahlArt <> 9 And giZahlArt <> 10 Then
        If Not IsNull(rsrs!Kundenzahl) Then
            rsrs!Kundenzahl = rsrs!Kundenzahl + dKundenZahl
        Else
            rsrs!Kundenzahl = dKundenZahl
        End If
    End If
    If Not IsNull(rsrs!ARTRAB_ANZ) Then
        rsrs!ARTRAB_ANZ = rsrs!ARTRAB_ANZ + dArtRabAnz
    Else
        rsrs!ARTRAB_ANZ = dArtRabAnz
    End If
    If Not IsNull(rsrs!ARTRAB_GES) Then
        rsrs!ARTRAB_GES = rsrs!ARTRAB_GES + dArtRabGes
    Else
        rsrs!ARTRAB_GES = dArtRabGes
    End If
    If Not IsNull(rsrs!GESRAB_ANZ) Then
        rsrs!GESRAB_ANZ = rsrs!GESRAB_ANZ + dGesRabAnz
    Else
        rsrs!GESRAB_ANZ = dGesRabAnz
    End If
    If Not IsNull(rsrs!GESRAB_GES) Then
        rsrs!GESRAB_GES = rsrs!GESRAB_GES + dGesRabGes
    Else
        rsrs!GESRAB_GES = dGesRabGes
    End If
    
    If Not IsNull(rsrs!GUTSCHEIN) Then
        rsrs!GUTSCHEIN = rsrs!GUTSCHEIN + dWertGutschein
    Else
        rsrs!GUTSCHEIN = dWertGutschein
    End If
    
    If derFehler = True Then
        schreibeProtokollKassenFehler "Dieser Bon macht Probleme: " & gdBonNr
        schreibeProtokollKassenFehler "erwartet wird hier 17: " & giZahlArt
        schreibeProtokollKassenFehler "erwartet wird ein bestimmter Umsatz: " & dUmsatz
        schreibeProtokollKassenFehler "Ende -------------------------------------------"
        
        Dim ctempaB As String
        ctempaB = "Hallo Frau/Herr " & gcBediener & " !" & vbCrLf & vbCrLf
        ctempaB = ctempaB & "Dieser Bon(" & gdBonNr & ") wurde nicht verbucht." & vbCrLf & vbCrLf
        ctempaB = ctempaB & "Bitte drucken Sie einen 2.Bon und faxen Sie diesen an KISS - Hannover(0511/9559144)!" & vbCrLf
        ctempaB = ctempaB & "Haben Sie etwas in Ihrer Handhabung bei EC Kartenzahlungen anders gemacht?" & vbCrLf
        ctempaB = ctempaB & "Um den Fehler endgültig zu beseitigen, bräuchten wir diese Information." & vbCrLf & vbCrLf
        ctempaB = ctempaB & "Vielen Dank     Thomas Heinz(KISS Hannover)"
        MsgBox ctempaB, vbInformation, "Fehlerbeseitigung Winkiss:"
    End If
    
    
'    rsrs!BELEGNR = gdBonNr
    
    If Not IsNull(rsrs!BELEGNR) Then
        If gdBonNr < CLng(rsrs!BELEGNR) Then
            
        Else
            rsrs!BELEGNR = gdBonNr
        End If
    Else
        rsrs!BELEGNR = gdBonNr
    End If
    
    
    If Not IsNull(rsrs!STORNO_GES) Then
        rsrs!STORNO_GES = rsrs!STORNO_GES + dStornoWert
    Else
        rsrs!STORNO_GES = dStornoWert
    End If
    
    
    If Not IsNull(rsrs!STORNO_ANZ) Then
        rsrs!STORNO_ANZ = rsrs!STORNO_ANZ + lStornoAnz
    Else
        rsrs!STORNO_ANZ = lStornoAnz
    End If
        
    
    rsrs.Update
    rsrs.Close: Set rsrs = Nothing
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "UpdateAFCStatAndersWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Function fnPruefeDialogSucheArtWKL20() As Integer
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp    As String
    
    ctmp = Text3(6).Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheArtWKL20 = 0
        Exit Function
    End If
    
    ctmp = Label1(9).Tag
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheArtWKL20 = 0
        Exit Function
    End If
    
    ctmp = Text3(5).Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        If IsNumeric(Left(ctmp, 6)) Then
            fnPruefeDialogSucheArtWKL20 = 0
            Exit Function
        Else
            Text3(5).Text = ""
        End If
    End If
    
    
    
    ctmp = Text3(1).Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheArtWKL20 = 0
        Exit Function
    End If
    
    ctmp = Text3(19).Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheArtWKL20 = 0
        Exit Function
    End If
    
    ctmp = Text3(2).Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheArtWKL20 = 0
        Exit Function
    End If
    
    ctmp = Text3(4).Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheArtWKL20 = 0
        Exit Function
    End If
    
    Text3(0).Text = SwapStr(Text3(0).Text, "'", "")
    ctmp = Text3(0).Text
    ctmp = Trim$(ctmp)
    
    If ctmp <> "" Then
        If Len(ctmp) > 1 Then
            fnPruefeDialogSucheArtWKL20 = 0
            Exit Function
        End If
    End If
    
    Text3(70).Text = SwapStr(Text3(70).Text, "'", "")
    ctmp = Text3(70).Text
    ctmp = Trim$(ctmp)
    
    If ctmp <> "" Then
        If Len(ctmp) > 0 Then
            fnPruefeDialogSucheArtWKL20 = 0
            Exit Function
        End If
    End If
    
    fnPruefeDialogSucheArtWKL20 = 1
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnPruefeDialogSucheArtWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Function fnPruefeDialogSucheKundenWKL20() As Integer
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp    As String
    
    If Label1(10).Caption = "Farbauswahl" Then
        fnPruefeDialogSucheKundenWKL20 = 0
        Exit Function
    End If
    
    ctmp = Text3(3).Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheKundenWKL20 = 0
        Exit Function
    End If
    
    ctmp = Combo1.Text
    ctmp = Trim$(ctmp)
    If ctmp <> "" Then
        fnPruefeDialogSucheKundenWKL20 = 0
        Exit Function
    End If
    
    fnPruefeDialogSucheKundenWKL20 = 1
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnPruefeDialogSucheKundenWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub SendeDaten2DruckerNeuWKL20()
    On Error GoTo LOKAL_ERROR
        
    Dim lartnr                  As Long
    Dim lAnzSatz                As Long
    Dim lAktSatz                As Long
    Dim lTask                   As Long
    Dim lcount                  As Long
    Dim lAnzZeile               As Long
    Dim lAnzLbSatz              As Long
    Dim lRet                    As Long
    
    Dim cLBSatz                 As String
    Dim cFeld                   As String
    Dim cDaten                  As String
    Dim ctmp                    As String
    Dim cAnz                    As String
    Dim cTmp2                   As String
    Dim cMWST                   As String
    Dim cText                   As String
    Dim cMWSTzzgl               As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim cArtNr                  As String
    ReDim cDruckZeile(1 To 1) As String
    Dim ctmpFW                  As String
    Dim cDatenfw                As String
    Dim cNachname               As String
    Dim cVorname                As String
    
    Dim iLevel                  As Integer
    Dim iAktCopy                As Integer
    Dim iStufe                  As Integer
    Dim iLenZeile               As Integer
    Dim iFileNr                 As Integer
    Dim iGesAnzahl              As Long
    
    Dim dGRabatt                As Double
    Dim dGRabattWert            As Double
    Dim dSumme                  As Double
    Dim dWert                   As Double
    Dim dEuro                   As Double
    Dim dMWStVoll               As Double
    Dim dMWStErm                As Double
    
    Dim dMWStAnteilBruttoErm    As Double
    Dim dMWStAnteilBruttoVoll   As Double
    Dim dMWStAnteilNettoErm     As Double
    Dim dMWStAnteilNettoVoll    As Double
    
    Dim dMWSTVzzgl              As Double
    Dim dMWSTEzzgl              As Double
    Dim dAktZeit                As Double
    Dim dNeuZeit                As Double
    Dim dMWSt                   As Double
    
    Dim bAusblenden             As Boolean
    Dim bBonZwang               As Boolean
    Dim gbStorni                As Boolean
    Dim dSparSatzsum            As Double
    Dim i                       As Integer
    
    dMWStAnteilBruttoErm = 0
    dMWStAnteilBruttoVoll = 0
    dMWStAnteilNettoErm = 0
    dMWStAnteilNettoVoll = 0
    
    gbStorni = False
    bBonZwang = False
    dSparSatzsum = 0
    
    iLevel = 0
    
    gbADTBON = False
    
'    setzedrucker gcBonDrucker
    
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    
SCHUBLADE:
'    OeffneSchubladeExplizitWKL20
    
    'Bei kK Zahlungen kann Schublade geschlossen bleiben
    If giZahlArt = 17 And gbKKSCHUB = True Then
    
    ElseIf giZahlArt = giKOLLEGE And gbKOLSCHUB = True Then
    
    Else
        If gbLadeCom Then
            OpenDrawerViaComPortModul20
        Else
            If gbAPI = False Then
                dAktZeit = Time
                lRet = Shell("Command.com /C " & gcPfad & "LADE.EXE", 6)
                dNeuZeit = Time
                Do While dNeuZeit - dAktZeit < (2 / 86400)
                    dNeuZeit = Time
                Loop
            Else
                aDeviceName = Printer.DeviceName
                cEscapeSequenz = gcLade
                OpenDrawer aDeviceName, cEscapeSequenz
            End If
        End If
    End If
    
StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    
    'zuerst QR-Code auf dem ersten Bon drucken und dann Papier schneiden <<<<< START
     If iAktCopy > 1 Then
     
        If MitQrCode And E_TSE_Aktiv Then
            'beim altDruckModus kann der Drucker beim Kunde kein QR-Code drucken (alte Drucker)
             If altDruckModus Then
             
             Else
               If gbBonDruck Then
                QRcodeDrucken
               End If
             End If
             
        End If
        
  If altDruckModus Then
       'Papier schneiden (alte Funktion)
        If gbBonDruck Then
            'Kassenbon abschneiden
            If gbAPI = True Then
                aDeviceName = Printer.DeviceName
                cEscapeSequenz = gcSchneiden
                OpenDrawer aDeviceName, cEscapeSequenz
            End If
        End If
    
    Else
        'Papier schneiden (neue Funktion)
         If gbBonDruck Then
             CutPapier
             Sleep 2000
         End If
    End If
    
    
      
       
     End If
    'zuerst QR-Code auf dem ersten Bon drucken und dann Papier schneiden <<<<< ENDE
    
    iLevel = 1
    cDaten = ""

    iLenZeile = glZeichenAnzahlBon
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    dMWSTVzzgl = 0
    dMWSTEzzgl = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    
    
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        If cFeld = "666666" Then
            gbBonDruck = True
            Exit For
        End If
    Next lAktSatz
     
            
    If gbBonDruck Then
        If gcBild <> "" Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcBild
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
    End If
    
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    If gbSPY Then
        frmWKL20!Winsock22.senddata "Bon beginnt" & vbCrLf
    End If
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "K.I.S.S. Warenwirtschaft"
    Else
        cDaten = gcBonText(0)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "Carsten Schröder"
    Else
        cDaten = gcBonText(1)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(4)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        iStufe = 3
    End If
    
    '***********************************************
    'Kopfdaten 4.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(12)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If

    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '//Zahlung mit Gutschein + EC-Lastschrift
    If gbGutschUNDlastschrift = True Then  'Achtung diese Variable muss auch zurückgesetzt werden
    
    
    
    Else
        '***********************************************
        'Artikelpositionen drucken
        '***********************************************
        
        iLevel = 4
        dSumme = 0
        iGesAnzahl = 0
        
        For lAktSatz = 0 To lAnzSatz - 1
            cLBSatz = List1.list(lAktSatz)
            
            cFeld = Mid(cLBSatz, 7, 6)
            If cFeld = "666666" Then
                bBonZwang = True
            End If
            lartnr = CLng(cFeld)
            If cFeld <> "000000" Then
                '1.Zeile: ArtNr + MWSTKz + ArtBezeich
                cDaten = cFeld & " "
                
                iLevel = 41
                cFeld = Mid(cLBSatz, 72, 1)
                cDaten = cDaten & cFeld ' & "  "
                cMWST = cFeld
                cMWSTzzgl = cMWST
                
                iLevel = 42
                'neu
                Dim cProv As String
                cProv = Mid(cLBSatz, 6, 1)
                cDaten = cDaten & cProv & " "
                'ende neu
                
                iLevel = 43
                cFeld = Mid(cLBSatz, 14, 35)
                cFeld = Trim$(cFeld)
                
                
                'neu
                Dim lVariablelaenge As Long
                lVariablelaenge = glZeichenAnzahlBon - 10
                
                If Len(cFeld) > lVariablelaenge Then
                    cFeld = Left(cFeld, lVariablelaenge)
                End If
                
                
'                If Len(cFeld) > 17 Then
'                    cFeld = Left(cFeld, 17)
'                End If
                
                iLevel = 44
                If gbDivKosmetik = True Then
                    If lartnr = 666666 Then
                        cDaten = cDaten & cFeld
                    Else
                        cDaten = cDaten & gcDivKosmetik
                    End If
                Else
                    cDaten = cDaten & cFeld
                End If
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
                
                '***********************************************
                'wenn Artikelermäßigung, dann drucken
                '***********************************************
                
                iLevel = 45
                ctmp = Mid(cLBSatz, 124, 3)
                If Val(ctmp) > 0 And gbRabatt Then
                    'Zeile nur bei Artikel-Ermäßigung drucken
                    
                    
                    
                    Dim dArtikelrabattinEuro As Double
                    dArtikelrabattinEuro = CDbl(Trim(Mid(cLBSatz, 84, 9)))
                    Dim dRabattierterGesamtPreisinEuro As Double
                    dRabattierterGesamtPreisinEuro = CDbl(Trim(Mid(cLBSatz, 60, 9)))
                    Dim dErgebnisinProz As Double
                    dErgebnisinProz = dArtikelrabattinEuro * 100 / (dRabattierterGesamtPreisinEuro + dArtikelrabattinEuro)
                    ctmp = Format$(dErgebnisinProz, "###,##0.00")
                    ctmp = CInt(ctmp)
                     
                    cDaten = "Rabatt:    " & ctmp & " %"
                    ctmp = Mid(cLBSatz, 84, 9)
                    dSparSatzsum = dSparSatzsum + CDbl(Trim(ctmp))
                    ctmp = fnMoveComma2Point$(ctmp)
                    ctmp = Space(9 - Len(ctmp)) & ctmp
                    cDaten = cDaten & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf

                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If

                
                
                '***********************************************
                'Anzahl, Einzelpreis, Positionspreis drucken
                '***********************************************
                
                
                If Left(cLBSatz, 1) = "x" Then
                    cAnz = Mid(cLBSatz, 2, 4)
                Else
                    cAnz = Mid(cLBSatz, 1, 5)
                End If
                
                
                
                iGesAnzahl = iGesAnzahl + Val(cAnz)
                
                iLevel = 46
                
                
                If Val(cAnz) < 0 Then
                    gbStorni = True
                End If
                
                If cProv = "*" Then
                    iLevel = 461
                
                    'wenn Sonderpreis, dann in Klammern hinter dem Einzelpreis den ListenVK
                
                
                    If Left(cLBSatz, 1) = "x" Then
                        cAnz = Mid(cLBSatz, 2, 4)
                    Else
                        cAnz = Mid(cLBSatz, 1, 5)
                    End If
                    
                    ctmp = Trim$(cAnz)
                    If Len(ctmp) < 4 Then
                        ctmp = ctmp & Space$(3 - Len(ctmp))
                        cDaten = ctmp & "x"
                    Else
                        ctmp = ctmp & Space$(4 - Len(ctmp))
                        cDaten = ctmp
                    End If
                    
                    
                    iLevel = 4611
                    
                    If gbRabatt Then
                        ctmp = Mid(cLBSatz, 74, 9)
                        ctmp = fnMoveComma2Point$(ctmp)
                        dWert = Val(ctmp)
                    Else
                        ctmp = Mid(cLBSatz, 50, 9)
                        ctmp = fnMoveComma2Point$(ctmp)
                        dWert = Val(ctmp)
                    End If
                    
                    iLevel = 4612
                    
                    'Ermittle VK-Preis von Artikel
                    Dim dKVKPR As Double
                    Dim cKVKPR As String
                    cKVKPR = Trim(ermKVKPR1(Mid(cLBSatz, 7, 6)))
                    
                    iLevel = 4613
                    
                    dKVKPR = 0
                    If IsNumeric(cKVKPR) Then
                        dKVKPR = CDbl(cKVKPR)
                    End If
                    
                    If dKVKPR > dWert Then
                        
                        If gbSonderPreisDarstellen = True Then
                    
                            ctmp = Format$(dWert, "###,##0.00")
                            ctmp = Space(7 - Len(ctmp)) & ctmp
                            cDaten = cDaten & ctmp
                            
                            ctmp = Format$(dKVKPR, "###,##0.00")
                            If Len(ctmp) < 7 Then
                                ctmp = Space(6 - Len(ctmp)) & "(" & ctmp & ")"
                                cDaten = cDaten & ctmp
                            End If
                        
                        Else
                            ctmp = Format$(dWert, "###,##0.00")
                            ctmp = Space(15 - Len(ctmp)) & ctmp
                            cDaten = cDaten & ctmp
                        
                        End If
                    
                    Else
                    
                        iLevel = 462
                    
                        ctmp = Format$(dWert, "###,##0.00")
                        ctmp = Space(15 - Len(ctmp)) & ctmp
                        cDaten = cDaten & ctmp
                    
                    End If
                Else
                    iLevel = 47
                    
                    If Left(cLBSatz, 1) = "x" Then
                        cAnz = Mid(cLBSatz, 2, 4)
                    Else
                        cAnz = Mid(cLBSatz, 1, 5)
                    End If
                    
                    ctmp = Trim$(cAnz)
                    ctmp = ctmp & Space$(6 - Len(ctmp))
                    cDaten = ctmp & " x"
                    
                    If gbRabatt Then
                        ctmp = Mid(cLBSatz, 74, 9)
                        ctmp = fnMoveComma2Point$(ctmp)
                        dWert = Val(ctmp)
                    Else
                        ctmp = Mid(cLBSatz, 50, 9)
                        ctmp = fnMoveComma2Point$(ctmp)
                        dWert = Val(ctmp)
                    End If
                    
                    
                    ctmp = Format$(dWert, "###,##0.00")
                    
                    ctmp = Space(11 - Len(ctmp)) & ctmp
                    cDaten = cDaten & ctmp
                    
                
                End If
                
                
                iLevel = 48
                
                
                ctmp = Mid(cLBSatz, 60, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
                If giPreisKz > 1 And giPreisKz < 4 Then
                    If cMWSTzzgl = "V" Then
                        dMWSTVzzgl = dMWSTVzzgl + (dWert * (gdMWStV / 100))
                    End If
                    If cMWSTzzgl = "E" Then
                        dMWSTEzzgl = dMWSTEzzgl + (dWert * (gdMWStE / 100))
                    End If
                End If
                ctmp = Format$(dWert, "###,##0.00")
                dSumme = dSumme + dWert
                ctmp = Space(13 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
                
                
                If gbDritteArtikelzeile Then
                
                    Dim sBedname As String
                
                    ctmp = Mid(cLBSatz, 148, 3)
                    ctmp = Trim$(ctmp)
                    
                    sBedname = ermBEDbez(Val(ctmp))
                    
                    
                    
                    lVariablelaenge = glZeichenAnzahlBon - 13
                
                    If Len(sBedname) > lVariablelaenge Then
                        sBedname = Left(sBedname, lVariablelaenge)
                    End If
                    
                    
                    
                    
                    ctmp = "Es bediente: " & sBedname
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
                
                
                
                
                
                
                
                
                
                
                '***********************************************
                'MWSt-Summe berechnen
                '***********************************************
                If cMWST = "V" Then
                    dMWSt = dWert / (100 + gdMWStV)
                    dMWSt = dMWSt * gdMWStV
                    dMWStVoll = dMWStVoll + dMWSt
                    
                    
                    dMWStAnteilNettoVoll = dMWStAnteilNettoVoll + ((dWert * 100) / (100 + gdMWStV))
                    dMWStAnteilBruttoVoll = dMWStAnteilBruttoVoll + dWert
                    
                ElseIf cMWST = "E" Then
                   dMWSt = dWert / (100 + gdMWStE)
                    dMWSt = dMWSt * gdMWStE
                    dMWStErm = dMWStErm + dMWSt
                    
                    
                    dMWStAnteilNettoErm = dMWStAnteilNettoErm + ((dWert * 100) / (100 + gdMWStE))
                    dMWStAnteilBruttoErm = dMWStAnteilBruttoErm + dWert
                Else
                    dMWSt = 0
                End If
            Else
            
                iLevel = 49
                
                
                'Zeile mit Zwischensumme drucken
                ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
                ctmp = Left(Trim(ctmp), 32)
                cDaten = ctmp
                
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
        Next lAktSatz
        
        '***********************************************
        'Trennstrich drucken
        '***********************************************
        iLevel = 5
        cDaten = String$(iLenZeile, "-")
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        
        '***********************************************
        'Summe drucken
        '***********************************************
        
        Dim dEndbetrag As Double
        dEndbetrag = 0
        ctmp = "Summe" & Space$(13) & gcWaehrung
'        ctmp = "Endbetrag" & Space$(9) & gcWaehrung
        cDaten = ctmp
        ctmp = Format$(gdSumme, "#####0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        
    End If '//If gcZahlMittel = "LS" And giZahlArt = 1 Then
    
    If gbGutschUNDlastschrift = True Then
        GoTo GutschECLast
    End If
    
    '***********************************************
    'Gesamtrabatt drucken
    '***********************************************
        
    If Label2(3).Visible And gbRabatt Then
        'Zeile nur bei Gesamt-Ermäßigung drucken
        
        dWert = fnHoleGesamtRabattModul20#()
        
        
        
        ctmp = Label2(3).Caption
        If Len(ctmp) > 6 Then
            ctmp = Left(ctmp, Len(ctmp) - 5)
        End If
        
        
        'sind Rabattwert und Gesamtrabattangabe negativ, so verfahren
        
        If dWert < 0 And CDbl(ctmp) < 0 Then
        
            'Köhler
            'dann Zeile nicht andrucken
            
            
        Else
        
            Dim cDruckGesRabattBezeichnung As String
            
            If gsiGESRAB > 0 Then
                cDruckGesRabattBezeichnung = Left(gsGESRABBEZ, 12) & ":"
            Else
                cDruckGesRabattBezeichnung = "GesRabatt:   "
            End If
        
            
            cDaten = cDruckGesRabattBezeichnung & Space(6 - Len(ctmp)) & ctmp & "% " & gcWaehrung
            
            
            
            
            
            
            
            
            
            
            
            dSparSatzsum = dSparSatzsum + dWert
        
            ctmp = Format$(dWert, "###,##0.00")
            ctmp = Space$(8 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        End If
        
        
    End If
    
    '***********************************************
    'Bei Preiskz = 2 oder 3 (EK-Preis) zzgl.MWST
    '***********************************************
    GoTo weiter1
    If giPreisKz > 1 And giPreisKz < 4 Then
        ctmp = "zzgl. MWSt.:  " & Format$(gdMWStV, "#0") & "%" & Space$(1) & gcWaehrung
        cDaten = ctmp
        ctmp = Format$(dMWSTVzzgl, "###,##0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
        gdSumme = gdSumme + dMWSTVzzgl
    
        ctmp = "zzgl. MWSt.:   " & Format$(gdMWStE, "#0") & "%" & Space$(1) & gcWaehrung
        cDaten = ctmp
        ctmp = Format$(dMWSTEzzgl, "###,##0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
        gdSumme = gdSumme + dMWSTEzzgl
        dSumme = gdSumme
    End If
    
weiter1:
    
    '***********************************************
    'Zahlungsart drucken
    'Bei Barzahlung ohne Rückgeld werden die Zeilen
    'Zahlungsart und Rückgeld unterdrückt
    '***********************************************
GutschECLast:

    bAusblenden = False
    iLevel = 603
    
    Dim dsumZollerstatt As Double
    dsumZollerstatt = 0
    For i = 0 To 10
        dsumZollerstatt = dsumZollerstatt + dZollEr(i)
    Next i
    
    'Achtung für Coslive
    If gcZahlArt(giZahlArt) = "Bar:" Then
        gcKreditKarte = ""
    End If
    'Ende Achtung für Coslive

    If gcZahlArt(giZahlArt) = "Bar:" And gdZurueck = 0 Then
        'könnte man so sagen aber noch eins
        If dsumZollerstatt > 0 Then
            bAusblenden = False
        Else
            bAusblenden = True
        End If
    End If
    
    If Not bAusblenden Then
        iLevel = 604
        
        
        
        If Trim(gcKreditKarte) = "" Then
            If UCase(Left(Trim$(gcZahlArt(giZahlArt)), 3)) = "AUS" Then
            
                ctmp = "Auszahlung " & gsEinAusBezeich
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
                
                gsEinAusBezeich = ""
                GoTo endbetrag
                 
                 
            ElseIf UCase(Left(Trim$(gcZahlArt(giZahlArt)), 3)) = "EIN" Then
                ctmp = "Einzahlung " & gsEinAusBezeich
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
                
                gsEinAusBezeich = ""
                GoTo endbetrag
            Else
                cTmp2 = Left(Trim$(gcZahlArt(giZahlArt)), 3) & " gegeben:"
            End If
            
            
            If giZahlArt = 1 Then 'Eclast
                If gb2BONKA = True Then
                    gbADTBON = True
                Else
                    gbADTBON = False
                End If

            End If
        Else
        
            If giZahlArt = 17 Then
                If gb2BONKA = True Then
                    gbADTBON = True
                Else
                    gbADTBON = False
                End If

            End If
            gcZahlArt(giZahlArt) = Trim$(gcZahlArt(giZahlArt))
            cTmp2 = gcZahlArt(giZahlArt) & " " & gcKreditKarte
        End If
        
        
        
        cTmp2 = Trim$(cTmp2)
        cTmp2 = cTmp2 & Space$(17 - Len(cTmp2))
        iLevel = 605
        
        ctmp = cTmp2 & Space$(1) & gcWaehrung
        cDaten = ctmp
        
        If gsUK <> "0" Then 'Fremdwährung im Spiel
            ctmpFW = cTmp2 & Space$(1) & gsFWK
            cDatenfw = ctmpFW
        End If
        
        If giPreisKz > 1 And giPreisKz < 4 Then
            gdGegeben = dSumme
        Else
            If Frame10.Visible = True Or Frame18.Visible = True Then  '//kein Barzahlung
                 gdGegeben = dSumme
                 If InStr(1, ctmp, "Einz.:") > 0 Or InStr(1, ctmp, "Ausz.:") > 0 Then
                    gdGegeben = gdSumme
                 End If
            Else
                'Barbon
                'Basiswährung
                ctmp = ""
                ctmp = Trim$(Text333.Text)
                ctmp = fnMoveComma2Point$(ctmp)
                gdGegeben = Val(ctmp)
                
                If gsUK <> "0" Then 'Fremdwährung im Spiel
                    'Fremdwährung
                    ctmpFW = ""
                    ctmpFW = Trim$(Text88.Text)
                    ctmpFW = fnMoveComma2Point$(ctmpFW)
                    gdGegebenFW = Val(ctmpFW)
'                    gdGegebenFW
                End If
            End If
        End If
        
        If gbGutschUNDlastschrift = True Then
            ctmp = Format$(gdGutLastRest, "###,##0.00")
        Else
            If dSumDukaten > 0 Then
                gdGegeben = gdGegeben - dSumDukaten
            End If
        
            ctmp = Format$(gdGegeben, "###,##0.00")
            If gsUK <> "0" Then 'Fremdwährung im Spiel
                ctmpFW = Format$(gdGegebenFW, "###,##0.00")
            End If
        End If
        
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        iLevel = 606
        
        
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        
        
        
        If dSumDukaten > 0 Then
        
            ctmp = "Dukaten gegeben: " & Space$(1) & gcWaehrung & Space$(11 - Len(Format$(dSumDukaten, "###,##0.00"))) & Format$(dSumDukaten, "###,##0.00")
            
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            iLevel = 606
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        End If
        
        If gsUK <> "0" Then 'Fremdwährung im Spiel
            ctmpFW = Space$(11 - Len(ctmpFW)) & ctmpFW
            cDatenfw = cDatenfw & ctmpFW
            KonvertAnsiAscii cDatenfw
            cEscapeSequenz = cDatenfw & vbCrLf
            iLevel = 606
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    
    'sind Zollerstatungen im Spiel, dann ist es immer eine Barzahlung
    
    'davon als Zollerstattung
    If dsumZollerstatt > 0 Then
    
        cDaten = "darin enthalten (Bar gegeben):"
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf

        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
        For i = 0 To 10

            If dZollEr(i) > 0 Then

                cDaten = "Rückerstattung St." & gcWaehrung & Space$(11 - Len(Format$(dZollEr(i), "###,##0.00"))) & Format$(dZollEr(i), "###,##0.00")
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                iLevel = 606

                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz

            End If
        Next i
        
        '***********************************************
        'Zeile Trennstrich drucken
        '***********************************************
        cDaten = String$(iLenZeile, "_")
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    
'        cDaten = "enthaltene Zollerstattungbeträge:"
'        KonvertAnsiAscii cDaten
'        cEscapeSequenz = cDaten & vbCrLf
'
'        lAnzZeile = lAnzZeile + 1
'        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'        cDruckZeile(lAnzZeile) = cEscapeSequenz
'
'        For i = 0 To 10
'
'            If dZollEr(i) > 0 Then
'
'                cDaten = Format$(dZollEr(i), "###,##0.00")
'                KonvertAnsiAscii cDaten
'                cEscapeSequenz = cDaten & vbCrLf
'                iLevel = 606
'
'                lAnzZeile = lAnzZeile + 1
'                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'                cDruckZeile(lAnzZeile) = cEscapeSequenz
'
'            End If
'        Next i
    End If
    'Ende davon als Zollerstattung
    
    
    
    
    '***********************************************
    'Rückgeld drucken
    'Bei Barzahlung ohne Rückgeld werden die Zeilen
    'Zahlungsart und Rückgeld unterdrückt
    '***********************************************
    If Not bAusblenden Then
        iLevel = 607
        ctmp = "Zurück:" & Space$(11) & gcWaehrung
        cDaten = ctmp
        ctmp = Format$(gdZurueck, "###,##0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        iLevel = 608
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Endbeterag' drucken
    '***********************************************
endbetrag:
    iLevel = 6101
    ctmp = "Endbetrag"
    
    ctmp = ctmp & Space$(21 - Len(ctmp) - 3)
    iLevel = 605
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "###,##0.00")
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    If gsUK <> "0" Then 'Fremdwährung im Spiel
        
        '***********************************************
        'Wechselkurs drucken
        '***********************************************
        ctmp = Format$(gsUK, "###,##0.00##")
        ctmp = Space$(13 - Len(ctmp)) & ctmp
        cDaten = "Wechselkurs " & gcWaehrung & "\" & gsFWK & ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        Dim dErg As Double
        
        dErg = 1 * CDbl(gsUK)
        ctmp = "1 " & gsFWK & " = " & Format$(dErg, "###,##0.00 " & gcWaehrung)
        
        cDaten = ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        '***********************************************
        'Zeile Leerzeile drucken
        '***********************************************
        cEscapeSequenz = vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    End If
    
    
    
    
    '***********************************************
    'Zeile 'Storno Unterschrift' drucken
    '***********************************************
    
    
    If gbStorni Then
    
    
    
    
    
    
    
    
    
    
    
        If gbKurzerStorni Then
    
            If gb2BONST = True Then
                gbADTBON = True
            Else
                gbADTBON = False
            End If
            cDaten = "Betrag erhalten bzw. verrechnet "
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            cDaten = "      (Unterschrift Kunde)      "
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        Else
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
            If gb2BONST = True Then
                gbADTBON = True
            Else
                gbADTBON = False
            End If
            cDaten = "Betrag erhalten bzw. verrechnet "
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "KULANZ-REKLAMATION"
            
            
            
            
            
            cDaten = String$(Fix(iLenZeile - Len(cDaten)) / 2, "*") & cDaten & String$(Fix(iLenZeile - Len(cDaten)) / 2, "*")
            
            
            
            
            
            
            
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Kaufdatum:______________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Belegnummer:____________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            cDaten = "Kaufort:________________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Zahlart:________________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Kundenname:_____________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "KundenNr:_______________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Straße:_________________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "PLZ/ORT:________________________"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            cDaten = "Telefon:"
            cDaten = cDaten & String$(iLenZeile - Len(cDaten), "_")
            
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            'Zeile Trennstrich drucken
            cDaten = String$(iLenZeile, "_")
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            cDaten = "Grund der Rückgabe"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            'Zeile Trennstrich drucken
            cDaten = String$(iLenZeile, "_")
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            
            
            
            'Leerzeile
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            cDaten = "wie gelöst? Bitte ankreuzen!"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            cDaten = "   Umtausch"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            cDaten = "   Gutschein erhalten"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "   Bargeld erhalten"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            
            'Zeile Trennstrich drucken
            cDaten = String$(iLenZeile, "_")
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
        
         
            
            
            
            
            
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            
            
            'Zeile Trennstrich drucken
            cDaten = String$(iLenZeile, "_")
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            cDaten = "(Unterschrift Kunde)"
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            
            
            
            cEscapeSequenz = vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            
            
            'Zeile Trennstrich drucken
            cDaten = String$(iLenZeile, "_")
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
           
            cDaten = "(Unterschrift Verkäufer)"
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
        End If
        
        
        
        
    End If
 
    '***********************************************
    'Zeile 'Anzahl Artikel' drucken
    '***********************************************
    If iGesAnzahl > 1 Then
        ctmp = "Anzahl Artikel: " & iGesAnzahl
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    If gbDritteArtikelzeile = False Then
        'Zeile 'Es bediente:' drucken  wenn die  3. Artikelzeile eingeblendet wird, dann nicht
    
        ctmp = "Es bediente Sie"
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        '***********************************************
        'Zeile Bedienername drucken
        '***********************************************
        iLevel = 611
        
        ctmp = gcBediener
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    End If
    
    If gbKASSNRUNTER = False Then
        '***********************************************
        'Zeile 'Kassennummer' drucken
        '***********************************************
        
        ctmp = "Kasse: " & gcKasNum
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    If Trim(gcKreditKarte) <> "" And gsZVT2_VirtuellID <> "" And gbZVT2_vTIDdrucken = True Then
        ctmp = "Terminal ID: " & gsZVT2_VirtuellID
        cDaten = ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
     gbZVT2_vTIDdrucken = False
    
    iLevel = 612
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    
    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
        
        iLevel = 613
        ctmp = "Ihre KundenNr: " & Label2(7).Caption
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        
    
        If gbKUNDENA = True Then
        
            If gbKUIBONfirma Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).firma
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            If gbKUIBONtitel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).titel
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            ctmp = ""
            If gbKUIBONvorname Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
            End If
            
            If gbKUIBONname Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).nachname
            End If
    
        
            iLevel = 614
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            If gbKUIBONstrasse Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
            
                iLevel = 615
                If Len(ctmp) > 32 Then
                    ctmp = Left(ctmp, 32)
                End If
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            ctmp = ""
            If gbKUIBONplz Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
            End If
            
            If gbKUIBONort Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).Ort
            End If
        
            iLevel = 616
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            iLevel = 617
            
            If gbKUIBONtel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).telefon
                If ctmp <> "" Then
                    cDaten = "Tel " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            iLevel = 618
            
            If gbKUIBONmobil Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Mobiltel
                If ctmp <> "" Then
                    cDaten = "Mobil " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
        End If
        
        
        'wenn schon mit Kundenbindung dann auch mit bonusvariante 1
        
        Dim sEinText As String
        Dim sWort As String
        
        cLBSatz = ""
        
        If giBonusNr = 0 Then
        
            sEinText = Trim(gsTextVor) & " " & Val(Label1(14).Caption) & " " & Trim(gsTextNach) & " "

        
            If Len(sEinText) > iLenZeile Then
                Do While Len(sEinText) > 0
                    sWort = Mid(sEinText, 1, InStr(1, sEinText, " ") - 1)
                    
                    If Len(cLBSatz & sWort & Space(1)) > iLenZeile Then
                    
                        cDaten = cLBSatz
                        KonvertAnsiAscii cDaten
                        cEscapeSequenz = cDaten & vbCrLf
                        
                        lAnzZeile = lAnzZeile + 1
                        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                        cDruckZeile(lAnzZeile) = cEscapeSequenz
                        
                        cLBSatz = ""
                        
                    End If
                    
                    cLBSatz = cLBSatz & sWort & Space(1)
                    sEinText = Mid(sEinText, Len(sWort) + 2, Len(sEinText) - Len(sWort) + 1)
                Loop
                
                cDaten = cLBSatz
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
                
            Else
                cLBSatz = sEinText
                cDaten = cLBSatz
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
        End If
    End If
    
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    
    iLevel = 6151
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6152
    cDaten = cDaten & Space$(4) & ctmp
    
    
    If gbKASSNRUNTER = False Then
        If giZahlArt = giKOLLEGE Then
            ctmp = "0"
            gdBonNr = 0
        Else
           
            ctmp = Format$(gdBonNr, "#####0")
            If gbSPIEGEL Then
            
                Dim ctmp111 As String
                Dim N As Integer
                ctmp111 = ctmp
                ctmp = ""
                For N = Len(ctmp111) To 1 Step -1
                
                    ctmp = ctmp & Mid(ctmp111, N, 1)
                
                Next N
            End If
            
        End If
        iLevel = 6153
        ctmp = gcKasNum & "/" & ctmp
        iLevel = 6154
        ctmp = Space$(8 - Len(ctmp)) & ctmp
        iLevel = 6155
        cDaten = cDaten & Space$(4) & ctmp
    End If
    
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Lieferschein bei Kreditverkäufen drucken
    '***********************************************
    
    iLevel = 7
    
    If giAndersZahlung = giKREDIT Then
        iLevel = 800
            
        ctmp = Label2(7).Caption
        ctmp = Trim$(ctmp)
        If gbGiltAlsRechnung Then
            cDaten = "Kassenbon gilt als Rechnung!"
        Else
            cDaten = "Kassenbon gilt als Lieferschein!"
        End If
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        '***********************************************
        'Zeile Leerzeile bei Kreditverkauf drucken
        '***********************************************
        cEscapeSequenz = vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        '***********************************************
        'Zeile Kundennummer bei Kreditverkauf drucken
        '***********************************************
        cDaten = "Ihre Kunden-Nr: " & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        

        cVorname = Trim(lookingForKundendaten(Trim(Label2(7).Caption)).vorname)
        
        If Len(cVorname) > 0 Then
            cVorname = Left(cVorname, 1) & ". "
        End If
        
        cNachname = Trim(lookingForKundendaten(Trim(Label2(7).Caption)).nachname)
        
        If Len(cNachname) > 30 Then
            cNachname = Left(cNachname, 30)
        End If

        ctmp = cVorname & cNachname
        
        
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf

        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz

        '***********************************************
        'Zeile Leerzeile bei Kreditverkauf drucken
        '***********************************************
        cEscapeSequenz = vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        '***********************************************
        'Zeile Leerzeile bei Kreditverkauf drucken
        '***********************************************
        cEscapeSequenz = vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        '***********************************************
        'Zeile Trennstrich drucken
        '***********************************************
        cDaten = "--------------------------------"
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        '***********************************************
        'Zeile Unterschrift Kunde bei Kreditverkauf drucken
        '***********************************************
        cDaten = "      (Unterschrift Kunde)      "
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        iLevel = 9
    End If
    
    
    
    '****enventuell angefallene Garantiedaten einfügen
    
    If sind_Garatie_daten_zu_drucken(gdBonNr) = True Then
    
        iLevel = 701
    
        
        cDaten = "*** Garantie - Informationen ***"
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        ermGarantie_daten gdBonNr
        
        iLevel = 702
        
        '3 Arrays auslesen
        Dim cWert As String
        Dim iCount As Integer
        For iCount = 1 To UBound(gcArrArtNr)
        
        
            'Artikelnummer
            cWert = gcArrArtNr(iCount)
            If cWert <> "" Then
                
            
                cDaten = "zu Artikel: " & cWert
                cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            End If
            
            iLevel = 703
            
            'Seriennummer
            
            cWert = gcArrSerienNr(iCount)
            If cWert <> "" Then
                
                If Len(cWert) <= 22 Then
            
                    cDaten = "SerienNr: " & cWert
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    
                ElseIf Len(cWert) <= 32 Then
                
                    cDaten = "SerienNr: "
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    
                    cDaten = cWert
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    
                ElseIf Len(cWert) > 32 Then
                
                    Dim sNeuWert As String
                    
                    sNeuWert = Right(cWert, Len(cWert) - 22)
                
                    cDaten = "SerienNr: " & Left(cWert, 22)
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    
                    cDaten = Left(sNeuWert, 32)
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    
                    Do While Len(sNeuWert) >= 32
                        sNeuWert = Right(sNeuWert, Len(sNeuWert) - 32)
                        
                        If sNeuWert <> "" Then
                            cDaten = Left(sNeuWert, 32)
                            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                            KonvertAnsiAscii cDaten
                            cEscapeSequenz = cDaten & vbCrLf
                            lAnzZeile = lAnzZeile + 1
                            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                            cDruckZeile(lAnzZeile) = cEscapeSequenz
                        End If
                    Loop
                    
                    
                
                End If
            
            End If
            
            
            
            
            
        Next iCount
        
        iLevel = 704
    
        cDaten = "*** Garantie - Informationen ***"
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    End If
    
    
    '**** ENDE enventuell angefallene Garantiedate einfügen
    
    
    
    
    
    iLevel = 750
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, gsSTERNZEICH)
'    cDaten = String$(iLenZeile, "*")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    If giPreisKz = 6 Then
    
        '***********************************************
        'Zeile Nettoumsatz
        '***********************************************
        iLevel = 6
        ctmp = "Nettoumsatz"
        cDaten = ctmp
        ctmp = Format$(gdSumme, "###,##0.00")
        ctmp = Space$(15 - Len(ctmp)) & ctmp
        iLevel = 601
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
    
        iLevel = 602
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    
    Else
    
        '***********************************************
        'Zeile Nettoumsatz
        '***********************************************
        iLevel = 6
        ctmp = "Nettoumsatz"
        cDaten = ctmp
        ctmp = Format$((gdSumme - (dMWStVoll + dMWStErm)), "###,##0.00")
        ctmp = Space$(15 - Len(ctmp)) & ctmp
        iLevel = 601
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
    
        iLevel = 602
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        
        
        If gbMitMwstAnteile = True Then
            'Neu
            'Möchten wir hier den Nettoumsatz gesplittet nach MWST_Arten darstellen
            
            '***********************************************
            'Zeile Anteil Netto volle MWSt drucken
            '***********************************************
            If dMWStAnteilNettoVoll <> 0 Then
                iLevel = 6999
        
                ctmp = "Nettoumsatz:  " & Format$(gdMWStV, "#0") & "%"
                cDaten = ctmp
                ctmp = Format$(dMWStAnteilNettoVoll, "###,##0.00")
                ctmp = Space$(9 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
        
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
        
            '***********************************************
            'Zeile Anteil Netto erm. MWSt drucken
            '***********************************************
            If dMWStAnteilNettoErm <> 0 Then
                iLevel = 6999
        
                ctmp = "Nettoumsatz:  " & Format$(gdMWStE, "#0") & "%"
                cDaten = ctmp
                ctmp = Format$(dMWStAnteilNettoErm, "###,##0.00")
                ctmp = Space$(10 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
        
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            
            
            'Ende Neu
        
        End If
        
        
        
        
        
        
        
        
        
        
        
        
        '***********************************************
        'Zeile volle MWSt drucken
        '***********************************************
        If dMWStVoll <> 0 Then
            iLevel = 609
        
            ctmp = "MWSt.-Anteil: " & Format$(gdMWStV, "#0") & "%"
            cDaten = ctmp
            ctmp = Format$(dMWStVoll, "###,##0.00")
            ctmp = Space$(9 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    
        '***********************************************
        'Zeile erm. MWSt drucken
        '***********************************************
        If dMWStErm <> 0 Then
            iLevel = 610
        
            ctmp = "MWSt.-Anteil: " & Format$(gdMWStE, "#0") & "%"
            cDaten = ctmp
            ctmp = Format$(dMWStErm, "###,##0.00")
            ctmp = Space$(10 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        
        
        If gbMitMwstAnteile = True Then
        
            'Neu
            'Möchten wir hier den Bruttoumsatz gesplittet nach MWST_Arten darstellen
            
            '***********************************************
            'Zeile Anteil Brutto volle MWSt drucken
            '***********************************************
            If dMWStAnteilBruttoVoll <> 0 Then
                iLevel = 6999
        
                ctmp = "Bruttoumsatz: " & Format$(gdMWStV, "#0") & "%"
                cDaten = ctmp
                ctmp = Format$(dMWStAnteilBruttoVoll, "###,##0.00")
                ctmp = Space$(9 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
        
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
        
            '***********************************************
            'Zeile Anteil Brutto erm. MWSt drucken
            '***********************************************
            If dMWStAnteilBruttoErm <> 0 Then
                iLevel = 6999
        
                ctmp = "Bruttoumsatz: " & Format$(gdMWStE, "#0") & "%"
                cDaten = ctmp
                ctmp = Format$(dMWStAnteilBruttoErm, "###,##0.00")
                ctmp = Space$(10 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
        
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            'Ende Neu
        End If
        
        
        
        
        
        
        
    
        '***********************************************
        'Zeile Bruttoumsatz
        '***********************************************
        
        iLevel = 6101
        ctmp = "Bruttoumsatz"
        cDaten = ctmp
        ctmp = Format$(gdSumme, "###,##0.00")
        ctmp = Space$(14 - Len(ctmp)) & ctmp
        iLevel = 6102
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        iLevel = 6103
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    End If
    
   If gbSparsatz And dSparSatzsum > 0 Then
        '***********************************************
        'Zeile 'Sie sparen' drucken
        '***********************************************
        
        ctmp = "Rabattsumme(" & gcWaehrung & "):" & Space$(4) & Format$(dSparSatzsum, "###,##0.00 ")
        dSparSatzsum = 0
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    End If
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************

    cDaten = String$(iLenZeile, gsSTERNZEICH)
'    cDaten = String$(iLenZeile, "*")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    
    
    '***********************************************
    'Zeile Karteninfo
    '***********************************************
    Dim sTempBeleg As String
    Dim lPos As Long
    
    
    '''''''''''''''''''''''''''' Check gsAdtBeleg START
    If gsAdtBeleg <> "" Then
    
        If gADTipAdress <> "" And gADTport <> "" Then 'NEU NACH TA 7.0
        
            If InStr(gsAdtBeleg, "Unterschrift umseitig") > 0 Then
    
                sTempBeleg = gsAdtBeleg
                sTempBeleg = SwapStr(sTempBeleg, Space(35), "")
                lPos = InStr(sTempBeleg, "Unterschrift umseitig")
        
                sTempBeleg = Mid(sTempBeleg, 166, lPos - 200)
                
    '            MsgBox sTempBeleg
                
                cDaten = "Kundenbeleg"
                If cDaten <> "" Then
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
        
                Do While Len(sTempBeleg) > 0
                    cDaten = Left(sTempBeleg, 32)
                    
                    If Left(cDaten, 3) = "BLZ" Then
                        cDaten = Left(cDaten, 21) & Space(1) & "xxxxxxx" & Right(cDaten, 3)
                    End If
                    
                    If Len(sTempBeleg) >= 33 Then
                        sTempBeleg = Right(sTempBeleg, Len(sTempBeleg) - 33)
                    Else
                        sTempBeleg = ""
                    End If
        
                    If cDaten <> "" Then
                        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                        KonvertAnsiAscii cDaten
                        cEscapeSequenz = cDaten & vbCrLf
                        lAnzZeile = lAnzZeile + 1
                        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                        cDruckZeile(lAnzZeile) = cEscapeSequenz
                    End If
                Loop
                
            ElseIf InStr(gsAdtBeleg, "Autorisierungsnummer") > 0 Or InStr(gsAdtBeleg, "EMV-Daten") > 0 Then
        
                sTempBeleg = gsAdtBeleg
                sTempBeleg = SwapStr(sTempBeleg, Space(35), "")
                
                If InStr(gsAdtBeleg, "Autorisierungsnummer") > 0 Then
                    lPos = InStr(sTempBeleg, "Autorisierungsnummer")
                ElseIf InStr(gsAdtBeleg, "EMV-Daten") > 0 Then
                    lPos = InStr(sTempBeleg, "EMV-Daten")
                End If
               
        
                sTempBeleg = Mid(sTempBeleg, 166, lPos + 30 - 164)
                
                cDaten = "Kundenbeleg"
                If cDaten <> "" Then
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
        
                Do While Len(sTempBeleg) > 0
                    cDaten = Left(sTempBeleg, 32)
                    
                    If Left(cDaten, 9) = "Kartennr." Then
                        cDaten = "Kartennr." & Space(4) & "xxxxxxxxxxxxxxx" & Right(cDaten, 4)
                    End If
                    
                    If Len(sTempBeleg) >= 33 Then
                        sTempBeleg = Right(sTempBeleg, Len(sTempBeleg) - 33)
                    Else
                        sTempBeleg = ""
                    End If
        
                    If cDaten <> "" Then
                        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                        KonvertAnsiAscii cDaten
                        cEscapeSequenz = cDaten & vbCrLf
                        lAnzZeile = lAnzZeile + 1
                        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                        cDruckZeile(lAnzZeile) = cEscapeSequenz
                    End If
                Loop
            End If
        Else
            sTempBeleg = gsAdtBeleg
            sTempBeleg = SwapStr(sTempBeleg, Space(35), "")
            lPos = InStr(sTempBeleg, "**")
            
            sTempBeleg = Left(sTempBeleg, lPos + 30)
    
            Do While Len(sTempBeleg) > 0
            
                cDaten = Left(sTempBeleg, 32)
                
                If Len(sTempBeleg) >= 33 Then
                    sTempBeleg = Right(sTempBeleg, Len(sTempBeleg) - 33)
                Else
                    sTempBeleg = ""
                End If
                
                If cDaten <> "" Then
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
                
            Loop
        
        End If
 End If
 '''''''''''''''''''''''''''' Check gsAdtBeleg ENDE
 
     
'TSE Footer START  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< START
    
    
    'wenn Endbetrag <= 0, dann TSE überspringen, weil ein
    'Kassenbon mit 0 Endbetrag nicht signiert wird
    If gdSumme > 0 Or gdSumme < 0 Then
    
    Else
    
        R_StartTime = ""
        R_FinishTime = ""
        R_TransactionNr = ""
        R_QRCodeAlsText = ""
        R_QRCodeAlsImgPath = ""
        R_FinishSignatur = ""
        R_StartSignatur = ""
        GoTo NACH_TSE
        
    End If
    
    
    
 
    If E_TSE_Aktiv And TSE_OK Then

            'nur erster Kassenbon wird signiert
            If iAktCopy < 2 Then
            
                'Bon signieren <<<<<<<<<<<< START
                
                    If giZahlArt = 8 Then
                    'BAR
                        TransactionSchreiben "", 1, 1, dMWStVoll, dMWStErm, 0, 0, 0, gdSumme, 0
                    Else
                    'UNBAR
                       TransactionSchreiben "", 1, 1, dMWStVoll, dMWStErm, 0, 0, 0, 0, gdSumme
                    End If
                 
                'Bon signieren <<<<<<<<<<<< ENDE
                
             End If
     
            If TSE_OK Then

                    '''''''''''''''''''  TSE Start  ''''''''''''''''''''''''
                    cDaten = "TSE Start: " & R_StartTime

                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf

                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz

                    '''''''''''''''''''  TSE Ende  ''''''''''''''''''''''''''
                    cDaten = "TSE Ende: " & R_FinishTime

                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf

                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz

                    '''''''''''''''  TSE Transaction.Nr  '''''''''''''''''''
                    cDaten = "TSE Transaction.Nr: " & R_TransactionNr

                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf

                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz

                    '''''''''''''''''''  TSE Signatur  ''''''''''''''''''''''''
                    cDaten = "TSE Signatur: " & vbNewLine & SplitStringNachCharZahl(5, R_FinishSignatur, 32)

                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf

                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    

                    '''''''''''''''''''  TSE alle Info zusammen (Optional) ''''''''''''''''''''''''
'                    cDaten = "TSE Info: " & vbNewLine & SplitStringNachCharZahl(5, R_QRCodeAlsText, 32)
'
'                    KonvertAnsiAscii cDaten
'                    cEscapeSequenz = cDaten & vbCrLf
'
'                    lAnzZeile = lAnzZeile + 1
'                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    
               Else

                    cDaten = "TSE nicht erreichbar !!!"

                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf

                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
               End If
        Else

            cDaten = "TSE ist deaktiviert/falsch" & vbNewLine & "     initialisiert !!!"

            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf

            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            ' initialisiert
 
            
'        cDaten = "TSE Start: " & TSS.TRStart 'Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
'
'        KonvertAnsiAscii cDaten
'        cEscapeSequenz = cDaten & vbCrLf
'
'        lAnzZeile = lAnzZeile + 1
'        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'        cDruckZeile(lAnzZeile) = cEscapeSequenz
'
'
'        cDaten = "TSE Ende: " & TSS.TRFinish 'Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
'
'        KonvertAnsiAscii cDaten
'        cEscapeSequenz = cDaten & vbCrLf
'
'        lAnzZeile = lAnzZeile + 1
'        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'        cDruckZeile(lAnzZeile) = cEscapeSequenz
'
'
'        cDaten = "TSE TaNr: " & TSS.TRNo 'Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
'
'        KonvertAnsiAscii cDaten
'        cEscapeSequenz = cDaten & vbCrLf
'
'        lAnzZeile = lAnzZeile + 1
'        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'        cDruckZeile(lAnzZeile) = cEscapeSequenz
'
'
'
'
'
'        cDaten = "TSE Serial: " & TSS.Serial 'Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
'
'        KonvertAnsiAscii cDaten
'        cEscapeSequenz = cDaten & vbCrLf
'
'        lAnzZeile = lAnzZeile + 1
'        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'        cDruckZeile(lAnzZeile) = cEscapeSequenz

 
     End If
    
   'TSE Footer ENDE <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< ENDE
    
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************

    cDaten = String$(iLenZeile, gsSTERNZEICH)
   'cDaten = String$(iLenZeile, "*")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
NACH_TSE:

    '***********************************************
    'Fußzeile 1 drucken
    '***********************************************
    
    'Fußzeilen
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "KEIN GÜLTIGER KASSENBON!"
    Else
        cDaten = gcBonText(2)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 2 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(3)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    
    '***********************************************
    'Fußzeile 3 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = ""
    Else
        cDaten = gcBonText(5)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    
    '***********************************************
    'Fußzeile 4 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(6)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 5 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(7)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 6 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(8)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If

    '***********************************************
    'Fußzeile 7 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(9)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 8 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(10)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 9 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(11)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, gsSTERNZEICH)
   'cDaten = String$(iLenZeile, "*")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    'Zwischendrin eventuell die anfallenden Garantiedaten
    
    
    
    'Am Ende eventuell einen Rabattgutschein für den nächsten Einkauf
    
    
    
    iLevel = 1050
    
    cLBSatz = ""
        
    Dim bGutscheinbedingung_erfuellt As Boolean
    bGutscheinbedingung_erfuellt = False
            
    If giBonusNr = 1 Then
        iLevel = 1052
        If gbWWKundBi Then 'nur mit Kundenbindung Gutschein anbieten
            If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
                bGutscheinbedingung_erfuellt = True
            End If
        Else
            bGutscheinbedingung_erfuellt = True
        End If
        
        iLevel = 1053
    
        If bGutscheinbedingung_erfuellt = True Then
        
            
            iLevel = 1054
            'für alle bonusfähigen Artikel größer Schwellenwert gibt es einen Rabattgutschein
            Dim dRabattfWert As Double
            Dim dDruckRabattWert As Double
            
            dRabattfWert = ermWertrabattf_Artikel
            
            'ich drucke Gutschein - dafür nehme ich den Bonus beim Kunden zurück
                           
            iLevel = 1055
            BonusVeränderung "negativ", CLng(Label2(7).Caption), dRabattfWert, 0
            iLevel = 1056
            If dRabattfWert >= CDbl(gsWWSchwellenwert) Then
                '***********************************************
                'Zeile Leerzeile drucken
                '***********************************************
                cDaten = String$(iLenZeile, " ")
                cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
                
                '***********************************************
                'Zeile  drucken
                '***********************************************
                
                cDaten = "---------- Gutschein -----------"
                cDaten = Trim$(cDaten)
                If cDaten <> "" Then
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
                
                '***********************************************
                'Zeile Leerzeile drucken
                '***********************************************
                cDaten = String$(iLenZeile, " ")
                cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
                
                iLevel = 1057
            
                If gsWWArt = "Prozent" Then
                    iLevel = 1058
                    dDruckRabattWert = dRabattfWert * CDbl(gsWWwert) / 100
                Else
                    iLevel = 1059
                    dDruckRabattWert = CDbl(gsWWwert)
                End If
                iLevel = 1060
                sEinText = Trim(gsTextVor) & " " & Format(dDruckRabattWert, "###,##0.00") & " " & Trim(gsWWZeichen) & " " & Trim(gsTextNach) & " "
            
                If Len(sEinText) > iLenZeile Then
                    Do While Len(sEinText) > 0
                        sWort = Mid(sEinText, 1, InStr(1, sEinText, " ") - 1)
                        
                        If Len(cLBSatz & sWort & Space(1)) > iLenZeile Then
                            cDaten = cLBSatz
                            KonvertAnsiAscii cDaten
                            cEscapeSequenz = cDaten & vbCrLf
                            
                            lAnzZeile = lAnzZeile + 1
                            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                            cDruckZeile(lAnzZeile) = cEscapeSequenz
                            cLBSatz = ""
                        End If
                        
                        iLevel = 1061
                        
                        cLBSatz = cLBSatz & sWort & Space(1)
                        sEinText = Mid(sEinText, Len(sWort) + 2, Len(sEinText) - Len(sWort) + 1)
                    Loop
                    
                    
                    
                    
                    cDaten = cLBSatz
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                    
                    If Val(gsWWBonusGDAUER) > 0 Then
                        cDaten = "Gültigkeit bis " & Format(DateValue(Now) + gsWWBonusGDAUER, "DD.MM.YYYY")
                        KonvertAnsiAscii cDaten
                        cEscapeSequenz = cDaten & vbCrLf
                        lAnzZeile = lAnzZeile + 1
                        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                        cDruckZeile(lAnzZeile) = cEscapeSequenz
                    End If
                    
                Else
                
                    iLevel = 1062
                    cLBSatz = sEinText
                    cDaten = cLBSatz
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
                


            End If
        End If
    End If
    
    iLevel = 1070
    
    '************************************************
    'ein paar Leerzeilen drucken  <<<<<<<<<<<< START
    '************************************************
    If Not MitQrCode Or Not E_TSE_Aktiv Or Not gdSumme > 0 Or Not TSE_OK Or altDruckModus Then
        'Barcode Bonus auf Bon
        If gsWWBonusArtnr <> "0" And dDruckRabattWert > 0 Then
        
        Else
         
        
        For lcount = 1 To 9
            If lcount = 9 Then
               cEscapeSequenz = vbCrLf
            Else
               cEscapeSequenz = " " & vbCrLf
            End If
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        Next lcount
        
        End If
        
    End If
    '***********************************************
    'ein paar Leerzeilen drucken  <<<<<<<<<<<< ENDE
    '***********************************************
        
        
        
        
        
        
    'OpenDrawer3 benutzt die WindowsAPI
    'OpenDrawer4 geht über das PRINTER-Objekt
    
    'Schublade nur einmal öffnen
    
    If giAndersZahlung = giKREDIT And iAktCopy = 2 Then
        GoTo BON_DRUCKEN
    End If
    
    iLevel = 12
    'Kassenschublade öffnen (ich habe es auskommentiert, weil die Schublade oben unter (SCHUBLADE:)-Block schon geöffnet wurde)
    'If giZahlArt = 17 And gbKKSCHUB = True Then
    
    'ElseIf giZahlArt = giKOLLEGE And gbKOLSCHUB = True Then
    
    'Else
        'If gbLadeCom Then
            'OpenDrawerViaComPortModul20
        'Else
            'If gbAPI = True Then
                'aDeviceName = Printer.DeviceName
                'cEscapeSequenz = gcLade
                'OpenDrawer aDeviceName, cEscapeSequenz
            'End If
        'End If
    'End If
    
    If giZahlArt = giKOLLEGE Then
        bBonZwang = True
    End If
    
    
BON_DRUCKEN:
    If bBonZwang Then
        gbBonDruck = True
    End If
    If gbBonDruck Then
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    End If
     
    
    Dim bPlusLZ As Boolean
    bPlusLZ = False
    
    If gbBonDruck Then
        If gsWWBonusArtnr <> "0" Then
            If dDruckRabattWert > 0 Then
                Barcode_Bonus CStr(dDruckRabattWert), "7"
                bPlusLZ = True
            End If
        End If
    Else
        If gsWWBonusArtnr <> "0" And dDruckRabattWert > 0 Then
            bPlusLZ = True
        End If
    End If
    
    
    
    
        
    If iAktCopy = 1 Then
        'Bon-Daten sichern
        
        Dim cKK_art As String
        Select Case giZahlArt
            Case 5
                cKK_art = "KR"
            Case 8
                cKK_art = "BA"
            Case 6
                cKK_art = "SC"
            Case 1
                cKK_art = "LS"
            Case 17
                cKK_art = gcKreditKarte
            Case Else
                cKK_art = ""
        End Select
        
        If gbSPY Then
            frmWKL20!Winsock22.senddata "Bon endet" & vbCrLf
        End If
        
        SichernBonDaten cDruckZeile(), lAnzZeile, cKK_art, Trim(Label2(7).Caption), bPlusLZ

    End If

'BON_SCHNEIDEN:
'    If gbBonDruck Then
'        'Kassenbon abschneiden
'        If gbAPI = True Then
'            aDeviceName = Printer.DeviceName
'            cEscapeSequenz = gcSchneiden
'            OpenDrawer aDeviceName, cEscapeSequenz
'        End If
'    End If
    
    iLevel = 11
ZWEITER_BON:
    If giAndersZahlung = giKREDIT And iAktCopy < 2 Then
        If gb2BONKR Then
            GoTo StartPunkt
        End If
    ElseIf giAndersZahlung = giKOLLEGE And iAktCopy < 2 Then
        If gb2BONKOLLVK Then
            GoTo StartPunkt
        End If
        
    ElseIf (giAndersZahlung = 45 Or giAndersZahlung = 46) And iAktCopy < 2 Then
        If gb2BONEA Then
            GoTo StartPunkt
        End If
        
    ElseIf gbADTBON And iAktCopy < 2 Then
        GoTo StartPunkt
    ElseIf gbBARBON2 And iAktCopy < 2 Then
        GoTo StartPunkt
    End If
    Erase cDruckZeile
    
    
    'uncommit die folgende Zeile zum Drucken des QR-Codes auf dem Bon
    If MitQrCode And E_TSE_Aktiv Then
         'beim altDruckModus kann der Drucker beim Kunde kein QR-Code drucken (alte Drucker)
         If altDruckModus Then
         
         Else
           If gbBonDruck Then
              QRcodeDrucken
           End If
         End If
    End If
    
    If altDruckModus Then
       'Papier schneiden (alte Funktion)
        If gbBonDruck Then
            'Kassenbon abschneiden
            If gbAPI = True Then
                aDeviceName = Printer.DeviceName
                cEscapeSequenz = gcSchneiden
                OpenDrawer aDeviceName, cEscapeSequenz
            End If
        End If
    
    Else
        'Papier schneiden (neue Funktion)
        If gbBonDruck Then
          CutPapier
        End If
    End If
   
    
    
GUTSCHEIN:
    lAnzLbSatz = List1.ListCount
    For lcount = 0 To lAnzLbSatz - 1
        cLBSatz = List1.list(lcount)
        cArtNr = Mid(cLBSatz, 7, 6)
        If cArtNr = "666666" Then
            If gbNoBonGu = False Then
            
                If Not altDruckModus Then
                    PaarLeereZeilenDrucken
                    Sleep 2000
                End If
                
                DruckeGutscheinBonWKL20 cLBSatz
                If altDruckModus Then
                    'Papier schneiden (alte Funktion)
                    If gbBonDruck Then
                        'Kassenbon abschneiden
                        If gbAPI = True Then
                            aDeviceName = Printer.DeviceName
                            cEscapeSequenz = gcSchneiden
                            OpenDrawer aDeviceName, cEscapeSequenz
                        End If
                    End If
    
                 Else
                    'Papier schneiden (neue Funktion)
                    If gbBonDruck Then
                     CutPapier
                    End If
                End If
            End If
        End If
    Next lcount
    
ENDE:

    If gADTipAdress <> "" And gADTport <> "" Then
        If gsAdtBeleg <> "" Then
            Sende_Wkl20_2DruckerECCASH_Haendlerbeleg
        End If
    End If
    
    Label8(0).Caption = ""
    Label8(1).Caption = ""
    gsAdtBeleg = ""
    gbADTBON = False
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerNeuWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iLevel
    
    Fehlermeldung1
    Resume Next
    
End Sub
Private Sub Sende_Wkl20_2DruckerECCASH_Haendlerbeleg()
    On Error GoTo LOKAL_ERROR

    Dim lcount                  As Long
    Dim lAnzZeile               As Long
    Dim cDaten                  As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    ReDim cDruckZeile(1 To 1) As String
    Dim iLenZeile               As Integer
    Dim sTempBeleg              As String
    Dim lPos                    As Long
    Dim i                       As Integer

    iLenZeile = 32

''    setzedrucker gcBonDrucker

    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz

    '***********************************************
    'Zeile Karteninfo
    '***********************************************

    If gsAdtBeleg <> "" Then
    
        If InStr(gsAdtBeleg, "Unterschrift umseitig") > 0 Then
        
            sTempBeleg = gsAdtBeleg
            sTempBeleg = SwapStr(sTempBeleg, Space(35), "")
            lPos = InStr(sTempBeleg, "**")
    
            sTempBeleg = Left(sTempBeleg, lPos + 30)
    
            Do While Len(sTempBeleg) > 0
                cDaten = Left(sTempBeleg, 32)
    
                If Len(sTempBeleg) >= 33 Then
                    sTempBeleg = Right(sTempBeleg, Len(sTempBeleg) - 33)
                Else
                    sTempBeleg = ""
                End If
    
                If cDaten <> "" Then
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            Loop
            
            cDaten = ""
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
            cDaten = "Ermächtigung Lastschrifteinzug:"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = ""
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Ich ermächtige hiermit das"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "oben genannte Unternehmen,"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "den als Endsumme ausgewiesenen"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "Betrag von meinem durch Bank- "
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "leitzahl und Kontonummer be-"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "zeichneten Konto durch Last-"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "schrift einzuziehen."
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = ""
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "Ermächtigung Adressweitergabe:"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = ""
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "Ich weise mein Kreditinstitut,"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "das durch die Bankleitzahl "
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "bezeichnet ist, unwiderruflich"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "an, bei Nichteinlösung der Last-"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "schrift oder bei Widerspruch"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "gegen die Lastschrift dem"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Unternehmen oder einem von"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "ihm beauftragten Dritten auf "
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "Anforderung meinen Namen und"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz

            cDaten = "meine Adresse mitzuteilen, damit"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "das Unternehmen seinen Anspruch"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "gegen mich geltend machen kann."
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
    
            '+Unterschrift
            
            cDaten = ""
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            cDaten = ""
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = ""
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            cDaten = "________________________________"
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            
            
            
            
            
            
            
            cDaten = "Unterschrift:"
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            
            KonvertAnsiAscii cDaten
            
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        
        Else
    
            sTempBeleg = gsAdtBeleg
            sTempBeleg = SwapStr(sTempBeleg, Space(35), "")
            lPos = InStr(sTempBeleg, "**")
    
            sTempBeleg = Left(sTempBeleg, lPos + 30)
    
            Do While Len(sTempBeleg) > 0
                cDaten = Left(sTempBeleg, 32)
    
                If Len(sTempBeleg) >= 33 Then
                    sTempBeleg = Right(sTempBeleg, Len(sTempBeleg) - 33)
                Else
                    sTempBeleg = ""
                End If
    
                If cDaten <> "" Then
                    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            Loop
        End If
    End If

    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    'für Leinefelde von 9 auf 6
    For lcount = 1 To 6
        If lcount = 6 Then
            cEscapeSequenz = vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount

BON_DRUCKEN:
    If gbAPI = True Then
        OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
    Else
        OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
    End If

BON_SCHNEIDEN:
    'Kassenbon abschneiden
    If gbAPI = True Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcSchneiden
        OpenDrawer aDeviceName, cEscapeSequenz
    End If

    gsAdtBeleg = ""

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Sende_Wkl20_2DruckerECCASH_Haendlerbeleg"
    Fehler.gsFehlertext = "Im Programmteil BEZAHLEN ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Sub SendeDaten2DruckerPark(lLfdNr As Long)
    On Error GoTo LOKAL_ERROR
    
    Dim lartnr                  As Long
    Dim lAnzSatz                As Long
    Dim lAktSatz                As Long
    Dim lTask                   As Long
    Dim lcount                  As Long
    Dim lAnzZeile               As Long
    
    Dim lAnzLbSatz              As Long
    Dim lRet                    As Long
    
    Dim cLBSatz                 As String
    Dim cFeld                   As String
    Dim cDaten                  As String
    Dim ctmp                    As String
    Dim cTmp2                   As String
    Dim cMWST                   As String
    Dim cText                   As String
    Dim cMWSTzzgl               As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim cArtNr                  As String
    ReDim cDruckZeile(1 To 1) As String
    ReDim cDruckZeile12(1 To 1) As String
    
    Dim ctmpFW                  As String
    Dim cDatenfw                As String
    
    Dim iLevel                  As Integer
    Dim iAktCopy                As Integer
    Dim iStufe                  As Integer
    Dim iLenZeile               As Integer
    Dim iFileNr                 As Integer
    Dim iGesAnzahl              As Integer
    
    Dim dGRabatt                As Double
    Dim dGRabattWert            As Double
    Dim dSumme                  As Double
    Dim dWert                   As Double
    Dim dEuro                   As Double
    Dim dMWStVoll               As Double
    Dim dMWStErm                As Double
    Dim dMWSTVzzgl              As Double
    Dim dMWSTEzzgl              As Double
    Dim dAktZeit                As Double
    Dim dNeuZeit                As Double
    Dim dMWSt                   As Double
    
    Dim bAusblenden             As Boolean
    Dim bBonZwang               As Boolean
    Dim gbStorni                As Boolean
    
    gbStorni = False
    bBonZwang = True
    
    If bBonZwang Then
        gbBonDruck = True
    End If
    
    
    
    iLevel = 0
 
    
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    

StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    dMWSTVzzgl = 0
    dMWSTEzzgl = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    If gbBonDruck Then
    
        If gdSumme > 0 Then
            Barcode CStr(gdSumme), CStr(lLfdNr)
        Else
        
        End If

    End If
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    
    If gcBild <> "" Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcBild
        OpenDrawer aDeviceName, cEscapeSequenz
    End If
    
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    
    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
        
        iLevel = 613
        ctmp = "Ihre KundenNr: " & Label2(7).Caption
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
        If gbKUNDENA = True Then
        
            If gbKUIBONfirma Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).firma
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            If gbKUIBONtitel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).titel
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            ctmp = ""
            If gbKUIBONvorname Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
            End If
            
            If gbKUIBONname Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).nachname
            End If
    
        
            iLevel = 614
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            If gbKUIBONstrasse Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
            
                iLevel = 615
                If Len(ctmp) > 32 Then
                    ctmp = Left(ctmp, 32)
                End If
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            ctmp = ""
            If gbKUIBONplz Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
            End If
            
            If gbKUIBONort Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).Ort
            End If
        
            iLevel = 616
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            iLevel = 617
            
            If gbKUIBONtel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).telefon
                If ctmp <> "" Then
                    cDaten = "Tel " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            iLevel = 618
            
            If gbKUIBONmobil Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Mobiltel
                If ctmp <> "" Then
                    cDaten = "Mobil " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
        End If
    End If
    
    
    
    
    
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    
    
    cDaten = "Dies ist kein Kassenbeleg"
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Vorgang an Drucker senden
    '***********************************************
    
    cDaten = "Vorgangsnummer:" & Space$(1) & CStr(lLfdNr)
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    

    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    
    ctmp = "Summe"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "###,##0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************
    
    
    '*****
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If
        
        iGesAnzahl = iGesAnzahl + Val(ctmp)
    Next lAktSatz
    
    
    
    
    '*****

    ctmp = "Anzahl Artikel: " & iGesAnzahl
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
   
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    dSumme = 0
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        If cFeld = "666666" Then
'            bBonZwang = True
        End If
        lartnr = CLng(cFeld)
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld
            cMWSTzzgl = cMWST
            
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            
            If gbDivKosmetik = True Then
                If lartnr = 666666 Then
                    cDaten = cDaten & cFeld
                Else
                    cDaten = cDaten & gcDivKosmetik
                End If
            Else
                cDaten = cDaten & cFeld
            End If
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'wenn Artikelermäßigung, dann drucken
            '***********************************************
            
            ctmp = Mid(cLBSatz, 124, 3)
            If Val(ctmp) > 0 And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
                'Zeile nur bei Artikel-Ermäßigung drucken
                
                
                
                Dim dArtikelrabattinEuro As Double
                dArtikelrabattinEuro = CDbl(Trim(Mid(cLBSatz, 84, 9)))
                Dim dRabattierterGesamtPreisinEuro As Double
                dRabattierterGesamtPreisinEuro = CDbl(Trim(Mid(cLBSatz, 60, 9)))
                Dim dErgebnisinProz As Double
                dErgebnisinProz = dArtikelrabattinEuro * 100 / (dRabattierterGesamtPreisinEuro + dArtikelrabattinEuro)
                ctmp = Format$(dErgebnisinProz, "###,##0.00")
                
                
                
                cDaten = "Rabatt:    " & ctmp & " %"
                ctmp = Mid(cLBSatz, 84, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                ctmp = Space(9 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            iGesAnzahl = iGesAnzahl + Val(ctmp)
            If Val(ctmp) < 0 Then
                gbStorni = True
            End If
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            
            ctmp = Format$(dWert, "###,##0.00")
            
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            If giPreisKz > 1 And giPreisKz < 4 Then
                If cMWSTzzgl = "V" Then
                    dMWSTVzzgl = dMWSTVzzgl + (dWert * (gdMWStV / 100))
                End If
                If cMWSTzzgl = "E" Then
                    dMWSTEzzgl = dMWSTEzzgl + (dWert * (gdMWStE / 100))
                End If
            End If
            ctmp = Format$(dWert, "###,##0.00")
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'MWSt-Summe berechnen
            '***********************************************
            If cMWST = "V" Then
                dMWSt = dWert / (100 + gdMWStV)
                dMWSt = dMWSt * gdMWStV
                dMWStVoll = dMWStVoll + dMWSt
            ElseIf cMWST = "E" Then
               dMWSt = dWert / (100 + gdMWStE)
                dMWSt = dMWSt * gdMWStE
                dMWStErm = dMWStErm + dMWSt
            Else
                dMWSt = 0
            End If
        Else
'            'Zeile mit Zwischensumme drucken
'            cDaten = "Zwischensumme:     "
'
'            ctmp = Mid(cLBSatz, 60, 9)
'            ctmp = fnMoveComma2Point$(ctmp)
'            dWert = Val(ctmp)
'            ctmp = Format$(dWert, "###,##0.00")
'            ctmp = Space(13 - Len(ctmp)) & ctmp
'
'            cDaten = cDaten & ctmp


            'Zeile mit Zwischensumme drucken
            ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
            ctmp = Left(Trim(ctmp), 32)
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    Next lAktSatz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    iLevel = 5
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    '***********************************************
    'Gesamtrabatt drucken
    '***********************************************
        
    If Label2(3).Visible And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
        'Zeile nur bei Gesamt-Ermäßigung drucken
        
        dWert = fnHoleGesamtRabattModul20#()
        ctmp = Label2(3).Caption
        
        
    
        If Len(ctmp) > 6 Then
            ctmp = Left(ctmp, Len(ctmp) - 5)
        End If
        
        Dim cDruckGesRabattBezeichnung As String
            
        cDruckGesRabattBezeichnung = "GesRabatt: "
        cDaten = cDruckGesRabattBezeichnung & Space(5 - Len(ctmp)) & ctmp & "% " & gcWaehrung
        
'        If Len(ctmp) > 3 Then
'            ctmp = Left(ctmp, Len(ctmp) - 3)
'        End If
'
'        If Len(ctmp) > 2 Then
'            cDaten = "Gesamtrabatt:" & Space(3 - Len(ctmp)) & ctmp & "% " & gcWaehrung
'        Else
'            cDaten = "Gesamtrabatt: " & Space(2 - Len(ctmp)) & ctmp & "% " & gcWaehrung
'        End If

        ctmp = Format$(dWert, "###,##0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    

GutschECLast:

    
    
    

    
   
    
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Endbeterag' drucken
    '***********************************************
endbetrag:
    iLevel = 6101
    ctmp = "Summe"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    iLevel = 605
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "###,##0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    
    
    '***********************************************
    'Zeile 'Anzahl Artikel' drucken
    '***********************************************
'    If iGesAnzahl > 1 Then
        ctmp = "Anzahl Artikel: " & iGesAnzahl
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
'    End If
    
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "Es bediente Sie"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    If gbKASSNRUNTER = False Then
        '***********************************************
        'Zeile 'Kassennummer' drucken
        '***********************************************
        
        ctmp = "Kasse: " & gcKasNum
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
        iLevel = 612
    End If
    
    
    
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    
    iLevel = 6151
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6152
    cDaten = cDaten & Space$(4) & ctmp
    
    If gbKASSNRUNTER = False Then
    
        If giZahlArt = giKOLLEGE Then
            ctmp = "0"
            gdBonNr = 0
        Else
            ctmp = Format$(gdBonNr, "#####0")
        End If
        iLevel = 6153
        ctmp = gcKasNum & "/" & ctmp
        iLevel = 6154
        ctmp = Space$(8 - Len(ctmp)) & ctmp
        iLevel = 6155
        cDaten = cDaten & Space$(4) & ctmp
    
    End If
    
    
    
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
    'OpenDrawer3 benutzt die WindowsAPI
    'OpenDrawer4 geht über das PRINTER-Objekt
    
    'Schublade nur einmal öffnen
    
    If giAndersZahlung = giKREDIT And iAktCopy = 2 Then
        GoTo BON_DRUCKEN
    End If
    
    iLevel = 12
    
BON_DRUCKEN:
    
    
    If gbBonDruck Then
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    End If
BON_SCHNEIDEN:
    If gbBonDruck Then
        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
    End If
    
'ZWEITER_BON:
    If gb2BONVerleih = True Then
        If iAktCopy < 2 Then
            GoTo StartPunkt
        End If
    End If
    
'    If gb2BONPA = True Then
'        If iAktCopy < 2 Then
'            GoTo StartPunkt
'        End If
'    End If
    
    iLevel = 11
'ENDE:
    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerPark"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SendeDaten2Drucker_ArtAuswahl(lLfdNr As Long)
    On Error GoTo LOKAL_ERROR
    
    Dim lartnr                  As Long
    Dim lAnzSatz                As Long
    Dim lAktSatz                As Long
    Dim lTask                   As Long
    Dim lcount                  As Long
    Dim lAnzZeile               As Long
    Dim lAnzLbSatz              As Long
    Dim lRet                    As Long
    Dim cLBSatz                 As String
    Dim cFeld                   As String
    Dim cDaten                  As String
    Dim ctmp                    As String
    Dim cTmp2                   As String
    Dim cMWST                   As String
    Dim cText                   As String
    Dim cMWSTzzgl               As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim cArtNr                  As String
    ReDim cDruckZeile(1 To 1) As String
    ReDim cDruckZeile12(1 To 1) As String
    
    
    Dim ctmpFW                  As String
    Dim cDatenfw                As String
    
    Dim iLevel                  As Integer
    Dim iAktCopy                As Integer
    Dim iStufe                  As Integer
    Dim iLenZeile               As Integer
    Dim iFileNr                 As Integer
    Dim iGesAnzahl              As Integer
    
    Dim dGRabatt                As Double
    Dim dGRabattWert            As Double
    Dim dSumme                  As Double
    Dim dWert                   As Double
    Dim dEuro                   As Double
    Dim dMWStVoll               As Double
    Dim dMWStErm                As Double
    Dim dMWSTVzzgl              As Double
    Dim dMWSTEzzgl              As Double
    Dim dAktZeit                As Double
    Dim dNeuZeit                As Double
    Dim dMWSt                   As Double
    
    Dim bAusblenden             As Boolean
    Dim bBonZwang               As Boolean
    Dim gbStorni                As Boolean
    
    gbStorni = False
    bBonZwang = False
    iLevel = 0
 
    
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    

StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    dMWSTVzzgl = 0
    dMWSTEzzgl = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    
    If gcBild <> "" Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcBild
        OpenDrawer aDeviceName, cEscapeSequenz
    End If

    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    
    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
        
        iLevel = 613
        ctmp = "Ihre KundenNr: " & Label2(7).Caption
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
        If gbKUNDENA = True Then
        
            If gbKUIBONfirma Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).firma
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            If gbKUIBONtitel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).titel
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            ctmp = ""
            If gbKUIBONvorname Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
            End If
            
            If gbKUIBONname Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).nachname
            End If
    
        
            iLevel = 614
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            If gbKUIBONstrasse Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
            
                iLevel = 615
                If Len(ctmp) > 32 Then
                    ctmp = Left(ctmp, 32)
                End If
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            ctmp = ""
            If gbKUIBONplz Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
            End If
            
            If gbKUIBONort Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).Ort
            End If
        
            iLevel = 616
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            iLevel = 617
            
            If gbKUIBONtel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).telefon
                If ctmp <> "" Then
                    cDaten = "Tel " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            iLevel = 618
            
            If gbKUIBONmobil Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Mobiltel
                If ctmp <> "" Then
                    cDaten = "Mobil " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
        End If
    End If
    
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    
    cDaten = "Auswahl"
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    cDaten = "Dies ist kein Kassenbeleg"
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    
    ctmp = "Summe"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "##,###0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************
    
    
    '*****
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If
        iGesAnzahl = iGesAnzahl + Val(ctmp)
    Next lAktSatz

    '*****

    ctmp = "Anzahl Artikel: " & iGesAnzahl
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
   
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    dSumme = 0
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        If cFeld = "666666" Then
            bBonZwang = True
        End If
        lartnr = CLng(cFeld)
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld
            cMWSTzzgl = cMWST
            
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            
            If gbDivKosmetik = True Then
                If lartnr = 666666 Then
                    cDaten = cDaten & cFeld
                Else
                    cDaten = cDaten & gcDivKosmetik
                End If
            Else
                cDaten = cDaten & cFeld
            End If
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'wenn Artikelermäßigung, dann drucken
            '***********************************************
            
            ctmp = Mid(cLBSatz, 124, 3)
            If Val(ctmp) > 0 And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
                'Zeile nur bei Artikel-Ermäßigung drucken
                
                
                Dim dArtikelrabattinEuro As Double
                dArtikelrabattinEuro = CDbl(Trim(Mid(cLBSatz, 84, 9)))
                Dim dRabattierterGesamtPreisinEuro As Double
                dRabattierterGesamtPreisinEuro = CDbl(Trim(Mid(cLBSatz, 60, 9)))
                Dim dErgebnisinProz As Double
                dErgebnisinProz = dArtikelrabattinEuro * 100 / (dRabattierterGesamtPreisinEuro + dArtikelrabattinEuro)
                ctmp = Format$(dErgebnisinProz, "###,##0.00")
                
                cDaten = "Rabatt:    " & ctmp & " %"
                ctmp = Mid(cLBSatz, 84, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                ctmp = Space(9 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            iGesAnzahl = iGesAnzahl + Val(ctmp)
            
            
            If Val(ctmp) < 0 Then
                gbStorni = True
            End If
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            
            ctmp = Format$(dWert, "##,###0.00")
            
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            If giPreisKz > 1 And giPreisKz < 4 Then
                If cMWSTzzgl = "V" Then
                    dMWSTVzzgl = dMWSTVzzgl + (dWert * (gdMWStV / 100))
                End If
                If cMWSTzzgl = "E" Then
                    dMWSTEzzgl = dMWSTEzzgl + (dWert * (gdMWStE / 100))
                End If
            End If
            ctmp = Format$(dWert, "##,###0.00")
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'MWSt-Summe berechnen
            '***********************************************
            If cMWST = "V" Then
                dMWSt = dWert / (100 + gdMWStV)
                dMWSt = dMWSt * gdMWStV
                dMWStVoll = dMWStVoll + dMWSt
            ElseIf cMWST = "E" Then
               dMWSt = dWert / (100 + gdMWStE)
                dMWSt = dMWSt * gdMWStE
                dMWStErm = dMWStErm + dMWSt
            Else
                dMWSt = 0
            End If
        Else
'            'Zeile mit Zwischensumme drucken
'            cDaten = "Zwischensumme:     "
'
'            ctmp = Mid(cLBSatz, 60, 9)
'            ctmp = fnMoveComma2Point$(ctmp)
'            dWert = Val(ctmp)
'            ctmp = Format$(dWert, "##,###0.00")
'            ctmp = Space(13 - Len(ctmp)) & ctmp
'
'            cDaten = cDaten & ctmp

            'Zeile mit Zwischensumme drucken
            ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
            ctmp = Left(Trim(ctmp), 32)
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    Next lAktSatz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    iLevel = 5
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    '***********************************************
    'Gesamtrabatt drucken
    '***********************************************
        
    If Label2(3).Visible And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
        'Zeile nur bei Gesamt-Ermäßigung drucken
        
        dWert = fnHoleGesamtRabattModul20#()
        ctmp = Label2(3).Caption
        
        
        
        If Len(ctmp) > 6 Then
            ctmp = Left(ctmp, Len(ctmp) - 5)
        End If
        
        Dim cDruckGesRabattBezeichnung As String
            
        cDruckGesRabattBezeichnung = "GesRabatt: "
        cDaten = cDruckGesRabattBezeichnung & Space(5 - Len(ctmp)) & ctmp & "% " & gcWaehrung
        
'        If Len(ctmp) > 3 Then
'            ctmp = Left(ctmp, Len(ctmp) - 3)
'        End If
'
'        If Len(ctmp) > 2 Then
'            cDaten = "Gesamtrabatt:" & Space(3 - Len(ctmp)) & ctmp & "% " & gcWaehrung
'        Else
'            cDaten = "Gesamtrabatt: " & Space(2 - Len(ctmp)) & ctmp & "% " & gcWaehrung
'        End If

        
        ctmp = Format$(dWert, "##,###0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
GutschECLast:
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Endbeterag' drucken
    '***********************************************
endbetrag:
    iLevel = 6101
    ctmp = "Summe"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    iLevel = 605
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "##,###0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    

    '***********************************************
    'Zeile 'Anzahl Artikel' drucken
    '***********************************************
'    If iGesAnzahl > 1 Then
        ctmp = "Anzahl Artikel: " & iGesAnzahl
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
'    End If
    
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "Es bediente Sie"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    If gbKASSNRUNTER = False Then
    
        '***********************************************
        'Zeile 'Kassennummer' drucken
        '***********************************************
    
        ctmp = "Kasse: " & gcKasNum
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
    
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    End If
    
    iLevel = 612
    
    
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    
    iLevel = 6151
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6152
    cDaten = cDaten & Space$(4) & ctmp
    
    
    If gbKASSNRUNTER = False Then
    
        If giZahlArt = giKOLLEGE Then
            ctmp = "0"
            gdBonNr = 0
        Else
            ctmp = Format$(gdBonNr, "#####0")
        End If
        iLevel = 6153
        ctmp = gcKasNum & "/" & ctmp
        iLevel = 6154
        ctmp = Space$(8 - Len(ctmp)) & ctmp
        iLevel = 6155
        cDaten = cDaten & Space$(4) & ctmp
    
    End If
    
    
    
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    If giAndersZahlung = giKREDIT And iAktCopy = 2 Then
        GoTo BON_DRUCKEN
    End If
    
    iLevel = 12
    
BON_DRUCKEN:
    If bBonZwang Then
        gbBonDruck = True
    End If
    
    If gbBonDruck Then
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    End If
    
    If gbBonDruck Then
    
        If gdSumme > 0 Then
            Barcode_ArtAuswahl CStr(gdSumme), CStr(lLfdNr)
        Else
        
        End If

    End If
    
BON_SCHNEIDEN:
    If gbBonDruck Then
        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
    End If
    
    
    
'ZWEITER_BON:
    If gb2BONVerleih = True Then
        If iAktCopy < 2 Then
            GoTo StartPunkt
        End If
    End If
    
    iLevel = 11
'ENDE:
    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2Drucker_ArtAuswahl"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SendeDaten2DruckerFleischer(lLfdNr As Long, cART As String, cBezeic As String)
    On Error GoTo LOKAL_ERROR
    
    
        
    Dim lartnr                  As Long
    Dim lAnzSatz                As Long
    Dim lAktSatz                As Long
    Dim lTask                   As Long
    Dim lcount                  As Long
    Dim lAnzZeile               As Long
    
    Dim lAnzLbSatz              As Long
    Dim lRet                    As Long
    
    Dim cLBSatz                 As String
    Dim cFeld                   As String
    Dim cDaten                  As String
    Dim ctmp                    As String
    Dim cTmp2                   As String
    Dim cMWST                   As String
    Dim cText                   As String
    Dim cMWSTzzgl               As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim cArtNr                  As String
    ReDim cDruckZeile(1 To 1) As String
    ReDim cDruckZeile12(1 To 1) As String
    
    
    Dim ctmpFW                  As String
    Dim cDatenfw                As String
    
    Dim iLevel                  As Integer
    Dim iAktCopy                As Integer
    Dim iStufe                  As Integer
    Dim iLenZeile               As Integer
    Dim iFileNr                 As Integer
    Dim iGesAnzahl              As Integer
    
    Dim dGRabatt                As Double
    Dim dGRabattWert            As Double
    Dim dSumme                  As Double
    Dim dWert                   As Double
    Dim dEuro                   As Double
    Dim dMWStVoll               As Double
    Dim dMWStErm                As Double
    Dim dMWSTVzzgl              As Double
    Dim dMWSTEzzgl              As Double
    Dim dAktZeit                As Double
    Dim dNeuZeit                As Double
    Dim dMWSt                   As Double
    
    Dim bAusblenden             As Boolean
    Dim bBonZwang               As Boolean
    Dim gbStorni                As Boolean
    
    gbStorni = False
    bBonZwang = False
    iLevel = 0
 
    
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    

StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    dMWSTVzzgl = 0
    dMWSTEzzgl = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    If gbBonDruck Then
        
        BarcodeF CStr(gdSumme), CStr(lLfdNr)
       
    End If
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    cDaten = "Dies ist kein Kassenbeleg"
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'artnr an Drucker senden
    '***********************************************
    
    cDaten = "Artikelnummer:" & Space$(1) & cART
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'bezeich an Drucker senden
    '***********************************************
    
    cDaten = cBezeic
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    

    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    
    ctmp = "Summe"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************
    
    
    '*****
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If
        
        iGesAnzahl = iGesAnzahl + Val(ctmp)
    Next lAktSatz
    
    
    
    
    '*****

    ctmp = "Anzahl Artikel: " & iGesAnzahl
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
   
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    dSumme = 0
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        If cFeld = "666666" Then
            bBonZwang = True
        End If
        lartnr = CLng(cFeld)
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld
            cMWSTzzgl = cMWST
            
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            
            If gbDivKosmetik = True Then
                If lartnr = 666666 Then
                    cDaten = cDaten & cFeld
                Else
                    cDaten = cDaten & gcDivKosmetik
                End If
            Else
                cDaten = cDaten & cFeld
            End If
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'wenn Artikelermäßigung, dann drucken
            '***********************************************
            
            ctmp = Mid(cLBSatz, 124, 3)
            If Val(ctmp) > 0 And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
                'Zeile nur bei Artikel-Ermäßigung drucken
                
                
                Dim dArtikelrabattinEuro As Double
                dArtikelrabattinEuro = CDbl(Trim(Mid(cLBSatz, 84, 9)))
                Dim dRabattierterGesamtPreisinEuro As Double
                dRabattierterGesamtPreisinEuro = CDbl(Trim(Mid(cLBSatz, 60, 9)))
                Dim dErgebnisinProz As Double
                dErgebnisinProz = dArtikelrabattinEuro * 100 / (dRabattierterGesamtPreisinEuro + dArtikelrabattinEuro)
                ctmp = Format$(dErgebnisinProz, "###,##0.00")
                
                
                cDaten = "Rabatt:    " & ctmp & " %"
                ctmp = Mid(cLBSatz, 84, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                ctmp = Space(9 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            iGesAnzahl = iGesAnzahl + Val(ctmp)
            If Val(ctmp) < 0 Then
                gbStorni = True
            End If
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            
            ctmp = Format$(dWert, "#####0.00")
            
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            If giPreisKz > 1 And giPreisKz < 4 Then
                If cMWSTzzgl = "V" Then
                    dMWSTVzzgl = dMWSTVzzgl + (dWert * (gdMWStV / 100))
                End If
                If cMWSTzzgl = "E" Then
                    dMWSTEzzgl = dMWSTEzzgl + (dWert * (gdMWStE / 100))
                End If
            End If
            ctmp = Format$(dWert, "#####0.00")
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'MWSt-Summe berechnen
            '***********************************************
            If cMWST = "V" Then
                dMWSt = dWert / (100 + gdMWStV)
                dMWSt = dMWSt * gdMWStV
                dMWStVoll = dMWStVoll + dMWSt
            ElseIf cMWST = "E" Then
               dMWSt = dWert / (100 + gdMWStE)
                dMWSt = dMWSt * gdMWStE
                dMWStErm = dMWStErm + dMWSt
            Else
                dMWSt = 0
            End If
        Else
'            'Zeile mit Zwischensumme drucken
'            cDaten = "Zwischensumme:     "
'
'            ctmp = Mid(cLBSatz, 60, 9)
'            ctmp = fnMoveComma2Point$(ctmp)
'            dWert = Val(ctmp)
'            ctmp = Format$(dWert, "#####0.00")
'            ctmp = Space(13 - Len(ctmp)) & ctmp
'
'            cDaten = cDaten & ctmp

            'Zeile mit Zwischensumme drucken
            ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
            ctmp = Left(Trim(ctmp), 32)
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    Next lAktSatz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    iLevel = 5
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    '***********************************************
    'Gesamtrabatt drucken
    '***********************************************
        
    If Label2(3).Visible And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
        'Zeile nur bei Gesamt-Ermäßigung drucken
        
        dWert = fnHoleGesamtRabattModul20#()
        
        ctmp = frmWKL20.Label2(3).Caption
        If Len(ctmp) > 6 Then
            ctmp = Left(ctmp, Len(ctmp) - 5)
        End If
        
        Dim cDruckGesRabattBezeichnung As String
            
        cDruckGesRabattBezeichnung = "GesRabatt: "
        cDaten = cDruckGesRabattBezeichnung & Space(5 - Len(ctmp)) & ctmp & "% " & gcWaehrung
        
        
        
        
        
        
        
        
        
'        ctmp = Label2(3).Caption
'        If Len(ctmp) > 3 Then
'            ctmp = Left(ctmp, Len(ctmp) - 3)
'        End If
'
'        If Len(ctmp) > 2 Then
'            cDaten = "Gesamtrabatt:" & Space(3 - Len(ctmp)) & ctmp & "% " & gcWaehrung
'        Else
'            cDaten = "Gesamtrabatt: " & Space(2 - Len(ctmp)) & ctmp & "% " & gcWaehrung
'        End If

        
        ctmp = Format$(dWert, "#####0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    

GutschECLast:

    
    
    

    
   
    
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Endbeterag' drucken
    '***********************************************
endbetrag:
    iLevel = 6101
    ctmp = "Summe"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    iLevel = 605
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Zeile 'Anzahl Artikel' drucken
    '***********************************************
'    If iGesAnzahl > 1 Then
        ctmp = "Anzahl Artikel: " & iGesAnzahl
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
'    End If
    
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "Es bediente Sie"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Zeile 'Kassennummer' drucken
    '***********************************************
    
    ctmp = "Kasse: " & gcKasNum
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    iLevel = 612
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    
    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
        
        iLevel = 613
        ctmp = "Ihre KundenNr: " & Label2(7).Caption
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
        If gbKUNDENA = True Then
        
            If gbKUIBONfirma Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).firma
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            If gbKUIBONtitel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).titel
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            ctmp = ""
            If gbKUIBONvorname Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
            End If
            
            If gbKUIBONname Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).nachname
            End If
    
        
            iLevel = 614
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            If gbKUIBONstrasse Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
            
                iLevel = 615
                If Len(ctmp) > 32 Then
                    ctmp = Left(ctmp, 32)
                End If
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            ctmp = ""
            If gbKUIBONplz Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
            End If
            
            If gbKUIBONort Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).Ort
            End If
        
            iLevel = 616
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            iLevel = 617
            
            If gbKUIBONtel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).telefon
                If ctmp <> "" Then
                    cDaten = "Tel " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            iLevel = 618
            
            If gbKUIBONmobil Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Mobiltel
                If ctmp <> "" Then
                    cDaten = "Mobil " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
        End If
    End If
    
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    
    iLevel = 6151
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6152
    cDaten = cDaten & Space$(4) & ctmp
    
    If giZahlArt = giKOLLEGE Then
        ctmp = "0"
        gdBonNr = 0
    Else
        ctmp = Format$(gdBonNr, "#####0")
    End If
    iLevel = 6153
    ctmp = gcKasNum & "/" & ctmp
    iLevel = 6154
    ctmp = Space$(8 - Len(ctmp)) & ctmp
    iLevel = 6155
    cDaten = cDaten & Space$(4) & ctmp
    
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
    
    'OpenDrawer3 benutzt die WindowsAPI
    'OpenDrawer4 geht über das PRINTER-Objekt
    
    'Schublade nur einmal öffnen
    
    If giAndersZahlung = giKREDIT And iAktCopy = 2 Then
        GoTo BON_DRUCKEN
    End If
    
    iLevel = 12
    
BON_DRUCKEN:
    If bBonZwang Then
        gbBonDruck = True
'        Command1(12).Caption = "Bon JA!!!"
    End If
    If gbBonDruck Then
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
            
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    End If
    
BON_SCHNEIDEN:
    If gbBonDruck Then
        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
    End If
    
    iLevel = 11

    

ENDE:
    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerFleischer"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

   
End Sub
Private Sub SendeDaten2DruckerParknetto(lLfdNr As Long)
    On Error GoTo LOKAL_ERROR
    
    Dim lartnr                  As Long
    Dim lAnzSatz                As Long
    Dim lAktSatz                As Long
    Dim lTask                   As Long
    Dim lcount                  As Long
    Dim lAnzZeile               As Long
    
    Dim lAnzLbSatz              As Long
    Dim lRet                    As Long
    
    Dim cLBSatz                 As String
    Dim cFeld                   As String
    Dim cDaten                  As String
    Dim ctmp                    As String
    Dim cTmp2                   As String
    Dim cMWST                   As String
    Dim cText                   As String
    Dim cMWSTzzgl               As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim cArtNr                  As String
    ReDim cDruckZeile(1 To 1) As String
    ReDim cDruckZeile12(1 To 1) As String
    
    
    Dim ctmpFW                  As String
    Dim cDatenfw                As String
    
    Dim iLevel                  As Integer
    Dim iAktCopy                As Integer
    Dim iStufe                  As Integer
    Dim iLenZeile               As Integer
    Dim iFileNr                 As Integer
    Dim iGesAnzahl              As Integer
    
    Dim dGRabatt                As Double
    Dim dGRabattWert            As Double
    Dim dSumme                  As Double
    Dim dSummeNetto             As Double
    Dim dWert                   As Double
    Dim dEuro                   As Double
    Dim dMWStVoll               As Double
    Dim dMWStErm                As Double
    Dim dMWSTVzzgl              As Double
    Dim dMWSTEzzgl              As Double
    Dim dAktZeit                As Double
    Dim dNeuZeit                As Double
    Dim dMWSt                   As Double
    Dim dRabattNetto            As Double
    
    Dim bAusblenden             As Boolean
    Dim bBonZwang               As Boolean
    Dim gbStorni                As Boolean
    
    gbStorni = False
    bBonZwang = False
    iLevel = 0
    dSummeNetto = 0
    dRabattNetto = 0
 
    
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    

StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    dMWSTVzzgl = 0
    dMWSTEzzgl = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    If gbBonDruck Then
    
        If gdSumme > 0 Then
            Barcode CStr(gdSumme), CStr(lLfdNr)
        Else
        
        End If

    End If
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    cDaten = "Dies ist kein Kassenbeleg"
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    '***********************************************
    'Vorgang an Drucker senden
    '***********************************************
    
    cDaten = "Vorgangsnummer:" & Space$(1) & CStr(lLfdNr)
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    
    ctmp = "Summe"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************
    
    
    '*****
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If
        iGesAnzahl = iGesAnzahl + Val(ctmp)
    Next lAktSatz
    
    
    
    
    '*****

    ctmp = "Anzahl Artikel: " & iGesAnzahl
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
   
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    dSumme = 0
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        If cFeld = "666666" Then
            bBonZwang = True
        End If
        lartnr = CLng(cFeld)
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld 'hier mehrwertsteuer
            cMWSTzzgl = cMWST
            
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            
            If gbDivKosmetik = True Then
                If lartnr = 666666 Then
                    cDaten = cDaten & cFeld
                Else
                    cDaten = cDaten & gcDivKosmetik
                End If
            Else
                cDaten = cDaten & cFeld
            End If
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'wenn Artikelermäßigung, dann drucken
            '***********************************************
            
            ctmp = Mid(cLBSatz, 124, 3)
            If Val(ctmp) > 0 And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
                'Zeile nur bei Artikel-Ermäßigung drucken
                
                
                
                
                cDaten = "Rabatt:    " & ctmp & " %"
                ctmp = Mid(cLBSatz, 84, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                ctmp = Space(9 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            iGesAnzahl = iGesAnzahl + Val(ctmp)
            If Val(ctmp) < 0 Then
                gbStorni = True
            End If
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            
            
            'hier voller Preis
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            dWert = nettoR(dWert, cMWST)
            ctmp = Format$(dWert, "#####0.00")
            
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)

            If cMWSTzzgl = "V" Then
                dMWSTVzzgl = dMWSTVzzgl + (dWert * gdMWStV) / (gdMWStV + 100)
            End If
            If cMWSTzzgl = "E" Then
                dMWSTEzzgl = dMWSTEzzgl + (dWert * gdMWStE) / (gdMWStE + 100)
            End If

            
            dWert = nettoR(dWert, cMWST)
            ctmp = Format$(dWert, "#####0.00")
            dSummeNetto = dSummeNetto + dWert
            
            
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'MWSt-Summe berechnen
            '***********************************************
            If cMWST = "V" Then
                dMWSt = dWert / (100 + gdMWStV)
                dMWSt = dMWSt * gdMWStV
                dMWStVoll = dMWStVoll + dMWSt
            ElseIf cMWST = "E" Then
               dMWSt = dWert / (100 + gdMWStE)
                dMWSt = dMWSt * gdMWStE
                dMWStErm = dMWStErm + dMWSt
            Else
                dMWSt = 0
            End If
        Else
'            'Zeile mit Zwischensumme drucken
'            cDaten = "Zwischensumme:     "
'
'            ctmp = Mid(cLBSatz, 60, 9)
'            ctmp = fnMoveComma2Point$(ctmp)
'            dWert = Val(ctmp)
'            ctmp = Format$(dWert, "#####0.00")
'            ctmp = Space(13 - Len(ctmp)) & ctmp
'
'            cDaten = cDaten & ctmp


            'Zeile mit Zwischensumme drucken
            ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
            ctmp = Left(Trim(ctmp), 32)
            cDaten = ctmp



            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    Next lAktSatz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    iLevel = 5
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    '***********************************************
    'Gesamtrabatt drucken
    '***********************************************
        
    If Label2(3).Visible And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
        'Zeile nur bei Gesamt-Ermäßigung drucken
        
'        dwert = dSummeNetto 'fnHoleGesamtRabattModul20#()

        ctmp = Label2(3).Caption
        If Len(ctmp) > 3 Then
            ctmp = Left(ctmp, Len(ctmp) - 3)
        End If
        
        dWert = (dSummeNetto * Val(ctmp)) / 100
        
        If Len(ctmp) > 2 Then
            cDaten = "Gesamtrabatt:" & Space(3 - Len(ctmp)) & ctmp & "% " & gcWaehrung
        Else
            cDaten = "Gesamtrabatt: " & Space(2 - Len(ctmp)) & ctmp & "% " & gcWaehrung
        End If
'        cDaten = "Gesamtrabatt: " & Space(2 - Len(cTmp)) & cTmp & "% " & gcWaehrung
        
        ctmp = Format$(dWert, "#####0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    

GutschECLast:

    
    
    

    
   
    
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Endbeterag' drucken
    '***********************************************
endbetrag:
    ctmp = "Summe Netto:"
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(dSummeNetto, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    ctmp = "MwSt Anteil: " & gdMWStV & "% "
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(dMWSTVzzgl, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    ctmp = "MwSt Anteil: " & gdMWStE & "% "
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(dMWSTEzzgl, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    ctmp = "Summe Brutto:"
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(gdSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    
    
    '***********************************************
    'Zeile 'Anzahl Artikel' drucken
    '***********************************************
'    If iGesAnzahl > 1 Then
        ctmp = "Anzahl Artikel: " & iGesAnzahl
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
'    End If
    
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "Es bediente Sie"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Zeile 'Kassennummer' drucken
    '***********************************************
    
    ctmp = "Kasse: " & gcKasNum
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    iLevel = 612
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    
    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
        
        iLevel = 613
        ctmp = "Ihre KundenNr: " & Label2(7).Caption
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
        If gbKUNDENA = True Then
        
            If gbKUIBONfirma Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).firma
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            If gbKUIBONtitel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).titel
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            ctmp = ""
            If gbKUIBONvorname Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
            End If
            
            If gbKUIBONname Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).nachname
            End If
    
        
            iLevel = 614
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            If gbKUIBONstrasse Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
            
                iLevel = 615
                If Len(ctmp) > 32 Then
                    ctmp = Left(ctmp, 32)
                End If
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            ctmp = ""
            If gbKUIBONplz Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
            End If
            
            If gbKUIBONort Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).Ort
            End If
        
            iLevel = 616
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            iLevel = 617
            
            If gbKUIBONtel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).telefon
                If ctmp <> "" Then
                    cDaten = "Tel " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            iLevel = 618
            
            If gbKUIBONmobil Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Mobiltel
                If ctmp <> "" Then
                    cDaten = "Mobil " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
        End If
    End If
    
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    
    iLevel = 6151
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6152
    cDaten = cDaten & Space$(4) & ctmp
    
    If giZahlArt = giKOLLEGE Then
        ctmp = "0"
        gdBonNr = 0
    Else
        ctmp = Format$(gdBonNr, "#####0")
    End If
    iLevel = 6153
    ctmp = gcKasNum & "/" & ctmp
    iLevel = 6154
    ctmp = Space$(8 - Len(ctmp)) & ctmp
    iLevel = 6155
    cDaten = cDaten & Space$(4) & ctmp
    
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    

    
    
    'OpenDrawer3 benutzt die WindowsAPI
    'OpenDrawer4 geht über das PRINTER-Objekt
    
    'Schublade nur einmal öffnen
    
    If giAndersZahlung = giKREDIT And iAktCopy = 2 Then
        GoTo BON_DRUCKEN
    End If
    
    iLevel = 12
    
BON_DRUCKEN:
    If bBonZwang Then
        gbBonDruck = True
'        Command1(12).Caption = "Bon JA!!!"
    End If
    If gbBonDruck Then
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
            
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    End If
        
BON_SCHNEIDEN:
    If gbBonDruck Then
        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
    End If
    
    iLevel = 11

    

ENDE:
    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerParknetto"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
   
End Sub
Private Sub SendeDaten2DruckerFleischernetto(lLfdNr As Long, cART As String, cBezeic As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lartnr                  As Long
    Dim lAnzSatz                As Long
    Dim lAktSatz                As Long
    Dim lTask                   As Long
    Dim lcount                  As Long
    Dim lAnzZeile               As Long
    
    Dim lAnzLbSatz              As Long
    Dim lRet                    As Long
    
    Dim cLBSatz                 As String
    Dim cFeld                   As String
    Dim cDaten                  As String
    Dim ctmp                    As String
    Dim cTmp2                   As String
    Dim cMWST                   As String
    Dim cText                   As String
    Dim cMWSTzzgl               As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim cArtNr                  As String
    ReDim cDruckZeile(1 To 1) As String
    ReDim cDruckZeile12(1 To 1) As String
    
    
    Dim ctmpFW                  As String
    Dim cDatenfw                As String
    
    Dim iLevel                  As Integer
    Dim iAktCopy                As Integer
    Dim iStufe                  As Integer
    Dim iLenZeile               As Integer
    Dim iFileNr                 As Integer
    Dim iGesAnzahl              As Integer
    
    Dim dGRabatt                As Double
    Dim dGRabattWert            As Double
    Dim dSumme                  As Double
    Dim dSummeNetto             As Double
    Dim dWert                   As Double
    Dim dwert12                 As Double
    Dim dEuro                   As Double
    Dim dMWStVoll               As Double
    Dim dMWStErm                As Double
    Dim dMWSTVzzgl              As Double
    Dim dMWSTEzzgl              As Double
    Dim dAktZeit                As Double
    Dim dNeuZeit                As Double
    Dim dMWSt                   As Double
    Dim dRabattNetto            As Double
    Dim dSummeVoll              As Double
    Dim lAnzahlArtikel          As Long
    Dim dWert13                 As Double
    Dim dSumArtikelRab          As Double
    
    Dim bAusblenden             As Boolean
    Dim bBonZwang               As Boolean
    Dim gbStorni                As Boolean
    
    gbStorni = False
    bBonZwang = False
    iLevel = 0
    dSummeNetto = 0
    dRabattNetto = 0
    dSumArtikelRab = 0
    dSummeVoll = 0
 
    
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    

StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    dMWSTVzzgl = 0
    dMWSTEzzgl = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
'    If gbBonDruck Then
'        BarcodeF CStr(gdSumme), CStr(lLfdNr)
'    End If
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    cDaten = "Dies ist kein Kassenbeleg"
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'artnr an Drucker senden
    '***********************************************
    
    cDaten = "Artikelnummer:" & Space$(1) & cART
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'bezeich an Drucker senden
    '***********************************************
    
    cDaten = cBezeic
    
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    
'    ctmp = "Summe"
'
'    ctmp = Trim$(ctmp)
'    ctmp = ctmp & Space$(17 - Len(ctmp))
'
'    ctmp = ctmp & Space$(1) & gcWaehrung
'    cDaten = ctmp
'    ctmp = Format$(gdSumme, "#####0.00")
'    ctmp = Space$(11 - Len(ctmp)) & ctmp
'
'    cDaten = cDaten & ctmp
'    KonvertAnsiAscii cDaten
'    cEscapeSequenz = cDaten & vbCrLf
'
'
'    lAnzZeile = lAnzZeile + 1
'    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
'    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************
    
    
    '*****
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If
        iGesAnzahl = iGesAnzahl + Val(ctmp)
    Next lAktSatz
    
    
    
    
    '*****

    ctmp = "Anzahl Artikel: " & iGesAnzahl
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
   
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    dSumme = 0
    iGesAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        If cFeld = "666666" Then
            bBonZwang = True
        End If
        lartnr = CLng(cFeld)
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld 'hier mehrwertsteuer
            cMWSTzzgl = cMWST
            
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            
            If gbDivKosmetik = True Then
                If lartnr = 666666 Then
                    cDaten = cDaten & cFeld
                Else
                    cDaten = cDaten & gcDivKosmetik
                End If
            Else
                cDaten = cDaten & cFeld
            End If
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'wenn Artikelermäßigung, dann drucken
            '***********************************************
            

            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            iGesAnzahl = iGesAnzahl + Val(ctmp)
            If Val(ctmp) < 0 Then
                gbStorni = True
            End If
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            ctmp = Trim$(ctmp)
            
            lAnzahlArtikel = Val(ctmp)
            
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            
            
            'hier voller Preis
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            dWert = Format$(dWert, "#####0.00")
            dWert = nettoR(dWert, cMWST)
            dWert = Format$(dWert, "#####0.00")
            
            dSummeVoll = dSummeVoll + (dWert * lAnzahlArtikel)
            dwert12 = dWert
            
            
            
            
            
            ctmp = Format$(dWert, "#####0.00")
            
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            dWert = Format$(dWert, "#####0.00")

            If cMWSTzzgl = "V" Then
            
                dMWSTVzzgl = Format$(dMWSTVzzgl, "#####0.00")
                dMWSTVzzgl = dMWSTVzzgl + Format$(((dWert * gdMWStV) / (gdMWStV + 100)), "#####0.00")
                dMWSTVzzgl = Format$(dMWSTVzzgl, "#####0.00")
            End If
            If cMWSTzzgl = "E" Then
            
                dMWSTEzzgl = Format$(dMWSTEzzgl, "#####0.00")
                dMWSTEzzgl = dMWSTEzzgl + Format$(((dWert * gdMWStE) / (gdMWStE + 100)), "#####0.00")
                dMWSTEzzgl = Format$(dMWSTEzzgl, "#####0.00")
            End If

            dWert = Format$(dWert, "#####0.00")
            dWert = nettoR(dWert, cMWST)
            dWert = Format$(dWert, "#####0.00")
            ctmp = Format$(dWert, "#####0.00")
            dSummeNetto = dSummeNetto + dWert
            
            
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & CStr(Format$((dwert12 * lAnzahlArtikel), "#####0.00"))
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            ctmp = Mid(cLBSatz, 124, 3)
            If Val(ctmp) > 0 And gbRabatt Then
                Dim dWert14 As Double
                'Zeile nur bei Artikel-Ermäßigung drucken
                
                cDaten = "Rabatt:    " & ctmp & " %"
                
                dWert14 = (dwert12 * lAnzahlArtikel) * Val(ctmp) / 100
                dWert14 = Format$(dWert14, "#####0.00")
                ctmp = Format$(dWert14, "#####0.00")
                
                dSumArtikelRab = dSumArtikelRab + dWert14

                ctmp = Space(9 - Len(ctmp)) & ctmp
                cDaten = cDaten & ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
        End If
    Next lAktSatz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    iLevel = 5
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    

    '***********************************************
    'Gesamtrabatt drucken
    '***********************************************
        
    If dSumArtikelRab > 0 Then Label2(3).Visible = True
    
    If Label2(3).Visible And Left(gFirma.FirmaName, 5) <> "Stief" And gbRabatt Then
        'Zeile nur bei Gesamt-Ermäßigung drucken

        ctmp = "Summe Netto:"
        ctmp = Trim$(ctmp)
        ctmp = ctmp & Space$(17 - Len(ctmp))
        ctmp = ctmp & Space$(1) & gcWaehrung
        cDaten = ctmp
        ctmp = Format$(dSummeVoll, "#####0.00")
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz

        If dSumArtikelRab = 0 Then
            ctmp = Label2(3).Caption
            If Len(ctmp) > 3 Then
                ctmp = Left(ctmp, Len(ctmp) - 3)
            End If
            dWert = (dSummeVoll * Val(ctmp)) / 100
            
            If Len(ctmp) > 2 Then
                cDaten = "Gesamtrabatt:" & Space(3 - Len(ctmp)) & ctmp & "% " & gcWaehrung
            Else
                cDaten = "Gesamtrabatt: " & Space(2 - Len(ctmp)) & ctmp & "% " & gcWaehrung
            End If
'            cDaten = "Gesamtrabatt: " & Space(2 - Len(cTmp)) & cTmp & "% " & gcWaehrung
            
            ctmp = Format$(dWert, "#####0.00")
        Else
            
            dSummeNetto = dSummeVoll - dSumArtikelRab
            cDaten = "Summe Art.rabatt: " & gcWaehrung
            ctmp = Format$(dSumArtikelRab, "#####0.00")
            Label2(3).Visible = False
        End If
        ctmp = Space$(11 - Len(ctmp)) & ctmp
        cDaten = cDaten & ctmp
        
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
GutschECLast:
    
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Endbeterag' drucken
    '***********************************************
endbetrag:
    ctmp = "Summe Netto:"
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(dSummeNetto, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    ctmp = "MwSt Anteil: " & gdMWStV & "% "
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(dMWSTVzzgl, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    ctmp = "MwSt Anteil: " & gdMWStE & "% "
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    ctmp = Format$(dMWSTEzzgl, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    ctmp = "Summe Brutto:"
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung
    cDaten = ctmp
    gdSumme = dSummeNetto + dMWSTVzzgl + dMWSTEzzgl
    ctmp = Format$(gdSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    
    
    
    '***********************************************
    'Zeile 'Anzahl Artikel' drucken
    '***********************************************

    ctmp = "Anzahl Artikel: " & iGesAnzahl
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "Es bediente Sie"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Zeile 'Kassennummer' drucken
    '***********************************************
    
    ctmp = "Kasse: " & gcKasNum
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    iLevel = 612
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    
    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
        
        iLevel = 613
        ctmp = "Ihre KundenNr: " & Label2(7).Caption
        cDaten = ctmp
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    
        If gbKUNDENA = True Then
        
            If gbKUIBONfirma Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).firma
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            If gbKUIBONtitel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).titel
            
                If ctmp <> "" Then
                    If Len(ctmp) > 32 Then ctmp = Left(ctmp, 32)
                    cDaten = ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            ctmp = ""
            If gbKUIBONvorname Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).vorname
            End If
            
            If gbKUIBONname Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).nachname
            End If
    
        
            iLevel = 614
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            
            If gbKUIBONstrasse Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).strasse
            
                iLevel = 615
                If Len(ctmp) > 32 Then
                    ctmp = Left(ctmp, 32)
                End If
                cDaten = ctmp
                KonvertAnsiAscii cDaten
                cEscapeSequenz = cDaten & vbCrLf
                
                lAnzZeile = lAnzZeile + 1
                ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                cDruckZeile(lAnzZeile) = cEscapeSequenz
            End If
            
            ctmp = ""
            If gbKUIBONplz Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Plz
            End If
            
            If gbKUIBONort Then
                If ctmp = "" Then
                    ctmp = ctmp & ""
                Else
                    ctmp = ctmp & " "
                End If
                ctmp = ctmp & lookingForKundendaten(Trim(Label2(7).Caption)).Ort
            End If
        
            iLevel = 616
            If Len(ctmp) > 32 Then
                ctmp = Left(ctmp, 32)
            End If
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            iLevel = 617
            
            If gbKUIBONtel Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).telefon
                If ctmp <> "" Then
                    cDaten = "Tel " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
            iLevel = 618
            
            If gbKUIBONmobil Then
                ctmp = lookingForKundendaten(Trim(Label2(7).Caption)).Mobiltel
                If ctmp <> "" Then
                    cDaten = "Mobil " & ctmp
                    KonvertAnsiAscii cDaten
                    cEscapeSequenz = cDaten & vbCrLf
                    
                    lAnzZeile = lAnzZeile + 1
                    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
                    cDruckZeile(lAnzZeile) = cEscapeSequenz
                End If
            End If
            
        End If
    End If
    
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    
    iLevel = 6151
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6152
    cDaten = cDaten & Space$(4) & ctmp
    
    If giZahlArt = giKOLLEGE Then
        ctmp = "0"
        gdBonNr = 0
    Else
        ctmp = Format$(gdBonNr, "#####0")
    End If
    iLevel = 6153
    ctmp = gcKasNum & "/" & ctmp
    iLevel = 6154
    ctmp = Space$(8 - Len(ctmp)) & ctmp
    iLevel = 6155
    cDaten = cDaten & Space$(4) & ctmp
    
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    
    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
    
    If gbBonDruck Then
        BarcodeF CStr(gdSumme), CStr(lLfdNr)
    End If
    

    
    
    'OpenDrawer3 benutzt die WindowsAPI
    'OpenDrawer4 geht über das PRINTER-Objekt
    
    'Schublade nur einmal öffnen
    
    If giAndersZahlung = giKREDIT And iAktCopy = 2 Then
        GoTo BON_DRUCKEN
    End If
    
    iLevel = 12
    
BON_DRUCKEN:
    If bBonZwang Then
        gbBonDruck = True
'        Command1(12).Caption = "Bon JA!!!"
    End If
    If gbBonDruck Then
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
            
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    End If
        
BON_SCHNEIDEN:
    If gbBonDruck Then
        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
    End If
    
    iLevel = 11

ENDE:
    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerFleischernetto"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
   
End Sub
Private Sub Barcode(cSumme As String, cVorgang As String)
On Error GoTo LOKAL_ERROR

    Dim lcount                  As Long
    Dim cZeichen                As String
    Dim cArtNr                  As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim lPruefZiffer            As Long

    aDeviceName = Printer.DeviceName
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(27) & Chr(97) & Chr(1)
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(29) & Chr(72) & Chr(2)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    'die Barcodehöhe
    
'    cEscapeSequenz = Chr(29) & Chr(104) & Chr(164)
'    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(104) & Chr(40)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(119) & Chr(3)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    If Len(cVorgang) = 1 Then
        cVorgang = "000" & cVorgang
    ElseIf Len(cVorgang) = 2 Then
        cVorgang = "00" & cVorgang
    ElseIf Len(cVorgang) = 3 Then
        cVorgang = "0" & cVorgang
    ElseIf Len(cVorgang) = 4 Then
        
    End If
    cSumme = Format$(cSumme, "#####.00")
    cSumme = SwapStr(cSumme, ",", "")
    cSumme = SwapStr(cSumme, ".", "")
    
    If Len(cSumme) = 1 Then
        cSumme = "00000" & cSumme
    ElseIf Len(cSumme) = 2 Then
        cSumme = "0000" & cSumme
    ElseIf Len(cSumme) = 3 Then
        cSumme = "000" & cSumme
    ElseIf Len(cSumme) = 4 Then
        cSumme = "00" & cSumme
    ElseIf Len(cSumme) = 5 Then
        cSumme = "0" & cSumme
    ElseIf Len(cSumme) = 6 Then

    End If
    
    cArtNr = "2" & "9" & cVorgang & cSumme
    
    Dim p1 As Integer
    Dim p2 As Integer
    Dim p3 As Integer
    Dim p4 As Integer
    Dim p5 As Integer
    Dim p6 As Integer
    Dim p7 As Integer
    Dim p8 As Integer
    Dim p9 As Integer
    Dim p10 As Integer
    Dim p11 As Integer
    Dim p12 As Integer
    Dim p13 As Integer
    
    Dim rest As Double
    Dim pz As Long
    
    p1 = Val(Mid(cArtNr, 1, 1)) * 1
    p2 = Val(Mid(cArtNr, 2, 1)) * 3
    p3 = Val(Mid(cArtNr, 3, 1)) * 1
    p4 = Val(Mid(cArtNr, 4, 1)) * 3
    p5 = Val(Mid(cArtNr, 5, 1)) * 1
    p6 = Val(Mid(cArtNr, 6, 1)) * 3
    p7 = Val(Mid(cArtNr, 7, 1)) * 1
    p8 = Val(Mid(cArtNr, 8, 1)) * 3
    p9 = Val(Mid(cArtNr, 9, 1)) * 1
    p10 = Val(Mid(cArtNr, 10, 1)) * 3
    p11 = Val(Mid(cArtNr, 11, 1)) * 1
    p12 = Val(Mid(cArtNr, 12, 1)) * 3
    p13 = p1 + p2 + p3 + p4 + p5 + p6 + p7 + p8 + p9 + p10 + p11 + p12
    
    rest = p13 Mod 10
    pz = 10 - rest
    If rest = 0 Then
        pz = 0
    End If

    cArtNr = cArtNr & Trim$(Str$(pz))
    
    cEscapeSequenz = gcBarCode & cArtNr
    OpenDrawer aDeviceName, cEscapeSequenz
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Barcode"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Barcode_ArtAuswahl(cSumme As String, cVorgang As String)
On Error GoTo LOKAL_ERROR

    Dim lcount                  As Long
    Dim cZeichen                As String
    Dim cArtNr                  As String
    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim lPruefZiffer            As Long

    aDeviceName = Printer.DeviceName
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(27) & Chr(97) & Chr(1)
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(29) & Chr(72) & Chr(2)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    'die Barcodehöhe
    
'    cEscapeSequenz = Chr(29) & Chr(104) & Chr(164)
'    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(104) & Chr(40)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(119) & Chr(3)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    If Len(cVorgang) = 1 Then
        cVorgang = "00" & cVorgang
    ElseIf Len(cVorgang) = 2 Then
        cVorgang = "0" & cVorgang
    ElseIf Len(cVorgang) = 3 Then
        cVorgang = "" & cVorgang
    End If
    cSumme = Format$(cSumme, "#####.00")
    cSumme = SwapStr(cSumme, ",", "")
    cSumme = SwapStr(cSumme, ".", "")
    
    If Len(cSumme) = 1 Then
        cSumme = "000000" & cSumme
    ElseIf Len(cSumme) = 2 Then
        cSumme = "00000" & cSumme
    ElseIf Len(cSumme) = 3 Then
        cSumme = "0000" & cSumme
    ElseIf Len(cSumme) = 4 Then
        cSumme = "000" & cSumme
    ElseIf Len(cSumme) = 5 Then
        cSumme = "00" & cSumme
    ElseIf Len(cSumme) = 6 Then
        cSumme = "0" & cSumme
    ElseIf Len(cSumme) = 7 Then

    End If
    
    cArtNr = "2" & "7" & cVorgang & cSumme
    
    Dim p1 As Integer
    Dim p2 As Integer
    Dim p3 As Integer
    Dim p4 As Integer
    Dim p5 As Integer
    Dim p6 As Integer
    Dim p7 As Integer
    Dim p8 As Integer
    Dim p9 As Integer
    Dim p10 As Integer
    Dim p11 As Integer
    Dim p12 As Integer
    Dim p13 As Integer
    
    Dim rest As Double
    Dim pz As Long
    
    
    p1 = Val(Mid(cArtNr, 1, 1)) * 1
    p2 = Val(Mid(cArtNr, 2, 1)) * 3
    p3 = Val(Mid(cArtNr, 3, 1)) * 1
    p4 = Val(Mid(cArtNr, 4, 1)) * 3
    p5 = Val(Mid(cArtNr, 5, 1)) * 1
    p6 = Val(Mid(cArtNr, 6, 1)) * 3
    p7 = Val(Mid(cArtNr, 7, 1)) * 1
    p8 = Val(Mid(cArtNr, 8, 1)) * 3
    p9 = Val(Mid(cArtNr, 9, 1)) * 1
    p10 = Val(Mid(cArtNr, 10, 1)) * 3
    p11 = Val(Mid(cArtNr, 11, 1)) * 1
    p12 = Val(Mid(cArtNr, 12, 1)) * 3
    p13 = p1 + p2 + p3 + p4 + p5 + p6 + p7 + p8 + p9 + p10 + p11 + p12
    
    rest = p13 Mod 10
    pz = 10 - rest
    If rest = 0 Then
        pz = 0
    End If
    

    
    cArtNr = cArtNr & Trim$(Str$(pz))
    
    
    
    
    cEscapeSequenz = gcBarCode & cArtNr
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Barcode_ArtAuswahl"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub




Private Sub BarcodeALR(cVorgang As String)
On Error GoTo LOKAL_ERROR

    Dim lcount                  As Long
    Dim cZeichen                As String
    Dim cArtNr                  As String

    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim lPruefZiffer            As Long

    aDeviceName = Printer.DeviceName
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(27) & Chr(97) & Chr(1)
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(29) & Chr(72) & Chr(2)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    'die Barcodehöhe
    
'    cEscapeSequenz = Chr(29) & Chr(104) & Chr(164)
'    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(104) & Chr(40)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(119) & Chr(3)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    If Len(cVorgang) = 1 Then
        cVorgang = "00000000" & cVorgang
    ElseIf Len(cVorgang) = 2 Then
        cVorgang = "0000000" & cVorgang
    ElseIf Len(cVorgang) = 3 Then
        cVorgang = "000000" & cVorgang
    ElseIf Len(cVorgang) = 4 Then
        cVorgang = "00000" & cVorgang
    ElseIf Len(cVorgang) = 5 Then
        cVorgang = "0000" & cVorgang
    ElseIf Len(cVorgang) = 6 Then
        cVorgang = "000" & cVorgang
    ElseIf Len(cVorgang) = 7 Then
        cVorgang = "00" & cVorgang
    ElseIf Len(cVorgang) = 8 Then
        cVorgang = "0" & cVorgang
    ElseIf Len(cVorgang) = 9 Then
        
    End If
    
    
    cArtNr = "2" & "77" & cVorgang
    
    Dim p1 As Integer
    Dim p2 As Integer
    Dim p3 As Integer
    Dim p4 As Integer
    Dim p5 As Integer
    Dim p6 As Integer
    Dim p7 As Integer
    Dim p8 As Integer
    Dim p9 As Integer
    Dim p10 As Integer
    Dim p11 As Integer
    Dim p12 As Integer
    Dim p13 As Integer
    
    Dim rest As Double
    Dim pz As Long
    
    
    p1 = Val(Mid(cArtNr, 1, 1)) * 1
    p2 = Val(Mid(cArtNr, 2, 1)) * 3
    p3 = Val(Mid(cArtNr, 3, 1)) * 1
    p4 = Val(Mid(cArtNr, 4, 1)) * 3
    p5 = Val(Mid(cArtNr, 5, 1)) * 1
    p6 = Val(Mid(cArtNr, 6, 1)) * 3
    p7 = Val(Mid(cArtNr, 7, 1)) * 1
    p8 = Val(Mid(cArtNr, 8, 1)) * 3
    p9 = Val(Mid(cArtNr, 9, 1)) * 1
    p10 = Val(Mid(cArtNr, 10, 1)) * 3
    p11 = Val(Mid(cArtNr, 11, 1)) * 1
    p12 = Val(Mid(cArtNr, 12, 1)) * 3
    p13 = p1 + p2 + p3 + p4 + p5 + p6 + p7 + p8 + p9 + p10 + p11 + p12
    
    rest = p13 Mod 10
    pz = 10 - rest
    If rest = 0 Then
        pz = 0
    End If
    
    cArtNr = cArtNr & Trim$(Str$(pz))
    
    cEscapeSequenz = gcBarCode & cArtNr
    OpenDrawer aDeviceName, cEscapeSequenz
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BarcodeALR"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub BarcodeF(cSumme As String, cVorgang As String)
On Error GoTo LOKAL_ERROR

    Dim lcount                  As Long
    Dim cZeichen                As String
    Dim cArtNr                  As String

    Dim aDeviceName             As String
    Dim cEscapeSequenz          As String
    Dim lPruefZiffer            As Long
    
    Dim cVZ                     As String

    aDeviceName = Printer.DeviceName
    cEscapeSequenz = vbCrLf
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(27) & Chr(97) & Chr(1)
    OpenDrawer aDeviceName, cEscapeSequenz

    cEscapeSequenz = Chr(29) & Chr(72) & Chr(2)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    'die Barcodehöhe
    
'    cEscapeSequenz = Chr(29) & Chr(104) & Chr(164)
'    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(104) & Chr(40)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    cEscapeSequenz = Chr(29) & Chr(119) & Chr(3)
    OpenDrawer aDeviceName, cEscapeSequenz
    
    If Len(cVorgang) = 1 Then
        cVorgang = "0" & cVorgang
    ElseIf Len(cVorgang) = 2 Then
        
    End If
    
    If Left(cSumme, 1) = "-" Then
        cSumme = Right(cSumme, Len(cSumme) - 1)
        cVZ = "1"
    Else
    
        cVZ = "0"
    End If
    
    
    
    cSumme = Format$(cSumme, "#####.00")
    cSumme = SwapStr(cSumme, ",", "")
    cSumme = SwapStr(cSumme, ".", "")
    
    If Len(cSumme) = 1 Then
        cSumme = "00000" & cSumme
    ElseIf Len(cSumme) = 2 Then
        cSumme = "0000" & cSumme
    ElseIf Len(cSumme) = 3 Then
        cSumme = "000" & cSumme
    ElseIf Len(cSumme) = 4 Then
        cSumme = "00" & cSumme
    ElseIf Len(cSumme) = 5 Then
        cSumme = "0" & cSumme
    ElseIf Len(cSumme) = 6 Then
        
    End If
    
    cArtNr = "2" & "8" & cVZ & cVorgang & "0" & cSumme
    
    Dim p1 As Integer
    Dim p2 As Integer
    Dim p3 As Integer
    Dim p4 As Integer
    Dim p5 As Integer
    Dim p6 As Integer
    Dim p7 As Integer
    Dim p8 As Integer
    Dim p9 As Integer
    Dim p10 As Integer
    Dim p11 As Integer
    Dim p12 As Integer
    Dim p13 As Integer
    
    Dim rest As Double
    Dim pz As Long
    
    
    p1 = Val(Mid(cArtNr, 1, 1)) * 1
    p2 = Val(Mid(cArtNr, 2, 1)) * 3
    p3 = Val(Mid(cArtNr, 3, 1)) * 1
    p4 = Val(Mid(cArtNr, 4, 1)) * 3
    p5 = Val(Mid(cArtNr, 5, 1)) * 1
    p6 = Val(Mid(cArtNr, 6, 1)) * 3
    p7 = Val(Mid(cArtNr, 7, 1)) * 1
    p8 = Val(Mid(cArtNr, 8, 1)) * 3
    p9 = Val(Mid(cArtNr, 9, 1)) * 1
    p10 = Val(Mid(cArtNr, 10, 1)) * 3
    p11 = Val(Mid(cArtNr, 11, 1)) * 1
    p12 = Val(Mid(cArtNr, 12, 1)) * 3
    p13 = p1 + p2 + p3 + p4 + p5 + p6 + p7 + p8 + p9 + p10 + p11 + p12
    
    rest = p13 Mod 10
    pz = 10 - rest
    If rest = 0 Then
        pz = 0
    End If

    cArtNr = cArtNr & Trim$(Str$(pz))
    
    cEscapeSequenz = gcBarCode & cArtNr
    OpenDrawer aDeviceName, cEscapeSequenz
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BarcodeF"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SendeDaten2DruckerRetoureWKL20(sRetourengrund As String)
    On Error GoTo LOKAL_ERROR
        
    '********************************************************************
    '* Vorlage für diese Sub ist SendeDaten2DruckerNeuWKL20
    '********************************************************************
    
    Dim lTask               As Long
    Dim lAnzSatz            As Long
    Dim lAktSatz            As Long
    Dim lcount              As Long
    Dim lAnzZeile           As Long
    Dim lAnzLbSatz          As Long
    Dim lRet                As Long
    
    Dim cLBSatz             As String
    Dim cFeld               As String
    Dim cDaten              As String
    Dim ctmp                As String
    Dim cTmp2               As String
    Dim cMWST               As String
    Dim cText               As String
    Dim aDeviceName         As String
    Dim cEscapeSequenz      As String
    Dim cArtNr              As String
    ReDim cDruckZeile(1 To 1) As String
    
    Dim dGRabatt            As Double
    Dim dGRabattWert        As Double
    Dim dSumme              As Double
    Dim lAnzahl             As Long
    Dim dWert               As Double
    Dim dEuro               As Double
    Dim dMWStVoll           As Double
    Dim dMWStErm            As Double
    Dim dAktZeit            As Double
    Dim dNeuZeit            As Double
    Dim dMWSt               As Double
    
    Dim bAusblenden         As Boolean
    
    Dim iStufe              As Integer
    Dim iLenZeile           As Integer
    Dim iLevel              As Integer
    Dim iAktCopy            As Integer
    Dim iFileNr             As Integer
   
    
   
    'Bonzwang bei Retoure
    gbBonDruck = True
    
    
    
    iLevel = 0
    
'    setzedrucker gcBonDrucker
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    
SCHUBLADE:
    If gbOpenSchubRetoure Then
        OeffneSchubladeExplizitWKL20
    End If


StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    lAnzahl = 0
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    


    If gcBild <> "" Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcBild
        OpenDrawer aDeviceName, cEscapeSequenz
    End If
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "K.I.S.S. Warenwirtschaft"
    Else
        cDaten = gcBonText(0)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "Carsten Schröder"
    Else
        cDaten = gcBonText(1)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(4)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        iStufe = 3
    End If
    
    '***********************************************
    'Kopfdaten 4.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(12)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If

    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Default-Text drucken
    '***********************************************
    
    cDaten = "W A R E N - R E T O U R E"
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = sRetourengrund
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    
    dSumme = 0
    lAnzahl = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            cDaten = cDaten & cFeld
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            
            ctmp = Trim$(ctmp)
            lAnzahl = lAnzahl + Val(ctmp)
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            ctmp = Format$(dWert, "#####0.00")
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            ctmp = Format$(dWert, "#####0.00")
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'MWSt-Summe berechnen
            '***********************************************
    
            If cMWST = "V" Then
                dMWSt = dWert / (100 + gdMWStV)
                dMWSt = dMWSt * gdMWStV
                dMWStVoll = dMWStVoll + dMWSt
            ElseIf cMWST = "E" Then
               dMWSt = dWert / (100 + gdMWStE)
                dMWSt = dMWSt * gdMWStE
                dMWStErm = dMWStErm + dMWSt
            Else
                dMWSt = 0
            End If
        Else
'            'Zeile mit Zwischensumme drucken
'            cDaten = "Zwischensumme:     "
'
'            ctmp = Mid(cLBSatz, 60, 9)
'            ctmp = fnMoveComma2Point$(ctmp)
'            dWert = Val(ctmp)
'            ctmp = Format$(dWert, "#####0.00")
'            ctmp = Space(13 - Len(ctmp)) & ctmp
'
'            cDaten = cDaten & ctmp

            'Zeile mit Zwischensumme drucken
            ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
            ctmp = Left(Trim(ctmp), 32)
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
        End If
    Next lAktSatz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    iLevel = 5
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Anzahl Artikel drucken
    '***********************************************
    
    ctmp = "Anzahl Artikel"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & "Stück"
    cDaten = ctmp
    ctmp = Format$(lAnzahl, "#####0")
    ctmp = Space$(9 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
            
    '***********************************************
    'Endbetrag drucken
    '***********************************************
    If gbRETVK Then
        ctmp = "Endbetrag"
    Else
        ctmp = "Endbetrag EK"
    End If
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung

    cDaten = ctmp
    ctmp = Format$(dSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
   
    bAusblenden = False
    
    'entfällt bei RETOURE
    '***********************************************
    'Rückgeld drucken
    'Bei Barzahlung ohne Rückgeld werden die Zeilen
    'Zahlungsart und Rückgeld unterdrückt
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile volle MWSt drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile erm. MWSt drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "Retoure erstellt von:"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Kassennummer' drucken
    '***********************************************
    
    ctmp = "Kasse: " & gcKasNum
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    iLevel = 612
    
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    ctmp = "0"
    gdBonNr = 0
    iLevel = 6151
    ctmp = gcKasNum & "/" & ctmp
    iLevel = 6152
    ctmp = Space$(8 - Len(ctmp)) & ctmp
    iLevel = 6153
    cDaten = cDaten & Space$(3) & ctmp
    iLevel = 6154
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6155
    cDaten = cDaten & Space$(5) & ctmp
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Lieferschein bei Kreditverkäufen drucken
    '***********************************************
    
    iLevel = 7
    
    'entfällt bei RETOURE
    '***********************************************
    '1.Zeile Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, gsSTERNZEICH)
'    cDaten = String$(iLenZeile, "*")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Euro drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    '2.Zeile Trennstrich drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Fußzeile 1 drucken
    '***********************************************
    'Fußzeilen
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "KEIN GÜLTIGER KASSENBON!"
    Else
        cDaten = gcBonText(2)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 2 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(3)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    '***********************************************
    'Fußzeile 3 drucken
    '***********************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = ""
    Else
        cDaten = gcBonText(5)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = "." & vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
    '*************************************************
    '* OpenDrawer3 benutzt die WindowsAPI
    '* OpenDrawer4 geht über das PRINTER-Objekt
    '*************************************************
    '******************************
    'Schublade nur einmal öffnen
    '******************************
    'entfällt bei RETOURE
    iLevel = 12

BON_DRUCKEN:
    '**************************************
    '* Bon wird bei RETOURE immer gedruckt
    '**************************************
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    
    If iAktCopy = 1 Then
        'Bon-Daten sichern
        SichernBonDaten cDruckZeile(), lAnzZeile, "", "", False
    End If

BON_SCHNEIDEN:

    If gbBonDruck Then
        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
    End If
    
    iLevel = 11
    
ZWEITER_BON:

    'entfällt bei RETOURE
    Erase cDruckZeile
    
GUTSCHEIN:
    'entfällt bei RETOURE
ENDE:

    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerRetoureWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub SendeDaten2DruckerRückgabeWKL20()
    On Error GoTo LOKAL_ERROR
        
    '********************************************************************
    '* Vorlage für diese Sub ist SendeDaten2DruckerNeuWKL20
    '********************************************************************
    
    Dim lTask               As Long
    Dim lAnzSatz            As Long
    Dim lAktSatz            As Long
    Dim lcount              As Long
    Dim lAnzZeile           As Long
    Dim lAnzLbSatz          As Long
    Dim lRet                As Long
    
    Dim cLBSatz             As String
    Dim cFeld               As String
    Dim cDaten              As String
    Dim ctmp                As String
    Dim cTmp2               As String
    Dim cMWST               As String
    Dim cText               As String
    Dim aDeviceName         As String
    Dim cEscapeSequenz      As String
    Dim cArtNr              As String
    ReDim cDruckZeile(1 To 1) As String
    
    Dim dGRabatt            As Double
    Dim dGRabattWert        As Double
    Dim dSumme              As Double
    Dim dWert               As Double
    Dim dEuro               As Double
    Dim dMWStVoll           As Double
    Dim dMWStErm            As Double
    Dim dAktZeit            As Double
    Dim dNeuZeit            As Double
    Dim dMWSt               As Double
    
    Dim bAusblenden         As Boolean
    Dim bBonZwang           As Boolean
    Dim iStufe              As Integer
    Dim iLenZeile           As Integer
    Dim iLevel              As Integer
    Dim iAktCopy            As Integer
    Dim iFileNr             As Integer
   
    
    bBonZwang = False
    iLevel = 0
    
'    setzedrucker gcBonDrucker
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    
''SCHUBLADE:
''    OeffneSchubladeExplizitWKL20


StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf. Logo auf Kassenbon bringen
    '***********************************************
    


    If gcBild <> "" Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcBild
        OpenDrawer aDeviceName, cEscapeSequenz
    End If
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "K.I.S.S. Warenwirtschaft"
    Else
        cDaten = gcBonText(0)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "Carsten Schröder"
    Else
        cDaten = gcBonText(1)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(4)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        iStufe = 3
    End If
    
    '***********************************************
    'Kopfdaten 4.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(12)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If

    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Default-Text drucken
    '***********************************************
    
    cDaten = "W A R E N - R Ü C K G A B E"
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    
    dSumme = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            cDaten = cDaten & cFeld
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            If Left(gFirma.FirmaName, 5) = "Stief" Then
                ctmp = Format$((dWert * 100), "########0")
            Else
                ctmp = Format$(dWert, "#####0.00")
            End If
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            ctmp = Format$(dWert, "#####0.00")
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'MWSt-Summe berechnen
            '***********************************************
    
            If cMWST = "V" Then
                dMWSt = dWert / (100 + gdMWStV)
                dMWSt = dMWSt * gdMWStV
                dMWStVoll = dMWStVoll + dMWSt
            ElseIf cMWST = "E" Then
               dMWSt = dWert / (100 + gdMWStE)
                dMWSt = dMWSt * gdMWStE
                dMWStErm = dMWStErm + dMWSt
            Else
                dMWSt = 0
            End If
        Else
'            'Zeile mit Zwischensumme drucken
'            cDaten = "Zwischensumme:     "
'
'            ctmp = Mid(cLBSatz, 60, 9)
'            ctmp = fnMoveComma2Point$(ctmp)
'            dWert = Val(ctmp)
'            ctmp = Format$(dWert, "#####0.00")
'            ctmp = Space(13 - Len(ctmp)) & ctmp
'
'            cDaten = cDaten & ctmp

            'Zeile mit Zwischensumme drucken
            ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
            ctmp = Left(Trim(ctmp), 32)
            cDaten = ctmp


            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
        End If
    Next lAktSatz
    
    
    
    
    
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    iLevel = 5
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
            
    '***********************************************
    'Endbetrag drucken
    '***********************************************
    
    ctmp = "Endbetrag"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung

    cDaten = ctmp
    ctmp = Format$(dSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
   
    
    bAusblenden = False
    
    'entfällt bei RETOURE
    '***********************************************
    'Rückgeld drucken
    'Bei Barzahlung ohne Rückgeld werden die Zeilen
    'Zahlungsart und Rückgeld unterdrückt
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile volle MWSt drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile erm. MWSt drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "Rückgabe erstellt von:"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Kassennummer' drucken
    '***********************************************
    
    ctmp = "Kasse: " & gcKasNum
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    iLevel = 612
    
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    ctmp = "0"
    gdBonNr = 0
    iLevel = 6151
    ctmp = gcKasNum & "/" & ctmp
    iLevel = 6152
    ctmp = Space$(8 - Len(ctmp)) & ctmp
    iLevel = 6153
    cDaten = cDaten & Space$(3) & ctmp
    iLevel = 6154
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6155
    cDaten = cDaten & Space$(5) & ctmp
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Lieferschein bei Kreditverkäufen drucken
    '***********************************************
    
    iLevel = 7
    
    'entfällt bei RETOURE
    '***********************************************
    '1.Zeile Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, gsSTERNZEICH)
'    cDaten = String$(iLenZeile, "*")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Euro drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    '2.Zeile Trennstrich drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Fußzeile 1 drucken
    '***********************************************
    'Fußzeilen
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "KEIN GÜLTIGER KASSENBON!"
    Else
        cDaten = gcBonText(2)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 2 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(3)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    '***********************************************
    'Fußzeile 3 drucken
    '***********************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = ""
    Else
        cDaten = gcBonText(5)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = "." & vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
   
    iLevel = 12
    
BON_DRUCKEN:
    '**************************************
    '* Bon wird bei RETOURE immer gedruckt
    '**************************************
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    
    If iAktCopy = 1 Then
        'Bon-Daten sichern
        SichernBonDaten cDruckZeile(), lAnzZeile, "", "", False
    End If

BON_SCHNEIDEN:

    If gbBonDruck Then

        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
        
    End If
    
    iLevel = 11
    
ZWEITER_BON:

    'entfällt bei RETOURE
    Erase cDruckZeile
    
GUTSCHEIN:
    'entfällt bei RETOURE
ENDE:

    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerRückgabeWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub SendeDaten2DruckerALRWKL20(lfnr As Long)
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz            As Long
    Dim lAktSatz            As Long
    Dim lcount              As Long
    Dim lAnzZeile           As Long
    
    Dim cLBSatz             As String
    Dim cFeld               As String
    Dim cDaten              As String
    Dim ctmp                As String
    Dim cMWST               As String

    Dim aDeviceName         As String
    Dim cEscapeSequenz      As String
    ReDim cDruckZeile(1 To 1) As String
    
    Dim dGRabatt            As Double
    Dim dGRabattWert        As Double
    Dim dSumme              As Double
    Dim dWert               As Double
    Dim dMWStVoll           As Double
    Dim dMWStErm            As Double
    Dim dMWSt               As Double
    
    Dim iStufe              As Integer
    Dim iLenZeile           As Integer
    Dim iLevel              As Integer
    Dim iAktCopy            As Integer
   
    iLevel = 0
    
'    setzedrucker gcBonDrucker
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    
'SCHUBLADE:
'    OeffneSchubladeExplizitWKL20


StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    dSumme = 0
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Hier geht's los
    '***********************************************
    
    lAnzSatz = List1.ListCount
    iLevel = 2
    
    '***********************************************
    'Drucker wird auf BonDrucker geschaltet
    '***********************************************
    
    aDeviceName = gcBonDrucker
    iLevel = 3
    dMWStVoll = 0
    dMWStErm = 0
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'ggf.barcode auf Kassenbon bringen
    '***********************************************
    
'    If gbBonDruck Then
    
        If lfnr > 0 Then
            BarcodeALR CStr(lfnr)
        Else
        
        End If

'    End If

    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Kopfdaten 1.Zeile an Drucker senden
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "K.I.S.S. Warenwirtschaft"
    Else
        cDaten = gcBonText(0)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '***********************************************
    'Kopfdaten 2.Zeile an Drucker senden
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "Carsten Schröder"
    Else
        cDaten = gcBonText(1)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    '***********************************************
    'Kopfdaten 3.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(4)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        iStufe = 3
    End If
    
    '***********************************************
    'Kopfdaten 4.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(12)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If

    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Default-Text drucken
    '***********************************************
    
    cDaten = "NUR FÜR ALR"
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Artikelpositionen drucken
    '***********************************************
    
    iLevel = 4
    
    dSumme = 0
    For lAktSatz = 0 To lAnzSatz - 1
        cLBSatz = List1.list(lAktSatz)
        
        cFeld = Mid(cLBSatz, 7, 6)
        
        If cFeld <> "000000" Then
            '1.Zeile: ArtNr + MWSTKz + ArtBezeich
            cDaten = cFeld & " "
            cFeld = Mid(cLBSatz, 72, 1)
            cDaten = cDaten & cFeld & "  "
            cMWST = cFeld
            cFeld = Mid(cLBSatz, 14, 35)
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 17 Then
                cFeld = Left(cFeld, 17)
            End If
            cDaten = cDaten & cFeld
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'Anzahl, Einzelpreis, Positionspreis drucken
            '***********************************************
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
            
            ctmp = Trim$(ctmp)
            ctmp = ctmp & Space$(6 - Len(ctmp))
            cDaten = ctmp & " x"
            
            If gbRabatt Then
                ctmp = Mid(cLBSatz, 74, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            Else
                ctmp = Mid(cLBSatz, 50, 9)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
            End If
            
            If Left(gFirma.FirmaName, 5) = "Stief" Then
                ctmp = Format$((dWert * 100), "########0")
            Else
                ctmp = Format$(dWert, "#####0.00")
            End If
            ctmp = Space(11 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            
            ctmp = Mid(cLBSatz, 60, 9)
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            ctmp = Format$(dWert, "#####0.00")
            dSumme = dSumme + dWert
            ctmp = Space(13 - Len(ctmp)) & ctmp
            cDaten = cDaten & ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
            '***********************************************
            'MWSt-Summe berechnen
            '***********************************************
    
            If cMWST = "V" Then
                dMWSt = dWert / (100 + gdMWStV)
                dMWSt = dMWSt * gdMWStV
                dMWStVoll = dMWStVoll + dMWSt
            ElseIf cMWST = "E" Then
               dMWSt = dWert / (100 + gdMWStE)
                dMWSt = dMWSt * gdMWStE
                dMWStErm = dMWStErm + dMWSt
            Else
                dMWSt = 0
            End If
        Else
'            'Zeile mit Zwischensumme drucken
'            cDaten = "Zwischensumme:     "
'
'            ctmp = Mid(cLBSatz, 60, 9)
'            ctmp = fnMoveComma2Point$(ctmp)
'            dWert = Val(ctmp)
'            ctmp = Format$(dWert, "#####0.00")
'            ctmp = Space(13 - Len(ctmp)) & ctmp
'
'            cDaten = cDaten & ctmp



            'Zeile mit Zwischensumme drucken
            ctmp = Mid(cLBSatz, 13, Len(cLBSatz) - 13)
            ctmp = Left(Trim(ctmp), 32)
            cDaten = ctmp
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
            
        End If
    Next lAktSatz
    
    
    
    
    
    
    '***********************************************
    'Trennstrich drucken
    '***********************************************
    
    iLevel = 5
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
            
    '***********************************************
    'Endbetrag drucken
    '***********************************************
    
    ctmp = "Endbetrag"
    
    ctmp = Trim$(ctmp)
    ctmp = ctmp & Space$(17 - Len(ctmp))
    ctmp = ctmp & Space$(1) & gcWaehrung

    cDaten = ctmp
    ctmp = Format$(dSumme, "#####0.00")
    ctmp = Space$(11 - Len(ctmp)) & ctmp
    iLevel = 6102
    cDaten = cDaten & ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    iLevel = 6103
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Trennstrich drucken
    '***********************************************
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    cDaten = String$(iLenZeile, "_")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    '***********************************************
    'Zeile Leerzeile drucken
    '***********************************************
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    '***********************************************
    'Zeile 'Es bediente Sie' drucken
    '***********************************************
    
    ctmp = "erstellt von:"
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Bedienername drucken
    '***********************************************
    iLevel = 611
    
    ctmp = gcBediener
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile 'Kassennummer' drucken
    '***********************************************
    
    ctmp = "Kasse: " & gcKasNum
    cDaten = ctmp
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    
    iLevel = 612
    
    '***********************************************
    'Zeile Kundennummer drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Zeile Datum, BelegNr, Uhrzeit drucken
    '***********************************************
    
    iLevel = 615
    
    ctmp = Format$(Date, "DD.MM.YYYY")
    cDaten = ctmp
    ctmp = "0"
    gdBonNr = 0
    iLevel = 6151
    ctmp = gcKasNum & "/" & ctmp
    iLevel = 6152
    ctmp = Space$(8 - Len(ctmp)) & ctmp
    iLevel = 6153
    cDaten = cDaten & Space$(3) & ctmp
    iLevel = 6154
    ctmp = Format$(Now, "HH:MM")
    iLevel = 6155
    cDaten = cDaten & Space$(5) & ctmp
    iLevel = 6156
    KonvertAnsiAscii cDaten
    iLevel = 6157
    cEscapeSequenz = cDaten & vbCrLf
    iLevel = 6158
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    iLevel = 6159
    cDruckZeile(lAnzZeile) = cEscapeSequenz

    '***********************************************
    'Zeile Lieferschein bei Kreditverkäufen drucken
    '***********************************************
    
    iLevel = 7
    
    'entfällt bei RETOURE
    '***********************************************
    '1.Zeile Trennstrich drucken
    '***********************************************
    
    cDaten = String$(iLenZeile, gsSTERNZEICH)
'    cDaten = String$(iLenZeile, "*")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '***********************************************
    'Zeile Euro drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    '2.Zeile Trennstrich drucken
    '***********************************************
    'entfällt bei RETOURE
    '***********************************************
    'Fußzeile 1 drucken
    '***********************************************
    'Fußzeilen
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "KEIN GÜLTIGER KASSENBON!"
    Else
        cDaten = gcBonText(2)
    End If
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '***********************************************
    'Fußzeile 2 drucken
    '***********************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(3)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    '***********************************************
    'Fußzeile 3 drucken
    '***********************************************
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = ""
    Else
        cDaten = gcBonText(5)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
        
        iLevel = 10
    End If
    '***********************************************
    'ein paar Leerzeilen drucken
    '***********************************************
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = "." & vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
    
    iLevel = 12
    
    
BON_DRUCKEN:
    '**************************************
    '* Bon wird bei RETOURE immer gedruckt
    '**************************************
        If gbAPI = True Then
            OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
        Else
            OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        End If
    
    If iAktCopy = 1 Then
        'Bon-Daten sichern
        SichernBonDaten cDruckZeile(), lAnzZeile, "", "", False
    End If

BON_SCHNEIDEN:

    If gbBonDruck Then

        'Kassenbon abschneiden
        If gbAPI = True Then
            aDeviceName = Printer.DeviceName
            cEscapeSequenz = gcSchneiden
            OpenDrawer aDeviceName, cEscapeSequenz
        End If
        
    End If
    
    iLevel = 11
    
ZWEITER_BON:

    'entfällt bei RETOURE
    Erase cDruckZeile
    
GUTSCHEIN:
    'entfällt bei RETOURE
ENDE:

    Label8(0).Caption = ""
    Label8(1).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerAlrWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

'aufgeräumt
Private Sub SendeDaten2DruckerLastSchriftWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz        As Long
    Dim lAktSatz        As Long
    Dim lRet            As Long
    Dim lcount          As Long
    Dim lAnzZeile       As Long
    Dim lAnzLbSatz      As Long
    Dim lTask           As Long
    Dim cLBSatz         As String
    Dim cFeld           As String
    Dim cDaten          As String
    Dim ctmp            As String
    Dim cTmp2           As String
    Dim cMWST           As String
    Dim cText           As String
    Dim aDeviceName     As String
    Dim cEscapeSequenz  As String
    Dim cArtNr          As String
    
    Dim dGRabatt        As Double
    Dim dGRabattWert    As Double
    Dim dSumme          As Double
    Dim dWert           As Double
    Dim dEuro           As Double
    Dim dMWStVoll       As Double
    Dim dMWStErm        As Double
    Dim dAktZeit        As Double
    Dim dNeuZeit        As Double
    Dim iFileNr         As Integer
    Dim iLenZeile       As Integer
    Dim iLevel          As Integer
    Dim iAktCopy        As Integer
    ReDim cDruckZeile(1 To 1) As String
    
    iLevel = 0
    setzedrucker gcBonDrucker
    'Drucker an, Display aus, Init Drucker
    aDeviceName = Printer.DeviceName
    cEscapeSequenz = gcInit
    OpenDrawer aDeviceName, cEscapeSequenz
    DoEvents
    
StartPunkt:
    lAnzZeile = 0
    ReDim cDruckZeile(1 To 1) As String
    
    iAktCopy = iAktCopy + 1
    iLevel = 1
    cDaten = ""
    iLenZeile = 32
    
    '********************************************************
    '* Hier geht's los                                      *
    '********************************************************
    
    'Lastschrifttext an Drucker senden
    lAnzSatz = List11.ListCount
    
    iLevel = 2
    
    'Drucker wird auf BonDrucker geschaltet
    aDeviceName = gcBonDrucker
    
    iLevel = 3
    
    '***********************************************
    'Drucker ein- und Kundendisplay ausschalten
    '***********************************************
    
    cEscapeSequenz = gcInit
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    'Kopfdaten an Drucker senden
    
    If gcBild <> "" Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcBild
        OpenDrawer aDeviceName, cEscapeSequenz
    End If
    
    cEscapeSequenz = vbCrLf
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    '**********************************************************
    '* 1.Kopfzeile
    '**********************************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "K.I.S.S. Warenwirtschaft"
    Else
        cDaten = gcBonText(0)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '**********************************************************
    '* 2.Kopfzeile
    '**********************************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "Carsten Schröder"
    Else
        cDaten = gcBonText(1)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '**********************************************************
    '* 3.Kopfzeile
    '**********************************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO-VERSION!"
    Else
        cDaten = gcBonText(4)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    '***********************************************
    'Kopfdaten 4.Zeile an Drucker senden
    '***********************************************

    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION"
    Else
        cDaten = gcBonText(12)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    End If
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
    
    iLevel = 4
    
    
    
    dSumme = 0
    For lAktSatz = 0 To lAnzSatz - 1
    
        cLBSatz = List11.list(lAktSatz)
        
        cDaten = cLBSatz
        KonvertAnsiAscii cDaten
        cEscapeSequenz = cDaten & vbCrLf
        
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    Next lAktSatz
    
    iLevel = 5
    
    cDaten = String$(iLenZeile, "-")
    cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
    KonvertAnsiAscii cDaten
    cEscapeSequenz = cDaten & vbCrLf
    
    lAnzZeile = lAnzZeile + 1
    ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
    cDruckZeile(lAnzZeile) = cEscapeSequenz
        
    iLevel = 6
    
    iLevel = 7
    
    '******************************************************
    '* 1.Fußzeile
    '******************************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "KEIN GÜLTIGER KASSENBON!"
    Else
        cDaten = gcBonText(2)
    End If
    
    If Trim$(cDaten) <> "" Then
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '******************************************************
    '* 2.Fußzeile
    '******************************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = "DEMO - VERSION!"
    Else
        cDaten = gcBonText(3)
    End If
    
    If Trim$(cDaten) <> "" Then
    
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    '******************************************************
    '* 3.Fußzeile
    '******************************************************
    
    If gbDEMO Then
        'HIER FÜR DEMO FESTTEXT
        cDaten = ""
    Else
        cDaten = gcBonText(5)
    End If
    
    If Trim$(cDaten) <> "" Then
    
        cDaten = Trim$(cDaten)
        If cDaten <> "" Then
            cDaten = Space$((iLenZeile - Len(cDaten)) / 2) & cDaten
            KonvertAnsiAscii cDaten
            cEscapeSequenz = cDaten & vbCrLf
            lAnzZeile = lAnzZeile + 1
            ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
            cDruckZeile(lAnzZeile) = cEscapeSequenz
        End If
    End If
    
    iLevel = 10
    
    For lcount = 1 To 9
        If lcount = 9 Then
            cEscapeSequenz = "." & vbCrLf
        Else
            cEscapeSequenz = " " & vbCrLf
        End If
        lAnzZeile = lAnzZeile + 1
        ReDim Preserve cDruckZeile(1 To lAnzZeile) As String
        cDruckZeile(lAnzZeile) = cEscapeSequenz
    Next lcount
    
BON_DRUCKEN:
    
    If gbAPI = True Then
        OpenDrawer3 aDeviceName, cDruckZeile(), lAnzZeile
        DoEvents
    Else
        OpenDrawer4 aDeviceName, cDruckZeile(), lAnzZeile
        DoEvents
    End If
    
    'Bon-Daten sichern
    SichernBonDaten cDruckZeile(), lAnzZeile, "LS", "", False

    
BON_SCHNEIDEN:

    'Kassenbon abschneiden
    If gbAPI = True Then
        aDeviceName = Printer.DeviceName
        cEscapeSequenz = gcSchneiden
        OpenDrawer aDeviceName, cEscapeSequenz
    End If
    
    iLevel = 11
    
    'Druckbereich freigeben
    
    Erase cDruckZeile
    DoEvents
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SendeDaten2DruckerLastSchriftWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function fnLogonBedienerWKL20%()
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp        As String
    Dim cSQL        As String
    Dim rsrs        As Recordset
    Dim lKJADate    As Long
    Dim cKJAZeit    As String
    
    lKJADate = Fix(Now)
    cKJAZeit = Format$(Now, "HH:MM:SS")
    
    fnLogonBedienerWKL20% = 0
    
    ctmp = Text1(0).Text
    ctmp = Trim$(ctmp)
    
    If ctmp = "" Then
    
        anzeige "rot2", "Bitte Ihre Bediener-Nummer eingeben!", Label27
        Text1(0).SetFocus
        fnLogonBedienerWKL20% = 1
        Exit Function
    End If
    
    
    
    
    
    
    
    If gbIdentUser Then
        If inIdentUser(CInt(ctmp)) = False Then
            anzeige "rot2", "Erst Arbeitszeitbeginn speichern, dann Kassieren!", Label27
            Label1(8).Caption = ""
            Text1(0).Text = ""
            Text1(0).SetFocus
            fnLogonBedienerWKL20% = 1
            Exit Function
        End If
    End If
    'alt
'    cSQL = "Select * from BEDNAME where BEDNU = " & ctmp & " "

    cSQL = "Update BEDNAME set SYNStatus = '' where BEDNU = " & ctmp & " and  SYNStatus is null "
    gdBase.Execute cSQL, dbFailOnError

    'neu,nur mit berechtigung größer 0
    cSQL = "Select * from BEDNAME where BEDNU = " & ctmp & " and BEDIENER > 0 and SYNStatus <> 'D' "
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If rsrs.EOF Then
        anzeige "rot", "Die eingegebene Bediener-Nummer ist ungültig!", Label27
        Text1(0).Text = ""
        Text1(0).SetFocus
        fnLogonBedienerWKL20% = 1
    Else
        rsrs.MoveFirst
        If Not IsNull(rsrs!bedname) Then
            gcBediener = rsrs!bedname
        Else
            gcBediener = ""
        End If
        Label1(8).Caption = gcBediener
        gcBedienerNr = Text1(0).Text
        
        If Val(gcALTBedienerNr) <> Val(gcBedienerNr) Then
            insertKASSBEDP lKJADate, cKJAZeit, gcKasNum, CInt(gcBedienerNr)
        End If
        
        gcALTBedienerNr = Text1(0).Text
        fnLogonBedienerWKL20% = 0
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    
    
    
    
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnLogonBedienerWKL20%"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub SucheArtikelKasseWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lLinr       As Long
    Dim lLinie      As Long
    Dim lcount      As Long
    Dim cRabattier  As String
    Dim ctmp        As String
    Dim cArtNrExakt As String
    Dim cMWST       As String
    Dim cSQL        As String
    Dim cArtBez     As String
    Dim cArtNr      As String
    Dim cLiBesNr    As String
    Dim cEAN        As String
    Dim cFeld       As String
    Dim cLBSatz     As String
    Dim cVKPR       As String
    Dim cBestand    As String
    Dim cRabatt     As String
    Dim cPGN        As String
    Dim cAWM        As String
    Dim cLinr       As String
    Dim cLinie      As String
    Dim cMerk       As String
    Dim cGroesse    As String
    
    Dim dRabatt     As Double
    Dim dVkPr       As Double
    Dim dKVkPr1     As Double
    Dim dFaktorV    As Double
    Dim dFaktorE    As Double
    Dim bAnd        As Boolean
    Dim rsrs        As Recordset
    Dim rsrs1       As Recordset
    Dim rsRs2       As Recordset
    
    Dim iStufe As Integer
    
    dFaktorV = 1 + (gdMWStV / 100)
    dFaktorE = 1 + (gdMWStE / 100)
    iStufe = 1
    dRabatt = 1
    If Label2(3).Visible Then
        cRabatt = Label2(3).Caption
        cRabatt = fnMoveComma2Point$(cRabatt)
        dRabatt = Val(cRabatt)
        dRabatt = dRabatt / 100
        dRabatt = 1 - dRabatt
    End If
    iStufe = 2
    If Label2(1).Visible Then
        cRabatt = Label2(1).Caption
        cRabatt = fnMoveComma2Point$(cRabatt)
        dRabatt = Val(cRabatt)
        dRabatt = dRabatt / 100
        dRabatt = 1 - dRabatt
    End If
    iStufe = 3
    bAnd = False
    
    cLinie = Val(Text3(77).Text)
    
    cArtNr = Val(Text3(19).Text)
    
    cArtBez = Text3(0).Text
    cArtBez = UCase$(cArtBez)

    cArtBez = LTrim(cArtBez)
    
    cArtBez = SwapStr(cArtBez, "     ", "*")
    cArtBez = SwapStr(cArtBez, "    ", "*")
    cArtBez = SwapStr(cArtBez, "   ", "*")
    cArtBez = SwapStr(cArtBez, "  ", "*")
    cArtBez = SwapStr(cArtBez, " ", "*")
    
    cArtBez = SwapStr(cArtBez, "???", "*[???]*")
    
    cLiBesNr = Text3(1).Text
    cLiBesNr = Trim$(cLiBesNr)
    cLiBesNr = UCase$(cLiBesNr)
    Text3(1).Text = cLiBesNr
    iStufe = 4
    cEAN = Text3(2).Text
    cEAN = Trim$(cEAN)
    cEAN = UCase$(cEAN)
    cEAN = SwapStr(cEAN, ",", "")
    cEAN = SwapStr(cEAN, ".", "")
    
    If cEAN <> "" Then
        If IsNumeric(cEAN) Then
            Text3(2).Text = cEAN
        Else
            Text3(2).Text = cEAN
            Text3(2).SetFocus
            Exit Sub
        End If
    End If
    
    cPGN = Text3(4).Text
    cPGN = Trim$(cPGN)

    cLinr = Text3(5).Text
    cLinr = Left(Trim(cLinr), 6)
    If IsNumeric(Left(cLinr, 6)) Then
    
    Else
        cLinr = ""
    End If
    
    iStufe = 5
    cAWM = Label1(9).Tag
    cAWM = Trim$(cAWM)
    
    cGroesse = Text3(70).Text
    
    cGroesse = SwapStr(cGroesse, "     ", "*")
    cGroesse = SwapStr(cGroesse, "    ", "*")
    cGroesse = SwapStr(cGroesse, "   ", "*")
    cGroesse = SwapStr(cGroesse, "  ", "*")
    cGroesse = SwapStr(cGroesse, " ", "*")
    
    
    loeschNEW srechnertab & "ASEEK", gdBase
    CreateTable srechnertab & "ASEEK", gdBase
    
    cSQL = "Insert into " & srechnertab & "ASEEK Select "
    cSQL = cSQL & "  distinct A.ARTNR  "
    cSQL = cSQL & ", A.BEZEICH  "
    cSQL = cSQL & ", B.LEKPR  "
    cSQL = cSQL & ", A.EKPR  "
    cSQL = cSQL & ", A.KVKPR1  "
    cSQL = cSQL & ", A.VKPR  "
    cSQL = cSQL & ", B.RKZ  "
    cSQL = cSQL & ", A.BESTAND  "
    cSQL = cSQL & ", A.MWST "
    cSQL = cSQL & ", 1 as SEEKMOD  "
    cSQL = cSQL & ", A.AWM "
    cSQL = cSQL & ", B.LINR "
    cSQL = cSQL & ", A.LPZ "
    cSQL = cSQL & ", A.Rabatt_ok "
    cSQL = cSQL & ", A.Groesse"
    cSQL = cSQL & " from ARTIKEL A , ARTLIEF B  where "
    cSQL = cSQL & " A.Artnr = B.Artnr  "
   
    

    bAnd = True
    iStufe = 6
    
    If cArtBez <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        cSQL = cSQL & " a.BEZEICH like '" & cArtBez & "*' "
        bAnd = True
    End If
    
    If cArtNr <> "0" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        cSQL = cSQL & " a.artnr = " & cArtNr & " "
        bAnd = True
    End If
    
    If cGroesse <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        cSQL = cSQL & " a.Groesse like '" & cGroesse & "*' "
        bAnd = True
    End If
    iStufe = 7
    
    If Check9.value = vbUnchecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.AWM <> '92' "
        bAnd = True
    Else
    
    End If
    
    If Check18.value = vbChecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.bestand > 0 "
        bAnd = True
    End If
    
    If cLinie <> "0" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.LPZ = " & cLinie
        bAnd = True
    End If
    
    If Check14.value = vbChecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " b.RKZ = 'N'   "
        bAnd = True
    Else
    
    End If
    
    If Check16.value = vbChecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.gefuehrt = 'J'   "
        bAnd = True
    Else
    
    End If
    
    
    If cLiBesNr <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " b.LIBESNR like '" & cLiBesNr & "' "
        bAnd = True
    End If
    iStufe = 8
    If cPGN <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.PGN = " & cPGN
        bAnd = True
    End If
    
    If cLinr <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " b.LINR = " & cLinr
        bAnd = True
    End If
    
    
     
    'Marke
    cFeld = Text3(6).Text
    cFeld = Trim$(cFeld)
    If cFeld <> "" Then
        If LoeseMarkenInArtnr1(cFeld) Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            cSQL = cSQL & " a.artnr in (Select artnr from MA" & srechnertab & ") "
            bAnd = True
        Else
            anzeige "rot", "Keine Artikel!", Label9
            Exit Sub
        End If
    End If
    
    iStufe = 9
    If cAWM <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.AWM = '" & cAWM & "' "
        bAnd = True
    End If
    
    iStufe = 10
    
    If cEAN <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        If Len(cEAN) > 6 Or (Len(cEAN) = 6 And Left(cEAN, 1) = "9") Then
        
            If Len(cEAN) = 8 Then
                If Left(cEAN, 1) = "2" Then
                
                    cSQL = cSQL & "((a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) or  "
                    
                    
                    cEAN = Mid(cEAN, 2, 6)
                    cSQL = cSQL & " a.ARTNR = " & cEAN & ") "
                    
                                     
                                     
                                     
'                    If Check16.Value = vbChecked Then
'                        cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "
'
'                    Else
'                        cEAN = Mid(cEAN, 2, 6)
'                        cSQL = cSQL & " a.ARTNR = " & cEAN & " "
'                    End If
                    

                    
                    bAnd = True
                    
                    
                    
'geändert am 18.04.2017 wegen EAN 09419113 -> kommt zu keinem Ergebnis aber das "and" steht bereits -> Folge: and and!
'Anfang
'                 ElseIf Left(cEAN, 1) = "0" Then
'
'                    cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "
'
'                    bAnd = True
'Ende
                    
                 Else
                 
                    If Ist_in_ARTEAN_K(cEAN) Then
                
                    End If
                    
                    cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "
                    
                    bAnd = True
                End If
            Else
                If Ist_in_ARTEAN_K(cEAN) Then
                
                End If
                    
                cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "

                
                bAnd = True
            
            End If
        Else
        '1.wunsch
            If IsNumeric(cEAN) Then
                cSQL = cSQL & " a.ARTNR = " & cEAN
                bAnd = True
            Else
                cSQL = cSQL & " a.ARTNR = -1 "
                bAnd = True
            End If
        End If
    End If
    
    If bAnd Then
        cSQL = cSQL & " and "
    End If
    cSQL = cSQL & " ( A.SYNSTATUS is null or A.SYNSTATUS = 'E' or A.SYNSTATUS = 'A' ) "
    
    
    
    iStufe = 11

    
    List4.Nodes.Clear
    Screen.MousePointer = 11
    anzeige "ROT2", "Artikel werden gesucht...", Label9
    gdBase.Execute cSQL, dbFailOnError
    
    DuplikateDelTabelle srechnertab & "ASEEK", gdBase, ""
    
    'such mal alle ArtliefArtikel, die kein RKZ haben
    'das Ganze machst du nur, wenn keine Lieferant gewählt wurde
    
    If Trim(Text3(5).Text) = "" Then
    
        cSQL = "Update " & srechnertab & "ASEEK inner join artlief on "
        cSQL = cSQL & " " & srechnertab & "ASEEK.artnr = artlief.artnr "
        cSQL = cSQL & " set " & srechnertab & "ASEEK.linr = artlief.linr "
        cSQL = cSQL & " where artlief.RKZ = 'N' "
        gdBase.Execute cSQL, dbFailOnError
        
    End If
    
    cSQL = "Update " & srechnertab & "ASEEK inner join artlief on "
    cSQL = cSQL & " " & srechnertab & "ASEEK.artnr = artlief.artnr "
    cSQL = cSQL & " and " & srechnertab & "ASEEK.linr = artlief.linr "
    cSQL = cSQL & " set " & srechnertab & "ASEEK.LEKPR = artlief.LEKPR "
    cSQL = cSQL & " , " & srechnertab & "ASEEK.RKZ = artlief.RKZ "
    gdBase.Execute cSQL, dbFailOnError
 
    cSQL = "Select * from " & srechnertab & "ASEEK"
    
    If Option2(0).value = True Then
        cSQL = cSQL & " order by BEZEICH "
    Else
        cSQL = cSQL & " order by LINR, LPZ, BEZEICH "
    End If
    
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    
'    'Verwandte
    If Option2(3).value = True Then
        If Not rsrs.EOF Then
            If cEAN <> "" Then
                rsrs.MoveFirst
                iStufe = 13
                If Not IsNull(rsrs!linr) Then
                    lLinr = rsrs!linr
                Else
                    lLinr = 0
                End If
    
                iStufe = 14
                If Not IsNull(rsrs!artnr) Then
                    cArtNrExakt = rsrs!artnr
                Else
                    cArtNrExakt = ""
                End If
    
                iStufe = 15
                If Not IsNull(rsrs!LPZ) Then
                    lLinie = rsrs!LPZ
                Else
                    Dim sSQL3 As String
                    sSQL3 = "Update Artikel set LPZ = 0 where artnr = " & cArtNrExakt
                    gdBase.Execute sSQL3, dbFailOnError
    
                    lLinie = 0
                End If
    
                cArtNrExakt = Space$(6 - Len(cArtNrExakt)) & cArtNrExakt
                rsrs.Close: Set rsrs = Nothing
    
                loeschNEW srechnertab & "ASEEK", gdBase
                CreateTable srechnertab & "ASEEK", gdBase
    
                cSQL = "Insert into " & srechnertab & "ASEEK Select "
                
                cSQL = cSQL & " A.ARTNR "
                cSQL = cSQL & ", A.BEZEICH  "
                cSQL = cSQL & ", B.LEKPR  "
                cSQL = cSQL & ", A.EKPR  "
                cSQL = cSQL & ", A.KVKPR1  "
                cSQL = cSQL & ", A.VKPR  "
                cSQL = cSQL & ", B.RKZ  "
                cSQL = cSQL & ", A.BESTAND  "
                cSQL = cSQL & ", A.MWST "
                cSQL = cSQL & ", 1 as SEEKMOD  "
                cSQL = cSQL & ", A.AWM "
                cSQL = cSQL & ", B.LINR "
                cSQL = cSQL & ", A.LPZ "
                cSQL = cSQL & ", A.Rabatt_ok "
                cSQL = cSQL & ", A.Groesse "
                cSQL = cSQL & " from ARTIKEL A , ARTLIEF B where "
                cSQL = cSQL & " A.Artnr = B.Artnr  "
                
              
                cSQL = cSQL & "  and B.LINR = " & Trim$(Str$(lLinr)) & " and A.LPZ = " & Trim$(Str$(lLinie))
                If Check9.value = vbUnchecked Then
                    cSQL = cSQL & " and A.AWM <> '92' "
                End If
                
                If Check18.value = vbChecked Then
                    cSQL = cSQL & " and a.bestand > 0 "
                End If
                
                If Check16.value = vbChecked Then
                    cSQL = cSQL & " and a.gefuehrt = 'J' "
                End If
    
                If Check14.value = vbChecked Then
                    cSQL = cSQL & " and B.RKZ = 'N' "
                End If
    
                cSQL = cSQL & " order by B.LINR, A.LPZ, A.BEZEICH "
                gdBase.Execute cSQL, dbFailOnError
                
                
                'such mal alle ArtliefArtikel, die kein RKZ haben
                'das Ganze machst du nur, wenn keine Lieferant gewählt wurde
                
                If Trim(Text3(5).Text) = "" Then
                
                    cSQL = "Update " & srechnertab & "ASEEK inner join artlief on "
                    cSQL = cSQL & " " & srechnertab & "ASEEK.artnr = artlief.artnr "
                    cSQL = cSQL & " set " & srechnertab & "ASEEK.linr = artlief.linr "
                    cSQL = cSQL & " where artlief.RKZ = 'N' "
                    gdBase.Execute cSQL, dbFailOnError
                    
                End If
                
                cSQL = "Update " & srechnertab & "ASEEK inner join artlief on "
                cSQL = cSQL & " " & srechnertab & "ASEEK.artnr = artlief.artnr "
                cSQL = cSQL & " and " & srechnertab & "ASEEK.linr = artlief.linr "
                cSQL = cSQL & " set " & srechnertab & "ASEEK.LEKPR = artlief.LEKPR "
                cSQL = cSQL & " , " & srechnertab & "ASEEK.RKZ = artlief.RKZ "
                gdBase.Execute cSQL, dbFailOnError
                
                'Ende neu
                
                
                
                
                
    
                cSQL = "Select * from " & srechnertab & "ASEEK"
                If Option2(0).value = True Then
                    cSQL = cSQL & " order by BEZEICH "
                Else
                    cSQL = cSQL & " order by LINR, LPZ, BEZEICH "
                End If
                FnOpenrecordset rsrs, cSQL, 1, gdBase
    
                iStufe = 16
            End If
        End If
    
    ElseIf Option2(2).value = True Then
        'Verwandte mal anders
        
        If Not rsrs.EOF Then
            If cEAN <> "" Then
                rsrs.MoveFirst
                
                If Not IsNull(rsrs!artnr) Then
                    cArtNrExakt = rsrs!artnr
                Else
                    cArtNrExakt = ""
                End If
                
                cArtNrExakt = Space$(6 - Len(cArtNrExakt)) & cArtNrExakt
                rsrs.Close: Set rsrs = Nothing
                
                loeschNEW srechnertab & "ASEEK", gdBase
                CreateTable srechnertab & "ASEEK", gdBase
                
                cSQL = "Insert into " & srechnertab & "ASEEK Select "
                cSQL = cSQL & " A.ARTNR  "
                cSQL = cSQL & ", A.BEZEICH  "
                cSQL = cSQL & ", B.LEKPR  "
                cSQL = cSQL & ", A.EKPR  "
                cSQL = cSQL & ", A.KVKPR1  "
                cSQL = cSQL & ", A.VKPR  "
                cSQL = cSQL & ", B.RKZ  "
                cSQL = cSQL & ", A.BESTAND  "
                cSQL = cSQL & ", A.MWST "
                cSQL = cSQL & ", 1 as SEEKMOD  "
                cSQL = cSQL & ", A.AWM "
                cSQL = cSQL & ", B.LINR "
                cSQL = cSQL & ", A.LPZ "
                cSQL = cSQL & ", A.Rabatt_ok "
                cSQL = cSQL & ", A.Groesse "

                
                
                
                cSQL = cSQL & " from ARTIKEL A , ARTLIEF B where "
                cSQL = cSQL & " A.Artnr = B.Artnr  "
                
                
                cSQL = cSQL & " and ((A.ean like '" & Left(cEAN, 7) & "*' or A.ean2 like '" & Left(cEAN, 7) & "*' or A.ean3 like '" & Left(cEAN, 7) & "*') "
                cSQL = cSQL & " or a.artnr in (Select artnr from artean_K where EAN like '" & Left(cEAN, 7) & "*')) "
               
                
                If Check9.value = vbUnchecked Then
                    cSQL = cSQL & " and A.AWM <> '92' "
                End If
                
                 If Check18.value = vbChecked Then
                    cSQL = cSQL & " and a.bestand > 0 "
                End If
                
                
                If Check16.value = vbChecked Then
                    cSQL = cSQL & " and a.gefuehrt = 'J' "
                End If
                
                If Check14.value = vbChecked Then
                    cSQL = cSQL & " and B.RKZ = 'N' "
                End If
                
                gdBase.Execute cSQL, dbFailOnError
                
                cSQL = "Select * from " & srechnertab & "ASEEK"
                If Option2(0).value = True Then
                    cSQL = cSQL & " order by BEZEICH "
                Else
                    cSQL = cSQL & " order by LINR, LPZ, BEZEICH "
                End If
                FnOpenrecordset rsrs, cSQL, 1, gdBase
                
                iStufe = 16
            End If
        End If
    ElseIf Option2(4).value = True Then
        'Verwandte mal anders
        
        If Not rsrs.EOF Then
            If cEAN <> "" Then
                rsrs.MoveFirst
                
                If Not IsNull(rsrs!artnr) Then
                    cArtNrExakt = rsrs!artnr
                Else
                    cArtNrExakt = ""
                End If
                
                cArtNrExakt = Space$(6 - Len(cArtNrExakt)) & cArtNrExakt
                rsrs.Close: Set rsrs = Nothing
                

                
                cSQL = "Select * from " & srechnertab & "ASEEK"
                If Option2(0).value = True Then
                    cSQL = cSQL & " order by BEZEICH "
                Else
                    cSQL = cSQL & " order by LINR, LPZ, BEZEICH "
                End If
                FnOpenrecordset rsrs, cSQL, 1, gdBase
                
                iStufe = 16
            End If
        End If
    End If
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            iStufe = 17
            If Not IsNull(rsrs!MWST) Then
                cMWST = rsrs!MWST
            Else
                cMWST = "V"
            End If
            iStufe = 18
            If Not IsNull(rsrs!artnr) Then
                cFeld = rsrs!artnr
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cFeld = Space$(6 - Len(cFeld)) & cFeld
            cLBSatz = cFeld & " "
            iStufe = 19
            If Not IsNull(rsrs!BEZEICH) Then
                cFeld = rsrs!BEZEICH
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cFeld = cFeld & Space$(35 - Len(cFeld))
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 20
            If Not IsNull(rsrs!vkpr) Then
                dVkPr = rsrs!vkpr
            Else
                dVkPr = 0
            End If
            cFeld = Format$(dVkPr, "###,##0.00")
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 9 Then
                cFeld = Space$(9)
            Else
                cFeld = Space$(9 - Len(cFeld)) & cFeld
            End If
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 21
            Select Case Val(Label8(3).Caption)
                Case Is = 0
                    If Not IsNull(rsrs!KVKPR1) Then
                        dKVkPr1 = rsrs!KVKPR1
                    Else
                        dKVkPr1 = 0
                    End If
                Case Is = 1
                    If Not IsNull(rsrs!vkpr) Then
                        dKVkPr1 = rsrs!vkpr
                    Else
                        dKVkPr1 = 0
                    End If
                Case Is = 2
                
                    dKVkPr1 = ermMaxLEKPR(rsrs!artnr)
                        
                    If dKVkPr1 = 0 Then
                        If Not IsNull(rsrs!lekpr) Then
                            dKVkPr1 = rsrs!lekpr
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * dFaktorV
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * dFaktorE
                    End If
                    
                Case Is = 3
                    If Not IsNull(rsrs!ekpr) Then
                        dKVkPr1 = rsrs!ekpr
                    Else
                        dKVkPr1 = 0
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * dFaktorV
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * dFaktorE
                    End If
                Case Is = 4 'Spez kvk
                    dKVkPr1 = LeseSpezpreis(CLng(rsrs!artnr), 0)
                    If dKVkPr1 = 0 Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dKVkPr1 = rsrs!KVKPR1
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                Case Is = 5 'lvk m A
                    If rsrs!RABATT_OK = "N" Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dKVkPr1 = rsrs!KVKPR1
                        Else
                            dKVkPr1 = 0
                        End If
                    Else
                        If Not IsNull(rsrs!vkpr) Then
                            dKVkPr1 = rsrs!vkpr
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                Case Is = 6 'Netto-KVK
                    If Not IsNull(rsrs!KVKPR1) Then
                        dKVkPr1 = rsrs!KVKPR1
                    Else
                        dKVkPr1 = 0
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * 100 / (100 + gdMWStV)
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * 100 / (100 + gdMWStE)
                    End If
            End Select
            iStufe = 22
            dKVkPr1 = dKVkPr1 * dRabatt
            cFeld = Format$(dKVkPr1, "###,##0.00")
            
            cFeld = Trim$(cFeld)
            cFeld = Space$(9 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld & " "
            
            iStufe = 23
            If Not IsNull(rsrs!BESTAND) Then
                dVkPr = rsrs!BESTAND
            Else
                dVkPr = 0
            End If
            cFeld = Format$(dVkPr, "#,##0")
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 5 Then cFeld = 0
            cFeld = Space$(5 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 24
            If Not IsNull(rsrs!RKZ) Then
                cFeld = rsrs!RKZ
            Else
                cFeld = "N"
            End If
            cFeld = Trim$(cFeld)
            cLBSatz = cLBSatz & cFeld & Space$(1)
            
            If Not IsNull(rsrs!AWM) Then
                cFeld = rsrs!AWM
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cLBSatz = cLBSatz & cFeld & Space(2 - Len(cFeld))
            
            cMerk = Left(ZeigeArtmerk(Trim(Left(cLBSatz, 6))), 1)
            cLBSatz = cLBSatz & Space(1 - Len(cMerk)) & cMerk
            
            iStufe = 25
            List4.Nodes.Add Text:=cLBSatz
            
            rsrs.MoveNext
        Loop
        
    End If
    rsrs.Close: Set rsrs = Nothing
    
    iStufe = 26
    
    Screen.MousePointer = 11
    
    If gbArtsucheArtFarb = True Then
        farbelist4 Me
    End If
    
'    Timer3.Enabled = False
'    glTimer3Count = 0
    
    Dim cartT As String
    iStufe = 27
    If List4.Nodes.Count > 0 Then
        For lcount = 1 To List4.Nodes.Count
            ctmp = List4.Nodes(lcount)
            cartT = Trim$(Left(ctmp, 6))
            If cartT = Trim$(cArtNrExakt) Then
                List4.Nodes(lcount).Selected = True
                
                List4_NodeClick List4.Nodes(lcount)
                
                
                List4.Nodes(lcount).EnsureVisible
                Bildzeigen cartT, Image1, Picture3, 80
                Exit For
            End If
        Next lcount
        anzeige "normal", List4.Nodes.Count & " Artikel", Label9
    Else
        If cArtBez <> "" Then
            Command4(15).Visible = True
            Command4_Click 15
            Exit Sub
        Else
            anzeige "rot", "Keine Artikel!", Label9
        End If

    End If
    iStufe = 28
    Frame9.Visible = False
    List2.Visible = True
    List4.Visible = True
    
    Command4(10).Visible = True
    Command4(9).Visible = True
    Command4(1).Visible = True
    Command8(118).Visible = True
    Command8(119).Visible = True
    cmdFoto.Visible = True
    List4.SetFocus
    
    
    'noch weitere Ergebnisse
    If cArtBez <> "" Then
        Command4(15).Visible = True
        
    End If
    
    Screen.MousePointer = 0
    
    
Exit Sub
LOKAL_ERROR:
    If iStufe = 12 Then
        Fehler.gsDescr = err.Description & " " & cSQL
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SucheArtikelKasseWKL20"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
         
        Fehlermeldung1
    

    Else
    
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SucheArtikelKasseWKL20"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
         
        Fehlermeldung1
    
'        Resume Next
    End If
    
    
End Sub

Private Sub ermweitereArtikel()
    On Error GoTo LOKAL_ERROR
    
    Dim lLinr       As Long
    Dim lLinie      As Long
    Dim lcount      As Long
    Dim cRabattier  As String
    Dim ctmp        As String
    Dim cArtNrExakt As String
    Dim cMWST       As String
    Dim cSQL        As String
    Dim cArtBez     As String
    Dim cLiBesNr    As String
    Dim cEAN        As String
    Dim cFeld       As String
    Dim cLBSatz     As String
    Dim cVKPR       As String
    Dim cBestand    As String
    Dim cRabatt     As String
    Dim cPGN        As String
    Dim cAWM        As String
    Dim cLinr       As String
    
    Dim dRabatt     As Double
    Dim dVkPr       As Double
    Dim dKVkPr1     As Double
    Dim dFaktorV    As Double
    Dim dFaktorE    As Double
    Dim bAnd        As Boolean
    Dim rsrs        As Recordset
    Dim rsrs1       As Recordset
    Dim rsRs2       As Recordset
    Dim cMerk       As String
    
    Dim iStufe As Integer
    
    dFaktorV = 1 + (gdMWStV / 100)
    dFaktorE = 1 + (gdMWStE / 100)
    iStufe = 1
    dRabatt = 1
    If Label2(3).Visible Then
        cRabatt = Label2(3).Caption
        cRabatt = fnMoveComma2Point$(cRabatt)
        dRabatt = Val(cRabatt)
        dRabatt = dRabatt / 100
        dRabatt = 1 - dRabatt
    End If
    iStufe = 2
    If Label2(1).Visible Then
        cRabatt = Label2(1).Caption
        cRabatt = fnMoveComma2Point$(cRabatt)
        dRabatt = Val(cRabatt)
        dRabatt = dRabatt / 100
        dRabatt = 1 - dRabatt
    End If
    iStufe = 3
    bAnd = False
    
    cArtBez = Text3(0).Text
    cArtBez = UCase$(cArtBez)
'    Text3(0).Text = cArtBez

    cArtBez = LTrim(cArtBez)
    
    cArtBez = SwapStr(cArtBez, "     ", "*")
    cArtBez = SwapStr(cArtBez, "    ", "*")
    cArtBez = SwapStr(cArtBez, "   ", "*")
    cArtBez = SwapStr(cArtBez, "  ", "*")
    cArtBez = SwapStr(cArtBez, " ", "*")
    
    cLiBesNr = Text3(1).Text
    cLiBesNr = Trim$(cLiBesNr)
    cLiBesNr = UCase$(cLiBesNr)
    Text3(1).Text = cLiBesNr
    iStufe = 4
    cEAN = Text3(2).Text
    cEAN = Trim$(cEAN)
    cEAN = UCase$(cEAN)
    cEAN = SwapStr(cEAN, ",", "")
    cEAN = SwapStr(cEAN, ".", "")
    
    If cEAN <> "" Then
        If IsNumeric(cEAN) Then
            Text3(2).Text = cEAN
        Else
            Text3(2).Text = cEAN
            Text3(2).SetFocus
            Exit Sub
        End If
    End If
    
    cPGN = Text3(4).Text
    cPGN = Trim$(cPGN)

    cLinr = Text3(5).Text
    cLinr = Left(Trim(cLinr), 6)
    If IsNumeric(Left(cLinr, 6)) Then
    
    Else
        cLinr = ""
    End If
    
    iStufe = 5
    cAWM = Label1(9).Tag
    cAWM = Trim$(cAWM)
    
    cSQL = "Insert into " & srechnertab & "ASEEK Select "
    cSQL = cSQL & " ARTNR  "
    cSQL = cSQL & ", BEZEICH  "
    cSQL = cSQL & ", LEKPR  "
    cSQL = cSQL & ", EKPR  "
    cSQL = cSQL & ", KVKPR1  "
    cSQL = cSQL & ", VKPR  "
    cSQL = cSQL & ", RKZ  "
    cSQL = cSQL & ", BESTAND  "
    cSQL = cSQL & ", MWST "
    cSQL = cSQL & ", 2 as SEEKMOD  "
    cSQL = cSQL & ", AWM "
    cSQL = cSQL & ", LINR "
    cSQL = cSQL & ", LPZ "
    cSQL = cSQL & ", Groesse "
    cSQL = cSQL & " from ARTIKEL A  where "
    cSQL = cSQL & " Artnr not in (select Artnr from " & srechnertab & "ASEEK) "
    cSQL = cSQL & " and "
    
    iStufe = 6
    
    If cArtBez <> "" Then
        cSQL = cSQL & " a.BEZEICH like '*" & cArtBez & "*' "
        bAnd = True
    End If
    iStufe = 7
    
    If Check9.value = vbUnchecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.AWM <> '92' "
        bAnd = True
    Else
    
    End If
    
    If Check18.value = vbChecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.bestand > 0 "
        bAnd = True
    End If
    
    If Check16.value = vbChecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.gefuehrt = 'J' "
        bAnd = True
    Else
    
    End If
    
    
    
    If Check14.value = vbChecked Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.RKZ = 'N' "
        bAnd = True
    Else
    
    End If
    
    
    If cLiBesNr <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.LIBESNR like '" & cLiBesNr & "' "
        bAnd = True
    End If
    iStufe = 8
    If cPGN <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.PGN = " & cPGN
        bAnd = True
    End If
    
    If cLinr <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.LINR = " & cLinr
        bAnd = True
    End If
     
    'Marke
    cFeld = Text3(6).Text
    cFeld = Trim$(cFeld)
    If cFeld <> "" Then
        If LoeseMarkenInArtnr1(cFeld) Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            cSQL = cSQL & " a.artnr in (Select artnr from MA" & srechnertab & ") "
            bAnd = True
        Else
            anzeige "rot", "Keine Artikel!", Label9
            Exit Sub
        End If
    End If
    
    iStufe = 9
    If cAWM <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        
        cSQL = cSQL & " a.AWM = '" & cAWM & "' "
        bAnd = True
    End If
    
    iStufe = 10
    
    If cEAN <> "" Then
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        If Len(cEAN) > 6 Or (Len(cEAN) = 6 And Left(cEAN, 1) = "9") Then
        
            If Len(cEAN) = 8 Then
                If Left(cEAN, 1) = "2" Then
                    cEAN = Mid$(cEAN, 2, 6)
                    cSQL = cSQL & " a.ARTNR = " & cEAN
                    bAnd = True
                 Else
                    cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "
                    bAnd = True
                End If
            Else
                cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "
                bAnd = True
            
            End If
        Else
        '1.wunsch
            If IsNumeric(cEAN) Then
                cSQL = cSQL & " a.ARTNR = " & cEAN
                bAnd = True
            Else
                cSQL = cSQL & " a.ARTNR = -1 "
                bAnd = True
            End If
        End If
    End If
    
    If bAnd Then
        cSQL = cSQL & " and "
    End If
    cSQL = cSQL & "  ( A.SYNSTATUS is null or A.SYNSTATUS = 'E' or A.SYNSTATUS = 'A' ) "
    
    iStufe = 11
'    hier sortierung
    If Option2(0).value = True Then
        cSQL = cSQL & " order by a.BEZEICH "
    Else
        cSQL = cSQL & " order by a.LINR, a.LPZ, a.BEZEICH "
    End If
    iStufe = 12
    
    
    Screen.MousePointer = 11
    anzeige "ROT2", "Artikel werden gesucht(2)...", Label9
    
    gdBase.Execute cSQL, dbFailOnError
 
    cSQL = "Select * from " & srechnertab & "ASEEK where seekmod = 2 "
    If Option2(0).value = True Then
        cSQL = cSQL & " order by BEZEICH "
    Else
        cSQL = cSQL & " order by LINR, LPZ, BEZEICH "
    End If
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            iStufe = 17
            If Not IsNull(rsrs!MWST) Then
                cMWST = rsrs!MWST
            Else
                cMWST = "V"
            End If
            iStufe = 18
            If Not IsNull(rsrs!artnr) Then
                cFeld = rsrs!artnr
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cFeld = Space$(6 - Len(cFeld)) & cFeld
            cLBSatz = cFeld & " "
            iStufe = 19
            If Not IsNull(rsrs!BEZEICH) Then
                cFeld = rsrs!BEZEICH
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cFeld = cFeld & Space$(35 - Len(cFeld))
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 20
            If Not IsNull(rsrs!vkpr) Then
                dVkPr = rsrs!vkpr
            Else
                dVkPr = 0
            End If
            cFeld = Format$(dVkPr, "###,##0.00")
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 9 Then
                cFeld = Space$(9)
            Else
                cFeld = Space$(9 - Len(cFeld)) & cFeld
            End If
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 21
            Select Case Val(Label8(3).Caption)
                Case Is = 0
                    If Not IsNull(rsrs!KVKPR1) Then
                        dKVkPr1 = rsrs!KVKPR1
                    Else
                        dKVkPr1 = 0
                    End If
                Case Is = 1
                    If Not IsNull(rsrs!vkpr) Then
                        dKVkPr1 = rsrs!vkpr
                    Else
                        dKVkPr1 = 0
                    End If
                Case Is = 2
                    dKVkPr1 = ermMaxLEKPR(rsrs!artnr)
                        
                    If dKVkPr1 = 0 Then
                        If Not IsNull(rsrs!lekpr) Then
                            dKVkPr1 = rsrs!lekpr
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * dFaktorV
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * dFaktorE
                    End If
                    
                Case Is = 3
                    If Not IsNull(rsrs!ekpr) Then
                        dKVkPr1 = rsrs!ekpr
                    Else
                        dKVkPr1 = 0
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * dFaktorV
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * dFaktorE
                    End If
                Case Is = 4 'Spez kvk
                    dKVkPr1 = LeseSpezpreis(CLng(rsrs!artnr), 0)
                    If dKVkPr1 = 0 Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dKVkPr1 = rsrs!KVKPR1
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                Case Is = 5 'lvk m A
                    If rsrs!RABATT_OK = "N" Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dKVkPr1 = rsrs!KVKPR1
                        Else
                            dKVkPr1 = 0
                        End If
                    Else
                        If Not IsNull(rsrs!vkpr) Then
                            dKVkPr1 = rsrs!vkpr
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                    
                Case Is = 6
                    If Not IsNull(rsrs!KVKPR1) Then
                        dKVkPr1 = rsrs!KVKPR1
                    Else
                        dKVkPr1 = 0
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * 100 / (100 + gdMWStV)
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * 100 / (100 + gdMWStE)
                    End If
                
            End Select
            iStufe = 22
            dKVkPr1 = dKVkPr1 * dRabatt
            cFeld = Format$(dKVkPr1, "###,##0.00")
            
            cFeld = Trim$(cFeld)
            cFeld = Space$(9 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 23
            If Not IsNull(rsrs!BESTAND) Then
                dVkPr = rsrs!BESTAND
            Else
                dVkPr = 0
            End If
            cFeld = Format$(dVkPr, "#,##0")
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 5 Then cFeld = 0
            cFeld = Space$(5 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 24
            If Not IsNull(rsrs!RKZ) Then
                cFeld = rsrs!RKZ
            Else
                cFeld = "N"
            End If
            cFeld = Trim$(cFeld)
            cLBSatz = cLBSatz & cFeld & Space$(1)
            
            If Not IsNull(rsrs!AWM) Then
                cFeld = rsrs!AWM
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cLBSatz = cLBSatz & cFeld & Space(2 - Len(cFeld))
            
            
            cMerk = Left(ZeigeArtmerk(Trim(Left(cLBSatz, 6))), 1)
            cLBSatz = cLBSatz & Space(1 - Len(cMerk)) & cMerk
            
            iStufe = 25
            List4.Nodes.Add Text:=cLBSatz
            
            rsrs.MoveNext
        Loop
        
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    iStufe = 26
    
    Screen.MousePointer = 11
    
    If gbArtsucheArtFarb = True Then
        farbelist4 Me
    End If
    
    
    Dim cartT As String
    iStufe = 27
    If List4.Nodes.Count > 0 Then
        For lcount = 1 To List4.Nodes.Count
            ctmp = List4.Nodes(lcount)
            cartT = Trim$(Left(ctmp, 6))
            If cartT = Trim$(cArtNrExakt) Then
                List4.Nodes(lcount).Selected = True
                List4.Nodes(lcount).EnsureVisible
                Exit For
            End If
        Next lcount
        anzeige "normal", List4.Nodes.Count & " Artikel", Label9
'        anzeige "normal", lCount - 1 & " Artikel", Label9
    Else
        If cArtBez <> "" Then
            If InStr(cArtBez, "*") > 0 Then
                Command4(15).Caption = "noch mehr Artikel"
                Command4(15).Visible = True
                Command4_Click 15
                Exit Sub
            Else
                anzeige "rot", "Keine Artikel!", Label9
            
            End If
        
            
        Else
            anzeige "rot", "Keine Artikel!", Label9
        End If
    End If
    iStufe = 28
    Frame9.Visible = False
    List2.Visible = True
    List4.Visible = True
    
    Command4(10).Visible = True
    Command4(9).Visible = True
    Command4(1).Visible = True
    cmdFoto.Visible = True
    Command8(118).Visible = True
    Command8(119).Visible = True
    
    
    List4.SetFocus
    Screen.MousePointer = 0
    
    'noch weitere Ergebnisse
    
    cArtBez = Trim(cArtBez)
    
    If cArtBez <> "" Then
        If InStr(cArtBez, "*") > 0 Then
            Command4(15).Caption = "noch mehr Artikel"
            Command4(15).Visible = True
        Else
            Command4(15).Caption = "weitere Artikel"
            Command4(15).Visible = False
        End If
    End If
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermweitereArtikel"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
     
    Fehlermeldung1
End Sub
Private Sub ermweitereArtikelT2()
    On Error GoTo LOKAL_ERROR
    
    Dim lLinr       As Long
    Dim lLinie      As Long
    Dim lcount      As Long
    Dim cRabattier  As String
    Dim ctmp        As String
    Dim cArtNrExakt As String
    Dim cMWST       As String
    Dim cSQL        As String
    Dim cArtBez     As String
    Dim cLiBesNr    As String
    Dim cEAN        As String
    Dim cFeld       As String
    Dim cLBSatz     As String
    Dim cVKPR       As String
    Dim cBestand    As String
    Dim cRabatt     As String
    Dim cPGN        As String
    Dim cAWM        As String
    Dim cLinr       As String
    Dim cMerk       As String
    
    Dim dRabatt     As Double
    Dim dVkPr       As Double
    Dim dKVkPr1     As Double
    Dim dFaktorV    As Double
    Dim dFaktorE    As Double
    Dim bAnd        As Boolean
    Dim rsrs        As Recordset
    Dim rsrs1       As Recordset
    Dim rsRs2       As Recordset
    Dim i           As Integer
    Dim j           As Integer
    
    Dim iStufe As Integer
    
    dFaktorV = 1 + (gdMWStV / 100)
    dFaktorE = 1 + (gdMWStE / 100)
    iStufe = 1
    dRabatt = 1
    If Label2(3).Visible Then
        cRabatt = Label2(3).Caption
        cRabatt = fnMoveComma2Point$(cRabatt)
        dRabatt = Val(cRabatt)
        dRabatt = dRabatt / 100
        dRabatt = 1 - dRabatt
    End If
    iStufe = 2
    If Label2(1).Visible Then
        cRabatt = Label2(1).Caption
        cRabatt = fnMoveComma2Point$(cRabatt)
        dRabatt = Val(cRabatt)
        dRabatt = dRabatt / 100
        dRabatt = 1 - dRabatt
    End If
    iStufe = 3
    bAnd = False
    
    cArtBez = Text3(0).Text
    cArtBez = UCase$(cArtBez)
'    Text3(0).Text = cArtBez

    cArtBez = LTrim(cArtBez)
    
    cArtBez = SwapStr(cArtBez, "     ", "*")
    cArtBez = SwapStr(cArtBez, "    ", "*")
    cArtBez = SwapStr(cArtBez, "   ", "*")
    cArtBez = SwapStr(cArtBez, "  ", "*")
    cArtBez = SwapStr(cArtBez, " ", "*")
    'jetzt malrauskriegen wieviele Teilstrings sind drin
    
    Dim lZaehler    As Long
    Dim lStart      As Long
    Dim lPos        As Long
    Dim lPosT       As Long
    ReDim cTeilstring(1 To 1) As String
    
    lStart = 0
    lZaehler = 0
    lPos = 100
    
    Do While lPos > 0
        lPos = InStr(lStart + 1, cArtBez, "*")
        
        lZaehler = lZaehler + 1
        ReDim Preserve cTeilstring(1 To lZaehler) As String
        
        lPosT = 0
        lPosT = InStr(lStart + 1, cArtBez, "*")
        
        If lPosT = 0 Then
            cTeilstring(lZaehler) = Mid(cArtBez, lStart + 1, Len(cArtBez) - (lStart))
        Else
            cTeilstring(lZaehler) = Mid(cArtBez, lStart + 1, lPosT - (lStart + 1))
        End If
        
        
        lStart = lPos
    Loop
    
    'Anzahl Teilstrings stehen fest
'    For i = 1 To LZaehler
'
'    Next i
    
    
    cLiBesNr = Text3(1).Text
    cLiBesNr = Trim$(cLiBesNr)
    cLiBesNr = UCase$(cLiBesNr)
    Text3(1).Text = cLiBesNr
    iStufe = 4
    cEAN = Text3(2).Text
    cEAN = Trim$(cEAN)
    cEAN = UCase$(cEAN)
    cEAN = SwapStr(cEAN, ",", "")
    cEAN = SwapStr(cEAN, ".", "")
    
    If cEAN <> "" Then
        If IsNumeric(cEAN) Then
            Text3(2).Text = cEAN
        Else
            Text3(2).Text = cEAN
            Text3(2).SetFocus
            Exit Sub
        End If
    End If
    
    cPGN = Text3(4).Text
    cPGN = Trim$(cPGN)

    cLinr = Text3(5).Text
    cLinr = Left(Trim(cLinr), 6)
    If IsNumeric(Left(cLinr, 6)) Then
    
    Else
        cLinr = ""
    End If
    
    iStufe = 5
    cAWM = Label1(9).Tag
    cAWM = Trim$(cAWM)
    
    Dim cSQLAnfang As String
    
    cSQLAnfang = "Insert into " & srechnertab & "ASEEK Select "
    cSQLAnfang = cSQLAnfang & " ARTNR  "
    cSQLAnfang = cSQLAnfang & ", BEZEICH  "
    cSQLAnfang = cSQLAnfang & ", LEKPR  "
    cSQLAnfang = cSQLAnfang & ", EKPR  "
    cSQLAnfang = cSQLAnfang & ", KVKPR1  "
    cSQLAnfang = cSQLAnfang & ", VKPR  "
    cSQLAnfang = cSQLAnfang & ", RKZ  "
    cSQLAnfang = cSQLAnfang & ", BESTAND  "
    cSQLAnfang = cSQLAnfang & ", MWST "
    cSQLAnfang = cSQLAnfang & ", 3 as SEEKMOD  "
    cSQLAnfang = cSQLAnfang & ", AWM "
    cSQLAnfang = cSQLAnfang & ", LINR "
    cSQLAnfang = cSQLAnfang & ", LPZ "
    cSQLAnfang = cSQLAnfang & ", GROESSE "
    cSQLAnfang = cSQLAnfang & " from ARTIKEL A  where "
    cSQLAnfang = cSQLAnfang & " Artnr not in (select Artnr from " & srechnertab & "ASEEK) "
    cSQLAnfang = cSQLAnfang & " and "
    

    Select Case lZaehler

        Case 2
'            lKombis = 1 * 2
        Case 3
'            lKombis = 1 * 2 * 3
        Case 4
        
        Case 5

        Case 6

        Case Else
            anzeige "rot", "Keine Artikel!", Label9
        
            Frame9.Visible = True
            Frame9.BackColor = Label9.BackColor
            List2.Visible = False
            List4.Visible = False
            
            Command4(10).Visible = False
            Command4(9).Visible = False
            Command4(1).Visible = False
            cmdFoto.Visible = False
            
            Command8(118).Visible = False
            Command8(119).Visible = False
            
            Command4(15).Caption = "weitere Artikel"
            Command4(15).Visible = False
            Text3(0).SetFocus
            Exit Sub
    End Select

    Select Case lZaehler
        Case 2
            
            anzeige "ROT2", "Artikel werden gesucht(3)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(1) & "*" & cTeilstring(2) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError
            
            anzeige "ROT2", "Artikel werden gesucht(4)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(2) & "*" & cTeilstring(1) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError

        Case 3, 4, 5, 6
        
            anzeige "ROT2", "Artikel werden gesucht(3)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(1) & "*" & cTeilstring(2) & "*" & cTeilstring(3) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError
            
            anzeige "ROT2", "Artikel werden gesucht(4)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(1) & "*" & cTeilstring(3) & "*" & cTeilstring(2) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError
            
            anzeige "ROT2", "Artikel werden gesucht(5)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(2) & "*" & cTeilstring(1) & "*" & cTeilstring(3) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError
            
            
            anzeige "ROT2", "Artikel werden gesucht(6)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(2) & "*" & cTeilstring(3) & "*" & cTeilstring(1) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError
            
            anzeige "ROT2", "Artikel werden gesucht(7)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(3) & "*" & cTeilstring(1) & "*" & cTeilstring(2) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError
            
            anzeige "ROT2", "Artikel werden gesucht(8)...", Label9
            cSQL = ""
            cArtBez = "*" & cTeilstring(3) & "*" & cTeilstring(2) & "*" & cTeilstring(1) & "*"
            cSQL = cSQLAnfang & MachDenRest(cArtBez)
            gdBase.Execute cSQL, dbFailOnError
    End Select

 
    cSQL = "Select * from " & srechnertab & "ASEEK where seekmod = 3 "
    If Option2(0).value = True Then
        cSQL = cSQL & " order by BEZEICH "
    Else
        cSQL = cSQL & " order by LINR, LPZ, BEZEICH "
    End If
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            iStufe = 17
            If Not IsNull(rsrs!MWST) Then
                cMWST = rsrs!MWST
            Else
                cMWST = "V"
            End If
            iStufe = 18
            If Not IsNull(rsrs!artnr) Then
                cFeld = rsrs!artnr
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cFeld = Space$(6 - Len(cFeld)) & cFeld
            cLBSatz = cFeld & " "
            iStufe = 19
            If Not IsNull(rsrs!BEZEICH) Then
                cFeld = rsrs!BEZEICH
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cFeld = cFeld & Space$(35 - Len(cFeld))
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 20
            If Not IsNull(rsrs!vkpr) Then
                dVkPr = rsrs!vkpr
            Else
                dVkPr = 0
            End If
            cFeld = Format$(dVkPr, "###,##0.00")
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 9 Then
                cFeld = Space$(9)
            Else
                cFeld = Space$(9 - Len(cFeld)) & cFeld
            End If
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 21
            Select Case Val(Label8(3).Caption)
                Case Is = 0
                    If Not IsNull(rsrs!KVKPR1) Then
                        dKVkPr1 = rsrs!KVKPR1
                    Else
                        dKVkPr1 = 0
                    End If
                Case Is = 1
                    If Not IsNull(rsrs!vkpr) Then
                        dKVkPr1 = rsrs!vkpr
                    Else
                        dKVkPr1 = 0
                    End If
                Case Is = 2
                    dKVkPr1 = ermMaxLEKPR(rsrs!artnr)
                        
                    If dKVkPr1 = 0 Then
                        If Not IsNull(rsrs!lekpr) Then
                            dKVkPr1 = rsrs!lekpr
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * dFaktorV
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * dFaktorE
                    End If
                    
                Case Is = 3
                    If Not IsNull(rsrs!ekpr) Then
                        dKVkPr1 = rsrs!ekpr
                    Else
                        dKVkPr1 = 0
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * dFaktorV
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * dFaktorE
                    End If
                Case Is = 4 'Spez kvk
                    dKVkPr1 = LeseSpezpreis(CLng(rsrs!artnr), 0)
                    If dKVkPr1 = 0 Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dKVkPr1 = rsrs!KVKPR1
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                Case Is = 5 'lvk m A
                    If rsrs!RABATT_OK = "N" Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dKVkPr1 = rsrs!KVKPR1
                        Else
                            dKVkPr1 = 0
                        End If
                    Else
                        If Not IsNull(rsrs!vkpr) Then
                            dKVkPr1 = rsrs!vkpr
                        Else
                            dKVkPr1 = 0
                        End If
                    End If
                    
                Case Is = 6 'Netto-KVK
                    If Not IsNull(rsrs!KVKPR1) Then
                        dKVkPr1 = rsrs!KVKPR1
                    Else
                        dKVkPr1 = 0
                    End If
                    If cMWST = "V" Then
                        dKVkPr1 = dKVkPr1 * 100 / (100 + gdMWStV)
                    End If
                    If cMWST = "E" Then
                        dKVkPr1 = dKVkPr1 * 100 / (100 + gdMWStE)
                    End If
                
            End Select
            iStufe = 22
            dKVkPr1 = dKVkPr1 * dRabatt
            cFeld = Format$(dKVkPr1, "###,##0.00")
            
            cFeld = Trim$(cFeld)
            cFeld = Space$(9 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 23
            If Not IsNull(rsrs!BESTAND) Then
                dVkPr = rsrs!BESTAND
            Else
                dVkPr = 0
            End If
            cFeld = Format$(dVkPr, "#,##0")
            cFeld = Trim$(cFeld)
            If Len(cFeld) > 5 Then cFeld = 0
            cFeld = Space$(5 - Len(cFeld)) & cFeld
            cLBSatz = cLBSatz & cFeld & " "
            iStufe = 24
            If Not IsNull(rsrs!RKZ) Then
                cFeld = rsrs!RKZ
            Else
                cFeld = "N"
            End If
            cFeld = Trim$(cFeld)
            cLBSatz = cLBSatz & cFeld & Space$(1)
            
            If Not IsNull(rsrs!AWM) Then
                cFeld = rsrs!AWM
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            cLBSatz = cLBSatz & cFeld & Space(2 - Len(cFeld))
            
            
            cMerk = Left(ZeigeArtmerk(Trim(Left(cLBSatz, 6))), 1)
            cLBSatz = cLBSatz & Space(1 - Len(cMerk)) & cMerk
            
            iStufe = 25
            List4.Nodes.Add Text:=cLBSatz
            
            rsrs.MoveNext
        Loop
        
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    iStufe = 26
    
    Screen.MousePointer = 11
    
    If gbArtsucheArtFarb = True Then
        farbelist4 Me
    End If
    
    Dim cartT As String
    iStufe = 27
    If List4.Nodes.Count > 0 Then
        For lcount = 1 To List4.Nodes.Count
            ctmp = List4.Nodes(lcount)
            cartT = Trim$(Left(ctmp, 6))
            If cartT = Trim$(cArtNrExakt) Then
                List4.Nodes(lcount).Selected = True
                List4.Nodes(lcount).EnsureVisible
                Exit For
            End If
        Next lcount
        anzeige "normal", List4.Nodes.Count & " Artikel", Label9
'        anzeige "normal", lCount - 1 & " Artikel", Label9
        
        
        Frame9.Visible = False
        List2.Visible = True
        List4.Visible = True
        
        Command4(10).Visible = True
        Command4(9).Visible = True
        Command4(1).Visible = True
        Command8(118).Visible = True
        Command8(119).Visible = True
        cmdFoto.Visible = True
        List4.SetFocus
        
    Else
        anzeige "rot", "Keine Artikel!", Label9
        
        Frame9.Visible = True
        Frame9.BackColor = Label9.BackColor
        List2.Visible = False
        List4.Visible = False
        
        Command4(10).Visible = False
        Command4(9).Visible = False
        Command4(1).Visible = False
        Command8(118).Visible = False
        Command8(119).Visible = False
        cmdFoto.Visible = False
        
        Command4(15).Caption = "weitere Artikel"
        Command4(15).Visible = False
        Text3(0).SetFocus
    End If
    iStufe = 28
    
    Screen.MousePointer = 0
    
    

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermweitereArtikelT2"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
     
    Fehlermeldung1
End Sub
Private Function MachDenRest(cArtBez As String) As String
On Error GoTo LOKAL_ERROR


    Dim cSQL        As String
    Dim bAnd   As Boolean
    Dim iStufe As Integer
    Dim cLiBesNr As String
    Dim cPGN As String
    Dim cLinr As String
    Dim cFeld As String
    Dim cAWM As String
    Dim cEAN As String
    
    
    cLiBesNr = Text3(1).Text
    cLiBesNr = Trim$(cLiBesNr)
    cLiBesNr = UCase$(cLiBesNr)
    Text3(1).Text = cLiBesNr
    iStufe = 4
    cEAN = Text3(2).Text
    cEAN = Trim$(cEAN)
    cEAN = UCase$(cEAN)
    cEAN = SwapStr(cEAN, ",", "")
    cEAN = SwapStr(cEAN, ".", "")
    
    If cEAN <> "" Then
        If IsNumeric(cEAN) Then
            Text3(2).Text = cEAN
        Else
            Text3(2).Text = cEAN
            Text3(2).SetFocus
            Exit Function
        End If
    End If
    
    cPGN = Text3(4).Text
    cPGN = Trim$(cPGN)

    cLinr = Text3(5).Text
    cLinr = Left(Trim(cLinr), 6)
    If IsNumeric(Left(cLinr, 6)) Then
    
    Else
        cLinr = ""
    End If
    
    iStufe = 5
    cAWM = Label1(9).Tag
    cAWM = Trim$(cAWM)

    cSQL = ""
    

        If cArtBez <> "" Then
            cSQL = cSQL & " a.BEZEICH like '" & cArtBez & "' "
            bAnd = True
        End If
        iStufe = 7
        If Check9.value = vbUnchecked Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.AWM <> '92' "
            bAnd = True
        End If
        
        If Check18.value = vbChecked Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.bestand > 0 "
            bAnd = True
        End If
        
        If Check16.value = vbChecked Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.gefuehrt = 'J' "
            bAnd = True
        Else
        
        End If
        
        If Check14.value = vbChecked Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.RKZ = 'N' "
            bAnd = True
        Else
        
        End If
        If cLiBesNr <> "" Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.LIBESNR like '" & cLiBesNr & "' "
            bAnd = True
        End If
        iStufe = 8
        If cPGN <> "" Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.PGN = " & cPGN
            bAnd = True
        End If
        If cLinr <> "" Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.LINR = " & cLinr
            bAnd = True
        End If
         
        'Marke
        cFeld = Text3(6).Text
        cFeld = Trim$(cFeld)
        If cFeld <> "" Then
            If LoeseMarkenInArtnr1(cFeld) Then
                If bAnd Then
                    cSQL = cSQL & " and "
                End If
                cSQL = cSQL & " a.artnr in (Select artnr from MA" & srechnertab & ") "
                bAnd = True
            Else
                anzeige "rot", "Keine Artikel!", Label9
                Exit Function
            End If
        End If
        
        iStufe = 9
        If cAWM <> "" Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            
            cSQL = cSQL & " a.AWM = '" & cAWM & "' "
            bAnd = True
        End If
        
        iStufe = 10
        
        If cEAN <> "" Then
            If bAnd Then
                cSQL = cSQL & " and "
            End If
            If Len(cEAN) > 6 Or (Len(cEAN) = 6 And Left(cEAN, 1) = "9") Then
            
                If Len(cEAN) = 8 Then
                    If Left(cEAN, 1) = "2" Then
                        cEAN = Mid$(cEAN, 2, 6)
                        cSQL = cSQL & " a.ARTNR = " & cEAN
                        bAnd = True
                     Else
                        cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "
                        bAnd = True
                    End If
                Else
                    cSQL = cSQL & "(a.EAN = '" & cEAN & "' or a.EAN2 = '" & cEAN & "' or a.EAN3 = '" & cEAN & "' ) "
                    bAnd = True
                
                End If
            Else
            '1.wunsch
                If IsNumeric(cEAN) Then
                    cSQL = cSQL & " a.ARTNR = " & cEAN
                    bAnd = True
                Else
                    cSQL = cSQL & " a.ARTNR = -1 "
                    bAnd = True
                End If
            End If
        End If
        
        If bAnd Then
            cSQL = cSQL & " and "
        End If
        cSQL = cSQL & "  ( A.SYNSTATUS is null or A.SYNSTATUS = 'E' or A.SYNSTATUS = 'A' ) "
        
        
        MachDenRest = cSQL


Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MachDenRest"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
     
    Fehlermeldung1
End Function
Private Sub SucheArtikelWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp                As String
    Dim cSuch               As String
    Dim cSQL                As String
    Dim dMenge              As Double
    Dim bgefunden           As Boolean
    Dim rsrs                As Recordset
    Dim lLinr               As Long
    Dim cZeitschriftenean   As String
    Dim cExtend             As String
    Dim cFotoPreis          As String
    Dim dSonderPreis        As Double
    Dim dPreis              As Double
    Dim dArtRab             As Double
    Dim dGesrab             As Double
    Dim dFotopreis          As Double
    Dim bDebug              As Boolean
    Dim dWert               As Single
    Dim cWg                 As String
    Dim cVZ                 As String
    Dim cWasSuchteMan       As String
    Dim cGeschwartnr        As String
    Dim svorgangsnummer     As String
    Dim sArtRab             As String
    Dim sGesRab             As String
    
    cExtend = ""
    bDebug = False
    bgefunden = False
    
    cZeitschriftenean = ""
    
    cSuch = Text1(1).Text
    cSuch = Trim$(cSuch)
    
    cWasSuchteMan = cSuch
    
    If cSuch = "" Then
        anzeige "rot", "Bitte einen Wert eingeben!", Label27
        Text1(1).SetFocus
        Exit Sub
    End If
    
    If Left(cSuch, 1) = "ß" Then
        cSuch = Right(cSuch, Len(cSuch) - 1)
    End If
    
    If InStr(cSuch, ",") > 0 Then
        If Len(cSuch) - InStr(cSuch, ",") > 2 Then
            anzeige "rot", "Ungültige Eingabe!", Label27
            Text1(1).SetFocus
            Exit Sub
        End If
    End If
    
    ctmp = Label2(5).Caption
    ctmp = Trim$(ctmp)
    
    ctmp = fnMoveComma2Point$(ctmp)
    dMenge = Val(ctmp)
    
    If Label2(0).Visible Then
        ctmp = Label2(0).Caption
        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        dSonderPreis = Val(ctmp)
    End If
    
    If Label2(1).Visible Then
        ctmp = Label2(1).Caption
        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        dArtRab = Val(ctmp)
    ElseIf Label2(3).Visible Then
        ctmp = Label2(3).Caption
        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        dGesrab = Val(ctmp)
    End If
    
    If InStr(cSuch, ",") > 0 Then
        anzeige "rot", "Artikelsuche mit Kommazeichen nicht möglich!", Label27
        Text1(1).SetFocus
        Exit Sub
    End If
    
    '*******************************************************
    '* Handelt es sich um eine EAN-13 mit führender 2 ?
    '*******************************************************
        
    If Len(cSuch) = 13 And Left(cSuch, 2) = "29" Then  'And Mid(cSuch, 6, 1) = "0"
        
        svorgangsnummer = CStr(Val(Mid(cSuch, 3, 4)))
        
        If glGSArtnr > 0 Then
        
            dlgGeschenkset.Show 1
            
            Select Case dlgGeschenkset.Back
                Case 1 'Ja
                    HoleUnterbrochenenBonWK20b_alsGS svorgangsnummer
                Case 2 'Nein
                    HoleUnterbrochenenBonWK20b svorgangsnummer
                
            End Select
            
        Else
            HoleUnterbrochenenBonWK20b svorgangsnummer
        End If
        
        faerbeRot
        
        BerechneZwischenSummeWKL20
        Ready4NextInputWKL20
        
        Text1(1).SetFocus
        Exit Sub
    End If
    
    gbArtrabhaltenLiebling = False
    
    If Len(cSuch) = 13 And Left(cSuch, 4) = "2771" Then
        'Artikelrabatt für den nächsten Artikel
        sArtRab = CStr(Val(Mid(cSuch, 5, 8)))
        Text1(1).Text = sArtRab
        'und Taste Artrab drücken
        Command1_Click 4
        
'        Text1(1).SetFocus
        Exit Sub
    End If
    
    
    If Len(cSuch) = 13 And Left(cSuch, 4) = "2772" Then
        'GesRabatt für den nächsten Artikel
        sGesRab = CStr(Val(Mid(cSuch, 5, 8)))
        Text1(1).Text = sGesRab
        'und Taste Gesrab drücken
        Command1_Click 3
        
        Text1(1).SetFocus
        Exit Sub
    End If
    
    'nur für Köhler Einzelrabattaufkleber
    If Len(cSuch) = 13 And Left(cSuch, 7) = "9839999" Then
        'Artikelrabatt für den nächsten Artikel
        sArtRab = CStr(Val(Mid(cSuch, 8, 5)))
        Text1(1).Text = sArtRab
        'und Taste Artrab drücken
        Command1_Click 4
        
        Text1(1).SetFocus
        Exit Sub
    End If
    
    
    
    If Len(cSuch) = 13 And Left(cSuch, 2) = "27" Then

        svorgangsnummer = CStr(Val(Mid(cSuch, 3, 3)))
        
        HoleUnterbrochenenBonWK20j_ARTAUSWAHL svorgangsnummer
        
        BerechneZwischenSummeWKL20
        Ready4NextInputWKL20
        
        Text1(1).SetFocus
        Exit Sub
    End If
    
    'Bonus auf Bon
    If Len(cSuch) = 13 And Left(cSuch, 2) = "25" Then
    
        'bonus_nr
        Dim lBonus_NR As Long
        
        lBonus_NR = CLng(Trim(Mid(cSuch, 7, 6)))
        
        
        Dim lFilangabe As Long
        lFilangabe = CLng(Trim(Mid(cSuch, 4, 2)))
        
        Dim sBonusAnwort As String
        sBonusAnwort = Einloesen_BONUS_SYS(lBonus_NR, lFilangabe)
        
        If Left(sBonusAnwort, 6) = "Dieser" Then
            MsgBox sBonusAnwort, vbOKOnly + vbCritical, "Winkiss Hinweis:"
        Else
            dPreis = CDbl(sBonusAnwort)
            
            If gsWWBonusArtnr <> "0" Then
                Warengruppe_kassieren_mit_PreisUebergabe Welche_Warengruppen_Taste(CLng(gsWWBonusArtnr)), dPreis
            End If
            
        End If


        
        
        BerechneZwischenSummeWKL20
        Ready4NextInputWKL20

        Text1(1).SetFocus
        Exit Sub
    End If
    
    
    
    If Len(cSuch) = 13 And Left(cSuch, 2) = "28" And Mid(cSuch, 6, 1) = "0" Then

        'Sonderpreisroutine begin

        gb28 = True

        dWert = CDbl(Mid(cSuch, 8, 5))
        dWert = dWert / 100
        cWg = Val(Mid(cSuch, 5, 3))

        Label2(0).Caption = Format$(dWert, "######0.00")
        Label2(0).Visible = True
        Label1(1).Visible = True
        Text1(1).Text = ""

        'Sonderpreisroutine ende

        If Label2(0).Visible Then
            Text1(1).Text = cWg
            SSCommand2_Click 15
            Label2(0).Caption = ""
            Label2(0).Visible = False
            Label1(1).Visible = False
        End If

        BerechneZwischenSummeWKL20
        Ready4NextInputWKL20

        Text1(1).SetFocus
        Exit Sub
    End If
    
    
    
    '*******************************************************
    '* Handelt es sich um eine EAN-13 mit führender 2 ?
    '*******************************************************
    
    
    
    If Len(cSuch) = 13 And Left(cSuch, 1) = "2" Then
    
        If Len(cSuch) = 13 And Left(cSuch, 4) = "2000" Then
            'nichts machen Ostergras für Uhl
        ElseIf Len(cSuch) = 13 And Left(cSuch, 2) = "21" Then
        
            'eigentlich
            'nichts machen das sind Gutscheine
            
            If glSpezFotoartikel > 0 Then
                If Left(cSuch, 6) = glSpezFotoartikel Then
                    cFotoPreis = Mid(cSuch, 8, 5)
                    cSuch = Left(cSuch, 6)
                    
                    dFotopreis = Val(cFotoPreis)
                    dFotopreis = dFotopreis / 100
                    Text1(1).Text = Format$(dFotopreis, "###0.00")
                End If
            End If
            
        ElseIf Len(cSuch) = 13 And Left(cSuch, 3) = "222" Then
        
            If glSpezLottoauszahlartikel > 0 Then
                If Left(cSuch, 6) = glSpezLottoauszahlartikel Then
                    cFotoPreis = Mid(cSuch, 8, 5)
                    cSuch = Left(cSuch, 6)
                    
                    dFotopreis = Val(cFotoPreis)
                    dFotopreis = dFotopreis / 100
                    
                    
                    Text1(1).Text = Format$(dFotopreis, "###0.00")
                    dMenge = -1
                End If
            End If
            
        ElseIf Len(cSuch) = 13 And Left(cSuch, 2) = "24" Then
            cFotoPreis = Mid(cSuch, 8, 5)
            cSuch = Left(cSuch, 6)
            
            
            dFotopreis = Val(cFotoPreis)
            dFotopreis = dFotopreis / 100
            Text1(1).Text = Format$(dFotopreis, "###0.00")

        Else
    
            If Len(cSuch) = 13 And Left(cSuch, 2) = "26" Then
            
                cFotoPreis = Mid(cSuch, 8, 5)
                cSuch = Left(cSuch, 6)
            Else
                cFotoPreis = Mid(cSuch, 8, 5)
                cSuch = Left(cSuch, 6)
            End If
            
            dFotopreis = Val(cFotoPreis)
            dFotopreis = dFotopreis / 100
            Text1(1).Text = Format$(dFotopreis, "###0.00")
        End If
        
        
    End If
    
    '*******************************************************
    '* Handelt es sich um eine EAN-13 für Zeitschriften?
    '*******************************************************
    If Len(cSuch) >= 13 And Left(cSuch, 3) = "414" And gcWaehrung = "EUR" Then
        'Zeitschrift in EURO und volle MWST
        cZeitschriftenean = cSuch
        If Len(cSuch) > 13 Then
            cExtend = cSuch
            cExtend = cExtend & Space$(18 - Len(cExtend))
        End If
        cFotoPreis = Mid(cSuch, 9, 4)
        
        lLinr = glZeitungsLinr ' ermLinrInZeitE
        
        If lLinr > 0 Then
            cSuch = ermartnrausLIBESNR(CStr(Val(Mid(cSuch, 4, 5))), lLinr)
        Else
            cSuch = ""
        End If
        
        If cSuch = "" Then cSuch = "666669"
        
        dFotopreis = Val(cFotoPreis)
        dFotopreis = dFotopreis / 100
        Text1(1).Text = Format$(dFotopreis, "###0.00")
    End If
    
    '*******************************************************
    '* Handelt es sich um eine EAN-13 für Zeitschriften?
    '*******************************************************
    If Len(cSuch) >= 13 And Left(cSuch, 3) = "419" And gcWaehrung = "EUR" Then
        cZeitschriftenean = cSuch
        'Zeitschrift in EURO und erm. MWST
        If Len(cSuch) > 13 Then
            cExtend = cSuch
            cExtend = cExtend & Space$(18 - Len(cExtend))
        End If
        cFotoPreis = Mid(cSuch, 9, 4)
        
        lLinr = glZeitungsLinr ' ermLinrInZeitE
        
        If lLinr > 0 Then
            cSuch = ermartnrausLIBESNR(CStr(Val(Mid(cSuch, 4, 5))), lLinr)
        Else
            cSuch = ""
        End If
    
        
        If cSuch = "" Then cSuch = "666668"
        
        dFotopreis = Val(cFotoPreis)
        dFotopreis = dFotopreis / 100
        Text1(1).Text = Format$(dFotopreis, "###0.00")
    End If
    
    '*******************************************************
    '* Handelt es sich um eine EAN-13 für Zeitschriften?
    '*******************************************************
    If Len(cSuch) >= 13 And Left(cSuch, 3) = "434" And gcWaehrung = "EUR" Then
        'Zeitschrift in EURO und volle MWST
        cZeitschriftenean = cSuch
        If Len(cSuch) > 13 Then
            cExtend = cSuch
            cExtend = cExtend & Space$(18 - Len(cExtend))
        End If
        cFotoPreis = Mid(cSuch, 9, 4)
        
        lLinr = glZeitungsLinr 'ermLinrInZeitE
        
        If lLinr > 0 Then
            cSuch = ermartnrausLIBESNR(CStr(Val(Mid(cSuch, 4, 5))), lLinr)
        Else
            cSuch = ""
        End If
        
        If cSuch = "" Then cSuch = "666669"
        
        dFotopreis = Val(cFotoPreis)
        dFotopreis = dFotopreis / 100
        Text1(1).Text = Format$(dFotopreis, "###0.00")
    End If
    
    '*******************************************************
    '* Handelt es sich um eine EAN-13 für Zeitschriften?
    '*******************************************************
    If Len(cSuch) >= 13 And Left(cSuch, 3) = "439" And gcWaehrung = "EUR" Then
        cZeitschriftenean = cSuch
        'Zeitschrift in EURO und erm. MWST
        If Len(cSuch) > 13 Then
            cExtend = cSuch
            cExtend = cExtend & Space$(18 - Len(cExtend))
        End If
        cFotoPreis = Mid(cSuch, 9, 4)
        
        lLinr = glZeitungsLinr 'ermLinrInZeitE
        
        If lLinr > 0 Then
            cSuch = ermartnrausLIBESNR(CStr(Val(Mid(cSuch, 4, 5))), lLinr)
        Else
            cSuch = ""
        End If
    
        
        If cSuch = "" Then cSuch = "666668"
        
        dFotopreis = Val(cFotoPreis)
        dFotopreis = dFotopreis / 100
        Text1(1).Text = Format$(dFotopreis, "###0.00")
    End If
    
    
    If Len(cSuch) >= 13 And Left(cSuch, 2) = "98" Then
        If gbCoupon = True Then

            Dim sErgebnis As String
            sErgebnis = Bonus_bedingung_Prüfen(cSuch)

            Select Case sErgebnis

                Case Is = "" 'alles gut

                Case Is <> ""

                    anzeige "rot", sErgebnis, Label27
                    Text1(1).Text = ""
                    Text1(1).SetFocus
                    Exit Sub

            End Select

        Else

        End If
    End If
    

    '**************************************************
    '* Ab hier normale Suche
    '**************************************************
    
    '*******************************************************
    '* Der normale Fall ist die Suche über einen EAN-Code,
    '* der per Scanner eingelesen wird
    '*******************************************************
    
    If Len(cSuch) > 6 Or (Len(cSuch) = 6 And Left(cSuch, 1) = "9") Then
    
        cSQL = "Select ARTNR from ARTIKEL where EAN = '" & cSuch & "' "
        cSQL = cSQL & " and ( ARTIKEL.SYNSTATUS is null or ARTIKEL.SYNSTATUS = 'E' or ARTIKEL.SYNSTATUS = 'A' ) "
        If gbkassgefuehrt Then
            cSQL = cSQL & " and gefuehrt = 'J'"
        End If
        If gbMitPreis Then
            
            If IstDasEineWGNforKasse(cSuch) = False Then
                If cZeitschriftenean = "" Then
                    cSQL = cSQL & " and kvkpr1 > 0 "
                End If
            End If
            
            
        End If
        FnOpenrecordset rsrs, cSQL, 1, gdBase
        
        If rsrs.EOF Then
        
            rsrs.Close: Set rsrs = Nothing
            
            cSQL = "Select ARTNR from ARTIKEL where EAN2 = '" & cSuch & "' "
            cSQL = cSQL & " and ( ARTIKEL.SYNSTATUS is null or ARTIKEL.SYNSTATUS = 'E' or ARTIKEL.SYNSTATUS = 'A' ) "
            If gbkassgefuehrt Then
                cSQL = cSQL & " and gefuehrt = 'J'"
            End If
            
            If gbMitPreis Then
                If IstDasEineWGNforKasse(cSuch) = False Then
                    If cZeitschriftenean = "" Then
                        cSQL = cSQL & " and kvkpr1 > 0 "
                    End If
                End If
            End If
            FnOpenrecordset rsrs, cSQL, 1, gdBase
        End If
        
        If rsrs.EOF Then
        
            rsrs.Close: Set rsrs = Nothing
            
            cSQL = "Select ARTNR from ARTIKEL where EAN3 = '" & cSuch & "' "
            cSQL = cSQL & " and ( ARTIKEL.SYNSTATUS is null or ARTIKEL.SYNSTATUS = 'E' or ARTIKEL.SYNSTATUS = 'A' ) "
            If gbkassgefuehrt Then
                cSQL = cSQL & " and gefuehrt = 'J'"
            End If
            
            If gbMitPreis Then
                If IstDasEineWGNforKasse(cSuch) = False Then
                    If cZeitschriftenean = "" Then
                        cSQL = cSQL & " and kvkpr1 > 0 "
                    End If
                End If
            End If
            FnOpenrecordset rsrs, cSQL, 1, gdBase
        End If
        
        If rsrs.EOF Then
        
            rsrs.Close: Set rsrs = Nothing
            
            cSQL = "Select Artikel.ARTNR from ARTEAN_K inner join Artikel on ARTEAN_K.artnr = Artikel.artnr where ARTEAN_K.EAN = '" & cSuch & "' "
            
            
            
            
            cSQL = cSQL & " and ( ARTIKEL.SYNSTATUS is null or ARTIKEL.SYNSTATUS = 'E' or ARTIKEL.SYNSTATUS = 'A' ) "
            If gbkassgefuehrt Then
                cSQL = cSQL & " and Artikel.gefuehrt = 'J'"
            End If
            
            If gbMitPreis Then
                If IstDasEineWGNforKasse(cSuch) = False Then
                    If cZeitschriftenean = "" Then
                        cSQL = cSQL & " and Artikel.kvkpr1 > 0 "
                    End If
                End If
            End If
            
            
            
            
            
            
            FnOpenrecordset rsrs, cSQL, 1, gdBase
            
        End If
        
        If rsrs.EOF Then
        
            rsrs.Close: Set rsrs = Nothing
            
            cSQL = "Select ARTNR from ARTIKEL where artnr = " & cSuch & " "
            cSQL = cSQL & " and ( ARTIKEL.SYNSTATUS is null or ARTIKEL.SYNSTATUS = 'E' or ARTIKEL.SYNSTATUS = 'A' ) "
            If gbkassgefuehrt Then
                cSQL = cSQL & " and gefuehrt = 'J'"
            End If
            
            If gbMitPreis Then
                If IstDasEineWGNforKasse(cSuch) = False Then
                    If cZeitschriftenean = "" Then
                        cSQL = cSQL & " and kvkpr1 > 0 "
                    End If
                End If
            End If
            FnOpenrecordset rsrs, cSQL, 1, gdBase
            
            
        End If
        
        If rsrs.EOF Then
        
            rsrs.Close: Set rsrs = Nothing
            
            If Len(cSuch) = 8 Then
                If Left(cSuch, 1) = "2" Then
                    cSuch = Mid(cSuch, 2, 6)
                ElseIf Left(cSuch, 1) = "0" Then
                    cSuch = Mid(cSuch, 2, 6)
                Else
                    cSuch = ""
                End If
            Else
                cSuch = ""
            End If
        Else
            rsrs.MoveFirst
            If Not IsNull(rsrs!artnr) Then
                cSuch = rsrs!artnr
            Else
                cSuch = ""
            End If
            
            rsrs.Close: Set rsrs = Nothing
        End If
    End If
    
    
    'Gibt es Markenbezogene Rabattgrenzen?
    
    If Hat_dieser_Artikel_Markenbezogene_Rabattgrenze(cSuch, dArtRab, dGesrab, dSonderPreis) = True Then
    
'        MsgBox "Keine Daten gefunden!", vbInformation, "Winkiss Hinweis:"
    
    End If
    
    
    
    
    
    
    If cSuch <> "" Then
        ArtikelAnDerKasseAnzeigen cSuch, dFotopreis, dSonderPreis, dArtRab, dGesrab, dMenge, cZeitschriftenean, cExtend, bDebug, cWasSuchteMan
        
      
        If cSuch <> "" Then
        
        
            If Val(Label8(3).Caption) = 0 Then 'wenn der Kunde auf kvkpr steht als Preiskz
                
            
        
        
                If LeseStaffelpreisArt_NEU(cSuch) Then
                    'Verarbeite Staffel
                    
                    'hole Staffnummer
                    Dim sStaffNr As String
                    sStaffNr = ermStaffNr(cSuch)
                    
                    
                    
                    Dim lStaffelmenge As Long
                    Dim dKVKStaffelpreis As Double
                    
                    Dim lStaffelmenge2 As Long
                    Dim dKVKStaffelpreis2 As Double
                    
                    Dim lStaffelmenge3 As Long
                    Dim dKVKStaffelpreis3 As Double
                    
                    Dim lVKMengeinWarenkorb As Long
                    lVKMengeinWarenkorb = ermittleVKMenge_UeberStaffelNR(CLng(sStaffNr))
                    
                    Dim rsStaff As Recordset
                    cSQL = "Select * from STAFFEL_KVK_GRUPPE where STAFFNR = " & sStaffNr
                    FnOpenrecordset rsStaff, cSQL, 1, gdBase
                    If Not rsStaff.EOF Then
                    
                        rsStaff.MoveFirst
            
                        If Not IsNull(rsStaff!Menge) Then
                            lStaffelmenge = rsStaff!Menge
                        Else
                            lStaffelmenge = 0
                        End If
                        
                        If Not IsNull(rsStaff!Menge2) Then
                            lStaffelmenge2 = rsStaff!Menge2
                        Else
                            lStaffelmenge2 = 0
                        End If
                        
                        If Not IsNull(rsStaff!Menge3) Then
                            lStaffelmenge3 = rsStaff!Menge3
                        Else
                            lStaffelmenge3 = 0
                        End If
                        
                        If lVKMengeinWarenkorb >= lStaffelmenge Then
                        
                            If Not IsNull(rsStaff!KVKPR1) Then
                                dKVKStaffelpreis = rsStaff!KVKPR1
                            Else
                                dKVKStaffelpreis = 0
                            End If
                            
                            If dKVKStaffelpreis > 0 Then
                                schreibeNeuenPreisInWarenkorb_ueberStaffNr CLng(sStaffNr), dKVKStaffelpreis
                            End If
                        
                        End If
                        
                        
                        
                        If lStaffelmenge2 > 0 Then
                            If lVKMengeinWarenkorb >= lStaffelmenge2 Then
                            
                                If Not IsNull(rsStaff!KVKPR2) Then
                                    dKVKStaffelpreis2 = rsStaff!KVKPR2
                                Else
                                    dKVKStaffelpreis2 = 0
                                End If
                                
                                If dKVKStaffelpreis2 > 0 Then
                                    schreibeNeuenPreisInWarenkorb_ueberStaffNr CLng(sStaffNr), dKVKStaffelpreis2
                                End If
                            
                            End If
                        End If
                        
                        
                        
                        
                        
                        If lStaffelmenge3 > 0 Then
                            If lVKMengeinWarenkorb >= lStaffelmenge3 Then
                            
                                If Not IsNull(rsStaff!KVKPR3) Then
                                    dKVKStaffelpreis3 = rsStaff!KVKPR3
                                Else
                                    dKVKStaffelpreis3 = 0
                                End If
                                
                                If dKVKStaffelpreis3 > 0 Then
                                    schreibeNeuenPreisInWarenkorb_ueberStaffNr CLng(sStaffNr), dKVKStaffelpreis3
                                End If
                            
                            End If
                        End If
                        
                    End If
                    rsStaff.Close: Set rsStaff = Nothing
                    
                    
                    Dim cZeile1             As String
                    Dim cZeile2             As String
                    
                    cZeile1 = ""
                    cZeile2 = ""
    
                    ZeigeKundenDisplay cZeile1, cZeile2
                    
                    
                    'neu 13.12.17
                    AktualisiereListboxWKL20
                    AktualisiereZeileZwischenSummeWKL20
                    'neu ende
                    
                    
                End If
            
            End If
            
            
            
            If LeseGeschwisterArt(cSuch) Then
            
                Dim rsGeschw As Recordset
                cSQL = "Select * from GESCHWART where MUTTERARTNR = " & cSuch
                FnOpenrecordset rsGeschw, cSQL, 1, gdBase
                If Not rsGeschw.EOF Then
                
                    rsGeschw.MoveFirst
        
                    Do While Not rsGeschw.EOF
                    
                        If Not IsNull(rsGeschw!artnr) Then
                            cGeschwartnr = rsGeschw!artnr
                        Else
                            cGeschwartnr = ""
                        End If
                        
                        If Not IsNull(rsGeschw!KVK_OK) Then
                            If rsGeschw!KVK_OK = -1 Then
                            
                                Label2(0).Visible = True
                                dSonderPreis = 0
                            Else
                                Label2(0).Visible = False
                                
                            End If
                        End If
                        
                        
                        If cGeschwartnr <> "" Then
                            If IsNumeric(cGeschwartnr) Then
                                ArtikelAnDerKasseAnzeigen cGeschwartnr, dFotopreis, dSonderPreis, dArtRab, dGesrab, dMenge, cZeitschriftenean, cExtend, bDebug
                            End If
                        End If
                        
                        Label2(0).Visible = False
                    rsGeschw.MoveNext
                    Loop
                End If
                rsGeschw.Close: Set rsGeschw = Nothing

            End If
        End If
    Else
    
        Text1(1).Text = unbekanntenEAN_Suchen_und_Anlegen(cWasSuchteMan) 'Über Parf Schalter
        
        If Text1(1).Text = "" Then
            Text1(1).Text = unbekanntenEAN_Suchen_und_Anlegen_DrogAlles(cWasSuchteMan) 'Über Drogerie und Spielwaren Schalter

        End If
        
        
        If Text1(1).Text <> cWasSuchteMan Then
            SSCommand2_Click 15 'also nochmal suchen
            Exit Sub
        End If
        
        If gsUnbekanntStrichMail <> "" Then
        
            'schicke Mail an die hinterlegte Adresse
            Dim cAbsenderEmail As String
            Dim cAnEmailadresse As String
            Dim cBetreff As String
            Dim cMessagetext As String
            Dim sAttachment As String
        
            sAttachment = ""
            
            cAbsenderEmail = ermFirmenMail
            If cAbsenderEmail = "" Then
                Exit Sub
            End If
            
            cAnEmailadresse = gsUnbekanntStrichMail
            cBetreff = "WinKiss Kasse (Strichcode unbekannt): " & cWasSuchteMan & " "
            
            cMessagetext = "Dieser Strichcode ist dem Kassensystem unbekannt: " & cWasSuchteMan & " " & vbCrLf & vbCrLf
            cMessagetext = cMessagetext & "Bitte beantworten Sie diese Email nicht."
            
            schickeMailimHintergrundSSL ermFirmenBez, cAbsenderEmail, "", cAnEmailadresse _
            , "bestsend@kisswws.de", gcSMTP_SERVER, gcSMTP_PORT, gcSMTP_USER, gcSMTP_PW, cBetreff, cMessagetext, sAttachment
            
        End If
        
    
        anzeige "Artikel", "Artikel nicht gefunden!", Label27
        Text1(1).Text = "nicht gefunden"
        Frame26.Visible = True

    End If
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 5 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SucheArtikelWKL20"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
End Sub
Private Function Bonus_bedingung_Prüfen(sBonusEANCode As String) As String
    On Error GoTo LOKAL_ERROR
    
    Dim sCouponID As String
    
    Bonus_bedingung_Prüfen = ""
    
    'Zuerst COUPON_ID
    
    sCouponID = erm_Coupon_ID(sBonusEANCode)
    
    If Trim(sCouponID) = "" Then
        Bonus_bedingung_Prüfen = "Für diesen Coupon ist keine Regel hinterlegt"
        Exit Function
    End If
    
    
    'Zeitraum OK?
    Dim cStart As String
    Dim cEnde As String
    
    cStart = erm_Coupon_Details(sBonusEANCode, "COUPON_STARTDATUM")
    cEnde = erm_Coupon_Details(sBonusEANCode, "COUPON_ENDEDATUM")
    
    If DateValue(Now) > CLng(DateValue(cStart)) And DateValue(Now) < CLng(DateValue(cEnde)) Then

    Else
        Bonus_bedingung_Prüfen = "Gilt nur von " & cStart & " bis " & cEnde
        Exit Function
    End If
    'Ende Zeitraum
    
    
    
    Dim cTitle As String
    cTitle = erm_Coupon_Details(sBonusEANCode, "COUPON_TITEL")
    
    
    
    Dim cMindestAnzahl As String
    cMindestAnzahl = erm_Coupon_Details(sBonusEANCode, "COUPON_MINDESTANZAHL")
    
    Dim cMindestUmsatz As String
    cMindestUmsatz = erm_Coupon_Details(sBonusEANCode, "COUPON_MINDESTUMSATZ") 'in Cent
    
    Dim cMehrfachErlaubt As String
    cMehrfachErlaubt = erm_Coupon_Details(sBonusEANCode, "COUPON_MEHRFACHEINLÖSUNG") 'Wahr oder Falsch
    
    Dim cCOUPON_ARTNR As String
    cCOUPON_ARTNR = erm_Coupon_Details(sBonusEANCode, "COUPON_ARTNR") 'Wahr oder Falsch
    
    
    'Wie oft ist dieser Coupon im Warenkorb?
    
    Dim iAnzahlGleicherCoupon As Integer
    iAnzahlGleicherCoupon = Wie_oft_dieseCouponID_schon_drin(sCouponID)
    
    If UCase(cMehrfachErlaubt) = "FALSCH" And iAnzahlGleicherCoupon > 0 Then
        Bonus_bedingung_Prüfen = "Nur ein Coupon für die Aktion " & cTitle & " zulässig"
        Exit Function
    End If

    Dim iBedingungAnzahl As Integer
    iBedingungAnzahl = CInt(iAnzahlGleicherCoupon + 1) * CInt(cMindestAnzahl)
    
    Dim dBedingungUmsatz As Double
    dBedingungUmsatz = CInt(iAnzahlGleicherCoupon + 1) * CDbl(cMindestUmsatz / 100)
    
    If sind_CouponBedingungen_erfüllt(iBedingungAnzahl, dBedingungUmsatz, sCouponID) = False Then
        Bonus_bedingung_Prüfen = cTitle & ": Mindestens " & iBedingungAnzahl & "Stück für " & Format(dBedingungUmsatz, "######0.00") & " !"
        Exit Function
    End If
    
'    Bonus_bedingung_Prüfen = "Bonus-Bedingung nicht erfüllt."

Exit Function
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Bonus_bedingung_Prüfen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Public Sub HoleUnterbrochenenBonWK20b_alsGS(cLfdNr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    Dim rsrs As Recordset
    Dim rsBonPause As Recordset
    Dim rsKd As Recordset
    
    Dim cBedNr As String
    Dim cZSum As String
    Dim cGRabatt As String
    Dim cKdName As String
    Dim cKdnr As String
    Dim cLbText As String
    Dim cPreisKz As String
    Dim sArtnr As String
    Dim dBetrag As Double
    Dim dSumSEKWert As Double
    Dim sMenge As String
    
    cSQL = "Select * from BONPAUSE where LFDNR = " & cLfdNr & " order by LBZEILE "
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!BEDNR) Then
            cBedNr = rsrs!BEDNR
        Else
            cBedNr = ""
        End If
        If Not IsNull(rsrs!ZSUM) Then
            cZSum = rsrs!ZSUM
            
            dBetrag = rsrs!ZSUM
        Else
            cZSum = "0,00"
        End If
        If Not IsNull(rsrs!GRABATT) Then
            cGRabatt = rsrs!GRABATT
        Else
            cGRabatt = "0,00"
        End If
        If Not IsNull(rsrs!KdName) Then
            cKdName = rsrs!KdName
        Else
            cKdName = ""
        End If
        If Not IsNull(rsrs!KdNr) Then
            cKdnr = rsrs!KdNr
        Else
            cKdnr = ""
        End If
        
        If cKdnr <> "" Then
            cSQL = "Select * from Kunden where Kundnr = " & Val(cKdnr)
            Set rsKd = gdBase.OpenRecordset(cSQL)
            
            If Not rsKd.EOF Then
                If Not IsNull(rsKd!PREISKZ) Then
                    cPreisKz = rsKd!PREISKZ
                Else
                    cPreisKz = "0"
                End If
                frmWKL20!Label8(3).Caption = cPreisKz
                giPreisKz = Val(cPreisKz)
            End If
            rsKd.Close
        End If
        
        frmWKL20!Label2(6).Caption = cZSum
        If cGRabatt <> "0,00" Then
            frmWKL20!Label2(3).Caption = cGRabatt
            frmWKL20!Label2(3).Visible = True
            frmWKL20!Label1(3).Visible = True
        Else
            frmWKL20!Label2(4).Visible = False
            frmWKL20!Label2(3).Visible = False
            frmWKL20!Label1(3).Visible = False
        End If
        
        If cKdName <> "" Or cKdnr <> "" Then
            frmWKL20!Label1(7).Caption = cKdName
            frmWKL20!Label2(7).Caption = cKdnr
            frmWKL20!Label1(7).Visible = True
            frmWKL20!Label1(19).Visible = True
            frmWKL20!Label2(7).Visible = True
        Else
            frmWKL20!Label1(7).Visible = False
            frmWKL20!Label1(19).Visible = False
            frmWKL20!Label2(7).Visible = False
        End If
        
        dSumSEKWert = 0
        
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!lbtext) Then
                cLbText = rsrs!lbtext
                
                sArtnr = Mid(cLbText, 7, 6)
                sArtnr = Trim$(sArtnr)
                
                sMenge = Mid(cLbText, 1, 5)
                sMenge = Val(Trim$(sMenge))
                
                dSumSEKWert = dSumSEKWert + ermSEKPR(sArtnr) * CLng(sMenge)
                
                
                
                If giFarbebeiPark > 0 And giFarbebeiPark < 20 Then
                
                    sArtnr = Mid(cLbText, 7, 6)
                    sArtnr = Trim$(sArtnr)
                    
                    cSQL = " Select count(*)  from bonpause where trim(Mid(lbtext,7,6)) = '" & sArtnr & "'"
                    Set rsBonPause = gdBase.OpenRecordset(cSQL)
                    
                    If Not rsBonPause.EOF Then
                        
                        If rsBonPause.RecordCount = 1 Then
                    
                            cSQL = "Update ARTIKEL set AWM = '0'  where Artnr = " & sArtnr
                            gdBase.Execute cSQL, dbFailOnError
                        
                        End If
                    
                    End If
                    
                    rsBonPause.Close
                    
                End If
                
               
                

'                frmWKL20!List1.AddItem cLbText
'                frmWKL20!List3.Nodes.Add Text:=Left(cLbText, 68)
'                farbelist3
            End If
            rsrs.MoveNext
        Loop
        
        
         
        
        If dBetrag > 0# Then
        
            cSQL = "Update Artikel set EKPR = '" & dSumSEKWert & "' where ARTNR = " & glGSArtnr & " "
            gdBase.Execute cSQL, dbFailOnError
            Artikel_kassieren_mit_PreisUebergabe glGSArtnr, Format(dBetrag * (-1), "######0.00")
            
        End If
        
        cSQL = "Delete from BONPAUSE where LFDNR = " & cLfdNr & " "
        gdBase.Execute cSQL, dbFailOnError
        
        'nur Anzeige
        HoleNeueBonNrWKL20
        
        frmWKL20!Label18.Caption = gdBonNr
        frmWKL20!Label18.Refresh
    End If
    rsrs.Close: Set rsrs = Nothing

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "HoleUnterbrochenenBonWK20b_alsGS"
    Fehler.gsFehlertext = "Im Programmteil offene Kassenvorgänge ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub schreibeNeuenPreisInWarenkorb(lSuch_Artnr As Long, dNeuerPreis As Double)
On Error GoTo LOKAL_ERROR

    Dim lAnz        As Long
    Dim lcount      As Long
    Dim cLBSatz     As String
    Dim cErsatz     As String
    Dim sKVKPR      As String
    Dim sSumKVKPR   As String
    Dim lartnr      As Long
    Dim lanz1       As Long
    Dim ctmp        As String
    
    
    'hier wird der VK mit dem EK ersetzt
    
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
        cLBSatz = List1.list(lcount)
        
        lartnr = CLng(Trim$(Mid(cLBSatz, 7, 6)))
        
        If lSuch_Artnr = lartnr Then
            'neuen KVKPR eintragen
            
            
            sKVKPR = dNeuerPreis
            sKVKPR = Format$(sKVKPR, "#####0.00 ")
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
        
            lanz1 = CLng(ctmp)
            sSumKVKPR = CStr(lanz1 * sKVKPR)
            
            sKVKPR = Format$(sKVKPR, "#####0.000")
            sKVKPR = Space$(9 - Len(sKVKPR)) & sKVKPR
            
            sSumKVKPR = Format$(sSumKVKPR, "#####0.00")
            sSumKVKPR = Space$(9 - Len(sSumKVKPR)) & sSumKVKPR
            
        
            Mid(cLBSatz, 50, 9) = "         "
            Mid(cLBSatz, 50, 9) = sKVKPR ' cErsatz 'hier einzelekpr
            Mid(cLBSatz, 60, 9) = "         "
            Mid(cLBSatz, 60, 9) = sSumKVKPR ' cErsatz 'hier zeilensumme ekpr
            
            List1.RemoveItem lcount
            List1.AddItem cLBSatz, lcount
            
            List3.Nodes.Remove lcount + 1
            List3.Nodes.Add Text:=Left(cLBSatz, 68)
            
        End If
    Next lcount
    

    List3.Nodes.Clear
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
    
        cLBSatz = ""
        cLBSatz = List1.list(lcount)
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
    
    Next lcount
    
    farbelist3
    
    
    
    
    
    
'    List1.Refresh
'    List3.Refresh
    
    
    BerechneZwischenSummeWKL20
    
'    LeereDialogModul20
'    Label2(6).Caption = "0,00"
'
'    List1.Clear
'    List3.Nodes.Clear
'    Label41(1).Caption = 0

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "schreibeNeuenPreisInWarenkorb"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
    Fehlermeldung1
End Sub
Private Sub schreibeNeuenPreisInWarenkorb_ueberStaffNr(lStaffNr As Long, dNeuerPreis As Double)
On Error GoTo LOKAL_ERROR

    Dim lAnz        As Long
    Dim lcount      As Long
    Dim cLBSatz     As String
    Dim cErsatz     As String
    Dim sKVKPR      As String
    Dim sSumKVKPR   As String
    Dim lartnr      As Long
    Dim lanz1       As Long
    Dim ctmp        As String
    
    
    
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
        cLBSatz = List1.list(lcount)
        
        lartnr = CLng(Trim$(Mid(cLBSatz, 7, 6)))
        
        
        If Gehoerst_du_zu_Staffel(lartnr, lStaffNr) Then
'        If lSuch_Artnr = lartnr Then
            'neuen KVKPR eintragen
            
            
            sKVKPR = dNeuerPreis
            sKVKPR = Format$(sKVKPR, "#####0.00 ")
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
        
            lanz1 = CLng(ctmp)
            sSumKVKPR = CStr(lanz1 * sKVKPR)
            
            sKVKPR = Format$(sKVKPR, "#####0.000")
            sKVKPR = Space$(9 - Len(sKVKPR)) & sKVKPR
            
            sSumKVKPR = Format$(sSumKVKPR, "#####0.00")
            sSumKVKPR = Space$(9 - Len(sSumKVKPR)) & sSumKVKPR
            
        
            Mid(cLBSatz, 50, 9) = "         "
            Mid(cLBSatz, 50, 9) = sKVKPR ' cErsatz 'hier einzelekpr
            Mid(cLBSatz, 60, 9) = "         "
            Mid(cLBSatz, 60, 9) = sSumKVKPR ' cErsatz 'hier zeilensumme ekpr
            
            Mid(cLBSatz, 74, 9) = sKVKPR ' cErsatz 'hier einzelekpr
            
            List1.RemoveItem lcount
            List1.AddItem cLBSatz, lcount
            
            List3.Nodes.Remove lcount + 1
            List3.Nodes.Add Text:=Left(cLBSatz, 68)
            
        End If
    Next lcount
    
    List3.Nodes.Clear
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
        cLBSatz = ""
        cLBSatz = List1.list(lcount)
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
    Next lcount
    
    farbelist3
    BerechneZwischenSummeWKL20
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "schreibeNeuenPreisInWarenkorb_ueberStaffNr"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
    Fehlermeldung1
End Sub
Private Sub schreibeRegulaerenPreisInWarenkorb_ueberStaffNr(lStaffNr As Long, iPreizKZ As Integer)
On Error GoTo LOKAL_ERROR

    Dim lAnz        As Long
    Dim lcount      As Long
    Dim cLBSatz     As String
    Dim cErsatz     As String
    Dim sKVKPR      As String
    Dim sSumKVKPR   As String
    Dim lartnr      As Long
    Dim lanz1       As Long
    Dim ctmp        As String
    
    
    
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
        cLBSatz = List1.list(lcount)
        
        lartnr = CLng(Trim$(Mid(cLBSatz, 7, 6)))
        
        
        If Gehoerst_du_zu_Staffel(lartnr, lStaffNr) Then

            'regulären KVKPR eintragen
            
            
            sKVKPR = ermPreisMitPreisZK(CStr(lartnr), iPreizKZ)
            sKVKPR = Format$(sKVKPR, "#####0.00 ")
            
            If Left(cLBSatz, 1) = "x" Then
                ctmp = Mid(cLBSatz, 2, 4)
            Else
                ctmp = Mid(cLBSatz, 1, 5)
            End If
        
            lanz1 = CLng(ctmp)
            sSumKVKPR = CStr(lanz1 * sKVKPR)
            
            sKVKPR = Format$(sKVKPR, "#####0.000")
            sKVKPR = Space$(9 - Len(sKVKPR)) & sKVKPR
            
            sSumKVKPR = Format$(sSumKVKPR, "#####0.00")
            sSumKVKPR = Space$(9 - Len(sSumKVKPR)) & sSumKVKPR
            
        
            Mid(cLBSatz, 50, 9) = "         "
            Mid(cLBSatz, 50, 9) = sKVKPR ' cErsatz 'hier einzelekpr
            Mid(cLBSatz, 60, 9) = "         "
            Mid(cLBSatz, 60, 9) = sSumKVKPR ' cErsatz 'hier zeilensumme ekpr
            
            List1.RemoveItem lcount
            List1.AddItem cLBSatz, lcount
            
            List3.Nodes.Remove lcount + 1
            List3.Nodes.Add Text:=Left(cLBSatz, 68)
            
        End If
    Next lcount
    
    List3.Nodes.Clear
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
        cLBSatz = ""
        cLBSatz = List1.list(lcount)
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
    Next lcount
    
    farbelist3
    BerechneZwischenSummeWKL20
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "schreibeRegulaerenPreisInWarenkorb_ueberStaffNr"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
    Fehlermeldung1
End Sub
Private Sub ArtikelAnDerKasseAnzeigen(cSuch As String, dFotopreis As Double, dSonderPreis As Double, dArtRab As Double, dGesrab As Double, _
dMenge As Double, cZeitschriftenean As String, cExtend As String, bDebug As Boolean, Optional sWaswarSuchString As String = "")
On Error GoTo LOKAL_ERROR

        Dim cSQL                As String
        Dim dPreis              As Double
        Dim dBestand            As Double
        Dim bgefunden           As Boolean
        Dim rsrs                As Recordset
        Dim cArtNr              As String
        Dim cArtBez             As String
        Dim cRabattOk           As String
        Dim cBonusOk            As String
        Dim cUmsOK              As String
        Dim cFeld               As String
        Dim cLBSatz             As String
        Dim cMWStKz             As String
        Dim dKassenVk           As Double
        Dim dEinzelpreis        As Double
        Dim dVerkaufsPreis      As Double
        Dim dListenPreis        As Double
        Dim dGesamtPreis        As Double
        Dim dEkpr               As Double
        Dim dErmWert            As Double
        Dim dMWStV              As Double
        Dim dMWStE              As Double
        Dim dRestMenge          As Double
        Dim cZeile1             As String
        Dim cZeile2             As String

        '*****************************************************************
        '* Es wurde ein Artikel gefunden!
        '*****************************************************************
        gsQMPreis = ""
        gsQMBez = ""
        If WasIstInhaltBez(cSuch) = "QM" Then
            gsARTNR = cSuch
            frmWKL91.Show 1
            gsARTNR = ""
        End If
        
        cSQL = "Select * from ARTIKEL where ARTNR = " & Val(cSuch) & " "
        cSQL = cSQL & " and ( ARTIKEL.SYNSTATUS is null or ARTIKEL.SYNSTATUS = 'E' or ARTIKEL.SYNSTATUS = 'A' ) "
        If gbkassgefuehrt Then
            cSQL = cSQL & " and gefuehrt = 'J'"
        End If
        
        If gbMitPreis Then
            If IstDasEineWGNforKasse(cSuch) = False Then
                If cZeitschriftenean = "" Then
                    cSQL = cSQL & " and kvkpr1 > 0 "
                End If
            End If
        End If
        FnOpenrecordset rsrs, cSQL, 1, gdBase
        
        If Not rsrs.EOF Then
            bgefunden = True
            rsrs.MoveFirst
            If Not IsNull(rsrs!artnr) Then
                cArtNr = rsrs!artnr
            Else
                cArtNr = ""
            End If
            cArtNr = Trim$(cArtNr)
            
            If Not IsNull(rsrs!BEZEICH) Then
                cArtBez = rsrs!BEZEICH
            Else
                cArtBez = ""
            End If
            cArtBez = Trim$(cArtBez)
            
            If Not IsNull(rsrs!ekpr) Then
                dEkpr = rsrs!ekpr
            Else
                dEkpr = 0
            End If
            
            Select Case Val(Label8(3).Caption)
                Case Is = 0
                    If dFotopreis = 0 Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dPreis = rsrs!KVKPR1
                        Else
                            dPreis = 0
                        End If
                    Else
                        dPreis = dFotopreis
                        dFotopreis = 0
                    End If
                Case Is = 1
                    If Not IsNull(rsrs!vkpr) Then
                        dPreis = rsrs!vkpr
                    Else
                        dPreis = 0
                    End If
                Case Is = 2 'Listeneinkaufspreis
                    'Achtung aufgepasst - jetzt den größten aus der Artlief nehmen
                    
                    dPreis = ermMaxLEKPR(cArtNr)
                    
                    If dPreis = 0 Then
                    
                        If Not IsNull(rsrs!lekpr) Then
                            dPreis = rsrs!lekpr
                        Else
                            dPreis = 0
                        End If
                    End If
                Case Is = 3
                    If Not IsNull(rsrs!ekpr) Then
                        dPreis = rsrs!ekpr
                    Else
                        dPreis = 0
                    End If
                Case Is = 4 'Spez kvk
                    dPreis = LeseSpezpreis(CLng(rsrs!artnr), 0)
                    If dPreis = 0 Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dPreis = rsrs!KVKPR1
                        Else
                            dPreis = 0
                        End If
                    End If
                    
                Case Is = 5 'lvk m A
                    If rsrs!RABATT_OK = "N" Then
                        If Not IsNull(rsrs!KVKPR1) Then
                            dPreis = rsrs!KVKPR1
                        Else
                            dPreis = 0
                        End If
                    Else
                        If Not IsNull(rsrs!vkpr) Then
                            dPreis = rsrs!vkpr
                        Else
                            dPreis = 0
                        End If
                    End If
                Case Is = 6 'Netto-KVK
                    If Not IsNull(rsrs!KVKPR1) Then
                        dPreis = rsrs!KVKPR1
                    Else
                        dPreis = 0
                    End If
            End Select
            
            dPreis = Format(dPreis, "#####0.00")
            
            
            If gsQMPreis <> "" Then
                dListenPreis = CDbl(gsQMPreis)
                dKassenVk = CDbl(gsQMPreis)
            Else
                dListenPreis = dPreis
                dKassenVk = dPreis
            End If
            
            
            
            
            If Not IsNull(rsrs!MWST) Then
                cMWStKz = rsrs!MWST
            Else
                cMWStKz = "V"
            End If
        
            If Not IsNull(rsrs!BESTAND) Then
                dBestand = rsrs!BESTAND
            Else
                dBestand = 0
            End If
            
            If Not IsNull(rsrs!RABATT_OK) Then
                cRabattOk = rsrs!RABATT_OK
            Else
                cRabattOk = "N"
            End If
            
            If Not IsNull(rsrs!BONUS_OK) Then
                cBonusOk = rsrs!BONUS_OK
            Else
                cBonusOk = "J"
            End If
            
            If cBonusOk = "J" Then 'Hier die Frage nach spez Bonusregeln
                If gbKUBONUS_WENN = False Then
                
                    If gsiKUBONUS_SCHWELLE > 0 Then
                    
                        'Nun, ist der kvk um x% kleiner als der LVK dann kein Bonus
                        
                        Dim dKVK_Boni As Double
                        Dim dLVK_Boni As Double
                        Dim dErg_Boni As Double
                        
                        dKVK_Boni = 0
                        dLVK_Boni = 0
                        
                        If Not IsNull(rsrs!KVKPR1) Then
                            dKVK_Boni = rsrs!KVKPR1
                        End If
                    
                        If Not IsNull(rsrs!vkpr) Then
                            dLVK_Boni = rsrs!vkpr
                        End If
                        
                        If dLVK_Boni > 0 Then
                            dErg_Boni = 100 - ((dKVK_Boni * 100) / dLVK_Boni)
                            If dErg_Boni >= gsiKUBONUS_SCHWELLE Then
                                cBonusOk = "N"
                            End If
                        End If
                    End If
                End If
            End If
            
            If Not IsNull(rsrs!UMS_OK) Then
                cUmsOK = rsrs!UMS_OK
            Else
                cUmsOK = "J"
            End If
            
            If Not IsNull(rsrs!AWM) Then
                byAWM = Val(rsrs!AWM)
            Else
                byAWM = 0
            End If
        Else
            bgefunden = False
        End If
        rsrs.Close: Set rsrs = Nothing
        
        If bgefunden = False Then
            anzeige "Artikel", "Artikel nicht gefunden!", Label27
            Text1(1).Text = "nicht gefunden"
            Frame26.Visible = True
            
            Exit Sub
        End If
        

        If gbKASSMBEST Then
            If IstDasEineWGN(CLng(cArtNr)) = False Then
                If dBestand <= 0 Then
                    anzeige "Artikel", "Artikel hat keinen Bestand", Label27
                    Exit Sub
                End If
            End If
        End If
        '*****************************************************************************************************
        '* Folgende Informationen werden in der Listbox-Zeile festgehalten:
        '*
        '* ANZAHL               (Format 5.0)    (Menge der verkauften Artikel)
        '* RABATTFÄHIG          (* oder Blank)  (Verlust Rabattfähigkeit durch DBF/Sonderpreis/ArtRabatt)
        '* ARTNR                (Format 6.0)    (Artikelnummer)
        '* ARTIKELBEZ.          (35 Zeichen)    (Artikelbezeichnung)
        '* EINZELPREIS          (Format 6.2)    (Preis, zu dem der Kunde kauft)
        '* GESAMTPREIS          (Format 6.2)    (Preis der Position, zu dem der Kunde kauft)
        '* MWST-KZ              (1 Zeichen)     (Mehrwertsteuer [V]oll, [E]rmäßigt, [O]hne)
        '* LISTEN/SONDERPREIS   (Format 6.2)    (Preis je Stück laut DBF oder Sonderpreis)
        '* ERM. BEI ARTERM      (Format 6.2)    (Ermäßigungsbetrag bei ArtRabatt)
        '* ERZIELTER VK-PREIS   (Format 6.2)    (echter VK-Preis, z.B. nach Gesamtrabatt)
        '* MWST-BETRAG VOLL     (Format 6.2)    (MWSt-Betrag bei voller MWSt)
        '* MWST-BETRAG ERM      (Format 6.2)    (MWSt-Betrag bei erm. MWSt)
        '* ART-RABATT IN PROZ   (Format 3.0)    (Artikel-Rabatt)
        '* VK-PREIS             (Format 6.2)    (Kassen-VK laut Datenbank)
        '* RESTBESTAND          (Format 6.0)    (Artikelbestand nach Verkauf)
        '* BEDIENER-NR          (Format 3.0)    (Bediener-Nr des Artikelverkaufes)
        '* RABATTFÄHIG LT. DBF  (Format 1.0)    (Rabatt_Ok laut Datenbank)
        '* BONUS_OK             (Format J/N)    (Bonus_Ok laut Datenbank)
        '* UMSATZ_OK            (Format J/N)    (Umsatz_Ok laut Datenbank)
        '* ZEITSCHRIFTEN-ID     (Format 18.0)   (Zeitschriften-Kennung)
        '*
        '*****************************************************************************************************
        
        If List1.ListCount = 0 Then
        
            'nur Anzeige
            HoleNeueBonNrWKL20
            Label18.Caption = gdBonNr
            Label18.Refresh
        End If
        
        '**************************************************************
        '* Bei Verkauf zu Netto wird die MWSt abgerechnet
        '**************************************************************
        If giPreisKz = 6 Then
            If cMWStKz = "V" Then
                dListenPreis = dListenPreis * 100 / (100 + gdMWStV)
                dKassenVk = dListenPreis
            End If
            If cMWStKz = "E" Then
                dListenPreis = dListenPreis * 100 / (100 + gdMWStE)
                dKassenVk = dListenPreis
            End If
            cMWStKz = "O"
'            cUmsOK = "N"
        End If
    
    
        '**************************************************************
        '* Bei Verkauf zum EK-Preis wird die MWSt aufgeschlagen
        '**************************************************************
        If giPreisKz > 1 And giPreisKz < 4 Then
            If cMWStKz = "V" Then
                dListenPreis = dListenPreis * (1 + (gdMWStV / 100))
                dKassenVk = dListenPreis
            End If
            If cMWStKz = "E" Then
                dListenPreis = dListenPreis * (1 + (gdMWStE / 100))
                dKassenVk = dListenPreis
            End If
        End If
    
        '************************************************************
        '* Nun steht der Stückpreis gemäß ARTIKEL.DBF fest
        '************************************************************
        
        'neu mit gerundetem Wert weiter 22.08.2016
'        dEinzelPreis = dListenPreis
        
        dEinzelpreis = Round(dListenPreis, 2)
        
        
        
        
        If Label2(0).Visible Then
            '***************************
            '* Sonderpreis wurde gesetzt
            '***************************
            dEinzelpreis = dSonderPreis
            dListenPreis = dSonderPreis
            '*******************************************
            '* Sonderpreise sind nicht rabattierfähig!
            '*******************************************
            If gbWarenGruppe Then
            
            
            
            Else
            
            
                '*******************************************
                '* Sonderpreise sind rabattierfähig, wenn unter Voreinstellung eingestellt
                '*******************************************
                If gbSondRab Then
                     cRabattOk = "J"
                Else
                    cRabattOk = "N"
                End If
                
            End If
            
            
        Else
            '***********************************************
            '* Kein Sonderpreis, also gilt der Listenpreis
            '***********************************************
            dSonderPreis = dListenPreis
        End If
        
        
        If gbJBTART = True And gsiGESRAB > 0 Then
        
            'ist es eine aktiver Terminpreisartikel und jubirab ist gesetzt, dann
            If IstDasEinAktiverTerminArtikel(CLng(cArtNr)) = True Then
                cRabattOk = "J"
            End If

            
        End If
        
        '************************************************************
        '* Jetzt prüfen, ob irgendein Rabatt geschaltet wurde
        '************************************************************
        
        If cRabattOk <> "N" Then
            If Label2(1).Visible Then
                dEinzelpreis = dEinzelpreis * ((100 - dArtRab) / 100)
                dErmWert = (dMenge * dSonderPreis) - (dMenge * dEinzelpreis)
            Else
                dEinzelpreis = dEinzelpreis * ((100 - dGesrab) / 100)
            End If

        End If
        
        '********Hier können Rabatte gewährt werden auch auf Artikel, die das
        '********Rabattkennzeichen "N" haben wenn in der Kundendatei im Feld Merkmal "ø" (alt 155)
        If Label1(7).Visible = False Then
            gbMerkmal = False
        End If
        
        If UCase(cRabattOk) = "N" Then
            If gbMerkmal Then
                If Label2(1).Visible Then
                    dEinzelpreis = dEinzelpreis * ((100 - dArtRab) / 100)
                    dErmWert = (dMenge * dSonderPreis) - (dMenge * dEinzelpreis)
                Else
                    dEinzelpreis = dEinzelpreis * ((100 - dGesrab) / 100)
                End If
            End If
        End If
        
        
        'Neu 04.11.2016 Für coslive Fil 20
        dEinzelpreis = Round(dEinzelpreis, 2)
        
        
        dGesamtPreis = dEinzelpreis * dMenge
        
        'MENGE
        cFeld = Format$(dMenge, "####0")
        cFeld = Space$(5 - Len(cFeld)) & cFeld
        cLBSatz = cFeld
        
        If Label1(18).Visible = True Then
            cLBSatz = cLBSatz & "p"
        Else
            If cRabattOk = "J" Then
                If dArtRab > 0 Then
                    cLBSatz = cLBSatz & "*"
                Else
                    cLBSatz = cLBSatz & " "
                End If
            Else
                cLBSatz = cLBSatz & "*"
            End If
        End If
        
        'ARTIKELNUMMER
        cFeld = cArtNr
        cFeld = Space$(6 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        Bildzeigen cArtNr, Image2, Picture2, 100
        
        'Handelsspanne anzeigen
        '1. mit dem größten LEK ,Shape1 und Label15(3)
        
        '2. mit dem kleinsten LEK, Shape2 und Label15(4)
        
        If gbHandelsspanne_Ausblenden = False Then
            Handelsspanne_anzeigen cArtNr, cMWStKz, CStr(dEinzelpreis)
        End If
        
        'ARTIKELBEZEICHNUNG
        cFeld = cArtBez
        
        If cZeitschriftenean <> "" Then
            If cFeld = "ZEITSCHRIFTEN" Then
                cFeld = cFeld & " " & cZeitschriftenean
            Else
                cFeld = Left(cFeld, 16) & Space(19 - Len(cZeitschriftenean)) & cZeitschriftenean
            End If
        End If
'        MsgBox Len(cFeld)
        
        
        
        If gsQMBez <> "" Then
            cFeld = Left(cFeld, 25) & Space(10 - Len(gsQMBez & " qm")) & gsQMBez & " qm"
        Else
            cFeld = cFeld & Space$(35 - Len(cFeld))
        End If
        cLBSatz = cLBSatz & cFeld & " "

        cZeile1 = Left(cFeld, 20)
        
        
        
        
        
        
        If gdCheckPreis > 0 Then
        
        
            If glRRArtnr > 0 Then
            
            ElseIf glBonusGrenzeArtnr = CLng(cArtNr) Then
            
            ElseIf glLieblingArtnr = CLng(cArtNr) Then
            
            ElseIf glZehnProzArtnr = CLng(cArtNr) Then
            
                
''                Text1(1).Text = CStr(glLieblingAR)
''                'und Taste Artrab drücken
''                Command1_Click 4
''                gbArtrabhaltenLiebling = True
'''                Text1(1).SetFocus
            
            
            Else
                If dEinzelpreis < gdCheckPreis Then
                    If IstDasEineWGNforKasse(cArtNr) = False Then
                        Frame30.Visible = True
                        Frame30.ZOrder 0
                    End If
                End If
            End If
            
            
        End If
        
        
        
        If glLieblingArtnr = CLng(cArtNr) Then
        
            Text1(1).Text = CStr(glLieblingAR)
            'und Taste Artrab drücken
            Command1_Click 4
            gbArtrabhaltenLiebling = True

        End If
        
        
        
        
        
        
        
        'Achtung Änderung für Schlanstein am 05.09.07 dritte Nachkommastelle
        'EINZELPREIS NACH RABATT
        'Achtung zurückgeändert am 04.03.14
'        cFeld = Format$(dEinzelPreis, "#####0.00")
        cFeld = Format$(dEinzelpreis, "#####0.000")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'GESAMTPREIS AUS EINZELPREIS x MENGE
        cFeld = Format$(dGesamtPreis, "#####0.00")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & "   "
        
        cZeile2 = gcWaehrung & " " & Trim$(cFeld)
        cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
        
        'MWST-KENNZEICHEN
        cFeld = cMWStKz
        cLBSatz = cLBSatz & cFeld & " "
                
        'LISTENPREIS bzw. SONDERPREIS
        cFeld = Format$(dSonderPreis, "#####0.00")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
                
        'ERMAESSIGNUNGSBETRAG BEI ARTIKELRABATT
        cFeld = Format$(dErmWert, "#####0.00")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'ERZIELTER VERKAUFSPREIS
        dVerkaufsPreis = dGesamtPreis
        cFeld = Format$(dVerkaufsPreis, "#####0.00")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'BETRAG VOLLE MWST
        If cMWStKz = "V" Then
            dMWStV = (dGesamtPreis / (100 + gdMWStV)) * gdMWStV
        Else
            dMWStV = 0
        End If
        cFeld = Format$(dMWStV, "#####0.00")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'BETRAG ERMÄSSIGTE MWST
        If cMWStKz = "E" Then
            dMWStE = (dGesamtPreis / (100 + gdMWStE)) * gdMWStE
        Else
            dMWStE = 0
        End If
        cFeld = Format$(dMWStE, "#####0.00")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'ARTIKELRABATT IN PROZENT
        cFeld = Format$(dArtRab, "##0")
        cFeld = Space$(3 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'VERKAUFSPREIS LAUT ARTIKELDATEI
        cFeld = Format$(dKassenVk, "#####0.00")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'BESTAND nach Verkauf
       
        iCheck = 1
        '1.SucheArtikel Plus und Minus möglich
        dRestMenge = fnAktualisiereBestandWKL20(cArtNr, dMenge, 1)
        
        cFeld = Format$(dRestMenge, "########0")
        cFeld = Space$(9 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        Dim cBedienernummer As String
        
        'BEDIENER-NUMMER
        cFeld = Text1(0).Text
        cFeld = Trim$(cFeld)
        cBedienernummer = cFeld
        cFeld = Space$(3 - Len(cFeld)) & cFeld
        cLBSatz = cLBSatz & cFeld & " "
        
        'RABATT-fähig
        If cRabattOk = "J" Then
            cLBSatz = cLBSatz & "0 "
        Else
            cLBSatz = cLBSatz & "1 "
        End If
        
        'BONUS-fähig
        'ist der Artikel bonusfähig? wird der Kundenbonus erhöht? das kann sich hier aufgrund einer Voreinstellung ändern
        If gbNoKUBONUS_wenn_Art_and_Ges_rab = True And (dArtRab > 0 Or dGesrab > 0) Then
            cBonusOk = "N"
        End If
        
        cLBSatz = cLBSatz & cBonusOk & " "
        
        'UMS_OK
        cLBSatz = cLBSatz & cUmsOK & " "
        
        'Zeitschriften-ID
        If gb28 = True Then
            cExtend = "Fleischerbon"
            cExtend = cExtend & Space$(18 - Len(cExtend))
            gb28 = False
        End If
        cLBSatz = cLBSatz & cExtend
        
        
        'Grund.cfg
        Dim cpfaddb As String

        cpfaddb = gcDBPfad
        If Right$(cpfaddb, 1) <> "\" Then
            cpfaddb = cpfaddb & "\"
        End If

        If FileExists(cpfaddb & "Grund.cfg") Then
            cLBSatz = cLBSatz & "@Q" & sWaswarSuchString
        End If
        'Ende Grund.cfg
        
        
        List1.AddItem cLBSatz
        List3.Nodes.Add Text:=Left(cLBSatz, 68)
        List3.Nodes(List3.Nodes.Count).EnsureVisible
        
        
        
        
        '''''''' Oliver Alte TSE START
'        If List1.ListCount = 1 Then
'            'TSE Start
'            TSS.Start WinsockTSE
'
'        End If
        '''''''' Oliver Alte TSE ENDE
         
        If gsJUGENDSCHUTZFARBE <> "" Then
            If CStr(byAWM) = gsJUGENDSCHUTZFARBE Then
            
            
            
                Dim yearAngabe As Integer
                yearAngabe = Year(Now) - 18
                anzeige "JUGENDSCHUTZ", "Volljährig bei Geburt vor " & Format(DateValue(Now) + 1, "dd.mm.") & yearAngabe, Label27
'                anzeige "JUGENDSCHUTZ", "Wann sind Sie geboren?", Label27
            End If
        End If
        
        
        If gsFARBKASSE = "1" Then
        
        
            If byAWM < 10 And byAWM > 0 Then
                List3.Nodes(List3.Nodes.Count).BackColor = glfarbe(byAWM)
                List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
            End If
            
            If byAWM < 20 And byAWM > 10 Then
                List3.Nodes(List3.Nodes.Count).BackColor = glfarbe2(byAWM - 10)
                List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
            End If
            
            If byAWM = 98 Then
                List3.Nodes(List3.Nodes.Count).ForeColor = vbRed
            End If
            If byAWM = 95 Then
                List3.Nodes(List3.Nodes.Count).BackColor = vbBlue
                List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
            End If
            
            If byAWM = 94 Then
                List3.Nodes(List3.Nodes.Count).BackColor = vbWhite
                List3.Nodes(List3.Nodes.Count).ForeColor = vbBlue
            End If
            
            If byAWM = 93 Then
                List3.Nodes(List3.Nodes.Count).BackColor = vbWhite
                List3.Nodes(List3.Nodes.Count).ForeColor = vbGreen
            End If
            
            If byAWM = 92 Then
                List3.Nodes(List3.Nodes.Count).BackColor = vbBlack
                List3.Nodes(List3.Nodes.Count).ForeColor = vbWhite
            End If
        
        ElseIf gsFARBKASSE = "2" Then
            
            Dim lFarbcode As Long
            Dim lFarbe As Long

            cSQL = "Select * from BEDTERM where bednu =  " & cBedienernummer
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                If Not IsNull(rsrs!FARBCODE) Then
                    lFarbcode = rsrs!FARBCODE
                Else
                    lFarbcode = 0
                End If
                Select Case lFarbcode
                    Case Is = 0
                        lFarbe = &H404040    'vbBlack
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbWhite
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                    Case Is = 1
                        lFarbe = vbRed
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                    Case Is = 2
                        lFarbe = vbGreen
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 3
                        lFarbe = vbYellow
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 4
                        lFarbe = vbBlue
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbWhite
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 5
                        lFarbe = vbMagenta
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 6
                        lFarbe = vbCyan
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 7
                        lFarbe = vbWhite
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                        
                    Case Is = 8
                        lFarbe = &HC0C0FF
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 9
                        lFarbe = &H40C0&
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbWhite
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 10
                        lFarbe = &H80C0FF 'Apricot
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                    Case Is = 11
                        lFarbe = &HFF8080 '&H80000003 'Hellblau
                        List3.Nodes(List3.Nodes.Count).ForeColor = vbBlack
                        List3.Nodes(List3.Nodes.Count).BackColor = lFarbe
                        
                End Select
            End If
            rsrs.Close: Set rsrs = Nothing
    
        
        End If
        
        
        
        
        
        
        If BistDuEinSonderkontingent(cArtNr) Then
            List3.Nodes(List3.Nodes.Count).BackColor = glfarbe(0)
'            frmWKL20.List3.Nodes(i).ForeColor = vbRed
        End If
        
        'moni
        If bsend = True Then
            senddata Mid(cLBSatz, 14, 50)
        End If
        
        '********************************************************
        '* Anzeige des Vorgangs auf dem Kundendisplay           *
        '********************************************************
        gbAutomaticClick = True
        List1.Selected(List1.ListCount - 1) = True

        If bDebug Then
            MsgBox Len(cLBSatz) & vbCrLf & cLBSatz
            MsgBox "Menge = " & Mid(cLBSatz, 1, 5)
            MsgBox "ArtNr = " & Mid(cLBSatz, 7, 6)
            MsgBox "Bezeich = " & Mid(cLBSatz, 14, 35)
            MsgBox "EPreis nach Rabatt = " & Mid(cLBSatz, 50, 9)
            MsgBox "GPreis = " & Mid(cLBSatz, 60, 9)
            MsgBox "MWST-Kz = " & Mid(cLBSatz, 72, 1)
            MsgBox "Listenpreis/Sonderpreis = " & Mid(cLBSatz, 74, 9)
            MsgBox "Betrag ArtRabatt = " & Mid(cLBSatz, 84, 9)
            MsgBox "erzielter VK-Preis = " & Mid(cLBSatz, 94, 9)
            MsgBox "Betrag volle MWST = " & Mid(cLBSatz, 104, 9)
            MsgBox "Betrag erm. MWST = " & Mid(cLBSatz, 114, 9)
            MsgBox "ArtRabatt % = " & Mid(cLBSatz, 124, 3)
            MsgBox "Listen-VK = " & Mid(cLBSatz, 128, 9)
            MsgBox "Restmenge = " & Mid(cLBSatz, 138, 9)
        End If
        
        BerechneZwischenSummeWKL20
        Dim len1 As Byte
        Dim len2 As Byte
        
        len1 = Len(Trim(cZeile2))
        len2 = Len(Trim(Label2(6).Caption))
        
        If gbKDEXM = True Then
            cZeile2 = CStr(dMenge) & " x " & Format$(dEinzelpreis, "#####0.00") & " " & gcWaehrung
        Else
            If len1 + len2 > 17 Then
                cZeile2 = "ZS " & Label2(6).Caption
            Else
                cZeile2 = Trim(cZeile2) & Space(20 - len1 - len2 - 3) & "ZS " & Label2(6).Caption
            End If
        End If
        
        ZeigeKundenDisplay cZeile1, cZeile2, cLBSatz, Label2(6).Caption
        

    
        Ready4NextInputWKL20
        Text1(1).SetFocus
        
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ArtikelAnDerKasseAnzeigen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
'    Resume Next
    
End Sub
Private Sub HandelsspanneWarenkorb_anzeigen(ShapeX As Shape, labelx As Label)
On Error GoTo LOKAL_ERROR

    ShapeX.Visible = False
    labelx.Caption = ""

    Dim lAnz                    As Long
    Dim lcount                  As Long
    Dim cLBSatz                 As String
    
    Dim sKVKPR                  As String
    Dim lartnr                  As Long
    Dim sMWST                   As String
    Dim sEK                     As String
    Dim dNettospanne            As Double
    
    Dim sSumKVKPR               As String
    Dim lMenge                  As Long
    Dim ctmp                    As String
    
    Dim dNettoertragV           As Double
    Dim dNettoertragE           As Double
    Dim dNettoertragO           As Double
    
    Dim dNettoKVKSummeV         As Double
    Dim dNettoKVKSummeE         As Double
    Dim dNettoKVKSummeO         As Double
    
    Dim dNettoertragGesamt      As Double
    Dim dGesamtKVKSUmmeNetto    As Double
    
    
    
    dNettoertragV = 0
    dNettoertragE = 0
    dNettoertragO = 0
    
    dNettoKVKSummeV = 0
    dNettoKVKSummeE = 0
    dNettoKVKSummeO = 0

    dNettoertragGesamt = 0
    dGesamtKVKSUmmeNetto = 0
    
    Dim dNettoertragGesamtG      As Double
    Dim dGesamtKVKSUmmeNettoG         As Double
    
    dNettoertragGesamtG = 0
    dGesamtKVKSUmmeNettoG = 0
    
    lAnz = List1.ListCount
    For lcount = 0 To lAnz - 1
    
        dNettoertragV = 0
        dNettoertragE = 0
        dNettoertragO = 0
    
    
        dNettoKVKSummeV = 0
        dNettoKVKSummeE = 0
        dNettoKVKSummeO = 0
    
        cLBSatz = List1.list(lcount)
        
        If Left(cLBSatz, 1) = "x" Then
            ctmp = Mid(cLBSatz, 2, 4)
        Else
            ctmp = Mid(cLBSatz, 1, 5)
        End If

        ctmp = Trim$(ctmp)
        ctmp = fnMoveComma2Point$(ctmp)
        lMenge = Val(ctmp)
            
        lartnr = CLng(Trim$(Mid(cLBSatz, 7, 6)))
        sSumKVKPR = Trim(Mid(cLBSatz, 60, 9))
        
        sKVKPR = Trim(Mid(cLBSatz, 50, 9))
        sMWST = Mid(cLBSatz, 72, 1)
        
        sEK = ermittleEKforSpanne(lartnr, sKVKPR, sMWST)
        
        
        
        
        
        
        
        
        
        
        
        Select Case sMWST
            Case Is = "V"
                dNettoertragV = dNettoertragV + CDbl(NettoErtrag(sSumKVKPR, CDbl(sEK) * lMenge, sMWST))
                dNettoKVKSummeV = (CDbl(sSumKVKPR) * 100) / (100 + gdMWStV)
                
            Case Is = "E"
                dNettoertragE = dNettoertragE + CDbl(NettoErtrag(sSumKVKPR, CDbl(sEK) * lMenge, sMWST))
                dNettoKVKSummeE = (CDbl(sSumKVKPR) * 100) / (100 + gdMWStE)
            Case Is = "O"
                dNettoertragO = dNettoertragO + CDbl(NettoErtrag(sSumKVKPR, CDbl(sEK) * lMenge, sMWST))
                dNettoKVKSummeO = (CDbl(sSumKVKPR) * 100) / 100
        End Select
            
        dNettoertragGesamt = dNettoertragV + dNettoertragE + dNettoertragO
        dGesamtKVKSUmmeNetto = dNettoKVKSummeV + dNettoKVKSummeE + dNettoKVKSummeO
        
        dNettoertragGesamtG = dNettoertragGesamtG + dNettoertragGesamt
        dGesamtKVKSUmmeNettoG = dGesamtKVKSUmmeNettoG + dGesamtKVKSUmmeNetto
    
    Next lcount
    
    If lAnz > 0 Then
    
        If dGesamtKVKSUmmeNettoG <> 0 Then
            dNettospanne = (dNettoertragGesamtG * 100) / dGesamtKVKSUmmeNettoG
        Else
            dNettospanne = 0
        End If
    
        Dim sTooltext As String
        
        sTooltext = "Nettospanne: " & Format(dNettospanne, "###,##0.00") & "%" & vbCrLf
        sTooltext = sTooltext & " Nettoertrag: " & Format(dNettoertragGesamtG, "###,##0.00") & "" & vbCrLf
        
        If gsSpanne = "LEK" Then
            sTooltext = sTooltext & " Basis: Listen-EK: "
        ElseIf gsSpanne = "SEK" Then
            sTooltext = sTooltext & " Basis: Schnitt-EK: "
        End If
        
        Dim sNettospanne As String
        sNettospanne = Format(dNettospanne, "###,##0.00")
        dNettospanne = CDbl(sNettospanne)
        
        labelx.Caption = Fix(dNettospanne)
        labelx.ToolTipText = sTooltext
        
        If dNettospanne >= 100 Then
            ShapeX.BackColor = &H8000&
        ElseIf dNettospanne > 79.99 Then
            ShapeX.BackColor = &HC000&
        ElseIf dNettospanne > 59.99 Then
            ShapeX.BackColor = &HFF00&
        ElseIf dNettospanne > 39.99 Then
            ShapeX.BackColor = &HFFFF&
        ElseIf dNettospanne > 19.99 Then
            ShapeX.BackColor = &H80C0FF
        ElseIf dNettospanne > 0 Then
            ShapeX.BackColor = &H80FF&
        ElseIf dNettospanne <= 0 Then
            ShapeX.BackColor = &HFF&
        End If
        
        ShapeX.Visible = True
        
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "HandelsspanneWarenkorb_anzeigen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
'    Resume Next
End Sub
Private Function ermittleEKforSpanne(lartnr As Long, sKVK As String, cMWST As String) As String
On Error GoTo LOKAL_ERROR

    ermittleEKforSpanne = "0"
    
    Dim sSQL As String
    Dim rsrs As DAO.Recordset
    Dim sEKpr As String
    
    Dim dSpanne As Double
    dSpanne = 0
    
    
    If gsSpanne = "LEK" Then

        'größten LEK suchen
        sSQL = "Select max(lekpr) as maxLek from artlief where artnr = " & lartnr
        Set rsrs = gdBase.OpenRecordset(sSQL)
        If Not rsrs.EOF Then
            sEKpr = "0"
            If Not IsNull(rsrs!maxLek) Then
                sEKpr = rsrs!maxLek
            End If
        End If
        rsrs.Close
        
        If sEKpr = "0" Then
            If lartnr = 666668 Or lartnr = 666669 Then
                If gdZeitungsSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(gdZeitungsSpanne, CDbl(sKVK), cMWST))
                End If
            Else
            
                dSpanne = ermSpanne(lartnr)
                If dSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(dSpanne, CDbl(sKVK), cMWST))
                End If
            End If
        End If
        
        If lartnr = 666668 Or lartnr = 666669 Then
            If gdZeitungsSpanne <> 0 Then
                Exit Function
            End If
        End If
        
    ElseIf gsSpanne = "SEK" Then
    
        'SEK suchen
        
        sEKpr = "0"
        sSQL = "Select EKPR as SEK from artikel where artnr = " & lartnr
        Set rsrs = gdBase.OpenRecordset(sSQL)
        If Not rsrs.EOF Then
            sEKpr = "0"
            If Not IsNull(rsrs!sEK) Then
                sEKpr = rsrs!sEK
            End If
        End If
        rsrs.Close
        
        If sEKpr = "0" Then
            If lartnr = 666668 Or lartnr = 666669 Then
                If gdZeitungsSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(gdZeitungsSpanne, CDbl(sKVK), cMWST))
                End If
            Else
                dSpanne = ermSpanne(lartnr)
                If dSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(dSpanne, CDbl(sKVK), cMWST))
                End If
            End If
        
        End If
    
    End If
    
    ermittleEKforSpanne = sEKpr
    

Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermittleEKforSpanne"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Function
Private Function ermSpanne(lartnr As Long) As Double
On Error GoTo LOKAL_ERROR

    ermSpanne = 0
    
    Dim sSQL As String
    Dim rsrs As DAO.Recordset
    
    sSQL = "Select Spanne from artikel where artnr = " & lartnr
    Set rsrs = gdBase.OpenRecordset(sSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!SPANNE) Then
            ermSpanne = rsrs!SPANNE
        End If
    End If
    rsrs.Close
        
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermSpanne"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Function

Private Sub Handelsspanne_anzeigen(sArt As String, cMWST As String, sKVK As String)
On Error GoTo LOKAL_ERROR

    'Handelsspanne anzeigen
    '1. mit dem größten LEK ,Shape1 und Label15(3)
    
    '2. mit dem kleinsten LEK, Shape2 und Label15(4)
    
    Dim sNettospanne    As String
    Dim dNettospanne    As Double
    Dim sKVKPR          As String
    Dim sEKpr           As String
    Dim sEKsql          As String
    
    
    Dim sSQL            As String
    Dim rsrs            As DAO.Recordset
    Dim sLiefBez        As String
    Dim bPrimLiVorhanden As Boolean
    
    Dim dSpanne         As Double
    
    dSpanne = 0
    
    bPrimLiVorhanden = False
    
    Shape1.Visible = False
    Shape2.Visible = False
    
    Label39(3).Caption = ""
    Label39(4).Caption = ""
    
    If gsSpanne = "LEK" Then
    
    
        If glPrimLinr > 0 Then
            'Gibt es diesen beim Prim Lief?
            sSQL = "Select * from artlief where artnr = " & sArt & " and linr = " & glPrimLinr
            Set rsrs = gdBase.OpenRecordset(sSQL)
            If Not rsrs.EOF Then
                bPrimLiVorhanden = True
            End If
            rsrs.Close
        
        End If

        'größten LEK suchen
        sSQL = "Select max(lekpr) as maxLek from artlief where artnr = " & sArt
        
        If bPrimLiVorhanden = True Then
            sSQL = sSQL & " and linr = " & glPrimLinr
        End If
        
        Set rsrs = gdBase.OpenRecordset(sSQL)
        If Not rsrs.EOF Then
            sEKpr = "0"
            If Not IsNull(rsrs!maxLek) Then
                sEKpr = rsrs!maxLek
            End If
        End If
        rsrs.Close
        
        If sEKpr = "0" Then
            If sArt = "666668" Or sArt = "666669" Then
                If gdZeitungsSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(gdZeitungsSpanne, CDbl(sKVK), cMWST))
                End If
            Else
            
                dSpanne = ermSpanne(CLng(sArt))
                If dSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(dSpanne, CDbl(sKVK), cMWST))
                End If
            
            
            
            End If
        
        End If
        
        sEKsql = SwapStr(sEKpr, ",", ".")
        
        sSQL = "Select linr from artlief where artnr = " & sArt & " and LEKPR = " & sEKsql
        Set rsrs = gdBase.OpenRecordset(sSQL)
        If Not rsrs.EOF Then
            
            sLiefBez = ""
            If Not IsNull(rsrs!linr) Then
                sLiefBez = ermLiefBez(CLng(rsrs!linr))
            End If
        End If
        rsrs.Close
        
        sNettospanne = NettospanneInProzent(sKVK, sEKpr, cMWST)
        dNettospanne = CDbl(sNettospanne)
        
        If dNettospanne >= 100 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
            Shape1.BackColor = &H8000&
        ElseIf dNettospanne > 79.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
            Shape1.BackColor = &HC000&
        ElseIf dNettospanne > 59.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
            Shape1.BackColor = &HFF00&
        ElseIf dNettospanne > 39.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
            Shape1.BackColor = &HFFFF&
        ElseIf dNettospanne > 19.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
            Shape1.BackColor = &H80C0FF
        ElseIf dNettospanne > 0 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
            Shape1.BackColor = &H80FF&
        ElseIf dNettospanne <= 0 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
            Shape1.BackColor = &HFF&
        End If
        
        Shape1.Visible = True
        
        
        If sArt = "666668" Or sArt = "666669" Then
            If gdZeitungsSpanne <> 0 Then
                Exit Sub
            End If
        End If
        
        
        If bPrimLiVorhanden = False Then
            'kleinsten LEK suchen
            sSQL = "Select min(lekpr) as minLek from artlief where artnr = " & sArt
            Set rsrs = gdBase.OpenRecordset(sSQL)
            If Not rsrs.EOF Then
                sEKpr = "0"
                If Not IsNull(rsrs!minLek) Then
                    sEKpr = rsrs!minLek
                End If
            End If
            rsrs.Close
            
            
'            If sEKpr = "0" Then
'                If sArt = "666668" Or sArt = "666669" Then
'                    If gdZeitungsSpanne <> 0 Then
'                        sEKpr = CStr(EKausNettospanneerrechnen(gdZeitungsSpanne, CDbl(sKVK), cMWST))
'                    End If
'                Else
'                    dSpanne = ermSpanne(CLng(sArt))
'                    If dSpanne <> 0 Then
'                        sEKpr = CStr(EKausNettospanneerrechnen(dSpanne, CDbl(sKVK), cMWST))
'                    End If
'                End If
'            End If
            
            sEKsql = SwapStr(sEKpr, ",", ".")
            
            sSQL = "Select linr from artlief where artnr = " & sArt & " and LEKPR = " & sEKsql
            Set rsrs = gdBase.OpenRecordset(sSQL)
            If Not rsrs.EOF Then
                
                sLiefBez = ""
                If Not IsNull(rsrs!linr) Then
                    sLiefBez = ermLiefBez(CLng(rsrs!linr))
                End If
            End If
            rsrs.Close
            
            sNettospanne = NettospanneInProzent(sKVK, sEKpr, cMWST)
            dNettospanne = CDbl(sNettospanne)
            
            If dNettospanne >= 100 Then
                Label39(4).Caption = Fix(dNettospanne)
                Label39(4).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
                Shape2.BackColor = &H8000&
            ElseIf dNettospanne > 79.99 Then
                Label39(4).Caption = Fix(dNettospanne)
                Label39(4).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
                Shape2.BackColor = &HC000&
            ElseIf dNettospanne > 59.99 Then
                Label39(4).Caption = Fix(dNettospanne)
                Label39(4).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
                Shape2.BackColor = &HFF00&
            ElseIf dNettospanne > 39.99 Then
                Label39(4).Caption = Fix(dNettospanne)
                Label39(4).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
                Shape2.BackColor = &HFFFF&
            ElseIf dNettospanne > 19.99 Then
                Label39(4).Caption = Fix(dNettospanne)
                Label39(4).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
                Shape2.BackColor = &H80C0FF
            ElseIf dNettospanne > 0 Then
                Label39(4).Caption = Fix(dNettospanne)
                Label39(4).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
                Shape2.BackColor = &H80FF&
            ElseIf dNettospanne <= 0 Then
                Label39(4).Caption = Fix(dNettospanne)
                Label39(4).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Listen-EK: " & Format(sEKpr, "###,##0.00") & " " & sLiefBez & ")"
                Shape2.BackColor = &HFF&
            End If
            
            If Label39(3).Caption <> Label39(4).Caption Then
                Shape2.Visible = True
                Label39(3).ToolTipText = "größter Listeneinkaufspreis = " & Label39(3).ToolTipText
                Label39(4).ToolTipText = "kleinster Listeneinkaufspreis = " & Label39(4).ToolTipText
            Else
                Label39(4).Caption = ""
            End If
        End If
        
    ElseIf gsSpanne = "SEK" Then
    
        'sek
        sSQL = "Select EKPR as SEK from artikel where artnr = " & sArt
        Set rsrs = gdBase.OpenRecordset(sSQL)
        If Not rsrs.EOF Then
            sEKpr = "0"
            If Not IsNull(rsrs!sEK) Then
                sEKpr = rsrs!sEK
            End If
        End If
        rsrs.Close
        
        If sEKpr = "0" Then
            If sArt = "666668" Or sArt = "666669" Then
                If gdZeitungsSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(gdZeitungsSpanne, CDbl(sKVK), cMWST))
                End If
            Else
                dSpanne = ermSpanne(CLng(sArt))
                If dSpanne <> 0 Then
                    sEKpr = CStr(EKausNettospanneerrechnen(dSpanne, CDbl(sKVK), cMWST))
                End If
            End If
        
        End If
        
        sNettospanne = NettospanneInProzent(sKVK, sEKpr, cMWST)
        dNettospanne = CDbl(sNettospanne)
        
        If dNettospanne >= 100 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Schnitt-EK: " & Format(sEKpr, "###,##0.00") & ")"
            Shape1.BackColor = &H8000&
        ElseIf dNettospanne > 79.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Schnitt-EK: " & Format(sEKpr, "###,##0.00") & ")"
            Shape1.BackColor = &HC000&
        ElseIf dNettospanne > 59.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Schnitt-EK: " & Format(sEKpr, "###,##0.00") & ")"
            Shape1.BackColor = &HFF00&
        ElseIf dNettospanne > 39.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Schnitt-EK: " & Format(sEKpr, "###,##0.00") & ")"
            Shape1.BackColor = &HFFFF&
        ElseIf dNettospanne > 19.99 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Schnitt-EK: " & Format(sEKpr, "###,##0.00") & ")"
            Shape1.BackColor = &H80C0FF
        ElseIf dNettospanne > 0 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Schnitt-EK: " & Format(sEKpr, "###,##0.00") & ")"
            Shape1.BackColor = &H80FF&
        ElseIf dNettospanne <= 0 Then
            Label39(3).Caption = Fix(dNettospanne)
            Label39(3).ToolTipText = "Nettospanne: " & sNettospanne & "% (Basis: Schnitt-EK: " & Format(sEKpr, "###,##0.00") & ")"
            Shape1.BackColor = &HFF&
        End If
        
        Shape1.Visible = True
    
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Handelsspanne_anzeigen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Bildzeigen(sArt As String, imgx As Image, PicX As PictureBox, iSize As Integer)
On Error GoTo LOKAL_ERROR

    Dim sPfad As String

    sPfad = gcDBPfad
    If Right(sPfad, 1) <> "\" Then
        sPfad = sPfad & "\"
    End If
    sPfad = sPfad & "PICTURE\ARTIKEL"
    
    If FileExists(sPfad & "\" & sArt & ".jpg") Then
        imgx.Picture = LoadPicture(sPfad & "\" & sArt & ".jpg")
    Else
        If FileExists(sPfad & "\" & "keinBild.jpg") Then
            imgx.Picture = LoadPicture(sPfad & "\" & "keinBild.jpg")
        Else
            PicX.Visible = False
            Exit Sub
        End If
    End If
    
    zeigImage_In_Picture_Kasse imgx, PicX, iSize
    PicX.Tag = sArt
    PicX.Visible = True
    
Exit Sub
LOKAL_ERROR:

    If err.Number = 481 Then
'        MsgBox "Diese Bild kann nicht gespeichert werden, ungültiges Dateiformat", vbInformation, "Winkiss Hinweis:"
        Kill sPfad & "\" & sArt & ".jpg"
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Bildzeigen"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
    
End Sub

Private Sub Kunden_Bildzeigen(sKund As String, imgx As Image, PicX As PictureBox, iSize As Integer, sKundenBilddatei As String)
On Error GoTo LOKAL_ERROR

    Dim sPfad As String
    Dim sBildname As String

    sPfad = gcDBPfad
    If Right(sPfad, 1) <> "\" Then
        sPfad = sPfad & "\"
    End If
    sPfad = sPfad & "PICTURE\KUNDEN"
    
    If FileExists(sPfad & "\" & sKundenBilddatei & ".jpg") Then
        imgx.Picture = LoadPicture(sPfad & "\" & sKundenBilddatei & ".jpg")
    Else
        
        Dim sGeschlecht As String
    
        sGeschlecht = lookingForKundendaten(sKund).geschlecht
        
        If UCase(sGeschlecht) = "W" Then
            sBildname = "keinBildw.jpg"
        ElseIf UCase(sGeschlecht) = "M" Then
            sBildname = "keinBildm.jpg"
        Else
            Dim sAnrede As String
    
            sAnrede = lookingForKundendaten(sKund).anrede
            
            If UCase(sAnrede) = "FRAU" Then
                sBildname = "keinBildw.jpg"
            ElseIf UCase(sAnrede) = "HERR" Then
                sBildname = "keinBildm.jpg"
            Else
                sBildname = "keinBildw.jpg"
            End If
        End If
        
        If FileExists(sPfad & "\" & sBildname) Then
            imgx.Picture = LoadPicture(sPfad & "\" & sBildname)
            PicX.Visible = True
        Else
            PicX.Visible = False
            Exit Sub
        End If
    
    
    
    
    
    
    End If
    
    zeigImage_In_Picture_Kasse imgx, PicX, iSize
    PicX.Tag = sKundenBilddatei
    PicX.Visible = True
    
Exit Sub
LOKAL_ERROR:

    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Kunden_Bildzeigen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub senddata(sData As String)
    On Error GoTo LOKAL_ERROR
'    moni
'    Winsock1.senddata sData
'
    Exit Sub
LOKAL_ERROR:
    If err.Number = 40006 Then
        bsend = False

    Else

        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "senddata"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

        Fehlermeldung1
    End If
End Sub
Private Sub formatgrd()
    On Error GoTo LOKAL_ERROR
    
    grd1.Clear
    
    grd1.Rows = 2
    grd1.Cols = 10
    grd1.FixedRows = 1
    grd1.FixedCols = 0
    
    grd1.Row = 0
    grd1.Col = 0
    grd1.Text = "Kundennr"
    grd1.ColWidth(0) = 1500
    
    grd1.Col = 1
    grd1.Text = "Kürzel"
    grd1.ColWidth(1) = 1500
    
    grd1.Col = 2
    grd1.Text = "Name"
    grd1.ColWidth(2) = 2800
    
    grd1.Col = 3
    grd1.Text = "Vorname"
    grd1.ColWidth(3) = 2000
    
    grd1.Col = 4
    grd1.Text = "Stadt"
    grd1.ColWidth(4) = 2800
    
    grd1.Col = 5
    grd1.Text = "Strasse"
    grd1.ColWidth(5) = 3500
    
    grd1.Col = 6
    grd1.Text = "Umsatz akt.Jahr"
    grd1.ColWidth(6) = 2500
    
    grd1.Col = 7
    grd1.Text = "Bonus"
    grd1.ColWidth(7) = 1500
    
    grd1.Col = 8
    grd1.Text = "Notizen"
    grd1.ColWidth(8) = 1500
    
    grd1.Col = 9
    grd1.Text = "Firma"
    grd1.ColWidth(9) = 1500
    
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "formatgrd"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Ready4NextInputWKL20()
    On Error GoTo LOKAL_ERROR
    
    'Sonderpreis
    Label1(1).Visible = False
    Label2(0).Caption = "0,00"
    Label2(0).Visible = False

    'Artikelrabatt
    If gbArtrabhalten = True Or gbArtrabhaltenLiebling = True Then
    
    Else
        Label1(2).Visible = False
        Label2(1).Caption = "0,00"
        Label2(1).Visible = False
        Label2(2).Visible = False
    End If
    
    'Menge
    Label2(5).Caption = "1"
    
    'Provision
    Label1(18).Visible = False
    
    Text1(1).Text = ""
    frmWKL20.Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Ready4NextInputWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SucheKundenKasseWKL20()
On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim i           As Integer
    Dim iRet        As Integer
    Dim cSQL        As String
    Dim cKuerzel    As String
    Dim cFeld       As String
    Dim cLBSatz     As String
    Dim ctmp        As String
    Dim cZeichen    As String
    
    Dim dUmsatz     As Double
    Dim dBonus      As Double
    Dim dUmsatzLJ   As Double
    Dim bAlphas     As Boolean
    Dim rsrs        As Recordset
    Dim lrow        As Long
    Dim cVorname    As String
    
    
    If Label1(27).Caption = "Karte/KdNr/Name" Then
    
        bAlphas = False
    
        cKuerzel = Text3(3).Text
        cKuerzel = Trim$(cKuerzel)
    
        For lcount = 1 To Len(cKuerzel)
            cZeichen = Mid(cKuerzel, lcount, 1)
            If InStr("1234567890", cZeichen) = 0 Then
                bAlphas = True
                Exit For
            End If
        Next lcount
    
        '2 x 2 Möglichkeiten:
        'a) nur Ziffern
        'aa) Wert kleiner als 1 Mio ---> KUNDNR
        'ab) Wert größer/gleich 1 Mio ---> KUNDKART
        'b) Alphas
        'ba) Länge > 5 ---> Kundennamen
        'bb) Länge <= 5 ---> Kürzel
        
        If bAlphas Then
            If Len(cKuerzel) <= 5 Then
                cSQL = "Select * from KUNDEN where (KUERZEL like '" & UCase$(cKuerzel) & "*')   and ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N')  "
            Else
                cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N' ) and NAME like '" & cKuerzel & "*' "
            End If
        Else
        
            If cKuerzel <> "" Then
                
            
                If Val(cKuerzel) < 10000000 Then
                    If Left(cKuerzel, 1) = "0" Then 'Point Rouge alle karten fangen mit Nullen 0000 an
                        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and  KUNDKART = '" & cKuerzel & "' "
                    Else
                        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and  KUNDNR = " & Trim$(Str$(Val(cKuerzel)))
                    End If
                Else
                    cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and  KUNDKART like '" & cKuerzel & "*' "
                End If
            Else
                cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') "
            End If
        End If
    
        cFeld = Label1(10).Tag
        cFeld = Trim$(cFeld)
        If cFeld <> "" Then
            cSQL = cSQL & " and AWM = '" & cFeld & "' "
        End If
        
        
        cVorname = Combo1.Text
        cVorname = Trim$(cVorname)
        
        If cVorname <> "" Then
            cSQL = cSQL & " and ucase(Vorname) like '" & UCase(cVorname) & "*' "
        End If
        
        If Check8.value = vbChecked Then
            cSQL = cSQL & " order by NAME, STRASSE, STADT, VORNAME"
        Else
        
            cSQL = cSQL & " order by KUERZEL, NAME, VORNAME, STADT "
        End If
        
    ElseIf Label1(27).Caption = "Strasse" Then
    
        cKuerzel = Text3(3).Text
        cKuerzel = Trim$(cKuerzel)
    
        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and Strasse like '" & cKuerzel & "*' "
    ElseIf Label1(27).Caption = "PLZ" Then
    
        cKuerzel = Text3(3).Text
        cKuerzel = Trim$(cKuerzel)
    
        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and PLZ like '" & cKuerzel & "*' "
    ElseIf Label1(27).Caption = "Firma" Then
    
        cKuerzel = Text3(3).Text
        cKuerzel = Trim$(cKuerzel)
    
        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and Firma like '" & cKuerzel & "*' "
        
    ElseIf Label1(27).Caption = "Ort" Then
    
        cKuerzel = Text3(3).Text
        cKuerzel = Trim$(cKuerzel)
    
        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and Stadt like '" & cKuerzel & "*' "
    ElseIf Label1(27).Caption = "Kundenkarte" Then
    
        cKuerzel = Text3(3).Text
        cKuerzel = Trim$(cKuerzel)
    
        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') and  KUNDKART like '" & cKuerzel & "*' "
    
    ElseIf Label1(27).Caption = "Telefon" Then
    
        cKuerzel = Text3(3).Text
        cKuerzel = Trim$(cKuerzel)
        
        cKuerzel = SwapStr(cKuerzel, " ", "*")
    
        cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N') "
        cSQL = cSQL & "and (Tel like '" & cKuerzel & "*' or Mobiltel like '" & cKuerzel & "*' )"
    
    
    
    End If
        
    lrow = 1
   
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveLast
        
        If rsrs.RecordCount > 1000 Then
            iRet = MsgBox("Es wurden mehr als 1000 Datensätze (" & rsrs.RecordCount & ") gefunden." & vbCrLf & "Wirklich anzeigen?", vbQuestion + vbYesNo, "Winkiss Frage:")
            If iRet = vbNo Then
                Exit Sub
            End If
        End If
        
        rsrs.MoveFirst
        grd1.Redraw = False
        Do While Not rsrs.EOF
        
            lrow = lrow + 1
            grd1.Rows = lrow + 1
            grd1.Row = lrow
            
            If Not IsNull(rsrs!Kundnr) Then
                cFeld = rsrs!Kundnr
                FaerbenFlexH WhatIsAwmKU(cFeld), grd1, 0, CInt(lrow)
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            grd1.Col = 0
            grd1.Text = cFeld
            
            dUmsatzLJ = umsatzLFJahr(cFeld) ' fnHoleJahresUmsatzWKL20(cFeld)

            If Not IsNull(rsrs!Kuerzel) Then
                cFeld = rsrs!Kuerzel
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            grd1.Col = 1
            grd1.Text = cFeld
            
            If Not IsNull(rsrs!name) Then
                ctmp = rsrs!name
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 2
            grd1.Text = ctmp
            
            cFeld = ctmp
            
            If Not IsNull(rsrs!vorname) Then
                ctmp = rsrs!vorname
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 3
            grd1.Text = ctmp
            
            If Not IsNull(rsrs!STADT) Then
                ctmp = rsrs!STADT
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 4
            grd1.Text = ctmp
            
            If Not IsNull(rsrs!strasse) Then
                ctmp = rsrs!strasse
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 5
            grd1.Text = ctmp
            
'            If Check8.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(5) = 0
'            End If
            
            dUmsatz = dUmsatzLJ
            cFeld = Format$(dUmsatz, "###,##0.00")
            grd1.Col = 6
            grd1.Text = cFeld
            
'            If Check1.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(6) = 0
'            End If
            
            If Not IsNull(rsrs!GESPERRT) Then
                cFeld = rsrs!GESPERRT
            Else
                cFeld = "N"
            End If
            
            If gbKUWAHLGESPERRTROT = True Then
            
                For i = 1 To 7
                    grd1.Col = i
                    If cFeld <> "N" Then
                        grd1.CellBackColor = vbRed
                    Else
                        grd1.CellBackColor = vbWhite
                    End If
                Next i
            End If
            
            If Not IsNull(rsrs!BONUS) Then
                dBonus = rsrs!BONUS
            Else
                dBonus = 0
            End If
            
            cFeld = Format$(dBonus, "#####0.00")
            
            grd1.Col = 7
            grd1.Text = cFeld
            
'            If Check7.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(7) = 0
'            End If
             
            If dBonus >= gdBonusGrenze Then
                If gbFILBONI = True Then
                    If Not IsNull(rsrs!FILIALNR) Then
                        If CInt(rsrs!FILIALNR) = CInt(gcFilNr) Then
                            grd1.CellBackColor = vbGreen
                        Else
                        
                        End If
                    End If
                Else
                    grd1.CellBackColor = vbGreen
                End If
            End If
            
            If Not IsNull(rsrs!NOTIZEN) Then
                ctmp = rsrs!NOTIZEN
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 8
            grd1.Text = ctmp
            
'            If Check11.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(8) = 0
'            End If
            
            If Not IsNull(rsrs!firma) Then
                ctmp = rsrs!firma
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 9
            grd1.Text = ctmp
            
'            If Check12.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(9) = 0
'            End If
            
            
            
            rsrs.MoveNext
        Loop
        
        grd1.RowHeight(1) = 0
        grd1.Redraw = True
        
        grd1.Col = 0
        grd1.Row = 1
        grd1.SetFocus
    Else
        MsgBox "Keine Daten gefunden!", vbInformation, "Winkiss Hinweis:"
    End If
    rsrs.Close: Set rsrs = Nothing
    
    Tabellenbreiteanpassen grd1, 1.7 * gdTabfak
    
    If Check8.value = vbUnchecked Then
        grd1.ColWidth(5) = 0
    End If
    
    If Check12.value = vbUnchecked Then
        grd1.ColWidth(9) = 0
    End If
    
    If Check11.value = vbUnchecked Then
        grd1.ColWidth(8) = 0
    End If
    
    If Check7.value = vbUnchecked Then
        grd1.ColWidth(7) = 0
    End If
    
    If Check1.value = vbUnchecked Then
        grd1.ColWidth(6) = 0
    End If
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    If lrow = 2 Then 'nur jetzt weiter
        glSelect = 2 'grd1.Row
        grd1.Col = 0
        grd1.Row = 2
        grd1.SetFocus
    End If
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SucheKundenKasseWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Tabellenbreiteanpassen(gridx As MSHFlexGrid, siEigFak As Single)
    On Error GoTo LOKAL_ERROR
    
    Dim siFak       As Single
    Dim bBreit()    As Long
    Dim i           As Integer
    Dim j           As Integer
    
    With gridx
    
        ReDim bBreit(.Cols - 1)
        
        For j = 0 To .Rows - 1
            For i = 0 To .Cols - 1
                If TextWidth(.TextMatrix(j, i)) > bBreit(i) Then
                    bBreit(i) = TextWidth(.TextMatrix(j, i))
                End If
            Next i
        Next j
        
        Select Case Screen.Height
            Case Is > 15000
                siFak = 1.5
            Case Is > 12000
                siFak = 1.4
            Case Is > 11000
                siFak = 1.2
            Case Is > 10000
                siFak = 1.1
            Case Is > 8000
                siFak = 1#
        End Select
        
        For i = 0 To .Cols - 1
            .ColWidth(i) = bBreit(i) * siFak * siEigFak
        Next i
    
    End With
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Tabellenbreiteanpassen"
    Fehler.gsFehlertext = "Beim Anpassen der Tabellenbreite ist ein Fehler aufgetreten."
    
    Fehlermeldung1
'    Resume Next
End Sub
Private Sub SucheKundenKasseWKL20Alphas(cKuerzel As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim i           As Integer
    Dim iRet        As Integer
    Dim cSQL        As String
    Dim cFeld       As String
    Dim cLBSatz     As String
    Dim ctmp        As String
    Dim cZeichen    As String
    
    Dim dUmsatz     As Double
    Dim dBonus      As Double
    Dim dUmsatzLJ   As Double
    Dim rsrs        As Recordset
    Dim lrow        As Long
    Dim cVorname    As String
    
    cSQL = "Select * from KUNDEN where ( SYNSTATUS is null or SYNSTATUS = 'E' or SYNSTATUS = 'A' or SYNSTATUS = 'N' ) and NAME like '" & cKuerzel & "*' "
       
    
    cFeld = Label1(10).Tag
    cFeld = Trim$(cFeld)
    If cFeld <> "" Then
        cSQL = cSQL & " and AWM = '" & cFeld & "' "
    End If
    
    cVorname = Combo1.Text
    cVorname = Trim$(cVorname)
    
    If cVorname <> "" Then
        cSQL = cSQL & " and ucase(Vorname) like '" & UCase(cVorname) & "*' "
    End If
    
    cSQL = cSQL & " order by KUERZEL, NAME, VORNAME, STADT "
    
    lrow = 1
    
    
   
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveLast
        
        If rsrs.RecordCount > 1000 Then
            iRet = MsgBox("Uppss..." & vbCrLf & "Es wurden mehr als 1000 Datensätze gefunden." & vbCrLf & "Wirklich anzeigen?", vbQuestion + vbYesNo, "Winkiss Frage:")
            If iRet = vbNo Then
                Exit Sub
            End If
        End If
        
        rsrs.MoveFirst
        grd1.Redraw = False
        Do While Not rsrs.EOF
        
            lrow = lrow + 1
            grd1.Rows = lrow + 1
            grd1.Row = lrow
            
            If Not IsNull(rsrs!Kundnr) Then
                cFeld = rsrs!Kundnr
                FaerbenFlexH WhatIsAwmKU(cFeld), grd1, 0, CInt(lrow)
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            grd1.Col = 0
            grd1.Text = cFeld
            
            dUmsatzLJ = umsatzLFJahr(cFeld) ' fnHoleJahresUmsatzWKL20(cFeld)

            If Not IsNull(rsrs!Kuerzel) Then
                cFeld = rsrs!Kuerzel
            Else
                cFeld = ""
            End If
            cFeld = Trim$(cFeld)
            grd1.Col = 1
            grd1.Text = cFeld
            
            If Not IsNull(rsrs!name) Then
                ctmp = rsrs!name
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 2
            grd1.Text = ctmp
            
            cFeld = ctmp
            
            If Not IsNull(rsrs!vorname) Then
                ctmp = rsrs!vorname
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 3
            grd1.Text = ctmp
            
            If Not IsNull(rsrs!STADT) Then
                ctmp = rsrs!STADT
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 4
            grd1.Text = ctmp
            
            If Not IsNull(rsrs!strasse) Then
                ctmp = rsrs!strasse
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 5
            grd1.Text = ctmp
            
'            If Check8.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(5) = 0
'            End If
            
            dUmsatz = dUmsatzLJ
            cFeld = Format$(dUmsatz, "###,##0.00")
            grd1.Col = 6
            grd1.Text = cFeld
            
'            If Check1.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(6) = 0
'            End If
            
            If Not IsNull(rsrs!GESPERRT) Then
                cFeld = rsrs!GESPERRT
            Else
                cFeld = "N"
            End If
            
            If gbKUWAHLGESPERRTROT = True Then
            
                For i = 1 To 7
                    grd1.Col = i
                    If cFeld <> "N" Then
                        grd1.CellBackColor = vbRed
                    Else
                        grd1.CellBackColor = vbWhite
                    End If
                Next i
            End If
            
            If Not IsNull(rsrs!BONUS) Then
                dBonus = rsrs!BONUS
            Else
                dBonus = 0
            End If
            
            cFeld = Format$(dBonus, "#####0.00")
            
            grd1.Col = 7
            grd1.Text = cFeld
            
'            If Check7.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(7) = 0
'            End If
             
            If dBonus >= gdBonusGrenze Then
                If gbFILBONI = True Then
                
                    If Not IsNull(rsrs!FILIALNR) Then
                        If CInt(rsrs!FILIALNR) = CInt(gcFilNr) Then
                            grd1.CellBackColor = vbGreen
                        Else
                        
                        End If
                    End If
                Else
                    grd1.CellBackColor = vbGreen
                End If
            End If
            
            If Not IsNull(rsrs!NOTIZEN) Then
                ctmp = rsrs!NOTIZEN
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 8
            grd1.Text = ctmp
            
'            If Check11.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(8) = 0
'            End If
            
            If Not IsNull(rsrs!firma) Then
                ctmp = rsrs!firma
            Else
                ctmp = ""
            End If
            ctmp = Trim$(ctmp)
            grd1.Col = 9
            grd1.Text = ctmp
            
'            If Check12.Value = vbChecked Then
'
'            Else
'                grd1.ColWidth(9) = 0
'            End If
            
            
            rsrs.MoveNext
        Loop
        
        grd1.RowHeight(1) = 0
        grd1.Redraw = True
        
        grd1.Col = 0
        grd1.Row = 1
    End If
    rsrs.Close: Set rsrs = Nothing
    
    Tabellenbreiteanpassen grd1, 1.7 * gdTabfak
    
    If Check8.value = vbUnchecked Then
        grd1.ColWidth(5) = 0
    End If
    
    If Check12.value = vbUnchecked Then
        grd1.ColWidth(9) = 0
    End If
    
    If Check11.value = vbUnchecked Then
        grd1.ColWidth(8) = 0
    End If
    
    If Check7.value = vbUnchecked Then
        grd1.ColWidth(7) = 0
    End If
    
    If Check1.value = vbUnchecked Then
        grd1.ColWidth(6) = 0
    End If
    
    
    
    
    
    If lrow = 2 Then 'nur jetzt weiter
        glSelect = 2 'grd1.Row

        grd1.Col = 0
        grd1.Row = 2
        grd1.SetFocus
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SucheKundenKasseWKL20Alphas"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub
Public Sub Gridneu(cKund As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim dBonus      As Double
    
    grd1.Redraw = False
    For lcount = 1 To grd1.Rows - 1
        grd1.Col = 0
        If grd1.Text = cKund Then
            grd1.Col = 8
            dBonus = ErmittleKundenBonus(cKund)
            If dBonus >= gdBonusGrenze Then
                grd1.CellBackColor = vbGreen
            Else
                grd1.CellBackColor = vbWhite
            End If
            grd1.Text = Format$(dBonus, "#####0.00")
        End If
        grd1.Col = 0
    Next lcount
    grd1.Redraw = True
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Gridneu"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub LeseArtikelFarbe(lartnr As Long)
    On Error GoTo LOKAL_ERROR
    
    Dim rsrs As Recordset
    Dim ctmp As String
    Dim sSQL As String
    
    sSQL = "select * from artikel where artnr = " & lartnr
    
    Set rsrs = gdBase.OpenRecordset(sSQL)
    
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!AWM) Then
            ctmp = rsrs!AWM
        Else
            ctmp = "0"
        End If
        
        If ctmp <> "" Then
            Label2(24).Tag = ctmp
            If ctmp = "98" Then
                Label2(24).Caption = "Neu"
                Label2(24).BackColor = vbWhite
                Label2(24).ForeColor = vbRed
                
                Label17(0).BackColor = vbWhite
                Label17(0).ForeColor = vbRed
            ElseIf ctmp = "95" Then
                Label2(24).Caption = "nicht lieferbar"
                Label2(24).BackColor = vbBlue
                Label2(24).ForeColor = vbBlack
                
                Label17(0).BackColor = vbBlue
                Label17(0).ForeColor = vbBlack
            ElseIf ctmp = "94" Then
                Label2(24).Caption = "Preisaktion vorbereitet"
                Label2(24).BackColor = glfarbe(0)
                Label2(24).ForeColor = vbBlue
                
                Label17(0).BackColor = glfarbe(0)
                Label17(0).ForeColor = vbBlue
            ElseIf ctmp = "93" Then
                Label2(24).Caption = "Preisaktion jetzt"
                Label2(24).BackColor = vbWhite
                Label2(24).ForeColor = vbGreen
                
                Label17(0).BackColor = vbWhite
                Label17(0).ForeColor = vbGreen
            ElseIf ctmp = "92" Then
                Label2(24).Caption = "lange nicht verkauft"
                Label2(24).BackColor = &H80000012
                Label2(24).ForeColor = vbWhite
                
                Label17(0).BackColor = &H80000012
                Label17(0).ForeColor = vbWhite
            Else
                If CByte(ctmp) < 10 Then
                    Label2(24).BackColor = glfarbe(ctmp)
                    Label2(24).Caption = ermFarbeBez(ctmp)
                    
                    Label17(0).BackColor = glfarbe(ctmp)
                ElseIf CByte(ctmp) > 10 And CByte(ctmp) < 20 Then
                    Label2(24).BackColor = glfarbe2(CInt(ctmp) - 10)
                    Label2(24).Caption = ermFarbeBez(CStr(CInt(ctmp)))
                    
                    Label17(0).BackColor = glfarbe2(CInt(ctmp) - 10)
                Else
                    Label2(24).BackColor = glfarbe(0)
                    Label2(24).Caption = ""
                    
                    Label17(0).BackColor = glfarbe(0)
                End If
            End If
        Else
            Label2(24).BackColor = glfarbe(0)
            Label2(24).Caption = ""
            
            Label17(0).BackColor = glfarbe(0)
        End If
    End If
    rsrs.Close: Set rsrs = Nothing

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "LeseArtikelFarbe"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub ZerlegeLbSatzWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim cLBSatz As String
    Dim cSQL    As String
    Dim rsrs    As Recordset
    Dim ctmp    As String
    
    Dim iinde As Integer
    iinde = List3.SelectedItem.index

    cLBSatz = List1.list(iinde - 1)
    
    
    Label17(0).Caption = Trim$(Mid(cLBSatz, 7, 6))
    Label17(1).Caption = Trim$(Mid(cLBSatz, 14, 35))
    Text4.Text = Trim$(Mid(cLBSatz, 14, 35))
    
    If Left(cLBSatz, 1) = "x" Then
        ctmp = Mid(cLBSatz, 2, 4)
    Else
        ctmp = Mid(cLBSatz, 1, 5)
    End If
    
    Text8(6).Text = Trim$(ctmp)
    iMerkBestPosi = CInt(Text8(6).Text)
    
    Label17(3).Caption = Trim$(Mid(cLBSatz, 50, 9))
    Text8(0).Text = Trim$(Mid(cLBSatz, 50, 9))
    Text8(5).Text = Trim$(Mid(cLBSatz, 6, 1))
    Label17(4).Caption = Trim$(Mid(cLBSatz, 60, 9))
    Label17(5).Caption = Trim$(Mid(cLBSatz, 74, 9))
    Label17(6).Caption = Trim$(Mid(cLBSatz, 124, 3))
    Label17(7).Caption = Trim$(Mid(cLBSatz, 84, 9))
    
    Label17(8).Caption = Trim$(Mid(cLBSatz, 72, 1))
    Label17(9).Caption = Trim$(Mid(cLBSatz, 94, 9))
    Label17(10).Caption = Trim$(Mid(cLBSatz, 104, 9))
    Label17(11).Caption = Trim$(Mid(cLBSatz, 114, 9))
    Label17(12).Caption = Trim$(Mid(cLBSatz, 128, 9))
    Label17(13).Caption = Trim$(Mid(cLBSatz, 138, 9))
'    Label17(14).Caption = Trim$(Mid(cLBSatz, 148, 3))
    Text8(10).Text = Trim$(Mid(cLBSatz, 148, 3))
    
    Label16(22).Caption = Trim$(Mid(cLBSatz, 154, 1))
    Label16(31).Caption = Trim$(Mid(cLBSatz, 156, 1))
    If Trim$(Mid(cLBSatz, 152, 1)) <> "" Then
        Label17(15).Caption = Trim$(Mid(cLBSatz, 152, 1))
        If Label17(15).Caption = "0" Then
            Label17(16).Caption = "Ja"
        End If
        If Label17(15).Caption = "1" Then
            Label17(16).Caption = "Nein"
        End If
    Else
        Label17(15).Caption = "0"
        Label17(16).Caption = "Ja"
    End If
    
    cSQL = "Select * from ARTIKEL where ARTNR = " & Label17(0).Caption & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!EAN) Then
            Text8(1).Text = rsrs!EAN
        Else
            Text8(1).Text = ""
        End If
        If Not IsNull(rsrs!EAN2) Then
            Text8(2).Text = rsrs!EAN2
        Else
            Text8(2).Text = ""
        End If
        If Not IsNull(rsrs!EAN3) Then
            Text8(3).Text = rsrs!EAN3
        Else
            Text8(3).Text = ""
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    LeseArtikelFarbe CLng(Label17(0).Caption)
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ZerlegeLbSatzWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub ZerlegeLbSatzWKL20forGarantie()
    On Error GoTo LOKAL_ERROR
    
    Dim cLBSatz As String
    
    Dim iinde As Integer
    iinde = List3.SelectedItem.index
    cLBSatz = List1.list(iinde - 1)
    
    Label17(30).Caption = Trim$(Mid(cLBSatz, 7, 6))
    Label17(31).Caption = Trim$(Mid(cLBSatz, 14, 35))
    
    Label17(2).Caption = Label2(7).Caption
    
    If Val(Label17(2).Caption) = 0 Then
        Label17(2).Caption = "keinen Kunden ausgewählt"
        Label17(2).ForeColor = vbRed
        
    Else
        Label17(2).ForeColor = vbBlack
    End If
   
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ZerlegeLbSatzWKL20forGarantie"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub ZerlegeLbSatzWKL20forGutschein()
    On Error GoTo LOKAL_ERROR
    
    Dim cLBSatz As String
    
    Dim iinde As Integer
    iinde = List3.SelectedItem.index
    cLBSatz = List1.list(iinde - 1)
    
    Label17(18).Caption = Trim$(Mid(cLBSatz, 53, 7))
    Label17(19).Caption = Trim$(Mid(cLBSatz, 24, 10))
    
    Label17(20).Caption = inWorten(Label17(18).Caption)
    
    Label17(17).Caption = Label2(7).Caption
    
    If Val(Label17(17).Caption) = 0 Then
        Label17(17).Caption = "keinen Kunden ausgewählt"
        Label17(17).ForeColor = vbRed
    Else
        Label17(17).ForeColor = vbBlack
    End If
   
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ZerlegeLbSatzWKL20forGutschein"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SwitchUpperLowerCaseWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lcount As Long
    
    If Left(SSCommand100(37).Caption, 1) = "A" Then
        For lcount = 0 To 34
            SSCommand100(lcount).Caption = LCase(SSCommand100(lcount).Caption)
        Next lcount
        
        SSCommand100(32).Caption = ","
        SSCommand100(33).Caption = "-"
        
        SSCommand100(37).Caption = "a -> A"
    Else
        For lcount = 0 To 34
            SSCommand100(lcount).Caption = UCase(SSCommand100(lcount).Caption)
        Next lcount
        
        SSCommand100(32).Caption = ";"
        SSCommand100(33).Caption = "_"
        
        SSCommand100(37).Caption = "A -> a"
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SwitchUpperLowerCaseWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Sonderpreisroutine()
On Error GoTo LOKAL_ERROR

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Sonderpreisroutine"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub KundenauswahlmaskeZeigen()
    On Error GoTo LOKAL_ERROR
    
    gcBedNr = Text1(0).Text
            
    Text3(3).Text = ""
    Combo1.Text = ""
    formatgrd
    
    Label1(10).Caption = "alle Farben"
    Label1(10).Tag = ""
    Label1(10).BackColor = Label1(16).BackColor
    Label1(10).ForeColor = Label1(16).ForeColor
    
    Frame8.Visible = True
    
    chk_Kunde_halten.value = vbUnchecked
    

    Frame9.Top = grd1.Top + grd1.Height + 100
'    Frame9.BackColor = Frame8.BackColor
    Frame9.Visible = True
'    Frame9.Refresh
    
    
    glSelect = 0
    MSComm2.PortOpen = False
    MSComm2.CommPort = gVerbindung.iComPort
    MSComm2.InputLen = 0
    MSComm2.Settings = gVerbindung.cSettings
    MSComm2.RThreshold = 1
    If Not MSComm2.PortOpen = True Then
        MSComm2.PortOpen = True
    End If
    
    Frame1.Visible = False
    Frame2.Visible = False
    Frame3.Visible = False
    Frame4.Visible = False
    Frame33.Visible = False
    
    Label3(4).Caption = "0"
    Text3(3).SetFocus
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 8005 Or err.Number = 8012 Then
        Resume Next
    ElseIf err.Number = 8002 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "KundenauswahlmaskeZeigen"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
End Sub
Private Sub KundenbestellungDurchführen()
    On Error GoTo LOKAL_ERROR

    If List1.ListCount > 0 Then
            
        If KUNDENBESTELLUNGOK Then
            Kundenbestellung 1
        Else
            frmWKL118.Show 1
            If gb118bestell = True Then
                Kundenbestellung 2
            Else
                Kundenbestellung 3
            End If
        End If

    ElseIf List1.ListCount = 0 Then
        anzeige "rot", "Keine Artikel für eine Kundenbestellung vorhanden!", Label27
        Text1(1).SetFocus
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "KundenbestellungDurchführen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
End Sub
Private Sub KundenauslieferungDurchführen()
    On Error GoTo LOKAL_ERROR

    If List1.ListCount > 0 Then
        Kundenauslieferung
    ElseIf List1.ListCount = 0 Then
        anzeige "rot", "Keine Artikel für eine Kundenauslieferung vorhanden!", Label27
        Text1(1).SetFocus
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "KundenauslieferungDurchführen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
End Sub
Private Sub Warengruppe_kassieren(iTaste As Integer)
On Error GoTo LOKAL_ERROR

Dim cArtNr As String
Dim dPreis As Double
Dim ctmp As String
Dim dWert As Double
Dim bKommaVorhanden As Boolean

    gbWarenGruppe = True
            
    cArtNr = Format(gWarenGruppe(iTaste).dArtNr, "#####0")
    dPreis = fnHolePreisWarengruppeWKL20(cArtNr)
        
    Text1(1).Text = Format$(dPreis, "######0.00")
                    
                    
    If gWarenGruppe(iTaste).cFaktor = "-" Then
        ctmp = Text1(1).Text
        If InStr(ctmp, ",") = 0 Then
            If Len(ctmp) < 2 Then
                ctmp = "0,0" & ctmp
            ElseIf Len(ctmp) < 3 Then
                ctmp = "0," & ctmp
            Else
                ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
            End If
        End If
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
        dWert = dWert * (-1)
        ctmp = Format$(dWert, "######0.00")
        Text1(1).Text = ctmp
    End If
    
    'Sonderpreisroutine begin
            
        
    ctmp = Text1(1).Text
    ctmp = Trim$(ctmp)
    If ctmp = "" Then
        anzeige "rot", "Bitte einen Wert eingeben!", Label27
        Text1(1).SetFocus
        Exit Sub
    End If
    bKommaVorhanden = False
    If InStr(ctmp, ",") Then
        bKommaVorhanden = True
    End If
    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)
    If Not bKommaVorhanden Then
        dWert = dWert / 100
    End If
    If dWert >= 10000 Then
        MsgBox "Der eingegebene Wert ist zu groß!", vbCritical, "STOP!"
        Text1(1).SetFocus
    End If
    Label2(0).Caption = Format$(dWert, "######0.00")
    Label2(0).Visible = True
    Label1(1).Visible = True
    Text1(1).Text = ""
    
    'Sonderpreisroutine ende
                    
    If Label2(0).Visible Then
        Text1(1).Text = cArtNr
        SSCommand2_Click 15
        
        Label2(0).Caption = ""
        Label2(0).Visible = False
        Label1(1).Visible = False
    End If
               
    gbWarenGruppe = False

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Warengruppe_kassieren"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
End Sub
Private Sub Warengruppe_kassieren_mit_PreisUebergabe(iTaste As Integer, dPreis As Double)
On Error GoTo LOKAL_ERROR

Dim cArtNr As String

Dim ctmp As String
Dim dWert As Double
Dim bKommaVorhanden As Boolean

    gbWarenGruppe = True
            
    cArtNr = Format(gWarenGruppe(iTaste).dArtNr, "#####0")
'    dPreis = fnHolePreisWarengruppeWKL20(cArtNr)
        
    Text1(1).Text = Format$(dPreis, "######0.00")
                    
                    
    If gWarenGruppe(iTaste).cFaktor = "-" Then
        ctmp = Text1(1).Text
        If InStr(ctmp, ",") = 0 Then
            If Len(ctmp) < 2 Then
                ctmp = "0,0" & ctmp
            ElseIf Len(ctmp) < 3 Then
                ctmp = "0," & ctmp
            Else
                ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
            End If
        End If
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
        dWert = dWert * (-1)
        ctmp = Format$(dWert, "######0.00")
        Text1(1).Text = ctmp
    End If
    
   
        
    ctmp = Text1(1).Text
    ctmp = Trim$(ctmp)
    If ctmp = "" Then
        anzeige "rot", "Bitte einen Wert eingeben!", Label27
        Text1(1).SetFocus
        Exit Sub
    End If
    bKommaVorhanden = False
    If InStr(ctmp, ",") Then
        bKommaVorhanden = True
    End If
    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)
    If Not bKommaVorhanden Then
        dWert = dWert / 100
    End If
    If dWert >= 10000 Then
        MsgBox "Der eingegebene Wert ist zu groß!", vbCritical, "STOP!"
        Text1(1).SetFocus
    End If
    Label2(0).Caption = Format$(dWert, "######0.00")
    Label2(0).Visible = True
    Label1(1).Visible = True
    Text1(1).Text = ""
    
    If Label2(0).Visible Then
        Text1(1).Text = cArtNr
        SSCommand2_Click 15
        
        Label2(0).Caption = ""
        Label2(0).Visible = False
        Label1(1).Visible = False
    End If
               
    gbWarenGruppe = False

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Warengruppe_kassieren_mit_PreisUebergabe"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
End Sub
Private Sub Artikel_kassieren_mit_PreisUebergabe(lartnr As Long, dPreis As Double)
On Error GoTo LOKAL_ERROR

    Dim cArtNr As String

    Dim ctmp As String
    Dim dWert As Double
    Dim bKommaVorhanden As Boolean

    gbWarenGruppe = True
            
    cArtNr = Format(lartnr, "#####0")
    
    Text1(1).Text = Format$(dPreis, "######0.00")
                    
    ctmp = Text1(1).Text
    If InStr(ctmp, ",") = 0 Then
        If Len(ctmp) < 2 Then
            ctmp = "0,0" & ctmp
        ElseIf Len(ctmp) < 3 Then
            ctmp = "0," & ctmp
        Else
            ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
        End If
    End If
    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)
    
    dWert = dWert * (-1)
    
    ctmp = Format$(dWert, "######0.00")
    Text1(1).Text = ctmp
    
    
    ctmp = Text1(1).Text
    ctmp = Trim$(ctmp)
    If ctmp = "" Then
        anzeige "rot", "Bitte einen Wert eingeben!", Label27
        Text1(1).SetFocus
        Exit Sub
    End If
    bKommaVorhanden = False
    If InStr(ctmp, ",") Then
        bKommaVorhanden = True
    End If
    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)
    If Not bKommaVorhanden Then
        dWert = dWert / 100
    End If
    If dWert >= 10000 Then
        MsgBox "Der eingegebene Wert ist zu groß!", vbCritical, "STOP!"
        Text1(1).SetFocus
    End If
    Label2(0).Caption = Format$(dWert, "######0.00")
    Label2(0).Visible = True
    Label1(1).Visible = True
    Text1(1).Text = ""
    
    If Label2(0).Visible Then
        Text1(1).Text = cArtNr
        SSCommand2_Click 15
        
        Label2(0).Caption = ""
        Label2(0).Visible = False
        Label1(1).Visible = False
    End If
               
    gbWarenGruppe = False

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Artikel_kassieren_mit_PreisUebergabe"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
End Sub
Private Sub Muss_der_Gesamtbetrag_gerundet_werden(sGesamtBetrag As String, sRunden As String)
On Error GoTo LOKAL_ERROR

'Nur die letzte Stelle betrachten
Dim cNeuerPreis As String
Dim dDiff As Double
Dim sTempAbrunden As String

If CDbl(sGesamtBetrag) <= gdSCHWELLEWK Then
    Exit Sub
End If

If sRunden = "1" Then

    Select Case Right(sGesamtBetrag, 1)
        Case "0"
            cNeuerPreis = sGesamtBetrag
        Case "1", "2", "3", "4"
            cNeuerPreis = Left(sGesamtBetrag, Len(sGesamtBetrag) - 1) & "0"
            
        Case "5"
            cNeuerPreis = sGesamtBetrag
        Case "6", "7", "8", "9"
            cNeuerPreis = Left(sGesamtBetrag, Len(sGesamtBetrag) - 1) & "5"
    End Select
    
    dDiff = CDbl(sGesamtBetrag) - CDbl(cNeuerPreis)
    
    
ElseIf sRunden = "2" Then 'aufrunden
    Select Case Right(sGesamtBetrag, 1)
        Case "0"
            cNeuerPreis = sGesamtBetrag
        Case "1", "2", "3", "4"
            cNeuerPreis = Left(sGesamtBetrag, Len(sGesamtBetrag) - 1) & "5"
            
        Case "5"
            cNeuerPreis = sGesamtBetrag
        Case "6"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.04)
        Case "7"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.03)
        Case "8"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.02)
        Case "9"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.01)
    End Select
    
    dDiff = CDbl(cNeuerPreis) - CDbl(sGesamtBetrag)
    
ElseIf sRunden = "3" Then 'sinnvoll runden
    dDiff = 0
    sTempAbrunden = ""
    Select Case Right(sGesamtBetrag, 1)
        Case "0"
            cNeuerPreis = sGesamtBetrag
        Case "1"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) - 0.01)
            sTempAbrunden = "-"
        Case "2"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) - 0.02)
            sTempAbrunden = "-"
        Case "3"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.02)
            sTempAbrunden = "+"
        Case "4"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.01)
            sTempAbrunden = "+"

        Case "5"
            cNeuerPreis = sGesamtBetrag
        Case "6"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) - 0.01)
            sTempAbrunden = "-"
        Case "7"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) - 0.02)
            sTempAbrunden = "-"
        Case "8"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.02)
            sTempAbrunden = "+"
        Case "9"
            cNeuerPreis = CStr(CDbl(sGesamtBetrag) + 0.01)
            sTempAbrunden = "+"
    End Select

    If sTempAbrunden = "-" Then
        dDiff = CDbl(sGesamtBetrag) - CDbl(cNeuerPreis)
    ElseIf sTempAbrunden = "+" Then
        dDiff = CDbl(cNeuerPreis) - CDbl(sGesamtBetrag)
    End If
    
End If

If dDiff <> 0# Then

    'aber noch gucken, ob diese AusnahmeArtikel im Warenkorb sind
    If DieseArtikelImWarenkorb(gsRabattAusnahmeArtikel) = True Then
    
    Else
    
        If sRunden = "1" Then
            
        ElseIf sRunden = "2" Then
            dDiff = dDiff * (-1)
            
        ElseIf sRunden = "3" Then
        
            If sTempAbrunden = "-" Then
            
            ElseIf sTempAbrunden = "+" Then
                dDiff = dDiff * (-1)
            End If
        
        End If
        Artikel_kassieren_mit_PreisUebergabe glRRArtnr, Format(dDiff, "######0.00")
    End If
End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Muss_der_Gesamtbetrag_gerundet_werden"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Kasse auf."
    
    Fehlermeldung1
End Sub
Private Sub Command1_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim iRet                As Integer
    Dim i                   As Integer
    Dim ctmp                As String
    Dim dWert               As Double
    Dim bKommaVorhanden     As Boolean
    Dim bDruck              As Boolean
    Dim cZeile1             As String
    Dim cZeile2             As String
    Dim iCount              As Integer
    Dim cArtNr              As String
    Dim dPreis              As Double
    Dim cSQL                As String
    Dim rsrs                As Recordset
    Dim lRet                As Long
    Dim iAFCBUCH            As Integer
    Dim Task                As String
    Dim siZahlbetrag        As Single
    Dim cMSGText            As String
    Dim dSumme              As Double
    Dim lfail               As Long
    Dim cQuelle             As String
    Dim cZiel               As String
    
    Dim hwnd&
    Dim Y As String
    Dim result&
    Dim Title$
    
    anzeige "Knormal", "", Label27
    
    If index <> 35 Then
        giZahlArt = index
    End If
    
    Select Case index
        Case Is = 0         'EC-Lastschrift
        
            If glBONUSAA_Artnr > 0 Then
                'neue Bonusautomatik
                Bonus_neu_AA
                
                If giAnzBonus_Erreicht > 0 Then
                    'Drücke die Schaltfläche x mal
                    For i = 1 To giAnzBonus_Erreicht
                        Warengruppe_kassieren Welche_Warengruppen_Taste(glBONUSAA_Artnr)
                    Next i
                End If
            Else
                'herkömliche alte Bonuserreicht Anzeige
                If WasistmitBonus = False Then
                
                    If gdbonusGutschein > 0 Then
                        'noch ein Gutschein in den Warenkorb
                            
                        Text1(1).Text = Format(gdbonusGutschein, "######0.00")
                        Command1_Click 14
                        
                        '+Bonusabzug
                        If glBonusGrenzeArtnr > 0 Then
                            Artikel_kassieren_mit_PreisUebergabe glBonusGrenzeArtnr, Format(gdbonusGutschein, "######0.00")
                        End If
                        
                    End If
                    Exit Sub
                End If
            End If
            
            If gbPLZGEBIET Then: WasistmitPLZ_Erfragen Label2(7).Caption, CDbl(Label2(6).Caption)
            If gbABOPLUS Then: WasistmitAboPlus
            If glBONUSNRE_Artnr > 0 Then: WasistmitBONUSNRE
            
            If gbMitKundeWahlHinweis Then
                If Label2(7).Caption = "0" Then
                    iRet = MsgBox("Möchten Sie einen Kunden auswählen!", vbYesNo + vbDefaultButton1 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                        Exit Sub
                    End If
                End If
            End If
            
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    anzeige "rot", "Verkauf ohne Kunden-Nr nicht möglich!", Label27

                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            If Label2(7).Caption <> "0" Then
                lRet = fnPruefeKundenSperrungWKL20()
                If lRet <> 0 Then
                    anzeige "rot", "Kunde ist für Zahlungen mit EC-Karte gesperrt!", Label27

                    Exit Sub
                End If
            End If
            
            
            gcZahlMittel = "LS"
            giZahlArt = 1
            ctmp = Label2(6).Caption
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            If gFirma.BLZ = "" Or gFirma.Konto = "" Or gFirma.BankName = "" Then
            
                cZeile1 = "EC-Lastschrift:"
                cZeile2 = gcWaehrung & " " & Label2(6).Caption
                cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                ZeigeKundenDisplay cZeile1, cZeile2

                gcZahlMittel = "LS"
                AndersZahlungWKL20 69 'Index

            Else
                If dWert > 0 Then
                    cZeile1 = "EC-Lastschrift:"
                    cZeile2 = gcWaehrung & " " & Label2(6).Caption
                    cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                    ZeigeKundenDisplay cZeile1, cZeile2
                    
                    Label11(0).Visible = True
                    
                    If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
                    
                        Label11(4).Caption = "Kunde / Kontoinhaber: "
                    
                        Label11(4).Caption = Label11(4).Caption & lookingForKundendaten(Trim(Label2(7).Caption)).vorname
                        Label11(4).Caption = Label11(4).Caption & " " & lookingForKundendaten(Trim(Label2(7).Caption)).nachname
                        
                    Else
                    
                        Label11(4).Caption = "Kunde: unbekannt"
                    End If
                    
                    Label11(4).Visible = True
                    
                    LeereDatenECKarteWKL20
                    List11.Clear
                    Label11(3).Caption = Label2(6).Caption & " " & gcWaehrung
                    
                    Frame18.Visible = True
                    
                    Frame1.Visible = False
                    Frame2.Visible = False
                    Frame3.Visible = False
                    Frame4.Visible = False
                    Frame33.Visible = False
                 
                    MSComm1.PortOpen = False
                    MSComm1.CommPort = gVerbindung.iComPort
                    MSComm1.InputLen = 0
                    MSComm1.Settings = gVerbindung.cSettings
                    MSComm1.RThreshold = 1
                    If Not MSComm1.PortOpen = True Then
                        MSComm1.PortOpen = True
                    End If
                    
                ElseIf dWert < 0 Then
                    MsgBox "EC-Lastschrift ist bei negativen Beträgen nicht möglich!", vbCritical, "STOP!"
                    Text1(1).SetFocus
                ElseIf dWert = 0 Then
                    MsgBox "Der Endbetrag ist 0. EC-Lastschrift ist nicht möglich!", vbCritical, "STOP!"
                    Text1(1).SetFocus
                End If
            End If
            
        Case Is = 1         'Kunden-Nummer
        
            'bediener?
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Verkauf ohne Bediener-Nr nicht möglich!", Label27

                If Text1(0).Visible And Text1(0).Enabled Then
                    Text1(0).SetFocus
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
        
        
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
        
            KundenauswahlmaskeZeigen
            
        Case Is = 2         'Sonderpreis
        
            If gbSPY Then
                frmWKL20!Winsock22.senddata "Taste Sonderpreis wird gedrückt" & vbCrLf
            End If
        
            If gbBEDKARTE = True Then
            
                If Identi(79) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
                    Dim ctemp As String
                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(79) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
            

            'Sonderpreisroutine begin
            
        
            ctmp = Text1(1).Text
            ctmp = Trim$(ctmp)
            If ctmp = "" Then
                anzeige "rot", "Bitte einen Wert eingeben!", Label27
'                    MsgBox "Bitte einen Wert eingeben!", vbCritical, "STOP!"
                Text1(1).SetFocus
                Exit Sub
            End If
            bKommaVorhanden = False
            If InStr(ctmp, ",") Then
                bKommaVorhanden = True
            End If
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            If Not bKommaVorhanden Then
                dWert = dWert / 100
            End If
            If dWert >= 10000 Then
                MsgBox "Der eingegebene Wert ist zu groß!", vbCritical, "STOP!"
                Text1(1).SetFocus
            End If
            Label2(0).Caption = Format$(dWert, "######0.00")
            Label2(0).Visible = True
            Label1(1).Visible = True
            Text1(1).Text = ""
            
            'Sonderpreisroutine ende
            
        Case Is = 3         'Gesamtrabatt
        
            If gbSPY Then
                frmWKL20!Winsock22.senddata "Taste Gesamtrabatt wird gedrückt" & vbCrLf
            End If
        
            If gbBEDKARTE = True Then
            
                If Identi(90) Then
                'ja man muss sich hier identifizieren
                
                    'Ja
'                    Dim ctemp As String
'                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(90) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
            'Gesrab begin
            If gbParknetto Then
                If Command1(3).BackColor = vbRed Then
                    anzeige "rot", "Gesamtrabatt wurde schon gestoppt.", Label27
                    Text1(1).SetFocus
                    Exit Sub
                End If
                
                If Command1(3).BackColor = vbGreen Then
                    Text1(1).Text = 0
                End If
            End If
            
            If Text1(1).Text = "" Then
                If gdVerBGesrabatt > 0 Then
                    Text1(1).Text = gdVerBGesrabatt
                End If
            End If
            
            ctmp = Text1(1).Text
            ctmp = Trim$(ctmp)
            
            If ctmp = "" Then
                anzeige "rot", "Bitte einen Wert eingeben!", Label27
                Text1(1).SetFocus
                Exit Sub
            End If
            
            bKommaVorhanden = False
            If InStr(ctmp, ",") Then
                bKommaVorhanden = True
            End If
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)
            If dWert > 100 Then
                MsgBox "Rabatte dürfen nicht größer als 100 % sein!", vbCritical, "STOP!"
                Text1(1).SetFocus
                Exit Sub
            End If
            
            If gbParknetto Then
                If Command1(3).BackColor = vbGreen Then
                    gsGesRabforNetto = Label2(3).Caption
                    AktualisiereListboxWKL20ARTRAB
                End If
            End If
            
            Label2(3).Caption = Format$(dWert, "######0.00")
            If dWert <> 0 Then
            
                If gbParknetto Then
                    Command1(3).BackColor = vbGreen
                Else
                    Command1(3).BackColor = &H80000004
                End If
                Label2(3).Visible = True
                
                If gbRabVs = True Then
                    Label2(4).Visible = False
                Else
                    Label2(4).Visible = True
                End If
                
                Label1(3).Visible = True
                
                Label2(3).ForeColor = &HFF0000
                If gbRabVs = False Then
                    Label1(3).Caption = "Gesamtrabatt:"
                Else
                    Label1(3).Caption = "GR"
                End If
                Label1(3).ForeColor = &H80000012
                Label2(4).ForeColor = &HFF0000
                
                Label1(3).Refresh
                Label2(3).Refresh
                Label2(4).Refresh
            Else
                If gbParknetto Then
                    If Command1(3).BackColor = vbGreen Then
                        Command1(3).BackColor = vbRed
                    Else
                        Command1(3).BackColor = &H80000004
                    End If
                Else
                    Command1(3).BackColor = &H80000004
                End If
                
                Label2(3).Visible = False
                Label2(4).Visible = False
                Label1(3).Visible = False
            End If
            
            If Command1(3).BackColor = vbRed Then
                        
            Else
            
                If gbNoKUBONUS_wenn_Art_and_Ges_rab = True Then
                    AktualisiereListboxWKL20_wegenNOKUNDENBONUS_AG_RAB
                End If
            
                AktualisiereListboxWKL20
                AktualisiereZeileZwischenSummeWKL20
            
            End If
            Text1(1).Text = ""

        Case Is = 4         'Artikelrabatt
            If gbSPY Then
                frmWKL20!Winsock22.senddata "Taste Artikelrabatt wird gedrückt" & vbCrLf
            End If
        
            If gbBEDKARTE = True Then
            
                If Identi(89) Then
                'ja man muss sich hier identifizieren
                
                    'Ja
'                    Dim ctemp As String
'                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(89) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
        
            'artrab begin
            ctmp = Text1(1).Text
            ctmp = Trim$(ctmp)
            If ctmp = "" Then
                anzeige "rot", "Bitte einen Wert eingeben!", Label27
'                    MsgBox "Bitte einen Wert eingeben!", vbCritical, "STOP!"
                Text1(1).SetFocus
                Exit Sub
            End If
            bKommaVorhanden = False
            If InStr(ctmp, ",") Then
                bKommaVorhanden = True
            End If
            ctmp = fnMoveComma2Point$(ctmp)
            dWert = Val(ctmp)

            If dWert > 100 Then
                MsgBox "Rabatte dürfen nicht größer als 100 % sein!", vbCritical, "Winkiss Hinweis:"
                Text1(1).SetFocus
                Exit Sub
            End If
            Label2(1).Caption = Format$(dWert, "######0.00")
            Label2(1).Refresh
            If dWert <> 0 Then
                Label2(1).Visible = True
                If gbRabVs = True Then
                    Label2(2).Visible = False
                Else
                    Label2(2).Visible = True
                End If
                Label1(2).Visible = True
            Else
                Label2(1).Visible = False
                Label2(2).Visible = False
                Label1(2).Visible = False
            End If
            Text1(1).Text = ""
            
        Case Is = 5         'Kreditverkauf
        
            If glBONUSAA_Artnr > 0 Then
                'neue Bonusautomatik
                Bonus_neu_AA
                
                If giAnzBonus_Erreicht > 0 Then
                    'Drücke die Schaltfläche x mal
                    For i = 1 To giAnzBonus_Erreicht
                        Warengruppe_kassieren Welche_Warengruppen_Taste(glBONUSAA_Artnr)
                    Next i
                End If
            Else
                'herkömliche alte Bonuserreicht Anzeige
                If WasistmitBonus = False Then
                
                    If gdbonusGutschein > 0 Then
                        'noch ein Gutschein in den Warenkorb
                            
                        Text1(1).Text = Format(gdbonusGutschein, "######0.00")
                        Command1_Click 14
                        
                        '+Bonusabzug
                        If glBonusGrenzeArtnr > 0 Then
                            Artikel_kassieren_mit_PreisUebergabe glBonusGrenzeArtnr, Format(gdbonusGutschein, "######0.00")
                        End If
                    End If
                    Exit Sub
                End If
            End If
            
            If gbPLZGEBIET Then: WasistmitPLZ_Erfragen Label2(7).Caption, CDbl(Label2(6).Caption)
            If gbABOPLUS Then: WasistmitAboPlus
            If glBONUSNRE_Artnr > 0 Then: WasistmitBONUSNRE
            
            If gbMitKundeWahlHinweis Then
                If Label2(7).Caption = "0" Then
                    iRet = MsgBox("Möchten Sie einen Kunden auswählen!", vbYesNo + vbDefaultButton1 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                        Exit Sub
                    End If
                End If
            End If
            
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    MsgBox "Verkauf ohne Kunden-Nr nicht möglich!", vbInformation, "Winkiss Hinweis:"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            If List1.ListCount > 0 Then
                If Label2(7).Visible Then
                    cZeile1 = "Kreditverkauf:"
                    cZeile2 = gcWaehrung & " " & Label2(6).Caption
                    cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                    ZeigeKundenDisplay cZeile1, cZeile2

                    gcZahlMittel = "KR"
                    AndersZahlungWKL20 index
                Else
                    anzeige "rot", "Bitte die Kundennummer festlegen!", Label27

                    Text1(1).SetFocus
                End If
            Else
                
                anzeige "rot", "Es liegen keine Verkäufe vor!", Label27
                Text1(1).SetFocus
            End If
            
        Case Is = 6         'Gemischte Zahlung, früher Scheckverkauf
        
            BerechneZwischenSummeWKL20
            
            ctmp = Label2(6).Caption
            ctmp = fnMoveComma2Point$(ctmp)
            dSumme = Val(ctmp)
            
            If dSumme < 0 Then
                'für Neidthardt
                Command1_Click 8
                    
                Exit Sub
            End If
        
            If glBONUSAA_Artnr > 0 Then
                'neue Bonusautomatik
                Bonus_neu_AA
                
                If giAnzBonus_Erreicht > 0 Then
                    'Drücke die Schaltfläche x mal
                    For i = 1 To giAnzBonus_Erreicht
                        Warengruppe_kassieren Welche_Warengruppen_Taste(glBONUSAA_Artnr)
                    Next i
                End If
            Else
                'herkömliche alte Bonuserreicht Anzeige
                If WasistmitBonus = False Then
                
                    If gdbonusGutschein > 0 Then
                        'noch ein Gutschein in den Warenkorb
                            
                        Text1(1).Text = Format(gdbonusGutschein, "######0.00")
                        Command1_Click 14
                        
                        '+Bonusabzug
                        If glBonusGrenzeArtnr > 0 Then
                            Artikel_kassieren_mit_PreisUebergabe glBonusGrenzeArtnr, Format(gdbonusGutschein, "######0.00")
                        End If
                        
                    End If
                    Exit Sub
                End If
            End If
        
            If gbPLZGEBIET Then: WasistmitPLZ_Erfragen Label2(7).Caption, CDbl(Label2(6).Caption)
            If gbABOPLUS Then: WasistmitAboPlus
            If glBONUSNRE_Artnr > 0 Then: WasistmitBONUSNRE
            
            If gbMitKundeWahlHinweis Then
                If Label2(7).Caption = "0" Then
                    iRet = MsgBox("Möchten Sie einen Kunden auswählen!", vbYesNo + vbDefaultButton1 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                        Exit Sub
                    End If
                End If
            End If
            
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    MsgBox "Verkauf ohne Kunden-Nr nicht möglich!", vbCritical, "STOP!"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            
            If List1.ListCount > 0 Then
                cZeile1 = "BAR:"
                cZeile2 = gcWaehrung & " " & Label2(6).Caption
                cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                ZeigeKundenDisplay cZeile1, cZeile2
                
                ctmp = Label2(6).Caption
                ctmp = fnMoveComma2Point$(ctmp)
             
                d68Summe = Val(ctmp)
                d68Nochoffen = Val(ctmp)
                c68Kdnr = Label2(7).Caption
                
                gbBackaus68 = False
                frmWKL68.Show 1
                
                If gbBackaus68 Then
                    'mach die Automatik_Bonus_Geschichte rückgängig
                    If glBONUSAA_Artnr > 0 Then
                        'suche_und_lösche_Bonusartikel
                        If sind_bestimmte_Artnr_drin(glBONUSAA_Artnr) Then
                            'dann lösch diese raus
                            sind_bestimmte_Artnr_drin_then_del (glBONUSAA_Artnr)
            
                            'setze den Kundenbonus wieder hoch
                            If Val(Label2(7).Caption) > 0 Then
            
                                
                                Set rsrs = gdBase.OpenRecordset("Select * from Kunden where kundnr = " & Val(Label2(7).Caption))
                                If Not rsrs.EOF Then
                                    rsrs.Edit
                                    rsrs!Status = "E"
                                    rsrs!SYNStatus = "E"
            
                                    If Not IsNull(rsrs!BONUS) Then
            
                                        rsrs!BONUS = rsrs!BONUS + (giAnzBonus_Erreicht * gdBonusGrenze)
                                    End If
            
                                    If Not IsNull(rsrs!TBONUS) Then
                                        rsrs!TBONUS = CDbl(rsrs!TBONUS) + (giAnzBonus_Erreicht * gdBonusGrenze)
                                    End If
            
                                    rsrs!LASTDATE = DateValue(Now)
                                    rsrs!LASTTIME = TimeValue(Now)
                                    rsrs.Update
            
                                End If
                                rsrs.Close
                            End If
            
                        End If
            
                        BerechneZwischenSummeWKL20
                    End If
                End If
               
            Else
                anzeige "rot", "Es liegen keine Verkäufe vor!", Label27
                Text1(1).SetFocus
            End If
        

        Case Is = 7         'Leiste 2
            
            Frame23.Visible = True
            Frame2.Visible = False
            
        Case Is = 8       'BAR
        
            Dim dGesArtRab As Double
            dGesArtRab = 0
            'Artikelrabatt 10Prozent ab 2 Artikel eines Lieferanten
            If glZehnProzLinr > 0 And glZehnProzArtnr > 0 Then
                If Wie_vielZehnProzLinr_schon_drin > 1 Then
                    'zehn Prozent rechnen
                    dGesArtRab = ZehnProzRechnen
                         'wenn dGesArtikelrabatt > 0 dann setzen wir einen Rabattartikel in den Warenkorb
                    If dGesArtRab > 0 Then
                    
'                        dGesArtRab = dGesArtRab * (-1)
                        Artikel_kassieren_mit_PreisUebergabe glZehnProzArtnr, Format(dGesArtRab, "######0.00")
                    End If
                    
                
                End If
            End If
            
        
        
            'Gesamtrabatt X ab einem bestimmten Warenkorbwert
            If gdWarenkorbWert > 0 And gdWarenkorbGR > 0 Then
                If CDbl(Label2(6).Caption) >= gdWarenkorbWert Then
                
                    Text1(1).Text = gdWarenkorbGR
                    'und Taste Gesrab drücken
                    Command1_Click 3
                End If
            End If
            
            'Ende Gesamtrabatt X ab einem bestimmten Warenkorbwert
        
        
        
            If glECAuszahlArtnr > 0 Then
            
                'wenn, dann warenkorb nach EC-Auszahlung absuchen und rausspringen da nur kartenzahlung in Betracht kommen kann
                Dim lAnzLbSatz As Long
                Dim lcount As Long
                Dim cLBSatz As String
    
                lAnzLbSatz = List1.ListCount
                For lcount = 0 To lAnzLbSatz - 1
                    cLBSatz = List1.list(lcount)
                    cArtNr = Trim(Mid(cLBSatz, 7, 6))
                    
                    If CLng(cArtNr) = glECAuszahlArtnr Then
                        
                        
                        anzeige "rot", "Bitte mit Kartenzahlung abschliessen!", Label27
                        Exit Sub
                    End If
                Next lcount
            
            End If
        
            If glBONUSAA_Artnr > 0 Then
                'neue Bonusautomatik
                Bonus_neu_AA
                
                If giAnzBonus_Erreicht > 0 Then
                    'Drücke die Schaltfläche x mal
                    For i = 1 To giAnzBonus_Erreicht
                        Warengruppe_kassieren Welche_Warengruppen_Taste(glBONUSAA_Artnr)
                    Next i
                End If
            Else
                'herkömliche alte Bonuserreicht Anzeige
                If WasistmitBonus = False Then
                    If gdbonusGutschein > 0 Then
                        'noch ein Gutschein in den Warenkorb
                            
                        Text1(1).Text = Format(gdbonusGutschein, "######0.00")
                        Command1_Click 14
                        
                        '+Bonusabzug
                        If glBonusGrenzeArtnr > 0 Then
                            Artikel_kassieren_mit_PreisUebergabe glBonusGrenzeArtnr, Format(gdbonusGutschein, "######0.00")
                        End If
                        
                    End If
                
                
                    Exit Sub
                End If
            End If
            
            If gbGuStattBar = True And CDbl(Label2(6).Caption) < 0 Then
                
                If nurStornofArtikel_enthalten Then
            
                    dlgGutschein.Show 1
                
                    Select Case dlgGutschein.Back
                    
                        Case 1 'als Gutschein
                            'noch ein Gutschein in den Warenkorb
                            
                            Text1(1).Text = Format(CDbl(Label2(6).Caption) * -1, "######0.00")
                            Command1_Click 14
                            
                        Case 2 'Geld auszahlen
    
                    End Select
                
                End If
            
            End If
            
            If gbPLZGEBIET Then: WasistmitPLZ_Erfragen Label2(7).Caption, CDbl(Label2(6).Caption)
            If gbABOPLUS Then: WasistmitAboPlus
            If glBONUSNRE_Artnr > 0 Then: WasistmitBONUSNRE
            If glRRArtnr > 0 Then: Muss_der_Gesamtbetrag_gerundet_werden Label2(6).Caption, gsAbrunden
            
            If gbMitKundeWahlHinweis Then
                If Label2(7).Caption = "0" Then
                    iRet = MsgBox("Möchten Sie einen Kunden auswählen!", vbYesNo + vbDefaultButton1 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                        Exit Sub
                    End If
                End If
            End If
        
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    MsgBox "Verkauf ohne Kunden-Nr nicht möglich!", vbCritical, "STOP!"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            
            
            If List1.ListCount > 0 Then
                cZeile1 = "BAR:"
                cZeile2 = gcWaehrung & " " & Label2(6).Caption
                cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                ZeigeKundenDisplay cZeile1, cZeile2
                
                gcZahlMittel = "BA"
                BarZahlungWKL20
            Else
                anzeige "rot", "Es liegen keine Verkäufe vor!", Label27
                Text1(1).SetFocus
            
            End If
            
        Case Is = 9
        
            If gbBEDKARTE = True Then
            
                If Identi(107) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
'                    Dim ctemp As String
'                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(78) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Unterbrechen/Fortsetzen ohne Bediener-Nr nicht möglich!", Label27
                If Text1(0).Visible And Text1(0).Enabled Then
                    Text1(0).SetFocus
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
        
        
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
            
            
            If List1.ListCount > 0 Then
                If gbLokalModus Then
                    If gbLocalSec Then
                        If gbAutoLokalModus Then
                            If gbBONWG Then
                                Command1(9).Enabled = False
                                Screen.MousePointer = 11
                                fleischerbon CStr(gBYTEWGNR)
                                Screen.MousePointer = 0
                                Command1(9).Enabled = True
                            End If

                        End If
                    End If
                Else
                    If gbBONWG Then
                        Command1(9).Enabled = False
                        Screen.MousePointer = 11
                        fleischerbon CStr(gBYTEWGNR)
                        Screen.MousePointer = 0
                        Command1(9).Enabled = True
                    Else
                        KassierenUnterbrechenWKL20  'Kassiervorgang unterbrechen
                        faerbeRot
                        
                        '''''''' Oliver Alte TSE START
                        
                        'If List1.ListCount = 0 Then
                            'TSS Cancel
                        '    TSS.Cancel WinsockTSE
                        'End If
                        
                        '''''''' Oliver Alte TSE ENDE
                        
                    End If
                End If
            ElseIf List1.ListCount = 0 Then
                If gbBONWG Then
                
                Else
                    If gbLokalModus Then
                        If gbLocalSec Then
                            If gbAutoLokalModus Then
                            
                            End If
                        End If
                    Else
                        kundenauswahlausblend
                        frmWK20b.Show 1 'Kassiervorgang fortsetzen
                        BerechneZwischenSummeWKL20
                        faerbeRot
                        
                        '''''''' Oliver Alte TSE START
                        
                        'If List1.ListCount > 0 Then
                            'TSS Start
                        '    TSS.Start WinsockTSE
                        'End If
                        
                        '''''''' Oliver Alte TSE ENDE
                        
                        
                        
                    End If
                    
                End If
                
            End If
        
        
        Case Is = 10        'Warengruppen
        
            Frame14.Visible = True
            
            Frame2.Visible = False
        
        Case Is = 11        'Ende
        
            voreinstellungspeichernE20B
            voreinstellungspeichernE20C
            
            '************************************************************
            If gbEcash Then
                Select Case gsEPartner
                    Case Is = "ADT"
                        If gsAdtVerfahren = "XML" Then
                            Y = "SECpos Pay" '  (Terminal-ID: " & gsTerminalid & ")"
                                                
                            hwnd = GetWindow(Me.hwnd, GW_HWNDFIRST)
                        
                            Do
                                result = GetWindowTextLength(hwnd) + 1
                                Title = Space(result)
                                result = GetWindowText(hwnd, Title, result)
                                Title = Left$(Title, Len(Title) - 1)
                        
                                If InStr(1, Title, Y) Then
                                    SendMessage hwnd, WM_CLOSE, ByVal 0&, ByVal 0&
                                End If
                        
                                hwnd = GetWindow(hwnd, GW_HWNDNEXT)
                            Loop Until hwnd = 0
                        End If
                End Select
            End If
            '********************************************************
        
            If List1.ListCount = 0 Then
            
'                SchreibeKonfigurationKassenWKL20
                cZeile1 = Chr$(31) & Chr$(67) + "0"
                cZeile2 = ""
                ZeigeKundenDisplay cZeile1, cZeile2, "", "", -1
                
                
                If gbZweitMoniMinimieren = False Then
                    cZeile1 = "Kasse geschlossen"
                    cZeile2 = ""
                    ZeigeKundenDisplay cZeile1, cZeile2
                End If
                
                
                frmWKL00!Label2.Visible = True
                If gbLokalModus Then
                   
                    frmWKL00!Label2.ForeColor = vbRed
                    frmWKL00!Label2.Caption = "lokaler Modus (Datenbank nicht erreichbar)"
                    frmWKL00!Label2.Refresh
                    
                    If gbLocalSec Then
                        If gbAutoLokalModus Then
                            anzeige "normal", "Offline - Betrieb", frmWKL00.Label2
                        End If
                    End If
                Else
                    frmWKL00!Label2.Caption = "Anwender aktiv"
                    frmWKL00!Label2.Refresh
                End If
                

                
                Unload frmWKL20
                'wenn bedkarte dann auch abmelden
                If gbBEDKARTE Then
                    If Identi(80) = False Then
                
                        gcUserName = ""
                        gcPass = ""
                        glLevel = -1
                        
                        frmWKL00!Label2.Visible = True
                        frmWKL00!Label2.Caption = "Anwender nicht aktiv"
                        frmWKL00!Label2.Refresh
                        
                        fAnmeldung
                    End If
                End If
                
                If ermaktUmsatz(False) > 0 Then
                    frmWKL00.Command3(1).BackColor = vbRed
                Else
                    frmWKL00.Command3(1).BackColor = &H8000000F
                End If
                
                Exit Sub
            Else
                If Label2(6).Caption <> "0,00" Then
                    anzeige "rot", "Bitte erst den Vorgang abschließen (kassieren)!", Label27
                Else
                    Unload frmWKL20
                    
                    If ermaktUmsatz(False) > 0 Then
                        frmWKL00.Command3(1).BackColor = vbRed
                    Else
                        frmWKL00.Command3(1).BackColor = &H8000000F
                    End If
                    Exit Sub
                End If
            End If
            
        Case Is = 12    'Kundenbestellung
            '1. Bediener
            
            If List1.ListCount = 0 Then
                anzeige "rot", "Keine Artikel für eine Kundenbestellung vorhanden!", Label27
                Text1(1).SetFocus
                Exit Sub
            End If
            
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Kundenbestellung ohne Bediener-Nr nicht möglich!", Label27
                If Text1(0).Visible And Text1(0).Enabled Then
                    Text1(0).SetFocus
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
            
            '2.Kunde
            If Label2(7).Caption = "0" Then
            
                frmWK21g.Show 1
            
                Select Case frmWK21g.Back
                    Case 3 'weiter mit Kundenminimum
                    
                        Artikelzurück
                        
                        Label8(0).Caption = ""
                        Label8(1).Caption = ""
                        
                        LeereDialogModul20
                        Label2(6).Caption = "0,00"
                        
                        List1.Clear
                        List3.Nodes.Clear
                        Label41(1).Caption = 0
                        Text1(1).SetFocus
                        
                        Exit Sub
                        
                    Case 2 'Neu Kunde
                        KundenauswahlmaskeZeigen
                        cmdNew_Click
                        
                    Case 1 'Kundenauswahl
                        KundenauswahlmaskeZeigen
                        
                    Case 0 'Abbruch
                        MsgBox "Kundenbestellung ohne Kunden-Nr nicht möglich!", vbInformation, "Winkiss Hinweis:"
                        If Text1(1).Visible And Text1(1).Enabled Then
                            Text1(1).SetFocus
                        End If
                End Select
                Exit Sub
            End If
            
            KundenbestellungDurchführen
            
        Case Is = 13    'Provision
            If Label1(18).Visible = False Then
                Label1(18).Visible = True
            Else
                Label1(18).Visible = False
            End If
        
        Case Is = 14        'Verkauf eines Gutscheins
            ctmp = Text1(1).Text
            ctmp = Trim$(ctmp)
            If ctmp = "" Then
                MsgBox "Bitte den Wert des Gutscheins angeben!", vbCritical, "STOP!"
                Text1(1).SetFocus
                Exit Sub
            End If
            
            If gbGutsch Then
                ErfasseGutscheinWKL20 'von Hand
            Else
                ErzeugeGutscheinWKL20
            End If
            
       Case Is = 15        'Zahlung mit Gutschein
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    MsgBox "Verkauf ohne Kunden-Nr nicht möglich!", vbInformation, "Winkiss Hinweis:"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            
            
            If glBONUSAA_Artnr > 0 Then
                'neue Bonusautomatik
                Bonus_neu_AA
                
                If giAnzBonus_Erreicht > 0 Then
                    'Drücke die Schaltfläche x mal
                    For i = 1 To giAnzBonus_Erreicht
                        Warengruppe_kassieren Welche_Warengruppen_Taste(glBONUSAA_Artnr)
                    Next i
                End If
            Else
                'herkömliche alte Bonuserreicht Anzeige
                If WasistmitBonus = False Then
                
                    If gdbonusGutschein > 0 Then
                        'noch ein Gutschein in den Warenkorb
                            
                        Text1(1).Text = Format(gdbonusGutschein, "######0.00")
                        Command1_Click 14
                        
                        '+Bonusabzug
                        If glBonusGrenzeArtnr > 0 Then
                            Artikel_kassieren_mit_PreisUebergabe glBonusGrenzeArtnr, Format(gdbonusGutschein, "######0.00")
                        End If
                        
                    End If
                    Exit Sub
                End If
            End If
            
            If gbPLZGEBIET Then: WasistmitPLZ_Erfragen Label2(7).Caption, CDbl(Label2(6).Caption)
            If gbABOPLUS Then: WasistmitAboPlus
            If glBONUSNRE_Artnr > 0 Then: WasistmitBONUSNRE
            
            If gbMitKundeWahlHinweis Then
                If Label2(7).Caption = "0" Then
                    iRet = MsgBox("Möchten Sie einen Kunden auswählen!", vbYesNo + vbDefaultButton1 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                        Exit Sub
                    End If
                End If
            End If
            
            
            If List1.ListCount > 0 Then
                
                gbBonDruck = True
                
                Timer1.Enabled = False
                
                If checkGutschein Or gbKL_LIVEGUTSCHEIN = True Or gbGutscheinBeiVKversteuern = True Then
                    Command1_Click 6
                Else
                
                    gbBackaus20g = False
                    
                    frmWK20g.Show 1
                    
                    If gbBackaus20g Then
                        'mach die Automatik_Bonus_Geschichte rückgängig
                        If glBONUSAA_Artnr > 0 Then
                            'suche_und_lösche_Bonusartikel
                            If sind_bestimmte_Artnr_drin(glBONUSAA_Artnr) Then
                                'dann lösch diese raus
                                sind_bestimmte_Artnr_drin_then_del (glBONUSAA_Artnr)
                
                                'setze den Kundenbonus wieder hoch
                                If Val(Label2(7).Caption) > 0 Then
                
                                    
                                    Set rsrs = gdBase.OpenRecordset("Select * from Kunden where kundnr = " & Val(Label2(7).Caption))
                                    If Not rsrs.EOF Then
                                        rsrs.Edit
                                        rsrs!Status = "E"
                                        rsrs!SYNStatus = "E"
                
                                        If Not IsNull(rsrs!BONUS) Then
                
                                            rsrs!BONUS = rsrs!BONUS + (giAnzBonus_Erreicht * gdBonusGrenze)
                                        End If
                
                                        If Not IsNull(rsrs!TBONUS) Then
                                            rsrs!TBONUS = CDbl(rsrs!TBONUS) + (giAnzBonus_Erreicht * gdBonusGrenze)
                                        End If
                
                                        rsrs!LASTDATE = DateValue(Now)
                                        rsrs!LASTTIME = TimeValue(Now)
                                        rsrs.Update
                
                                    End If
                                    rsrs.Close
                                End If
                
                            End If
                
                            BerechneZwischenSummeWKL20
                        End If
                    End If
                End If
                
                Timer1.Enabled = True
                If gbBONNEIN = False Then
                    gbBonDruck = True
                Else
                    gbBonDruck = False
                End If
                
            Else
                anzeige "rot", "Es liegen keine Verkäufe vor!", Label27
                Text1(1).SetFocus
            End If

            If gsiGESRAB > 0 Then
                zeigeZwangsrabatt
            End If
            
            
        Case Is = 16        'Artikel suchen
            Text3(0).Text = ""
            Text3(1).Text = ""
            Text3(2).Text = ""
            Text3(4).Text = ""
            Text3(5).Text = ""
            Text3(6).Text = ""
            Text3(77).Text = ""
            Text3(19).Text = ""
            Text3(70).Text = ""
            bFocusonList4 = False
            List4.Visible = False
            List2.Visible = False
            List2.Clear
            List4.Nodes.Clear
            List2.AddItem "ArtNr. Artikelbezeichnung                  Listen-Vk Kunden-Vk Best. RKZ"
            Me.Refresh
            If gbFilNr And gcFilNr <> 0 Then
                Command4(9).Visible = True
            Else
                Command4(9).Visible = False
            End If
            
            Picture3.Tag = ""
            Picture3.Visible = False
            
            Command4(15).Caption = "weitere Artikel"
            Command4(15).Visible = False
            
            Frame6.Visible = True
            
            Frame9.Top = Command4(2).Top - Frame9.Height
            
            Frame9.BackColor = Label9.BackColor
            Frame9.Visible = True
            
            Label1(9).Caption = "alle Farben"
            Label1(9).Tag = ""
            Label1(9).BackColor = Label5(5).BackColor
            Label1(9).ForeColor = Label5(5).ForeColor
            
            anzeige "normal", "Artikel suchen", Label9
            Me.Refresh
            
            If NewTableSuchenDBKombi("EKASS", gdApp) Then
                If SpalteInTabellegefundenNEW("EKASS", "bo2", gdApp) = False Then
                    SpalteAnfuegenNEW "EKASS", "bo2", "BIT", gdApp
                End If
                
                If SpalteInTabellegefundenNEW("EKASS", "bo3", gdApp) = False Then
                    SpalteAnfuegenNEW "EKASS", "bo3", "BIT", gdApp
                    Option2(3).value = True
                End If
                
                If SpalteInTabellegefundenNEW("EKASS", "bo4", gdApp) = False Then
                    SpalteAnfuegenNEW "EKASS", "bo4", "BIT", gdApp
                    
                End If
                voreinstellungladen
            End If

            Frame1.Visible = False
            Frame2.Visible = False
            Frame23.Visible = False
            Frame3.Visible = False
            Frame4.Visible = False
            Frame33.Visible = False
            Frame29.Visible = False
            Label3(5).Caption = "0"
            Text3(0).SetFocus
            
        Case Is = 17        'Kartenverkauf
            '************************************************************
            
            iWelchekarte = 0
            
'            Dim dGesArtRab As Double
            dGesArtRab = 0
            'Artikelrabatt 10Prozent ab 2 Artikel eines Lieferanten
            If glZehnProzLinr > 0 And glZehnProzArtnr > 0 Then
                If Wie_vielZehnProzLinr_schon_drin > 1 Then
                    'zehn Prozent rechnen
                    dGesArtRab = ZehnProzRechnen
                         'wenn dGesArtikelrabatt > 0 dann setzen wir einen Rabattartikel in den Warenkorb
                    If dGesArtRab > 0 Then
                    
                        'dGesArtRab = dGesArtRab * (-1)
                        Artikel_kassieren_mit_PreisUebergabe glZehnProzArtnr, Format(dGesArtRab, "######0.00")
                    End If
                    
                
                End If
            End If
            
            
            
            
            
            
            
            'ist ein Rundungrabattartikel enthalten? dann raus damit
            
            
            If glRRArtnr > 0 Then
            
                If DieseArtikelImWarenkorb(CStr(glRRArtnr)) = True Then
                    'entferne
                    ArtikelausWarenkorbraus CStr(glRRArtnr)
                End If
            
            End If
            
            
            If gdKartenschwellenwert > 0 Then
                Dim dZahlbetrag As Double
                
                dZahlbetrag = CDbl(Label2(6).Caption)
                
                If dZahlbetrag < gdKartenschwellenwert Then
    
                    MsgBox "Kartenzahlung nicht möglich, erst ab " & Format(gdKartenschwellenwert, "######0.00") & " Euro.", vbCritical, "Kartenzahlung nicht möglich!"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
    
                End If
            End If
            
            
        
            If gbPLZGEBIET Then: WasistmitPLZ_Erfragen Label2(7).Caption, CDbl(Label2(6).Caption)
            If gbABOPLUS Then: WasistmitAboPlus
            If glBONUSNRE_Artnr > 0 Then: WasistmitBONUSNRE
            
            If gbMitKundeWahlHinweis Then
                If Label2(7).Caption = "0" Then
                    iRet = MsgBox("Möchten Sie einen Kunden auswählen!", vbYesNo + vbDefaultButton1 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                        Exit Sub
                    End If
                End If
            End If
        
            If gbEcash Then
                Select Case gsEPartner
                    Case Is = "ADT"
                        If gsAdtVerfahren = "XML" Then
                        
                            Y = "SECpos Pay" '  (Terminal-ID: " & gsTerminalid & ")"
                                                
                            hwnd = GetWindow(Me.hwnd, GW_HWNDFIRST)
                        
                            Do
                                result = GetWindowTextLength(hwnd) + 1
                                Title = Space(result)
                                result = GetWindowText(hwnd, Title, result)
                                Title = Left$(Title, Len(Title) - 1)
                        
                                If InStr(1, Title, Y) Then
                        '            MsgBox hwnd
                                    SendMessage hwnd, WM_CLOSE, ByVal 0&, ByVal 0&
                        
                                End If
                        
                                hwnd = GetWindow(hwnd, GW_HWNDNEXT)
                            Loop Until hwnd = 0
                        End If
                End Select
            End If
        '********************************************************
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    MsgBox "Verkauf ohne Kunden-Nr nicht möglich!", vbCritical, "STOP!"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            
            If List1.ListCount > 0 Then
                cZeile1 = "Kreditkarte:"
                cZeile2 = gcWaehrung & " " & Label2(6).Caption
                cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                ZeigeKundenDisplay cZeile1, cZeile2
                
                If gbEcash = True And gsEPartner = "ZV2" And gbZVT2_Kartenwahl = False Then
                    gcZahlMittel = "KA"
                    gbErfolg = True
                Else
                    gcZahlMittel = "KA"
                    frmWKL29.Show 1
                End If
                
                If gbErfolg = False Then
                    Screen.MousePointer = 0
                    gcKreditKarte = ""
                    Exit Sub
                Else
                
                
                    If glBONUSAA_Artnr > 0 Then
                        'neue Bonusautomatik
                        Bonus_neu_AA
                        
                        If giAnzBonus_Erreicht > 0 Then
                            'Drücke die Schaltfläche x mal
                            For i = 1 To giAnzBonus_Erreicht
                                Warengruppe_kassieren Welche_Warengruppen_Taste(glBONUSAA_Artnr)
                            Next i
                        End If
                    Else
                        'herkömliche alte Bonuserreicht Anzeige
                        If WasistmitBonus = False Then
                            gcKreditKarte = ""
                            
                            If gdbonusGutschein > 0 Then
                                'noch ein Gutschein in den Warenkorb
                                    
                                Text1(1).Text = Format(gdbonusGutschein, "######0.00")
                                Command1_Click 14
                                
                                '+Bonusabzug
                                If glBonusGrenzeArtnr > 0 Then
                                    Artikel_kassieren_mit_PreisUebergabe glBonusGrenzeArtnr, Format(gdbonusGutschein, "######0.00")
                                End If
                                
                            End If
                            
                            
                            Exit Sub
                        End If
                    End If
            
                    AndersZahlungWKL20 index '17 = Kartenverkauf
                    
                End If
            Else
                anzeige "rot", "Es liegen keine Verkäufe vor!", Label27
'                MsgBox "Es liegen keine Verkäufe vor!", vbCritical, "FEHLENDE DATEN"
                Text1(1).SetFocus
            End If
            
        '*********************************************************************************
        '* Leiste 2
        '*********************************************************************************
            
        Case 18 To 29           'Warengruppentasten 1 bis 12
        
            gbWarenGruppe = True
            ctmp = Text1(1).Text
            ctmp = Trim$(ctmp)
            
            ctmp = SwapStr(ctmp, ",", ".")
            
            If Val(ctmp) = 0 Then
                'Text1(1).Text ist leer -> Preis aus DB holen
                If gWarenGruppe(index).dArtNr > 0 Then
                    cArtNr = Format(gWarenGruppe(index).dArtNr, "#####0")
                Else
                    cArtNr = -1
                End If
                
                dPreis = fnHolePreisWarengruppeWKL20(cArtNr)
                
                'wenn fester KVKPR dann auch Kundenbindung abchecken
                
                If dPreis > 0 And Val(Label2(7).Caption) > 0 Then
                
                    dPreis = AktualisiereEinzelArtikelAufGrundPreisKZ(cArtNr)
                
                End If
                
                If dPreis <= 0 Then
                    If gbNachfragenbeiWGNohnePreis = True Then
                        iRet = MsgBox("Ohne Preis fortfahren?", vbYesNo + vbDefaultButton2 + vbQuestion, "Winkiss Frage:")
                        
                       
                    
                        If iRet = vbYes Then
                            Text1(1).Text = cArtNr
                            SSCommand2_Click 15
                        Else
                            Text1(1).SetFocus
                        End If
                    
                        
                        
                        
                        
                    Else
                        MsgBox "Bitte den Preis für die Warengruppe angeben!", vbInformation, "Winkiss Hinweis:"
                        Text1(1).SetFocus
                    End If
                Else
                
                    
                    
                    
                
                
                    Text1(1).Text = Format$(dPreis, "######0.00")
                    
                    
                    
                    '*****031204
                    If gWarenGruppe(index).cFaktor = "-" Then
                        ctmp = Text1(1).Text
                        If InStr(ctmp, ",") = 0 Then
                            If Len(ctmp) < 2 Then
                                ctmp = "0,0" & ctmp
                            ElseIf Len(ctmp) < 3 Then
                                ctmp = "0," & ctmp
                            Else
                                ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
                            End If
                        End If
                        ctmp = fnMoveComma2Point$(ctmp)
                        dWert = Val(ctmp)
                        dWert = dWert * (-1)
                        ctmp = Format$(dWert, "######0.00")
                        Text1(1).Text = ctmp
                    End If
                    '******031204
                    
                    
                    
                    
                    
                    'Sonderpreisroutine begin
            
        
                    ctmp = Text1(1).Text
                    ctmp = Trim$(ctmp)
                    If ctmp = "" Then
                        anzeige "rot", "Bitte einen Wert eingeben!", Label27
                        Text1(1).SetFocus
                        Exit Sub
                    End If
                    bKommaVorhanden = False
                    If InStr(ctmp, ",") Then
                        bKommaVorhanden = True
                    End If
                    ctmp = fnMoveComma2Point$(ctmp)
                    dWert = Val(ctmp)
                    If Not bKommaVorhanden Then
                        dWert = dWert / 100
                    End If
                    If dWert >= 10000 Then
                        MsgBox "Der eingegebene Wert ist zu groß!", vbCritical, "STOP!"
                        Text1(1).SetFocus
                    End If
                    Label2(0).Caption = Format$(dWert, "######0.00")
                    Label2(0).Visible = True
                    Label1(1).Visible = True
                    Text1(1).Text = ""
                    
                    'Sonderpreisroutine ende
                    
                    If Label2(0).Visible Then
                        Text1(1).Text = cArtNr
                        SSCommand2_Click 15
                        
                        
                        Label2(0).Caption = ""
                        Label2(0).Visible = False
                        Label1(1).Visible = False
                    End If
                End If
            Else
                'Text1(1).Text enthält einen Preis -> als Sonderpreis betrachten
                If gWarenGruppe(index).dArtNr > 0 Then
                    cArtNr = Format(gWarenGruppe(index).dArtNr, "#####0")
                Else
                    cArtNr = -1
                End If
                
                
                If glECAuszahlArtnr = CLng(cArtNr) Then
                
                    Dim dECAuszahlWert As Double
                
                    bKommaVorhanden = False
                    If InStr(ctmp, ",") Then
                        bKommaVorhanden = True
                    End If
                    ctmp = fnMoveComma2Point$(ctmp)
                    dECAuszahlWert = Val(ctmp)
                    If Not bKommaVorhanden Then
                        dECAuszahlWert = dECAuszahlWert / 100
                    End If
                
                
                
                
                    If Val(Label2(5).Caption) < 0 Then
                        dECAuszahlWert = dECAuszahlWert * -1
                    End If
                
                
                    If dECAuszahlWert < 0 Then
                    
                        anzeige "rot", "EC - Auszahlung nicht negativ!", Label27

                        Text1(1).SetFocus
                        Exit Sub
                    
                    End If
                End If
                
                
                
                
                
                
                dPreis = fnHolePreisWarengruppeWKL20(cArtNr)
                If dPreis > 0 Then
                
                    anzeige "rot", "Diese Warengruppe(" & cArtNr & ") hat einen festen Preis.", Label27

                    Text1(1).SetFocus
                    Exit Sub
                
                End If
                If gWarenGruppe(index).cFaktor = "-" Then
                    ctmp = Text1(1).Text
                    If InStr(ctmp, ",") = 0 Then
                        If Len(ctmp) < 2 Then
                            ctmp = "0,0" & ctmp
                        ElseIf Len(ctmp) < 3 Then
                            ctmp = "0," & ctmp
                        Else
                            ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
                        End If
                    End If
                    ctmp = fnMoveComma2Point$(ctmp)
                    dWert = Val(ctmp)
                    dWert = dWert * (-1)
                    ctmp = Format$(dWert, "######0.00")
                    Text1(1).Text = ctmp
                End If
                
                'Sonderpreisroutine begin
                
                
                
                
                If glBaganzArtnr > 0 Then
                    If cArtNr = glBaganzArtnr Then
                        If glBaganzAR > 0 Then
                            'dann setz doch einfach AR
                            
                            If glBaganzAR < 100 Then
                            
                                Label2(1).Caption = Format$(glBaganzAR, "######0.00")
                                Label2(1).Refresh
                            
                                Label2(1).Visible = True
                                If gbRabVs = True Then
                                    Label2(2).Visible = False
                                Else
                                    Label2(2).Visible = True
                                End If
                                Label1(2).Visible = True
                               
                            End If
                            
                            
                            
                        End If
                    End If
                End If
                
                
                
            
        
                ctmp = Text1(1).Text
                ctmp = Trim$(ctmp)
                If ctmp = "" Then
                    anzeige "rot", "Bitte einen Wert eingeben!", Label27

                    Text1(1).SetFocus
                    Exit Sub
                End If
                bKommaVorhanden = False
                If InStr(ctmp, ",") Then
                    bKommaVorhanden = True
                End If
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
                If Not bKommaVorhanden Then
                    dWert = dWert / 100
                End If
                
                
                
                If dWert >= 10000 Then
                    cMSGText = "Der eingegebene Preis " & dWert & " " & gcWaehrung & " ist zu groß!" & vbCrLf & vbCrLf
                    cMSGText = cMSGText & "Soll der Preis von " & dWert & " " & gcWaehrung & " trotzdem übernommen werden?"
                    iRet = MsgBox(cMSGText, vbCritical + vbYesNo + vbDefaultButton2, "Winkiss Hinweis:")
                    
                    If iRet <> vbYes Then
                        Text1(1).Text = ""
                        Text1(1).SetFocus
                        Exit Sub
                    End If
                    Text1(1).SetFocus
                End If
                
                
                
                Label2(0).Caption = Format$(dWert, "######0.00")
                Label2(0).Visible = True
                Label1(1).Visible = True
                Text1(1).Text = ""
                
                'Sonderpreisroutine ende
                If gWarenGruppe(index).dArtNr > 0 Then
                    Text1(1).Text = Format(gWarenGruppe(index).dArtNr, "#####0")
                Else
                    Text1(1).Text = -1
                End If
                SSCommand2_Click 15
                
               
                
                Label2(0).Caption = ""
                Label2(0).Visible = False
                Label1(1).Visible = False
            End If
            gbWarenGruppe = False
            
        Case Is = 30            'Sonderfunktionen 3.Leiste
            Frame29.Visible = True
            Frame23.Visible = False
            
        Case Is = 31            'Terminkalender
            
            gckundnr = ""
            
            'globArtikelarray leeren
            For iCount = 0 To 9
                gsArtikelArray(iCount) = ""
            Next iCount
            
            Screen.MousePointer = 11
            
            frmWKL82.Label1(0).Visible = True
            frmWKL82.Show 1
            
            'Man kommt mit Bediener wieder, dann Bediener anzeigen
            
            'aber Bediener leeren steht über alles
            If gbBEDLEER = True Then
                Text1(0).Text = ""
                Label1(8).Caption = ""
                Text1(0).SetFocus
            End If
            
            If Val(gcTerm_Bed) > 0 Then
                Text1(0).Text = gcTerm_Bed
                Label8(2).Caption = "1"
            End If
                
            
            
            'Man kommt mit Kundennummer wieder, dann Kunden anzeigen
            
            If Val(gckundnr) > 0 Then
            
                Label2(7).Caption = gckundnr
                HoleKundenDatenWKL20 gckundnr
                
                
                
                gckundnr = ""

                If gbSterne Then
                    AllesinKUNDAZEeinzel Label2(7).Caption, False
                    Zeigdiesterne Picture1(1), Picture1(2), Picture1(3), Picture1(4), Picture1(5), wievieleSterne(Label2(7).Caption, "KUNDA" & srechnertab, 180), wievieleSterneAlt

                End If

                Label2(7).Visible = True
                Label1(7).Visible = True
                Label1(19).Visible = True
            End If
            
            'Man kommt mit Artnr-Array wieder, dann Artikel anzeigen
            Dim sArtnr As String
            For iCount = 0 To UBound(gsArtikelArray)
                sArtnr = gsArtikelArray(iCount)
                If Val(sArtnr) > 0 Then
                    Text1(1).Text = sArtnr
                    Text1(1).Refresh
                    SSCommand2_Click 15
                End If
            Next iCount
            
'            List3.Refresh
            
            'Man muss sogar den Bondrucker wieder aktivieren
            setzedrucker gcBonDrucker
            
            
            
            
            
            
            
        
            
            
        Case Is = 32            'Barzahlung über Leiste 2
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    MsgBox "Verkauf ohne Kunden-Nr nicht möglich!", vbCritical, "STOP!"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            If List1.ListCount <> 0 Then
                Command1_Click 35   'auf Leiste 1 wechseln (wg. NeuInit Dialog)
                Command1_Click 8    'BAR-Taste auf Leiste 1
            End If
            
        Case Is = 33            'Schublade öffnen
            If gbBEDKARTE = True Then
            
                If Identi(78) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
'                    Dim ctemp As String
'                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(78) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
            
            If gbSCHUBMB Then
                DruckeSchubladeUnterschrift
            End If
            
            OeffneSchubladeExplizitWKL20
            
        Case Is = 34        '2.Kassenbon
        
            If gbBEDKARTE = True Then
            
                If Identi(105) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
'                    Dim ctemp As String
'                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(105) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
            Else
                If glLevel >= 3 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
            'jetzt geht es zum Programmteil
            
            Frame1.Visible = False
            Frame3.Visible = False
            Frame4.Visible = False
            Frame23.Visible = False
            List12.Clear
            Frame24.Visible = True
            
            If gsEPartner = "ELP" Or gsEPartner = "ZV2" Then
'            If gsEPartner = "ELP" Then
                Command11(9).Enabled = True
            Else
                Command11(9).Enabled = False
            End If
            
            If gbLokalModus = True Then
                Check5.Visible = False
            Else
                Check5.Visible = True
            End If
            
            If gbUmsAnz = True Then
                Label14.Caption = Format(ermaktUmsatz(True), "######0.00")
                Label14.Refresh
                
                Label26.Caption = Format(ermaktKassensoll, "######0.00")
                Label26.Refresh
            Else
                Label26.Visible = False
                Label14.Visible = False
            End If
            
            InitBonListeWKL20
            For iCount = 0 To 6
                If Option1(iCount).value = True Then
                    Option1(iCount).SetFocus
                    Exit For
                End If
            Next iCount
            If List12.ListCount > 0 Then
                List12.Selected(0) = True
                List12.SetFocus
            
            End If
            
        Case Is = 35        'von Leiste 2 -> Leiste 1
            
            
            
            Frame2.Visible = True
            Frame23.Visible = False
            
        '*********************************************************************************
        '* Leiste 3
        '*********************************************************************************
        Case Is = 36 'Rückgabe beleg
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Beleg drucken ohne Bediener-Nr nicht möglich!", Label27
                If Text1(0).Visible And Text1(0).Enabled Then
                    Text1(0).SetFocus
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
            
            If List1.ListCount > 0 Then
                SetzeAufBelegArtikelWKL20
            ElseIf List1.ListCount = 0 Then
                anzeige "rot", "Keine Artikel für einen Beleg vorhanden!", Label27
                Text1(1).SetFocus
            End If
            
        Case Is = 37 'aus Datei
        
                Aus_Datei
                
        Case Is = 38
            
            If MDEeinlesenOhneLinr(Label27, txtStatus, picprogress, frmWKL20) = False Then
                anzeigeNew "rot", "Es konnten keine Daten aus dem MDE - Gerät ausgelesen werden.", Label27
            Else
                anzeigeNew "normal", "", Label27
                MdeVerarbeitung2
            End If

        Case Is = 39 'Gutschein prüfen
        
            frmWKL188.Show 1
        
        Case Is = 40        'Kunden Konto
            frmWKL102.Show 1
        Case Is = 41        'Kunden Auslieferung
        
            '1. Bediener
            
            If List1.ListCount = 0 Then
                anzeige "rot", "Keine Artikel für eine Kundenauslieferung vorhanden!", Label27
                Text1(1).SetFocus
                Exit Sub
            End If
            
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Kundenauslieferung ohne Bediener-Nr nicht möglich!", Label27
                If Text1(0).Visible And Text1(0).Enabled Then
                    Text1(0).SetFocus
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
            
    
            '2.Kunde
            If Label2(7).Caption = "0" Then
            
                MsgBox "Kundenauslieferung ohne Kunden-Nr nicht möglich!", vbInformation, "Winkiss Hinweis:"
                If Text1(1).Visible And Text1(1).Enabled Then
                    Text1(1).SetFocus
                End If
            
                Exit Sub
            End If
            
            KundenauslieferungDurchführen
            
        Case Is = 42        'Kunden Verleih
        
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Artikelauswahl ohne Bediener-Nr nicht möglich!", Label27
                If Text1(0).Visible And Text1(0).Enabled Then
                    Text1(0).SetFocus
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
            
            
            If List1.ListCount > 0 Then
                If gbLokalModus Then
                    If gbLocalSec Then
                        If gbAutoLokalModus Then
                            
                        End If
                    End If
                Else
                    If Label2(7).Caption = "0" Then
                        MsgBox "Artikelauswahl ohne Kunden-Nr nicht möglich!", vbInformation, "Winkiss Hinweis:"
                        If Text1(1).Visible And Text1(1).Enabled Then
                            Text1(1).SetFocus
                        End If
                        Exit Sub
                    End If
                    KassierenUnterbrechenWKL20_ArtAuswahl  'Kassiervorgang unterbrechen
                    faerbeRot_ArtAuswahl
                End If
            ElseIf List1.ListCount = 0 Then
                If gbLokalModus Then
                    If gbLocalSec Then
                        If gbAutoLokalModus Then
                        
                        End If
                    End If
                Else
                    frmWK20j.Show 1 'Kassiervorgang fortsetzen
                    faerbeRot_ArtAuswahl
                End If
            End If
        
        
            
            
            
        
        Case Is = 43        'Arbeitsbeginn
            gcDlgTitel = "Arbeits-Beginn"
            frmWK20d.Show 1
            
        Case Is = 44        'von Leiste 3 -> Leiste 2
            
            gbNumTaste = True
            Frame23.Visible = True
            Frame29.Visible = False

        Case Is = 45    'Auszahlung
        
        
            'Zur Sicherheit eventuell gewählten Kunden ausblenden bzw entfernen
            kundenauswahlausblend
        
        
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Verkauf ohne Bediener-Nr nicht möglich!", Label27

                If Text1(0).Visible And Text1(0).Enabled Then
                    Text1(0).SetFocus
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
        
        
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
            
            If List1.ListCount = 0 And Trim$(Text1(1).Text) <> "" Then
                cZeile1 = "Auszahlung:"
                cZeile2 = gcWaehrung & " " & Label2(6).Caption
                cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                ZeigeKundenDisplay cZeile1, cZeile2
                AndersZahlungWKL20 index
            Else
                MsgBox "Bitte ggf. alle Positionen aus der Liste entfernen und nur den Betrag eingeben!", vbCritical, "STOP!"
                Text1(1).SetFocus
            End If
            
        Case Is = 46 'Einzahlung
        
        
            'Zur Sicherheit eventuell gewählten Kunden ausblenden bzw entfernen
            kundenauswahlausblend
        
        
            If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                anzeige "rot", "Verkauf ohne Bediener-Nr nicht möglich!", Label27

                If Text1(0).Visible And Text1(0).Enabled Then
                    
                    Text1(0).SetFocus
                    
                End If
                
                Exit Sub
            Else
                iRet = fnLogonBedienerWKL20%()
        
        
                If iRet <> 0 Then
                    Text1(0).SetFocus
                    Exit Sub
                End If
            End If
            
            If List1.ListCount = 0 And Trim$(Text1(1).Text) <> "" Then
                cZeile1 = "Einzahlung:"
                cZeile2 = gcWaehrung & " " & Label2(6).Caption
                cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                ZeigeKundenDisplay cZeile1, cZeile2
                AndersZahlungWKL20 index
            Else
                MsgBox "Bitte ggf. alle Positionen aus der Liste entfernen und nur den Betrag eingeben!", vbCritical, "STOP!"
                Text1(1).SetFocus
            End If
            
        Case Is = 47        'Kollegen-VK
            'Kollegen-VK ist nur ab Berechtigungsstufe 6 erlaubt!
            'Anm.: Es gibt Kunden, die das NICHT hart verdrahtet haben möchten!!!
            'daher wird der Wert KALKULATION jetzt dafür genommen
            
'            If glLevel < DlgZugriff(4).dZugriff Or glLevel < 6 Then
'                MsgBox "Nicht möglich!" & vbCrLf & vbCrLf & "Kollegen-Verkauf ist nur mit Zugriffs-Level 6 oder höher erlaubt!", vbInformation, "INFO"
'                Exit Sub
'            Else
                If List1.ListCount > 0 Then
                    If Label2(7).Visible Then
                        cZeile1 = "Kreditverkauf:"
                        cZeile2 = gcWaehrung & " " & Label2(6).Caption
                        cZeile2 = Space$(20 - Len(cZeile2)) & cZeile2
                        ZeigeKundenDisplay cZeile1, cZeile2
                        gcZahlMittel = "KO"
                        AndersZahlungWKL20 index
                    Else
                        anzeige "rot", "Bitte die Kundennummer festlegen!", Label27
                        Text1(1).SetFocus
                    End If
                Else
                    anzeige "rot", "Es liegen keine Verkäufe vor!", Label27
                    Text1(1).SetFocus
                End If
        Case Is = 48        'Filialtausch
            frmWKLaj.Show 1
            setzedrucker gcBonDrucker
        Case Is = 49 'Retoure
        
            If gbBEDKARTE = True Then
            
                If Identi(88) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
'                    Dim ctemp As String
'                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(88) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
            'retoure begin
            
            If List1.ListCount = 0 Then
                anzeige "rot", "Keine Artikel für Retoure vorhanden!", Label27
                Text1(1).SetFocus
            Else
                iRet = MsgBox("Wollen Sie wirklich eine Artikelretoure durchführen?", vbYesNo + vbDefaultButton2 + vbQuestion, "Winkiss Frage:")
                If iRet = vbYes Then
                
                    Dim cRetourengrund As String
                    dlgRetoure.Show 1
                    
                    Select Case dlgRetoure.Back
                        Case 1
                            cRetourengrund = "Marktbereinigung"
                        Case 2
                            cRetourengrund = "technischer Defekt"
                        Case 3
                            cRetourengrund = "Bruch"
                        Case 4
                            cRetourengrund = "Unverträglich"
                        Case 5
                            cRetourengrund = "Verfallsdat erreicht"
                        Case 6
                            cRetourengrund = "Retoure an Lieferant"
                    End Select
                
                    SetzeRetourArtikelWKL20 cRetourengrund
                End If
            End If
            
        Case Is = 50        'letzter Bon
        
            DruckeZweitenKassenbonNeu
        Case Is = 51        'Kreditverwaltung
        
            Screen.MousePointer = 11
            frmWKL24.Show 1
        
        Case Is = 52        'ArbeitsEnde
            gcDlgTitel = "Arbeits-Ende"
            frmWK20d.Show 1
            
        Case Is = 53        'von Warengruppen -> Leiste 1
            gbNumTaste = True
            Frame2.Visible = True
            Frame29.Visible = False
            
        Case Is = 55
        
            If Command33(1).Caption = "Zurück" Then
            
                Command33_Click 1
                Command1_Click 17
            End If
            

        Case Is = 54    'F2 farbe
            Screen.MousePointer = 0
            gsBackcolor = Label1(9).BackColor
            gsForecolor = Label1(9).ForeColor
            gsArtikelFarbe = Label1(9).Tag
            
            frmWKL49.Show 1
            
            Label1(9).BackColor = gsBackcolor
            Label1(9).ForeColor = gsForecolor
            Label1(9).Tag = gsArtikelFarbe
            
            If gsArtikelFarbe <> "" Then
                Label1(9).Caption = "Farbauswahl"
            Else
                Label1(9).Caption = "alle Farben"
            End If
        
        Case Is = 63           'Barzahlung über Warengruppen 13 - 64
            If gbZwangsKdNr Then
                If Label2(7).Caption = "0" Then
                    anzeige "rot", "Verkauf ohne Kunden-Nr nicht möglich!", Label27
'                    MsgBox "Verkauf ohne Kunden-Nr nicht möglich!", vbCritical, "STOP!"
                    If Text1(1).Visible And Text1(1).Enabled Then
                        Text1(1).SetFocus
                    End If
                    Exit Sub
                End If
            End If
            If List1.ListCount <> 0 Then
                Command1_Click 106   'auf Leiste 1 wechseln (wg. NeuInit Dialog)
                Command1_Click 8    'BAR-Taste auf Leiste 1
            End If
            
            
        Case 120 To 171           'Warengruppentasten 13 bis 64
        
            gbWarenGruppe = True
            ctmp = Text1(1).Text
            ctmp = Trim$(ctmp)
            
            ctmp = SwapStr(ctmp, ",", ".")
            
            If Val(ctmp) = 0 Then
                'Text1(1).Text ist leer -> Preis aus DB holen
                If gWarenGruppe(index).dArtNr > 0 Then
                    cArtNr = Format(gWarenGruppe(index).dArtNr, "#####0")
                Else
                    cArtNr = -1
                End If
                
                dPreis = fnHolePreisWarengruppeWKL20(cArtNr)
                
                'wenn fester KVKPR dann auch Kundenbindung abchecken
                
                If dPreis > 0 And Val(Label2(7).Caption) > 0 Then
                
'                    MsgBox Label8(3).Caption
                
                    dPreis = AktualisiereEinzelArtikelAufGrundPreisKZ(cArtNr)
                
                End If
                
                If dPreis <= 0 Then
                
                    If gbNachfragenbeiWGNohnePreis = True Then
                        iRet = MsgBox("Ohne Preis fortfahren?", vbYesNo + vbDefaultButton2 + vbQuestion, "Winkiss Frage:")
                        
                        If iRet = vbYes Then
                            Text1(1).Text = cArtNr
                            SSCommand2_Click 15
                            Command1_Click 106
                        Else
                            Text1(1).SetFocus
                        End If
                    
                    Else
                        MsgBox "Bitte den Preis für die Warengruppe angeben!", vbInformation, "Winkiss Hinweis:"
                        Text1(1).SetFocus
                    End If
                
                
                
''''                    anzeige "rot", "Bitte den Preis für die Warengruppe angeben!", Label27
'''''                    MsgBox "Bitte den Preis für die Warengruppe angeben!", vbCritical, "STOP!"
''''                    Text1(1).SetFocus
                Else
                    Text1(1).Text = Format$(dPreis, "######0.00")
                    
                    
                    '*****031204
                    If gWarenGruppe(index).cFaktor = "-" Then
                        ctmp = Text1(1).Text
                        If InStr(ctmp, ",") = 0 Then
                            If Len(ctmp) < 2 Then
                                ctmp = "0,0" & ctmp
                            ElseIf Len(ctmp) < 3 Then
                                ctmp = "0," & ctmp
                            Else
                                ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
                            End If
                        End If
                        ctmp = fnMoveComma2Point$(ctmp)
                        dWert = Val(ctmp)
                        dWert = dWert * (-1)
                        ctmp = Format$(dWert, "######0.00")
                        Text1(1).Text = ctmp
                    End If
                    '******031204
                    
                    
                    
                    
                    'Sonderpreisroutine begin
            
        
                    ctmp = Text1(1).Text
                    ctmp = Trim$(ctmp)
                    If ctmp = "" Then
                        anzeige "rot", "Bitte einen Wert eingeben!", Label27
'                        MsgBox "Bitte einen Wert eingeben!", vbCritical, "STOP!"
                        Text1(1).SetFocus
                        Exit Sub
                    End If
                    bKommaVorhanden = False
                    If InStr(ctmp, ",") Then
                        bKommaVorhanden = True
                    End If
                    ctmp = fnMoveComma2Point$(ctmp)
                    dWert = Val(ctmp)
                    If Not bKommaVorhanden Then
                        dWert = dWert / 100
                    End If
                    If dWert >= 10000 Then

                        MsgBox "Der eingegebene Wert ist zu groß!", vbCritical, "STOP!"
                        Text1(1).SetFocus
                    End If
                    Label2(0).Caption = Format$(dWert, "######0.00")
                    Label2(0).Visible = True
                    Label1(1).Visible = True
                    Text1(1).Text = ""
                    
                    'Sonderpreisroutine ende
                    
                    If Label2(0).Visible Then
                        Text1(1).Text = cArtNr
                        SSCommand2_Click 15
                        Label2(0).Caption = ""
                        Label2(0).Visible = False
                        Label1(1).Visible = False
                    End If
                    Command1_Click 106
                End If
            Else
                'Text1(1).Text enthält einen Preis -> als Sonderpreis betrachten
                If gWarenGruppe(index).dArtNr > 0 Then
                    cArtNr = Format(gWarenGruppe(index).dArtNr, "#####0")
                Else
                    cArtNr = -1
                End If
                dPreis = fnHolePreisWarengruppeWKL20(cArtNr)
                If dPreis > 0 Then
                
                    MsgBox "Diese Warengruppe(" & cArtNr & ") hat einen festen Preis.", vbInformation, "Winkiss Hinweis:"

                    Text1(1).SetFocus
                    Exit Sub
                
                End If
                
                If gWarenGruppe(index).cFaktor = "-" Then
                    ctmp = Text1(1).Text
                    If InStr(ctmp, ",") = 0 Then
                        If Len(ctmp) < 2 Then
                            ctmp = "0,0" & ctmp
                        ElseIf Len(ctmp) < 3 Then
                            ctmp = "0," & ctmp
                        Else
                            ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
                        End If
                    End If
                    ctmp = fnMoveComma2Point$(ctmp)
                    dWert = Val(ctmp)
                    dWert = dWert * (-1)
                    ctmp = Format$(dWert, "######0.00")
                    Text1(1).Text = ctmp
                End If
                
                'Sonderpreisroutine begin
            
        
                ctmp = Text1(1).Text
                ctmp = Trim$(ctmp)
                If ctmp = "" Then
                    anzeige "rot", "Bitte einen Wert eingeben!", Label27
'                    MsgBox "Bitte einen Wert eingeben!", vbCritical, "STOP!"
                    Text1(1).SetFocus
                    Exit Sub
                End If
                bKommaVorhanden = False
                If InStr(ctmp, ",") Then
                    bKommaVorhanden = True
                End If
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
                If Not bKommaVorhanden Then
                    dWert = dWert / 100
                End If
                If dWert >= 10000 Then
                    MsgBox "Der eingegebene Wert ist zu groß!", vbCritical, "STOP!"
                    Text1(1).SetFocus
                End If
                Label2(0).Caption = Format$(dWert, "######0.00")
                Label2(0).Visible = True
                Label1(1).Visible = True
                Text1(1).Text = ""
                
                'Sonderpreisroutine ende
                If gWarenGruppe(index).dArtNr > 0 Then
                    Text1(1).Text = Format(gWarenGruppe(index).dArtNr, "#####0")
                Else
                    Text1(1).Text = -1
                End If
                SSCommand2_Click 15
                Label2(0).Caption = ""
                Label2(0).Visible = False
                Label1(1).Visible = False
                
                Command1_Click 106
            End If
            gbWarenGruppe = False
            
        Case Is = 106   'zu Leiste 1
            gbNumTaste = True
            Frame2.Visible = True
            Frame14.Visible = False
        Case Is = 56 'Farbe
            Screen.MousePointer = 0
            
            
            gsBackcolor = Label1(10).BackColor
            gsForecolor = Label1(10).ForeColor
            gsKundenFarbe = Label1(10).Tag
            
            frmWKL65.Show 1
            
            Label1(10).BackColor = gsBackcolor
            Label1(10).ForeColor = gsForecolor
            Label1(10).Tag = gsKundenFarbe
            If gsKundenFarbe <> "" Then
                Label1(10).Caption = "Farbauswahl"
            Else
                Label1(10).Caption = "alle Farben"
            End If
    End Select
    
    If Frame3.Visible Then
        If index <> 11 Then
            If Text1(1).Visible Then
                If Text1(0).Text = "" Then
                    Text1(0).SetFocus
                Else
                    Text1(1).SetFocus
                End If
            Else
                Text1(0).SetFocus
            End If
        End If
    End If
    If Frame18.Visible Then
        List11.SetFocus
    End If
    
    
    If mdeErr Then
        reportbildschirm "", "aWKL20e" 'Error artikel aus Datei
        mdeErr = False
    End If
    
    
    
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 8005 Or err.Number = 8012 Then
        Resume Next
    ElseIf err.Number = 8002 Then
        Resume Next
    Else
        
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Command1_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & index
        
        Fehlermeldung1
        
    End If
End Sub
Private Sub DruckeSchubladeUnterschrift()
    On Error GoTo LOKAL_ERROR

    Dim cbedname As String
    ReDim cZeilen(0 To 11) As String
    
    cbedname = Label1(8).Caption
    
    'Drucke den Beleg
    
    cZeilen(0) = "Schublade öffnen, Warum?"
    cZeilen(1) = ""
    
    cZeilen(2) = "Name:  " & cbedname
    cZeilen(3) = "Datum: " & DateValue(Now) & " Zeit:  " & TimeValue(Now)
    cZeilen(4) = "Grund:"
    cZeilen(5) = ""
    cZeilen(6) = ""
    cZeilen(7) = "__________________________________"
    cZeilen(8) = "Unterschrift:"
    cZeilen(9) = ""
    cZeilen(10) = ""
    cZeilen(11) = "_________________________________"
    
    DruckeArbeitszeitBelegWK20d cZeilen(), 11
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "DruckeSchubladeUnterschrift"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Function pfadseekExcel_Kasse() As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim sTitle      As String
    Dim sFilter     As String
    Dim sOldpfad    As String
    Dim sExcelpfad  As String
    
    pfadseekExcel_Kasse = False

    sTitle = "Speichern des Pfades"
    
    sFilter = "Excel - Dateien (*.xls)|*.xls"
    
    sOldpfad = gcDBPfad & "\IN"
    sExcelpfad = pfadaendernKomplett(sTitle, sFilter, sOldpfad)
    
    If UCase(Right(sExcelpfad, 3)) = "XLS" Then
        pfadseekExcel_Kasse = True
        Label45.Caption = sExcelpfad
    End If
    
    Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "pfadseekExcel_Kasse"
    Fehler.gsFehlertext = "Im Programmteil Terminpreise ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function

Private Sub Aus_Datei()
    On Error GoTo LOKAL_ERROR


    Dim sSQL        As String
    Dim cPfad       As String
    Dim cDatname    As String
    Dim dbExcel     As Database
    Dim rsrs        As Recordset
    Dim rsRs2       As Recordset
    Dim rsArt       As Recordset
    Dim gsExcel50   As String
    Dim rsFilBu     As Recordset
    Dim sEAN        As String
    Dim sArtnr      As String
    

    gsExcel50 = "Excel 5.0;"
    mdeErr = False
    
    If pfadseekExcel_Kasse = False Then
        anzeige "rot2", "Abbruch durch Benutzer", Label27
        Exit Sub
    End If

    cPfad = Label45.Caption

    Screen.MousePointer = 11

    Set dbExcel = OpenDatabase(cPfad, 0, 0, gsExcel50)

    loeschNEW "TERMERR", gdBase
    CreateTableT2 "TERMERR", gdBase

    Set rsFilBu = gdBase.OpenRecordset("TERMERR")

    Dim rsArtlief As DAO.Recordset
    Set rsrs = dbExcel.OpenRecordset("Order$")
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!EAN) Then
            
                sEAN = rsrs!EAN
                
                If InStr(sEAN, ",") > 0 Then
                    sEAN = Left(sEAN, InStr(sEAN, ",") - 1)
                End If

                sArtnr = "0"

                sSQL = "select * from Artikel where ean = '" & sEAN & "' or ean2 = '" & sEAN & "' or ean3 = '" & sEAN & "'"
                Set rsArtlief = gdBase.OpenRecordset(sSQL)
                If Not rsArtlief.EOF Then
                    sArtnr = Trim(rsArtlief!artnr)
                    
                    If Val(sArtnr) > 0 Then
                        Text1(1).Text = rsrs!Qty
                        SSCommand2_Click 12
    
                        Text1(1).Text = sArtnr
                        SSCommand2_Click 15
                        
                    End If
                Else

                    mdeErr = True
                    rsFilBu.AddNew

                    rsFilBu!EAN = Trim(sEAN)
'                    rsFilBu!NAN = rsrs![No.]
                    rsFilBu!Lieferant = ""
                    rsFilBu!ARTIKELTEXT = Left(rsrs!Product, 35)
                    rsFilBu!VPE = 0
'                    rsFilBu!LVP = rsrs!Price

                    rsFilBu.Update

                End If
                
            End If
            rsArtlief.Close: Set rsArtlief = Nothing
        rsrs.MoveNext
        Loop

    End If
    rsrs.Close: Set rsrs = Nothing
    
    anzeigeNew "normal", "", Label27
    Screen.MousePointer = 0
    
    

    'ENDE ENDE


    

    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Aus_Datei"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
'    Resume Next
End Sub

Private Sub MdeVerarbeitung2()
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL        As String
    Dim rsMDE       As Recordset
    Dim rsArt       As Recordset
    Dim seekEAN     As String
    
    Screen.MousePointer = 11
    
    Set rsMDE = gdBase.OpenRecordset("mdeinh")
    If Not rsMDE.EOF Then
        rsMDE.MoveFirst
        Do While Not rsMDE.EOF
            If Not IsNull(rsMDE!eancode) Then
            
                seekEAN = Trim(rsMDE!eancode)
                seekEAN = checkean(seekEAN)

                If Len(seekEAN) = 11 Then
                    seekEAN = "0" & seekEAN
            
                    sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                ElseIf Len(seekEAN) = 8 Then
                    If Left(seekEAN, 1) = "2" Then
                        seekEAN = Mid$(seekEAN, 2, 6)
                        sSQL = "select * from artikel where artnr = " & seekEAN
                    Else
                        sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                    End If
                
                Else
                    sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                End If
                
                Set rsArt = gdBase.OpenRecordset(sSQL)
                
                If Not rsArt.EOF Then 'hier die bekannten
                    
                Else
                    anzeige "rot", "Vorgang abgebrochen - unbekannte Artikel", Label27
                    rsArt.Close: Set rsArt = Nothing
                    rsMDE.Close: Set rsMDE = Nothing
                    Exit Sub
                End If
                rsArt.Close: Set rsArt = Nothing
            End If
            rsMDE.MoveNext
        Loop
    
    End If
    rsMDE.Close: Set rsMDE = Nothing
    
    List3.Visible = False
    List1.Visible = False
    
    
    Set rsMDE = gdBase.OpenRecordset("mdeinh")
    If Not rsMDE.EOF Then
        rsMDE.MoveFirst
        Do While Not rsMDE.EOF
            If Not IsNull(rsMDE!eancode) Then
            
                seekEAN = Trim(rsMDE!eancode)
                seekEAN = checkean(seekEAN)

                If Len(seekEAN) = 11 Then
                    seekEAN = "0" & seekEAN
            
                    sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                ElseIf Len(seekEAN) = 8 Then
                    If Left(seekEAN, 1) = "2" Then
                        seekEAN = Mid$(seekEAN, 2, 6)
                        sSQL = "select * from artikel where artnr = " & seekEAN
                    Else
                        sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                    End If
                
                Else
                    sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                    sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                End If
                
                Set rsArt = gdBase.OpenRecordset(sSQL)
                
                If Not rsArt.EOF Then 'hier die bekannten
                    
                    Text1(1).Text = rsMDE!Menge
                    SSCommand2_Click 12
                    
                    Text1(1).Text = rsArt!artnr
                    SSCommand2_Click 15
                End If
                rsArt.Close: Set rsArt = Nothing
            End If
            rsMDE.MoveNext
        Loop
    End If
    rsMDE.Close: Set rsMDE = Nothing
    
    List3.Visible = True
    List1.Visible = True
    
    anzeigeNew "normal", "", Label27
    Screen.MousePointer = 0
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MdeVerarbeitung2"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub faerbeRot()
    On Error GoTo LOKAL_ERROR
    
    If Datendrin("BONPAUSE", gdBase) Then
        Command1(9).BackColor = vbRed
    Else
        Command1(9).BackColor = &H80000004
    End If
    
    If gbBONWG Then
        Command1(9).BackColor = &HC0C0FF
    End If

Exit Sub
LOKAL_ERROR:
     Fehler.gsDescr = err.Description
     Fehler.gsNumber = err.Number
     Fehler.gsFormular = Me.name
     Fehler.gsFunktion = "faerbeRot"
     Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. "
     
     Fehlermeldung1
End Sub
Private Sub faerbeRot_ArtAuswahl()
    On Error GoTo LOKAL_ERROR
    
    If Datendrin("ARTAUSWAHL", gdBase) Then
        Command1(42).BackColor = vbRed
    Else
        Command1(42).BackColor = &H80000004
    End If
    
Exit Sub
LOKAL_ERROR:
     Fehler.gsDescr = err.Description
     Fehler.gsNumber = err.Number
     Fehler.gsFormular = Me.name
     Fehler.gsFunktion = "faerbeRot_ArtAuswahl"
     Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. "
     
     Fehlermeldung1
End Sub


Private Sub Command1_MouseUp(index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    On Error GoTo LOKAL_ERROR
    
    If index = 7 And Button = 2 And Shift = 1 Then

        Frame23.Visible = True
        Frame2.Visible = False
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command1_MouseUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub
Private Sub Command10_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim bErlaubt As Boolean
    Dim ctemp As String
    Dim iRet As Integer
    
    Select Case index
        Case Is = 0     'Speichern
            Command10(0).Enabled = False
            If gECKarte.Datenstrom <> "" Then
                iRet = fnPruefeDatenstromECKarteWKL20()
                If iRet = 0 Then                'jetzt Bon drucken und Daten schreiben

                    gcZahlMittel = "LS"
                    giZahlArt = 1
                    iRet = fnDruckeKassenBonECLastWKL20()
                    If iRet = 0 Then
                        iRet = fnSchreibeDTADatenWKL20()
                        If iRet = 0 Then
                            List11.Clear
                            Frame1.Visible = True
                            If gbLeiste2Start = True Then
                                Frame23.Visible = True
                                Frame2.Visible = False
                            Else
                                Frame2.Visible = True
                                Frame23.Visible = False
                            End If
                            Frame3.Visible = True
                            Frame4.Visible = True
                            Frame18.Visible = False
                            
                            List1.Clear
                            List3.Nodes.Clear
                            Label41(1).Caption = 0
                            Label2(6).Caption = "0,00"
                            LeereDialogModul20

                           
                            If gsiGESRAB > 0 Then
                                zeigeZwangsrabatt
                            End If
                            
                            gbNumTaste = True
                            Text1(0).Text = gcBedienerNr
                            Text1(1).SetFocus
                            gcKreditKarte = ""
                            gcZahlMittel = ""
                            If gbBEDLEER = True Then
                                Label1(8).Caption = ""
                                Text1(0).SetFocus
                                Text1(0).Text = ""
                                indentmitKarte
                            End If
                            Command10_Click 3
                        Else
                            MsgBox "Daten konnten nicht gespeichert werden!", vbCritical, "STOP!"
                            List11.SetFocus
                        End If
                    End If
                End If
            End If
            If gbGutschUNDlastschrift = True Then
                gbGutschUNDlastschrift = False
                Unload frmWK20g
            Else
            
            End If
            'bAbschluss = False
        Case Is = 1     'Kundendaten
        
            If gbBEDKARTE = True Then
            
                If Identi(94) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
                    
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(94) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                            End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
        
        
        
        
        
        
        
        
        
            If frmWKL20!Label2(7).Caption <> "0" And frmWKL20!Label2(7).Visible Then
                gcKundenNr = frmWKL20!Label2(7).Caption
                iKasse = 2
            End If
            
            frmWKL13.Show 1
            setzedrucker gcBonDrucker
            
            gcKundenNr = ""
            
        Case Is = 2     'Löschen
                LeereDatenECKarteWKL20
                List11.Clear
                Label11(0).Visible = True
                Label11(4).Caption = ""
                Label11(4).Visible = False
                List11.SetFocus
                Label13(0).Visible = False
                Label13(1).Visible = False
                Label13(2).Visible = False

        Case Is = 3     'Schließen
        
            Command10(0).Enabled = True
        
            If gbGutschUNDlastschrift Then
                gbGutschUNDlastschrift = False
            End If
            If gbGutschein Then
                gbGutschein = False
                Frame18.Visible = False
                If bAbschluss = False Then
                    frmWK20g.Show vbModal
                    Exit Sub
                End If
            End If

            gbLastSchriftEnde = True
            If List11.ListCount > 0 Then
                frmWK20c.Show 1
            End If
            If gbLastSchriftEnde Then
                Frame1.Visible = True
                If gbLeiste2Start = True Then
                    Frame23.Visible = True
                    Frame2.Visible = False
                Else
                    Frame2.Visible = True
                    Frame23.Visible = False
                End If
                Frame3.Visible = True
                Frame4.Visible = True
                Frame18.Visible = False
                
                
                'mach die Automatik_Bonus_Geschichte rückgängig
                If glBONUSAA_Artnr > 0 Then
                    'suche_und_lösche_Bonusartikel
                    If sind_bestimmte_Artnr_drin(glBONUSAA_Artnr) Then
                        'dann lösch diese raus
                        sind_bestimmte_Artnr_drin_then_del (glBONUSAA_Artnr)

                        'setze den Kundenbonus wieder hoch
                        If Val(Label2(7).Caption) > 0 Then

                            Dim rsrs As Recordset
                            Set rsrs = gdBase.OpenRecordset("Select * from Kunden where kundnr = " & Val(Label2(7).Caption))
                            If Not rsrs.EOF Then
                                rsrs.Edit
                                rsrs!Status = "E"
                                rsrs!SYNStatus = "E"

                                If Not IsNull(rsrs!BONUS) Then

                                    rsrs!BONUS = rsrs!BONUS + (giAnzBonus_Erreicht * gdBonusGrenze)
                                End If

                                If Not IsNull(rsrs!TBONUS) Then
                                    rsrs!TBONUS = CDbl(rsrs!TBONUS) + (giAnzBonus_Erreicht * gdBonusGrenze)
                                End If

                                rsrs!LASTDATE = DateValue(Now)
                                rsrs!LASTTIME = TimeValue(Now)
                                rsrs.Update

                            End If
                            rsrs.Close
                        End If

                    End If

                    BerechneZwischenSummeWKL20
                End If
                
                
                
                
                
                
                
                If gbBEDLEER = True Then
                    Text1(0).SetFocus
                    indentmitKarte
                Else
                    gbNumTaste = True
                    Text1(1).SetFocus
                End If
                MSComm1.PortOpen = False
                InitKundenDisplayModul20
            End If
            bAbschluss = False
        Case Is = 4     'Manuelle Eingabe
        
        
            LeereDatenECKarteWKL20
            List11.Clear
            
            Text6(0).Text = "" 'ktnr
            Text6(1).Text = "" 'blz

            If IsNumeric(Label2(7).Caption) Then
                Text6(0).Text = LeseKontonummer(Label2(7).Caption)
                Text6(1).Text = LeseBankleitzahl(Label2(7).Caption)
            End If
            
            Text6(2).Text = ""
            Text6(3).Text = ""
            Frame20.Visible = True
            Frame19.Visible = False
            Frame22.Visible = False
            Frame21.Visible = True
            Text6(0).SetFocus
    End Select
Exit Sub
LOKAL_ERROR:
    If err.Number = 8005 Or err.Number = 8012 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Command10_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
End Sub
Private Sub Command11_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    Dim ctmp As String
    Dim cBonNr As String
    Dim iCount As Integer
    
    Select Case index
        Case Is = 0     'Suchen
            List12.Clear
            For iCount = 0 To 6
                If Option1(iCount).value = True Then
                    ctmp = Option1(iCount).Caption
                    Exit For
                End If
            Next iCount
            ctmp = Left(ctmp, 2)
            
            If Combo2.Text = "Alle Zahlungsarten" Then
                AnlistenBonDatenNeu ctmp, "0"
            Else
                AnlistenBonDatenNeu ctmp, Left(Combo2.Text, 2)
            End If
            
            List5.Clear
            If List12.ListCount > 0 Then
                List12.ListIndex = 0
            End If
            List12.SetFocus
            
        Case Is = 1     'Drucken
            If List12.ListIndex < 0 Then
                MsgBox "Bitte einen Kassenbon in der Liste auswählen!", vbInformation, "Winkiss Hinweis:"
                List12.SetFocus
            Else
                For iCount = 0 To 6
                    If Option1(iCount).value = True Then
                        ctmp = Option1(iCount).Caption
                        Exit For
                    End If
                Next iCount
                ctmp = Left(ctmp, 2)
                cBonNr = List12.list(List12.ListIndex)
                
                If Check5.value = vbChecked Then 'also dina4 druck
                    If Check17.value = vbChecked Then 'Nettorechnung
                        DruckeKassenZweitBonDinA4_Netto ctmp, cBonNr, "Rechnung", gbDINA4RECHFU
                    Else
                        DruckeKassenZweitBonDinA4 ctmp, cBonNr, "2. Bon", gbDINA4RECHFU
                    End If
                    
                    setzedrucker gcBonDrucker
                Else
                    DruckeZweitBonAusListe List5, False
                End If
            End If
            

            

        Case Is = 2     'Schließen
        
            gbQRFlag = False
            Frame23.Enabled = True

            Frame1.Visible = True
            Frame3.Visible = True
            Frame4.Visible = True
            Frame23.Visible = True
            Frame24.Visible = False
            gbNumTaste = True
            Text1(1).SetFocus
            
        Case Is = 3     'Letzter Bon
            If List12.ListCount = 0 Then
                MsgBox "Für den gewählten Tag steht kein 'Letzter Bon' zur Verfügung.", vbInformation, "Winkiss Hinweis:"
            Else
                List12.Selected(0) = True
                Command11_Click 1
            End If
        Case Is = 4
            frmWKL137.Show 1
            
        Case Is = 5     'Zoll
            If List12.ListIndex < 0 Then
                MsgBox "Bitte einen Kassenbon in der Liste auswählen!", vbInformation, "Winkiss Hinweis:"
                List12.SetFocus
            Else
                For iCount = 0 To 6
                    If Option1(iCount).value = True Then
                        ctmp = Option1(iCount).Caption
                        Exit For
                    End If
                Next iCount
                ctmp = Left(ctmp, 2)
                cBonNr = List12.list(List12.ListIndex)
                
                
                'Welcher Tag > 01.01.2020
                
                Dim lPruefTag As Long
                lPruefTag = CLng(DateValue("01.01.2020"))
                
                If DateValue(Now) > lPruefTag Then
                
                    Dim cSatz As String
                    Dim dBonWert As Double
                    
                    
                    cSatz = List12.list(List12.ListIndex)
    
                    cSatz = Mid(cSatz, 8, 9)
                    cSatz = Trim$(cSatz)
                    
                    
                    dBonWert = CDbl(cSatz)
                    
                    If dBonWert < 50.01 Then
                    
                        Dim sMessage As String
                        sMessage = "Seit dem 02.01.2020 dürfen Ausfuhrbescheinigungen erst ab einem Betrag von 50,01  ausgestellt werden."
                        
                        'Am 01.01.2020 tritt die Bagatellgrenze von 50  in Kraft.
                        'Ausfuhrscheine für Schweizer Kunden*innen dürfen ab dem
                        '02.01.2020 erst ab einem Betrag von 50,01  ausgestellt werden.
                
                        MsgBox sMessage, vbInformation, "Winkiss Hinweis:"
                        Exit Sub
                    End If
                
                End If
                
                
                'also dina4 druck
'                setzedrucker gcListenDrucker
'
                Dim dVolleMWST As Double
                dVolleMWST = Hole_Volle_MWST_aus_Bon(List5)
                
                Dim dErmMWST As Double
                dErmMWST = Hole_Erm_MWST_aus_Bon(List5)
                
                Drucke_Zoll_DinA4 ctmp, cBonNr, "2. Bon", dVolleMWST, dErmMWST
                setzedrucker gcBonDrucker
                
            End If
        Case Is = 7 'Paket
            MsgBox Format(ermPaket_summe_del, "#####0.00") & " Euro", vbInformation, "Winkiss Hinweis:"
        Case 8
        
            Spezliste
            
            
        Case 9
        
            Select Case gsEPartner
                Case Is = "ELP"
                    lese_ELPAY_opt
                    setzedrucker gcBonDrucker
                    BelegWiederholung_elPAY
                    
'                Case Is = "ZVT"
'                    lese_ZVT_opt
'                    setzedrucker gcBonDrucker
'                    BelegWiederholung_ZVT
                Case Is = "ZV2"
                    lese_ZVT_opt2

                    BelegWiederholung_ZVT2 False
            End Select
        
            
        
    End Select
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command11_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command12_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim iRet As Integer
    
    Select Case index
        Case Is = 0
            iRet = fnPruefeEingabeECKarte()
            Select Case iRet
                Case Is = 0
                    BildeDatenStromWKL20
                    If List11.ListCount > 0 Then
                        Command12_Click 1
                    End If
                Case Is = 1
                    MsgBox "Bitte die Kontonummer eingeben!", vbCritical, "STOP!"
                    Text6(0).SetFocus
                    Exit Sub
                Case Is = 2
                    MsgBox "Bitte die Bankleitzahl eingeben!", vbCritical, "STOP!"
                    Text6(1).SetFocus
                    Exit Sub
                Case Is = 3
                    MsgBox "Bitte die Gültigkeit (Format MM / JJ) eingeben!", vbCritical, "STOP!"
                    Text6(2).SetFocus
                    Exit Sub
                Case Is = 4
                    MsgBox "Bitte die Gültigkeit (Format MM / JJ) eingeben!", vbCritical, "STOP!"
                    Text6(3).SetFocus
                    Exit Sub
                Case Is = 5
                    MsgBox "Der eingegebene Monat ist falsch!", vbCritical, "STOP!"
                    Text6(2).SetFocus
                    Exit Sub
            End Select
        Case Is = 1
            Frame19.Visible = True
            Frame22.Visible = True
            Frame20.Visible = False
            Frame21.Visible = False
            List11.SetFocus
    End Select
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command12_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command13_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    If index < 10 Then
        Text6(Label12.Caption).Text = Text6(Label12.Caption).Text & Command13(index).Caption
    ElseIf index = 10 Then
        Text6(Label12.Caption).Text = ""
    ElseIf index = 11 Then
        If Len(Text6(Label12.Caption).Text) > 0 Then
            Text6(Label12.Caption).Text = Left(Text6(Label12.Caption).Text, Len(Text6(Label12.Caption).Text) - 1)
        End If
    End If
    
    Text6(Label12.Caption).SetFocus
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command13_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command14_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
        
    Dim ctmp As String
    Dim cEAN As String
    Dim cEAN2 As String
    Dim cEAN3 As String
    Dim iFeld As Integer
    Dim iRet As Integer
    Dim lAnzZeilen As Long
    Dim lcount As Long
    Dim cSQL As String
    Dim rsrs As Recordset
    Dim cTmp22 As String
    Dim cPreis As String
    Dim cPreisText As String
    Dim cCode As String
    Dim cLBSatz As String
    Dim cNeuerPreis As String
    Dim cZeile1 As String
    Dim cZeile2 As String
    
    iFeld = Val(Label16(11).Caption)
    Select Case index
        Case 0 To 10            'Ziffern
            If bErsterAnschlag = True Then
                Text8(iFeld).Text = Command14(index).Caption
                bErsterAnschlag = False
            Else
                Text8(iFeld).Text = Text8(iFeld).Text & Command14(index).Caption
            End If
            Text8(iFeld).SetFocus
            
        Case Is = 11            'Komma
        
            If bErsterAnschlag = True Then
                Text8(0).Text = Command14(index).Caption
                bErsterAnschlag = False
            Else
                If InStr(Text8(0).Text, ",") = 0 Then
                    Text8(0).Text = Text8(0).Text & Command14(index).Caption
                End If
            End If
            Text8(iFeld).SetFocus
        Case Is = 12            'Clear
            Text8(iFeld).Text = ""
            Text8(iFeld).SetFocus
        Case Is = 13            'Speichern
            ctmp = Text8(0).Text
            ctmp = Trim$(ctmp)
            
            cTmp22 = Text4.Text
            cTmp22 = Trim$(cTmp22)
            
            If Val(ctmp) > 10000 Then
                MsgBox "Der Preis von " & ctmp & " ist zu hoch. Bitte neuen Preis eingeben!", vbInformation, "Winkiss Hinweis:"
                Text8(0).Text = ""
                Text8(0).SetFocus
                Exit Sub
            End If
            
            If ctmp = "" And cTmp22 = "" Then
                MsgBox "Bitte geben sie einen anderen Preis oder eine andere Bezeichnung ein!", vbInformation, "Winkiss Hinweis:"
                Text8(0).SetFocus
            Else
                cNeuerPreis = Text8(0).Text
                If InStr(cNeuerPreis, ",") = 0 Then
                    cNeuerPreis = Format$(Val(cNeuerPreis) / 100, "#####0.00")
                End If
            
                If CDbl(Format(cNeuerPreis, "#####0.00")) <> CDbl(Format(Label17(9).Caption, "#####0.00")) Then
                    Drucke_Preisänderungsbon True, Format(Label17(9).Caption), cNeuerPreis, Label17(0).Caption, Label1(8).Caption
                    
                    cZeile1 = "geänderter Preis:"
                    cZeile2 = Format(cNeuerPreis, "#####0.00") & " EUR"
                
                    ZeigeKundenDisplay cZeile1, cZeile2
                End If
            
                SchreibeNeuenPreisWKL20 ctmp
                BerechneZwischenSummeWKL20
                Command14_Click 14
            End If
            
        Case Is = 14            'Schließen
            Frame1.Visible = True
            If gbLeiste2Start = True Then
                Frame23.Visible = True
                Frame2.Visible = False
            Else
                Frame2.Visible = True
                Frame23.Visible = False
            End If
            Frame3.Visible = True
            Frame4.Visible = True
            Frame27.Visible = False
            gbNumTaste = True
            AktualisiereZeileZwischenSummeWKL20
            Text1(0).Text = gcBedienerNr
            Text1(1).SetFocus
        Case Is = 15    'Speichern in Datenbank
        
            If gbBEDKARTE = True Then
            
                If Identi(103) Then
                'ja man muss sich hier identifizieren
                
                    'Ja
                    Dim ctemp As String
                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(103) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "Winkiss Hionweis:"
                    Exit Sub
                End If
            End If
        
            'Speichern in Datenbank beginnt
        
            Dim bEAN        As Boolean
            Dim bEAN2       As Boolean
            Dim bEAN3       As Boolean
            Dim bAWM        As Boolean
            Dim bKVKPR1     As Boolean
            Dim lKJADate    As Long
            Dim cKJAZeit    As String
            
            bKVKPR1 = False
            bEAN = False
            bEAN2 = False
            bEAN3 = False
            bAWM = False
        
            ctmp = Text8(0).Text
            ctmp = Trim$(ctmp)
            
            If Val(ctmp) > 10000 Then
                MsgBox "Der Preis von " & ctmp & " ist zu hoch. Bitte neuen Preis eingeben!", vbInformation, "Winkiss Hinweis:"
                Text8(0).Text = ""
                Text8(0).SetFocus
                Exit Sub
            End If
            
            If ctmp <> "" Then
                If InStr(ctmp, ",") = 0 Then
                    ctmp = "00" & ctmp
                    ctmp = Left(ctmp, Len(ctmp) - 2) & "," & Right(ctmp, 2)
                End If
                cPreis = ctmp
            Else
                cPreis = ""
            End If
            
            ctmp = Text8(1).Text
            ctmp = Trim$(ctmp)
            If ctmp <> "" Then
                iRet = fnPruefeEANWert(ctmp)
                If iRet <> 0 Then
                    MsgBox "Der eingegebene Wert ist kein gültiger EAN-Code!", vbCritical, "STOP!"
                    Text8(1).SetFocus
                    Exit Sub
                Else
                    cEAN = ctmp
                End If
            Else
                cEAN = ""
            End If
                        
            ctmp = Text8(2).Text
            ctmp = Trim$(ctmp)
            If ctmp <> "" Then
                iRet = fnPruefeEANWert(ctmp)
                If iRet <> 0 Then
                    MsgBox "Der eingegebene Wert ist kein gültiger EAN-Code!", vbCritical, "STOP!"
                    Text8(2).SetFocus
                    Exit Sub
                Else
                    cEAN2 = ctmp
                End If
            Else
                cEAN2 = ""
            End If
                        
            ctmp = Text8(3).Text
            ctmp = Trim$(ctmp)
            If ctmp <> "" Then
                iRet = fnPruefeEANWert(ctmp)
                If iRet <> 0 Then
                    MsgBox "Der eingegebene Wert ist kein gültiger EAN-Code!", vbCritical, "STOP!"
                    Text8(3).SetFocus
                    Exit Sub
                Else
                    cEAN3 = ctmp
                End If
            Else
                cEAN3 = ""
            End If
            
            If checkthisean(Trim$(Text8(1).Text), Trim$(Label17(0).Caption)) = True Then

            Else
                Text8(1).SetFocus
                Screen.MousePointer = 0
                MsgBox "Diese EAN - Nummer ist schon vergeben. Diese kann kein zweites Mal gespeichert werden.", vbInformation, "Winkiss Hinweis:"
                
                Exit Sub
            End If
            
            If checkthisean(Trim$(Text8(2).Text), Trim$(Label17(0).Caption)) = True Then

            Else
                Text8(2).SetFocus
                Screen.MousePointer = 0
                MsgBox "Diese EAN - Nummer ist schon vergeben. Diese kann kein zweites Mal gespeichert werden.", vbInformation, "Winkiss Hinweis:"
                
                Exit Sub
            End If
            
            If checkthisean(Trim$(Text8(3).Text), Trim$(Label17(0).Caption)) = True Then

            Else
                Text8(3).SetFocus
                Screen.MousePointer = 0
                MsgBox "Diese EAN - Nummer ist schon vergeben. Diese kann kein zweites Mal gespeichert werden.", vbInformation, "Winkiss Hinweis:"
                
                Exit Sub
            End If
            
            Dim lBestand As Long
                            
            cSQL = "Select * from ARTIKEL where ARTNR = " & Label17(0).Caption & " "
            FnOpenrecordset rsrs, cSQL, 1, gdBase
            If Not rsrs.EOF Then
            
                lBestand = 0
                If Not IsNull(rsrs!BESTAND) Then
                    lBestand = rsrs!BESTAND
                End If
                
                'Hat sich der KVKPR1 geändert
                If Not IsNull(rsrs!KVKPR1) Then
                    If Trim(CStr(rsrs!KVKPR1)) <> Trim$(cPreis) Then
                        bKVKPR1 = True
                    End If
                Else
                    bKVKPR1 = True
                End If
                    
                'Hat sich der EAN(1) geändert
                If Not IsNull(rsrs!EAN) Then
                    If Trim(CStr(rsrs!EAN)) <> Trim$(cEAN) Then
                        bEAN = True
                    End If
                Else
                    bEAN = True
                End If
                
                'Hat sich der EAN2 geändert
                If Not IsNull(rsrs!EAN2) Then
                    If Trim(CStr(rsrs!EAN2)) <> Trim$(cEAN2) Then
                        bEAN2 = True
                    End If
                Else
                    bEAN2 = True
                End If
                
                'Hat sich der EAN3 geändert
                If Not IsNull(rsrs!EAN3) Then
                    If Trim(CStr(rsrs!EAN3)) <> Trim$(cEAN3) Then
                       bEAN3 = True
                    End If
                Else
                   bEAN3 = True
                End If
                
                'Hat sich der AWM geändert
                If Not IsNull(rsrs!AWM) Then
                    If Trim(CStr(rsrs!AWM)) <> Trim$(Label2(24).Tag) Then
                       bAWM = True
                    End If
                Else
                   bAWM = True
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            If bAWM Then
                ctmp = Trim$(Label2(24).Tag)
                Artikelveraenderung Label17(0).Caption, ctmp, "Kasse/Position ändern", "AWM"
            End If
            
            If bEAN Then
                ctmp = Trim$(cEAN)
                Artikelveraenderung Label17(0).Caption, ctmp, "Kasse/Position ändern", "EAN"
            End If
            
            If bEAN2 Then
                ctmp = Trim$(cEAN2)
                Artikelveraenderung Label17(0).Caption, ctmp, "Kasse/Position ändern", "EAN2"
            End If
            
            If bEAN3 Then
                ctmp = Trim$(cEAN3)
                Artikelveraenderung Label17(0).Caption, ctmp, "Kasse/Position ändern", "EAN3"
            End If
            
            If bKVKPR1 Then
                Artikelveraenderung Label17(0).Caption, Trim$(cPreis), "Kasse/Position ändern", "KVKPR1"
                
                If lBestand <= 0 Then lBestand = 1
                schreibeWKEtidru Label17(0).Caption, lBestand, CLng(gcFilNr)
            End If
            
            If cPreis <> "" Then
                cNeuerPreis = Text8(0).Text
                If InStr(cNeuerPreis, ",") = 0 Then
                    cNeuerPreis = Format$(Val(cNeuerPreis) / 100, "#####0.00")
                End If
            
                If CDbl(Format(Text8(0).Text, "#####0.00")) <> CDbl(Format(Label17(9).Caption, "#####0.00")) Then
                    Drucke_Preisänderungsbon False, Format(Label17(9).Caption), cNeuerPreis, Label17(0).Caption, Label1(8).Caption
                    
                    cZeile1 = "geänderter Preis:"
                    cZeile2 = Format(cNeuerPreis, "#####0.00") & " EUR"
                
                    ZeigeKundenDisplay cZeile1, cZeile2
                End If
            
                ctmp = Text8(0).Text
                SchreibeNeuenPreisWKL20 ctmp
                BerechneZwischenSummeWKL20
            End If
            
            
            Command14_Click 14
        Case Is = 16        'nur Schließen von Garantie
            Frame1.Visible = True
            If gbLeiste2Start = True Then
                Frame23.Visible = True
                Frame2.Visible = False
            Else
                Frame2.Visible = True
                Frame23.Visible = False
            End If
            Frame3.Visible = True
            Frame4.Visible = True
            
            Frame5.Visible = False
            Frame9.Visible = False
            
            Frame12.Visible = False
            gbNumTaste = True
            
            Text1(0).Text = gcBedienerNr
            Text1(1).SetFocus
        Case Is = 17
            frmWKL135.Show 1
        Case Is = 20 'Gutschein drucken
        
'            gcGutscheinDrucker

'            reportbildschirm_Gutschein
            If gcGutscheinDrucker <> "" Then
                setzedrucker gcGutscheinDrucker
            Else
                setzedrucker gcListenDrucker
            End If

            Dim bMitVorschau As Boolean
            Dim ballemitText As Boolean
'            Dim sGutschText As String
'            Dim sBemerkung As String
            Dim cGutschnr As String
            
            bMitVorschau = True
            ballemitText = True
            
            cGutschnr = ""
'            sGutschText = ""
'            sBemerkung = ""
        
            If List6.ListCount > 1 Then
                iRet = MsgBox("Möchten Sie alle Gutscheine drucken?", vbQuestion + vbYesNo, "Winkiss Frage:")
                If iRet = vbYes Then
                
                    iRet = MsgBox("Mit Druckvorschau?", vbQuestion + vbYesNo, "Winkiss Frage:")
                    If iRet = vbYes Then
                        bMitVorschau = True
                    Else
                        bMitVorschau = False
                    End If
                    
                    iRet = MsgBox("Möchten Sie für alle Gutscheine den Gutscheintext und die Bemerkung drucken?", vbQuestion + vbYesNo, "Winkiss Frage:")
                    If iRet = vbYes Then
                        ballemitText = True
                    Else
                        ballemitText = False
                        cGutschnr = Label17(19).Caption
                    End If
                    
         
                    
                    
                    
'                    sGutschText = Text8(7).Text
'                    sBemerkung = Text8(8).Text
'
                    
                    
                    
                    
                    lAnzZeilen = List6.ListCount
                    For lcount = 0 To lAnzZeilen - 1
                    
                        cLBSatz = ""
                        cLBSatz = List6.list(lcount)
                        
                        cCode = Trim(Left(cLBSatz, 10))
                        cPreis = Trim(Mid(cLBSatz, 11, Len(cLBSatz) - 10))
                        cPreisText = inWorten(cPreis)
                        
                        cPreis = Trim(Mid(cLBSatz, 11, Len(cLBSatz) - 10))
                        
                        
                        If ballemitText = False Then
                            If cGutschnr = cCode Then
                                gutscheindrucken cCode, Text8(7).Text, cPreis, cPreisText, Text8(8).Text, bMitVorschau
                            Else
                                gutscheindrucken cCode, "", cPreis, cPreisText, "", bMitVorschau
                            End If
                        Else
                            gutscheindrucken cCode, Text8(7).Text, cPreis, cPreisText, Text8(8).Text, bMitVorschau
                        End If
                        
                    Next lcount
                    
                ElseIf iRet = vbNo Then
                    gutscheindrucken Label17(19).Caption, Text8(7).Text, Label17(18).Caption, Label17(20).Caption, Text8(8).Text, bMitVorschau
                End If
            Else
                gutscheindrucken Label17(19).Caption, Text8(7).Text, Label17(18).Caption, Label17(20).Caption, Text8(8).Text, bMitVorschau
            End If
        Case Is = 30            'nur Speichern von Garantie

            lKJADate = Fix(Now)
            cKJAZeit = Format$(Now, "HH:MM:SS")
            
            insertGarantie lKJADate, cKJAZeit, gcKasNum, CInt(gcBedienerNr), Text8(13).Text, Text8(9).Text, _
            CLng(Label17(30).Caption), Label17(31).Caption, Val(Label17(2).Caption), Val(Label18.Caption)
            
            Text8(9).Text = ""
            Text8(13).Text = ""
            
            Command14_Click 16
            
        Case Is = 19        'nur Schließen von GUTSCHEIN
            Frame1.Visible = True
            If gbLeiste2Start = True Then
                Frame23.Visible = True
                Frame2.Visible = False
            Else
                Frame2.Visible = True
                Frame23.Visible = False
            End If
            Frame3.Visible = True
            Frame4.Visible = True
            
            Frame5.Visible = False
            Frame9.Visible = False
            
            Frame12.Visible = False
            gbNumTaste = True
            
            setzedrucker gcBonDrucker
            
            Text1(0).Text = gcBedienerNr
            Text1(1).SetFocus
                                    
    End Select
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command14_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub gutscheindrucken(cCode As String, cGutschtext As String, cPreis As String, cPreisText As String, cBem As String, bMitDruckvorschau As Boolean)
On Error GoTo LOKAL_ERROR

    loeschNEW "PRINTGUTSCH", gdBase
    CreateTable "PRINTGUTSCH", gdBase
       
    Dim cEANCode As String
    Dim cSQL As String
    Dim cBarcode As String
    
    cEANCode = fnMoveGutschnr2EAN13(cCode)
    
    cBarcode = ean13(cEANCode)
    
    cSQL = "Insert into PRINTGUTSCH (Gutschtext,Gutschnr,GUPreis,Preistext,Datum,Bemerk,EAN,BARCODE)"
    cSQL = cSQL & "  values "
    cSQL = cSQL & "  ( '" & cGutschtext & "'"
    cSQL = cSQL & "  , " & cCode
    
    If Check13.value = vbChecked Then
        cSQL = cSQL & "  , '" & cPreis & "'"
        cSQL = cSQL & "  , '" & cPreisText & "'"
    Else
        cSQL = cSQL & "  , null "
        cSQL = cSQL & "  , ''"
    End If
       
    cSQL = cSQL & "  , '" & DateValue(Now) & "'"
    cSQL = cSQL & "  , '" & cBem & "'"
    cSQL = cSQL & "  , '" & cEANCode & "'"
    cSQL = cSQL & "  , '" & cBarcode & "'"
    cSQL = cSQL & "  )"
    gdBase.Execute cSQL, dbFailOnError
    
    Screen.MousePointer = 11
    
   
    
    If Modul6.FindFile(gcDBPfad, "aWKL20as.rpt") Then
        reportbildschirm_Gutschein "", "aWKL20as", bMitDruckvorschau
    Else
        reportbildschirm_Gutschein "", "aWKL20a", bMitDruckvorschau
    End If
    
   
    

    Screen.MousePointer = 0
       
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "gutscheindrucken"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Label2_Click(index As Integer)
On Error GoTo LOKAL_ERROR

    Dim ctmp As String
    If index = 24 Then
        gsBackcolor = Label2(24).BackColor
        gsForecolor = Label2(24).ForeColor
        gsArtikelFarbe = Label2(24).Tag
        
        frmWKL49.Show 1
        
        Label2(24).BackColor = gsBackcolor
        Label2(24).ForeColor = gsForecolor
        
        Label17(0).BackColor = gsBackcolor
        Label17(0).ForeColor = gsForecolor
        
        Label2(24).Tag = gsArtikelFarbe
        
        ctmp = gsArtikelFarbe
        
        If ctmp <> "" Then
            If ctmp = "98" Then
                Label2(24).Caption = "Neu"
            ElseIf ctmp = "95" Then
                Label2(24).Caption = "nicht lieferbar"
            ElseIf ctmp = "94" Then
                Label2(24).Caption = "Preisaktion vorbereitet"
            ElseIf ctmp = "93" Then
                Label2(24).Caption = "Preisaktion jetzt"
            ElseIf ctmp = "92" Then
                Label2(24).Caption = "lange nicht verkauft"
            Else
                If CByte(ctmp) < 10 Then
                    Label2(24).Caption = ermFarbeBez(ctmp)
                ElseIf CByte(ctmp) > 10 And CByte(ctmp) < 20 Then
                    Label2(24).Caption = ermFarbeBez(CStr(CInt(ctmp)))
                Else
                    Label2(24).Caption = ""
                End If
            End If
        Else
            Label2(24).Caption = ""
        End If
        
    End If
       
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Label2_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub



Private Sub Picture5_Click()
On Error GoTo LOKAL_ERROR

frmWKL160.Show 1

Dim cPfad As String
cPfad = gcDBPfad
If Right(cPfad, 1) <> "\" Then
    cPfad = cPfad & "\"
End If

Set Picture5.Picture = LoadPicture(cPfad & "Picture\System\" & "brief.gif")
Picture5.Visible = True
Picture5.Tag = "brief"

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Picture5_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub

Private Sub SSCommand100_Click(index As Integer)
On Error GoTo LOKAL_ERROR
    
    Dim iZielIndex As Integer
    
    iZielIndex = Label3(5).Caption
    If iZielIndex < 0 Then
        Exit Sub
    End If
    
    If index = 37 Then
        SwitchUpperLowerCaseWKL20
        Exit Sub
    End If
    
    If iZielIndex = 3 Then 'kunden_multifeld
        Select Case index
            Case 0 To 34, 63 To 72, 78 To 87
                Text3(iZielIndex).Text = Text3(iZielIndex).Text & SSCommand100(index).Caption
                Text3(iZielIndex).SetFocus
            Case 62    'Löschen
                Text3(iZielIndex).Text = ""
                Text3(iZielIndex).SetFocus
                
            Case 61
                If Len(Text3(iZielIndex).Text) > 0 Then
                    Text3(iZielIndex).Text = Left(Text3(iZielIndex).Text, Len(Text3(iZielIndex).Text) - 1)
                End If
                Text3(iZielIndex).SetFocus
                
            Case Is = 35 'zurück
                Select Case iZielIndex
                    Case 3
                        Combo1.SetFocus
                    Case 97
                        Text3(3).SetFocus
                End Select

            Case Is = 36 'vor

                Select Case iZielIndex
                    Case 3
                        Combo1.SetFocus
                    Case 97
                        Text3(3).SetFocus
                End Select
        End Select
        
    ElseIf iZielIndex = 97 Then 'Kunden_vorname
    
        Select Case index
            Case 0 To 34, 63 To 72, 78 To 87
                Combo1.Text = Combo1.Text & SSCommand100(index).Caption
                Combo1.SetFocus
            Case 62    'Löschen
                Combo1.Text = ""
                Combo1.SetFocus
                
            Case 61
                If Len(Combo1.Text) > 0 Then
                    Combo1.Text = Left(Combo1.Text, Len(Combo1.Text) - 1)
                End If
                Combo1.SetFocus
                
            Case Is = 35 'zurück
                Select Case iZielIndex
                    Case 3
                        Combo1.SetFocus
                    Case 97
                        Text3(3).SetFocus
                End Select

            Case Is = 36 'vor

                Select Case iZielIndex
                    Case 3
                        Combo1.SetFocus
                    Case 97
                        Text3(3).SetFocus
                End Select
        End Select
        
    ElseIf iZielIndex = 13 Then
        Select Case index
            Case 0 To 34, 63 To 72, 78 To 87
                Text8(iZielIndex).Text = Text8(iZielIndex).Text & SSCommand100(index).Caption
                Text8(iZielIndex).SetFocus
            Case 62    'Löschen
                Text8(iZielIndex).Text = ""
                Text8(iZielIndex).SetFocus
                
            Case 61 'leeren
                If Len(Text8(iZielIndex).Text) > 0 Then
                    Text8(iZielIndex).Text = Left(Text8(iZielIndex).Text, Len(Text8(iZielIndex).Text) - 1)
                End If
                Text8(iZielIndex).SetFocus
                
            Case Is = 35 'Zurück
                Text8(9).SetFocus
            
            Case Is = 36 'vor
                Text8(9).SetFocus
            
        End Select
    ElseIf iZielIndex = 9 Then
        Select Case index
            Case 0 To 34, 63 To 72, 78 To 87
                Text8(iZielIndex).Text = Text8(iZielIndex).Text & SSCommand100(index).Caption
                Text8(iZielIndex).SetFocus
            Case 62    'Löschen
                Text8(iZielIndex).Text = ""
                Text8(iZielIndex).SetFocus
                
            Case 61 'leeren
                If Len(Text8(iZielIndex).Text) > 0 Then
                    Text8(iZielIndex).Text = Left(Text8(iZielIndex).Text, Len(Text8(iZielIndex).Text) - 1)
                End If
                Text8(iZielIndex).SetFocus
                
            Case Is = 35 'Zurück
                Text8(13).SetFocus
            
            Case Is = 36 'vor
                Text8(13).SetFocus
        End Select
    ElseIf iZielIndex = 7 Then
        Select Case index
            Case 0 To 34, 63 To 72, 78 To 87
                Text8(iZielIndex).Text = Text8(iZielIndex).Text & SSCommand100(index).Caption
                Text8(iZielIndex).SetFocus
            Case 62    'Löschen
                Text8(iZielIndex).Text = ""
                Text8(iZielIndex).SetFocus

            Case 61 'leeren
                If Len(Text8(iZielIndex).Text) > 0 Then
                    Text8(iZielIndex).Text = Left(Text8(iZielIndex).Text, Len(Text8(iZielIndex).Text) - 1)
                End If
                Text8(iZielIndex).SetFocus

            Case Is = 35 'Zurück
                Text8(8).SetFocus

            Case Is = 36 'vor
                Text8(8).SetFocus
        End Select
        

    ElseIf iZielIndex = 8 Then
        Select Case index
            Case 0 To 34, 63 To 72, 78 To 87
                Text8(iZielIndex).Text = Text8(iZielIndex).Text & SSCommand100(index).Caption
                Text8(iZielIndex).SetFocus
            Case 62    'Löschen
                Text8(iZielIndex).Text = ""
                Text8(iZielIndex).SetFocus

            Case 61 'leeren
                If Len(Text8(iZielIndex).Text) > 0 Then
                    Text8(iZielIndex).Text = Left(Text8(iZielIndex).Text, Len(Text8(iZielIndex).Text) - 1)
                End If
                Text8(iZielIndex).SetFocus

            Case Is = 35 'Zurück
                Text8(7).SetFocus

            Case Is = 36 'vor
                Text8(7).SetFocus
            
        End Select
    Else
        Select Case index
            Case 0 To 34, 63 To 72, 78 To 87
                Text3(iZielIndex).Text = Text3(iZielIndex).Text & SSCommand100(index).Caption
                Text3(iZielIndex).SetFocus
            Case 62    'Löschen
                Text3(iZielIndex).Text = ""
                Text3(iZielIndex).SetFocus
                
            Case 61
                If Len(Text3(iZielIndex).Text) > 0 Then
                    Text3(iZielIndex).Text = Left(Text3(iZielIndex).Text, Len(Text3(iZielIndex).Text) - 1)
                End If
                Text3(iZielIndex).SetFocus
                
            Case Is = 35 'zurück
                Select Case iZielIndex
                    Case 4
                        Text3(1).SetFocus
                    Case 1
                        Text3(77).SetFocus
                    Case 77
                        Text3(5).SetFocus
                    Case 5
                        Text3(6).SetFocus
                    Case 6
                        Text3(2).SetFocus
                    Case 2
                        Text3(19).SetFocus
                    Case 19
                        Text3(0).SetFocus
                    Case 70
                        Text3(4).SetFocus
                End Select
            
            Case Is = 36 'vor
                
                Select Case iZielIndex
                    Case 0
                        Text3(19).SetFocus
                    Case 19
                        Text3(2).SetFocus
                    Case 2
                        Text3(6).SetFocus
                    Case 6
                        Text3(5).SetFocus
                    Case 5
                        Text3(77).SetFocus
                    Case 77
                        Text3(1).SetFocus
                    Case 1
                        Text3(4).SetFocus
                    Case 4
                        Text3(70).SetFocus
                End Select
        End Select
    End If
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 5 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SSCommand100_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. Zielindex: " & iZielIndex & " Index: " & index
        
        Fehlermeldung1
    End If
End Sub
Private Sub SSCommand2_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim iRet        As Integer
    Dim ctmp        As String
    Dim dWert       As Double
    Dim lcount      As Long
    Dim cArtNr      As String
    Dim cSQL        As String
    Dim rsrs        As Recordset
    Dim dAnz        As Double
    Dim iCount      As Integer
    Dim cZeichen    As String
    Dim i           As Integer
    Dim iStufe      As Integer
    Dim ctemp       As String
    Dim c2CheckBed  As String
    Dim iBedZaehler As Integer
    
    iStufe = 0
    
    gcWaehrung = "EUR"

    Select Case index
        Case 0 To 10    'Ziffern 1,2,3,4,5,6,7,8,9,0,00
            isperre = 0
            If Frame15.Visible = True Then
                Text1(2).Text = Text1(2).Text & SSCommand2(index).Caption
            Else

                If gcWaehrung = "EUR" Then
                    If Frame33.Visible = True Then
                        If gsFremdKuerzel <> "" Then
                            Text88.Text = Text88.Text & SSCommand2(index).Caption
                        Else
                            Text333.Text = Text333.Text & SSCommand2(index).Caption
                        End If
                    Else
                        If Label8(2).Caption = "0" Then
                            Text1(0).Text = Text1(0).Text & SSCommand2(index).Caption
                        ElseIf Label8(2).Caption = "1" Then
                        
                            Text1(1).Text = Text1(1).Text & SSCommand2(index).Caption

                        ElseIf Label8(2).Caption = "2" Then

                        End If
                    End If
                End If
            End If
            gbNumTaste = True
        Case Is = 11    'Komma
            If gcWaehrung = "EUR" Then
                If Frame33.Visible = True Then
                
                    If gsFremdKuerzel <> "" Then
                        Text88.Text = Text88.Text & SSCommand2(index).Caption
                    Else
                        Text333.Text = Text333.Text & SSCommand2(index).Caption
                    End If
    
                    
                Else
                
                    If Label8(2).Caption = "1" Then
                        Text1(1).Text = Text1(1).Text & SSCommand2(index).Caption
                    ElseIf Label8(2).Caption = "2" Then
    
                    End If
                    
                End If
            End If
        
        Case Is = 12    'Multiplikator
            
            If Label8(2).Caption = "1" Then
                ctmp = Left(Text1(1).Text, 5)
                ctmp = Trim$(ctmp)
                ctmp = fnMoveComma2Point$(ctmp)
                dWert = Val(ctmp)
                If Val(Label2(5).Caption) < 0 Then
                    dWert = dWert * -1
                End If
                
                If dWert >= 0 Then
                    Label2(5).Caption = Format$(dWert, "#####0")
                    Text1(1).Text = ""
                End If
                
                'ist der Wert kleiner 0  dann ist ein Storno im spiel
'                If dWert < 0 Then
'                    'ist Storno generell erlaubt?
'                End If
            End If
            
            isperre = isperre + 1
            If isperre > 2 Then
            
                allObjectsAusschalten Me
                
                Frame4.Enabled = True

                Frame15.Enabled = True
                Frame15.Visible = True
                Text1(2).Text = ""
                Text1(2).SetFocus
            
            End If
            
            
            
            
            
            
            
            
            
            
            
            
        Case Is = 13    'BackSpace
            If Frame15.Visible = True Then
                ctmp = Text1(2).Text
                ctmp = Trim$(ctmp)
                If ctmp <> "" Then
                    Text1(2).Text = Left(ctmp, Len(ctmp) - 1)
                End If
            Else
                If gcWaehrung = "EUR" Then
                    If Frame33.Visible = True Then
                        ctmp = Text333.Text
                        ctmp = Trim$(ctmp)
                        If ctmp <> "" Then
                            Text333.Text = Left(ctmp, Len(ctmp) - 1)
                        End If
                    Else 'End If
                    
                    If Label8(2).Caption = "0" Then
                        ctmp = Text1(0).Text
                        ctmp = Trim$(ctmp)
                        If ctmp <> "" Then
                            Text1(0).Text = Left(ctmp, Len(ctmp) - 1)
                        End If
                    ElseIf Label8(2).Caption = "1" Then
                        ctmp = Text1(1).Text
                        ctmp = Trim$(ctmp)
                        If ctmp <> "" Then
                            Text1(1).Text = Left(ctmp, Len(ctmp) - 1)
                        End If
                    End If
                    
                    End If
                End If
            End If
            
        Case Is = 14    'LOE
            If gcWaehrung = "EUR" Then
                If Frame33.Visible = True Then
                
                    
                    If gsFremdKuerzel <> "" Then 'Fremdwährung hat focus
                        iStufe = 122
                        Label88(2).Caption = "noch offen"
                        Label88(3).Caption = "0,00"
                        
                        Text88.Text = ""
                        iStufe = 123
                        Text88.SetFocus
                    Else
                        iStufe = 122
                        Label333(2).Caption = Label333(0).Caption
                        Label333(3).Caption = "0,00"
                        Label333(1).Caption = "0,00" 'dukate
                        dSumDukaten = 0 'dukate
                        Text333.Text = ""
                        iStufe = 123
                        Text333.SetFocus
                    End If
                    
                    iStufe = 124
                    Zurückrechnen
                    
                    iStufe = 125

                    
                    
                    Command33(0).Enabled = True
                    iStufe = 126
                Else 'End If
            
                If Label8(2).Caption = "0" Then
                    iStufe = 127
                    Text1(0).Text = ""
                ElseIf Label8(2).Caption = "1" Then
                    iStufe = 128
                    Text1(1).Text = ""
                    If Label2(0).Visible Then
                        iStufe = 129
                        Label1(1).Visible = False
                        Label2(0).Caption = "0,00"
                        Label2(0).Visible = False
                    End If
                    If Label2(1).Visible Then
                        iStufe = 130
                        Label1(2).Visible = False
                        Label2(1).Caption = "0,00"
                        Label2(1).Visible = False
                    End If
                    If Label2(2).Visible Then
                        iStufe = 131
                        Label2(2).Caption = " % "
                        Label2(2).Visible = False
                    End If
                    If Label2(5).Caption <> "1" Then
                        iStufe = 132
                        Label2(5).Caption = "1"
                    End If
                End If
                
                End If
            End If
        
        
        Case Is = 15    'OK Button
        
            If Text1(1).Text = "9999" Then
            
                If giBonusNr = 2 Then
            
                    spezi_bon_drucken
                    
                    Text1(1).Text = ""
                    Text1(1).SetFocus
                    Exit Sub
                
                End If
            End If
        
            anzeige "knormal", "", Label27
            
            faerbeRot
            faerbeRot_ArtAuswahl
            iStufe = 1
            
            isperre = 0
            
            If Command33(1).Caption = "Schließen" Then Frame33.Visible = False
            If Frame33.Visible = True Then
                
            Else
                iStufe = 2
                If Label8(2).Caption = "0" Then
                    iRet = fnLogonBedienerWKL20%()
                    iStufe = 3
                    If iRet = 0 Then
                        For lcount = 0 To 17
                            Command1(lcount).Visible = True
                        Next lcount
                        
                        iStufe = 4
                        
                        Label41(0).Visible = True
                        Label41(1).Visible = True
                        
                        
                        iStufe = 5
                        '*****Hier Zwangsgesamtrabatt
                        
                        'Frage Jubliläumsrabatt zeigen oder Kundenrabatt?
                    
                        If gsiGESRAB > 0 Then
                            zeigeZwangsrabatt
                        End If
                        iStufe = 6
                        '*****Hier Zwangsgesamtrabatt Ende
                        
'                        'Lese Konfiguration Kasse je nach Bediener
'                        LeseKonfigurationKasseWKL20
                        iStufe = 7
                        
                        LeseDisplayText
                        InitKundenDisplayModul20
                        
                        iStufe = 8
                        
                        If gbLeiste2Start = True Then
                            Frame23.Visible = True
                            Frame2.Visible = False
                        Else
                            Frame2.Visible = True
                            Frame23.Visible = False
                        End If
                        
                        If gsWAAGE <> "keine Waage" Then
                            Waage
                        End If
                        
                        iStufe = 81
                        
                        Frame1.Visible = True
                        Label1(0).Visible = True
                        
                        iStufe = 9
                        Text1(0).Visible = True
                        Label1(4).Visible = True
                        
                        iStufe = 10
                        Label2(5).Visible = True
                        Label1(5).Visible = True
                        
                        iStufe = 11
                        Label2(6).Visible = True
                        Label1(6).Visible = True
                        
                        iStufe = 12
                        Text1(1).Visible = True
                        gbNumTaste = True
                        
                        iStufe = 13
                        If Text1(1).Visible And Text1(1).Enabled Then
                            Text1(1).SetFocus
                        End If
                        
                        iStufe = 14
                        Label8(2).Caption = "1"
                        
                    End If
                ElseIf Label8(2).Caption = "1" Then
                
                    iStufe = 15
                    If Trim$(Text1(0).Text) = "" Or Trim$(Text1(0).Text) = "0" Then
                        anzeige "rot", "Verkauf ohne Bediener-Nr nicht möglich!", Label27
                        
                        iStufe = 16
                        If Text1(0).Visible And Text1(0).Enabled Then
                            Text1(0).SetFocus
                        End If
                        
                        Exit Sub
                    Else
                        iStufe = 17
                        iRet = fnLogonBedienerWKL20%()
                
                        If iRet <> 0 Then
                            Text1(0).SetFocus
                            Exit Sub
                        End If
                        
                        iStufe = 18
                    End If
                    
                    If Val(Trim$(Label2(5).Caption)) = 0 Then
                        iStufe = 19
                        MsgBox "Verkauf ohne Mengenanbabe nicht möglich!", vbCritical, "STOP!"
                        If Text1(1).Visible And Text1(1).Enabled Then
                            Text1(1).SetFocus
                        End If
                        iStufe = 20
                        
                        Exit Sub
                    End If
                    
                    cArtNr = Text1(1).Text
                    
                    iStufe = 21
                    For iCount = 1 To Len(cArtNr)
                        cZeichen = Mid(cArtNr, iCount, 1)
                        If InStr("1234567890,+-ß", cZeichen) = 0 Then
                            'Wenn etwas Alpha-mäßiges in dem Feld steht, wird von einer
                            'Artikelsuche mittels Texteingabe ausgegangen
                            iStufe = 22
                            
                            
                            
                            If Right$(Text1(1).Text, 14) = "nicht gefunden" Then
                                anzeige "Artikel", "Artikel nicht gefunden!", Label27
        
                                Text1(1).Text = "nicht gefunden"
                                Frame26.Visible = True
                                
                                Exit Sub
                            End If
                            
                            
                            If gbArtikelTextSuche = True Then
                                Command1_Click 16 'Artikelsuche
                                Text3(0).Text = Text1(1).Text
                                
                                iStufe = 23
                                Command4_Click 0
                                
                                bFocusonList4 = True
                                
                                Exit Sub
                            Else
                                anzeige "Artikel", "Artikel nicht gefunden!", Label27
                            
                                Text1(1).Text = "nicht gefunden"
                                Frame26.Visible = True
                                
                                Exit Sub
                            
                            End If
                        End If
                    Next iCount
                    
                    'wenn nicht in der Artikeltextsuche gelandet dann nochmals prüfen
                    
                    For iCount = 1 To Len(cArtNr)
                        cZeichen = Mid(cArtNr, iCount, 1)
                        If InStr("-", cZeichen) > 0 Then

                            anzeige "Artikel", "Artikel nicht gefunden!", Label27
                            Text1(1).Text = "nicht gefunden"
                            Frame26.Visible = True
                            Exit Sub
                        End If
                    Next iCount
                    
                    
                    iStufe = 24
                    If cArtNr = "-" Or cArtNr = "+" Then
                        cArtNr = cArtNr & "1"
                        Label2(5).Caption = Trim$(Str$(Val(cArtNr)))
                        Text1(1).Text = ""
                        
                        iStufe = 25
                        If Text1(1).Visible And Text1(1).Enabled Then
                            Text1(1).SetFocus
                        End If
                        iStufe = 26
                        Exit Sub
                    End If
                    
                    dAnz = Label2(5).Caption
                    
                    iStufe = 27
                    If Trim$(Text1(1).Text) = "" Then
                        anzeige "rot", "Bitte einen Wert eingeben!", Label27
                        
                        'das könnte das Problem sein
                        Text1(1).SetFocus
                        iStufe = 28
                        Exit Sub
                    End If
                    iStufe = 29
                    
                    If dAnz > 9999 Then
                        MsgBox "Ihre Mengeneingabe von " & dAnz & " Stück ist zu hoch.", vbInformation, "Winkiss Hinweis:"
                        Label2(5).Caption = "1"
                        Exit Sub
                    End If
                    
                    If dAnz > 999 Then
                      iRet = MsgBox("Ist Ihre Mengeneingabe von " & dAnz & " Stück richtig?", vbYesNo + vbQuestion + vbDefaultButton2, "Winkiss Frage:")
                        If iRet = vbNo Then
                            Label2(5).Caption = "1"
                            iStufe = 30
                            Exit Sub
                        End If
                    End If
                    
                    iStufe = 31
                    
                    '    Suche in zuordean
                    cSQL = "Select * from Zuordean where GPEAN = '" & Text1(1).Text & "' "
                    FnOpenrecordset rsrs, cSQL, 1, gdBase
                    If Not rsrs.EOF Then
                        Text1(1).Text = IIf(IsNull(rsrs!EAN), "", rsrs!EAN)
                        Label2(5).Caption = IIf(IsNull(rsrs!Faktor), 1, rsrs!Faktor * dAnz)
                    End If
                    rsrs.Close: Set rsrs = Nothing
                    
                    iStufe = 32
            
                    SucheArtikelWKL20
                    
                    iStufe = 33
                    
                ElseIf Label8(2).Caption = "2" Then
                
                End If
           End If
           
           
        Case Is = 16    'Storno
        
            If gbSPY Then
                frmWKL20!Winsock22.senddata "Taste Storno wird gedrückt" & vbCrLf
            End If
        
        
        
            If Identi(76) Then '76 steht für storno
                'Arbeitet Unternehmen mit Bedienerkarte?
                If gbBEDKARTE = True Then
                    'Ja unternehmen arbeitet mit Bedienerkarten
                    
                    'jetzt ist die Frage, ob 2 Bediener ein Storno erlauben müssen ungeachtet der Berechtigungsstrufe
                    If gbSTORNOcheck2Bed Then
                        'zweifache Bedienerkartenüberprüfung ohne Levelberechtigung
                        
                        gcIdentStornoBedienerNr1 = ""
                        gcIdentStornoBedienerNr2 = ""
                        
                        gcIdentUserName = ""
                        gcIdentPass = ""
                        gcIdentBedienerNr = ""
                        glIdentLevel = -1
                        
                        c2CheckBed = ""
                        iBedZaehler = 0
                            
                        gsMeldestatus = "Identifikation"
                        
                        frmWK12a.Show 1
                        If glIdentLevel = -1 Then
                            gbStornoErlaubt = False
                        Else
                            gbStornoErlaubt = True
                            c2CheckBed = gcIdentBedienerNr
                            gcIdentStornoBedienerNr1 = gcIdentBedienerNr
                            iBedZaehler = 1
                            
                            '2.Mal
                        
                            gcIdentUserName = ""
                            gcIdentPass = ""
                            gcIdentBedienerNr = ""
                            glIdentLevel = -1
                            
                            
                            
                            gsMeldestatus = "Identifikation"
                            
                            frmWK12a.Show 1
                            If glIdentLevel = -1 Then
                                gbStornoErlaubt = False
                            Else
                                gbStornoErlaubt = True
                                If c2CheckBed <> gcIdentBedienerNr Then
                                    iBedZaehler = 2
                                    gcIdentStornoBedienerNr2 = gcIdentBedienerNr
                                Else
                                    gcIdentStornoBedienerNr1 = ""
                                    gcIdentStornoBedienerNr2 = ""
                                    c2CheckBed = ""
                                    iBedZaehler = 0
                                End If
                            End If
                            '2.Mal ende
                        End If
                        
                        
                        If iBedZaehler <> 2 Then
                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                            
                            Label2(5).Caption = "1"
                            
                            If Text1(1).Visible = True Then
                                Text1(1).SetFocus
                            End If
                            
                            gcIdentStornoBedienerNr1 = ""
                            gcIdentStornoBedienerNr2 = ""
                
                            Exit Sub
                        End If
                    
                    Else
                        'einfache Bedienerkartenüberprüfung mit Levelberechtigung
                        gcIdentUserName = ""
                        gcIdentPass = ""
                        gcIdentBedienerNr = ""
                        glIdentLevel = -1
                            
                        gsMeldestatus = "Identifikation"
                        
                        frmWK12a.Show 1
                        If glIdentLevel = -1 Then
                            gbStornoErlaubt = False
                        Else
                            
                            If gbZugriffNew Then
                                If glIdentLevel >= ermittlezugriff(76) Then
                                    schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                    gbStornoErlaubt = True
                                Else
                                    
                                    ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                    ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                    schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                    MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                    gbStornoErlaubt = False
                                End If
                            Else
                                gbStornoErlaubt = True
                            End If
                            
                        End If
                        
                        If Not gbStornoErlaubt Then
                        
                            If glIdentLevel = -1 Then
                                MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                            End If
                            
                            Label2(5).Caption = "1"
                            
                            If Text1(1).Visible = True Then
                                Text1(1).SetFocus
                            End If
                            
                            Exit Sub
                        End If
                    End If
                Else
                    frmWKLai.Show 1
                    If Not gbStornoErlaubt Then
                        MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        Label2(5).Caption = "1"
                        If Text1(1).Visible = True Then
                            Text1(1).SetFocus
                        End If
                        Exit Sub
                    End If
                End If
            End If
            If Label8(2).Caption = "1" Then
                If Left(Label2(5).Caption, 1) <> "-" Then
                    Label2(5).Caption = "-" & Label2(5).Caption
                End If
            End If
        
''        Case Is = 17    'Windows Taskleiste
''
''            SendKeysEx "WIN"
'''            SendKeysEx "{WIN}"
             
        
        
    End Select
    
    If Label8(2).Caption = "0" Then
        If Text1(0).Visible And Text1(0).Enabled Then
            Text1(0).SetFocus
        End If
    ElseIf Label8(2).Caption = "1" Then
        If Text1(1).Visible And Text1(1).Enabled Then
            Text1(1).SetFocus
        End If
    End If
Exit Sub
LOKAL_ERROR:

    If index = 14 And iStufe = 123 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SSCommand2_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & index & " " & iStufe
        
        Fehlermeldung1
    End If
End Sub

Private Sub Waage()
    On Error GoTo LOKAL_ERROR
    
    If Not MSComm3.PortOpen = False Then MSComm3.PortOpen = False
                        
    MSComm3.CommPort = gbYteWAAGEPcom
    MSComm3.InputLen = 0
    MSComm3.RThreshold = 1

    If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
    
Exit Sub
LOKAL_ERROR:

    MsgBox "Die Waage ist nicht angeschlossen.", vbInformation, "Winkiss Hinweis:"

End Sub
Private Sub RechneNochFürFremdW()
    On Error GoTo LOKAL_ERROR

    Dim dOffen As Double
    dOffen = CDbl(Label333(0).Caption) / CDbl(gsUK)
    Label88(2).Caption = "noch offen"
    Label88(3).Caption = Format$(dOffen, "#####0.00")
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "RechneNochFürFremdW"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub LeseKonfigurationKasseWKL20()
    On Error GoTo LOKAL_ERROR
    
    Dim lAnzSatz As Long
    Dim lAktSatz As Long
    Dim DSatz As KASSEINI_
    Dim iFileNr As Integer
    Dim iBedNr As Integer
    Dim bgefunden As Boolean
    
    iBedNr = Val(Text1(0).Text)
    
    iFileNr = FreeFile
    
    Open gcPfad & "KASSEWKL.INI" For Random As #iFileNr Len = Len(DSatz)
    If LOF(iFileNr) > 0 Then
        lAnzSatz = LOF(iFileNr) / Len(DSatz)
        For lAktSatz = 1 To lAnzSatz
            Get #iFileNr, lAktSatz, DSatz
            If DSatz.LFDNR = -1 Then
                If DSatz.Wert1 = 1 Then
                    gbDisplay = True
                    If DSatz.WERT2 > 0 Then
                        gbDisplaySeriell = True
                        giDisplaySeriellComPort = DSatz.WERT2
                    Else
                        gbDisplaySeriell = False
                    End If
                Else
                    gbDisplay = False
                    gbDisplaySeriell = False
                End If
                Exit For
            End If
        Next lAktSatz
    Else
        gbDisplay = False
    End If
    Close iFileNr
    
'    If DSatz.WERT2 = 9 Then
'        gbZweitMoni = True
'    End If
    
    If gbDisplaySeriell Then
        iFileNr = FreeFile
        Open gcPfad & "DISPLAY.CFG" For Binary As #iFileNr
        If LOF(iFileNr) > 0 Then
            gcDisplay = Space$(LOF(iFileNr))
            Get #iFileNr, 1, gcDisplay
        Else
            gcDisplay = "Epson"
        End If
        Close iFileNr
    End If
    
    If gbDisplaySeriell Then
        Select Case gcDisplay
            Case Is = "Aures neu"
                frmWKL20!MSComm3.CommPort = giDisplaySeriellComPort
                frmWKL20!MSComm3.Settings = "9600,N,8,1"
                frmWKL20!MSComm3.InputLen = 0
                frmWKL20!MSComm3.PortOpen = True
            Case Is = "Sango"
                frmWKL20!MSComm3.CommPort = giDisplaySeriellComPort
                frmWKL20!MSComm3.Settings = "9600,N,8,1"
                frmWKL20!MSComm3.InputLen = 0
                frmWKL20!MSComm3.PortOpen = True
        End Select
    End If
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 8005 Then
        Resume Next
    ElseIf err.Number = 8002 Then
        MsgBox "Der COM - Port " & giDisplaySeriellComPort & " steht nicht zur Verfügung.", vbInformation, "Winkiss Hinweis:"
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "LeseKonfigurationKasseWKL20"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
End Sub
Private Sub Command33_KeyUp(index As Integer, KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyEscape Then
        Command33_Click (1)
    ElseIf KeyCode = vbKeyReturn Then
        Command33_Click (0)
    Else
'        Frame33.SetFocus 'Command4(12).SetFocus
    End If
      
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command33_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub voreinstellungspeichern()
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL    As String
    Dim bo0     As Integer
    Dim bo1     As Integer
    Dim bo2     As Integer
    Dim bo3     As Integer
    Dim bo4     As Integer
    
    loeschNEW "EKASS", gdApp
    CreateTable "EKASS", gdApp


    bo0 = Option2(0).value
    bo1 = Option2(1).value
    bo2 = Option2(2).value
    bo3 = Option2(3).value
    bo4 = Option2(4).value
    
    sSQL = "Insert into EKASS ( bo0,bo1,bo2,bo3,bo4) values (" & bo0 & "," & bo1 & "," & bo2 & "," & bo3 & "," & bo4 & ")"
    gdApp.Execute sSQL, dbFailOnError
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungspeichern"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Sub voreinstellungladen()
    On Error GoTo LOKAL_ERROR
    
    Dim rs As Recordset
    Dim cSQL As String
    
    cSQL = "select * from EKASS"
    Set rs = gdApp.OpenRecordset(cSQL)
    
    If Not rs.EOF Then
        rs.MoveFirst
        If Not IsNull(rs!bo0) Then
            Option2(0).value = rs!bo0
        End If
        If Not IsNull(rs!bo1) Then
            Option2(1).value = rs!bo1
        End If
        
        If Not IsNull(rs!bo2) Then
            Option2(2).value = rs!bo2
        End If
        If Not IsNull(rs!bo3) Then
            Option2(3).value = rs!bo3
        End If
        If Not IsNull(rs!bo4) Then
            Option2(4).value = rs!bo4
        End If
    End If
    rs.Close: Set rs = Nothing

     
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungladen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
    Resume Next
End Sub
Private Sub Command4_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim iRet As Integer
    Dim cLBSatz As String
    Dim cSQL As String
    Dim rsrs As Recordset
    Dim cPfad As String
    Dim ctemp As String
    Dim bErlaubt As Boolean
    Dim sSQL As String
    
    Screen.MousePointer = 11
    
    Select Case index
        Case Is = 0

            anzeige "normal", "Artikel suchen", Label9
            iRet = fnPruefeDialogSucheArtWKL20()
            If iRet = 0 Then
                List4.Visible = False
                List4.Refresh
                List2.Visible = False
                List2.Refresh
                
                Command4(10).Visible = False
                Command4(9).Visible = False
                Command4(1).Visible = False
                Command8(118).Visible = False
                Command8(119).Visible = False
                cmdFoto.Visible = False
                
                Me.Refresh

                SucheArtikelKasseWKL20
            Else
                MsgBox "Bitte die Suchkriterien erweitern!", vbInformation, "Winkiss Hinweis:"
                Text3(0).SetFocus
            End If


        Case Is = 1
            If List4.SelectedItem Is Nothing Then
                MsgBox "Bitte einen Eintrag in der Liste auswählen!", vbInformation, "Winkiss Hinweis:"
'                List4.SetFocus
            Else
                cLBSatz = List4.SelectedItem.Text
                cLBSatz = Left(cLBSatz, 6)
                cLBSatz = Trim$(cLBSatz)
                Text1(1).Text = cLBSatz
                Command4_Click 2
                SSCommand2_Click 15
            End If
        Case Is = 2
            
            Frame1.Visible = True
            
            If gbLeiste2Start = True Then
                Frame23.Visible = True
                Frame2.Visible = False
            Else
                Frame2.Visible = True
                Frame23.Visible = False
            End If
            
            Frame3.Visible = True
            Frame4.Visible = True
            Frame33.Visible = False
            Frame6.Visible = False
            Frame9.Visible = False
            gbNumTaste = True
            Text1(1).SetFocus
            voreinstellungspeichern
          
        Case Is = 3 'schließen
            Frame1.Visible = True
            If gbLeiste2Start = True Then
                Frame23.Visible = True
                Frame2.Visible = False
            Else
                Frame2.Visible = True
                Frame23.Visible = False
            End If
            Frame3.Visible = True
            Frame4.Visible = True
            Frame33.Visible = False
            Frame6.Visible = False
            
            Frame8.Visible = False
            Frame9.Visible = False
            
            MSComm2.PortOpen = False
            
            gbNumTaste = True
            Text1(1).SetFocus
            iKasse = 0
            gcKundenNr = ""
            If glSelect < 1 Then
                iOldPreisKZ = giPreisKz
                kundenauswahlausblend
                If giPreisKz <> iOldPreisKZ Then
                    AktualisiereListboxWKL20aufGrundPreisKZand
                    AktualisiereZeileZwischenSummeWKL20
                End If
            End If
            
        Case Is = 4     'WÄHLEN
            iOldPreisKZ = giPreisKz
            
            kundenauswahlausblend True
            
            If glSelect < 1 Then
                Screen.MousePointer = 0
                MsgBox "Bitte einen Satz in der Tabelle markieren!", vbInformation, "Winkiss Hinweis:"
                Exit Sub
            Else
                grd1.Row = glSelect
                grd1.Col = 0
                cLBSatz = grd1.Text
                cLBSatz = Trim$(cLBSatz)
                
                If Val(cLBSatz) > 0 Then
                
                    If gbDSDRUCKEN Then
                        If DS_Noch_Nicht_Unterschrieben(cLBSatz) Then
                        
                            MsgBox "Datenschutzblatt wurde noch NICHT unterschrieben!", vbInformation, "Unterschrift erforderlich:"
                        
                            If gcListenDrucker <> gcBonDrucker Then
                                setzedrucker gcListenDrucker
            
                                DatenschutzblattKundeDrucken cLBSatz, True
                                Pause 2
                                setzedrucker gcBonDrucker
                                
                                iRet = MsgBox("Wurde das Datenschutzblatt unterschrieben?", vbQuestion + vbYesNo + vbDefaultButton2, "Winkiss Frage:")
                                If iRet = vbYes Then
                                    sSQL = "Update Kunden set ds = true"
                                    sSQL = sSQL & " , Status = 'E' "
                                    sSQL = sSQL & " , SynStatus = 'E' "
                                    sSQL = sSQL & " where kundnr = " & cLBSatz
                                    gdBase.Execute sSQL, dbFailOnError
                                End If
                                
                            End If
                        Else
                            If gbDSMeldungErfolg = True Then
                                MsgBox "Datenschutzblatt wurde unterschrieben!", vbInformation, "OK"
                            End If
                        End If
                    End If
                    
                    HoleKundenDatenWKL20 cLBSatz
                    Label2(7).Caption = cLBSatz
                    
                    If gbSterne Then
                        
                        AllesinKUNDAZEeinzel Label2(7).Caption, False
                        Zeigdiesterne Picture1(1), Picture1(2), Picture1(3), Picture1(4), Picture1(5), wievieleSterne(Label2(7).Caption, "KUNDA" & srechnertab, 180), wievieleSterneAlt
                        
                    End If
                    
                    Label2(7).Visible = True
                    Label1(7).Visible = True
                    Label1(19).Visible = True
                    Command4_Click 3
                End If
            End If
            
        Case Is = 5 '** suchen **
            iRet = fnPruefeDialogSucheKundenWKL20()
            If iRet = 0 Then
                glSelect = 0
                SucheKundenKasseWKL20
            Else
                MsgBox "Bitte mindestens 1 Suchkriterium angeben!", vbInformation, "Winkiss Hinweis:"
                Text3(3).SetFocus
            End If
            
        Case Is = 6     '** Historie **
        
            If glSelect < 1 Then
                Screen.MousePointer = 0
                MsgBox "Bitte einen Satz in der Tabelle markieren!", vbInformation, "Winkiss Hinweis:"
                Exit Sub
            Else
                grd1.Row = glSelect
                grd1.Col = 0
                cLBSatz = grd1.Text
                cLBSatz = Trim$(cLBSatz)
                If Val(cLBSatz) > 0 Then
                
                    gckundnr = cLBSatz
                    gckundnr = Trim$(gckundnr)
                    gsARTNR = ""
                    
                    If gckundnr <> "" Then
                    
                        gdBonusAusKundenhistorie = 0
                        
                        gbBonusEinloesungHierErlaubt = True
                        frmWKL74.Show 1
                        gbBonusEinloesungHierErlaubt = False
                        
                        If glBonusAuszahlungArtnr > 0 Then
                            If gdBonusAusKundenhistorie > 0 Then
                            
                                Command4_Click 4
                            
                                Artikel_kassieren_mit_PreisUebergabe glBonusAuszahlungArtnr, Format(gdBonusAusKundenhistorie, "######0.00")
                            
                            End If
                        End If
                    End If
                    setzedrucker gcBonDrucker
                End If
            End If
        Case 7
            cPfad = gcDBPfad
            If Right(cPfad, 1) <> "\" Then
                cPfad = cPfad & "\"
            End If
            
            zeigeHilfe "LPROTOK", "Schalter1Prot.txt", cPfad
        Case 12
            cPfad = gcDBPfad
            If Right(cPfad, 1) <> "\" Then
                cPfad = cPfad & "\"
            End If
            
            zeigeHilfe "LPROTOK", "Schalter2Prot.txt", cPfad
        Case Is = 8  '** Daten **
            If gbBEDKARTE = True Then
            
                If Identi(94) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
                    
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(94) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                            End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
                
            Else
                If glLevel >= 5 Then
                    
                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
        
           iKasse = 0
            
            If glSelect < 1 Then
                Screen.MousePointer = 0
                MsgBox "Bitte einen Satz in der Tabelle markieren!", vbInformation, "Winkiss Hinweis:"
                Exit Sub
            Else
                grd1.Row = glSelect
                grd1.Col = 0
                cLBSatz = grd1.Text
                cLBSatz = Trim$(cLBSatz)
                gckundnr = Trim$(Str$(Val(cLBSatz)))
                
                gcKundenNr = gckundnr
                
                iKasse = 2
                frmWKL13.Show 1
                setzedrucker gcBonDrucker
                Text3(3).Text = gckundnr
                Command4_Click 5
            End If
            

            iKasse = 0
        Case Is = 9
            If gbBEDKARTE = True Then

                If Identi(87) Then
                'ja man muss sich hier identifizieren

                    'Ja
                    bErlaubt = False

                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1

                    gsMeldestatus = "Identifikation"

                    frmWK12a.Show 1

                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else

                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(87) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else

                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If

                    End If

                    If Not bErlaubt Then

                        If glIdentLevel = -1 Then

                        End If

                        Exit Sub
                    Else

                    End If
                End If

            Else
                If glLevel >= 5 Then

                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If
        
        
            If List4.SelectedItem Is Nothing Then
                MsgBox "Bitte einen Eintrag in der Liste auswählen!", vbCritical, "STOP!"
'                List4.SetFocus
            Else
                cLBSatz = List4.SelectedItem.Text
                cLBSatz = Left(cLBSatz, 6)
                cLBSatz = Trim$(cLBSatz)
                gcArtNrFiliale = cLBSatz
                frmWKLae.Show 1
                
            End If
            
        Case Is = 10  '//info
        
        'ausgeblendet für naegele
        'wieder eingeblendet auf mehrfachen Wunsch
        
            If gbBEDKARTE = True Then

                If Identi(87) Then
                'ja man muss sich hier identifizieren

                    'Ja
                    bErlaubt = False

                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1

                    gsMeldestatus = "Identifikation"

                    frmWK12a.Show 1

                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else

                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(87) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else

                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If

                    End If

                    If Not bErlaubt Then

                        If glIdentLevel = -1 Then

                        End If

                        Exit Sub
                    Else

                    End If
                End If

            Else
                If glLevel >= 5 Then

                Else
                    MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                    Exit Sub
                End If
            End If

            If List4.SelectedItem Is Nothing Then
                MsgBox "Bitte einen Eintrag in der Liste auswählen!", vbCritical, "STOP!"
            Else
                cLBSatz = List4.SelectedItem.Text

                cLBSatz = Left(cLBSatz, 6)
                cLBSatz = Trim$(cLBSatz)
                gcArtNrFiliale = cLBSatz
                frmWKLam.Show 1
            End If
            
        Case Is = 11 '** Bonus **
        
            Dim dBonusvomKundevoher As Double
            Dim dBonusfaehigjetzt As Double
            
            dBonusvomKundevoher = 0
            dBonusfaehigjetzt = 0
        
            If glSelect < 1 Then
                Screen.MousePointer = 0
                MsgBox "Bitte einen Satz in der Tabelle markieren!", vbInformation, "Winkiss Hinweis:"
                Exit Sub
            Else
                gckundnr = ""
                grd1.Row = glSelect
                grd1.Col = 0
                cLBSatz = grd1.Text
                cLBSatz = Trim$(cLBSatz)
                gckundnr = Trim$(Str$(Val(cLBSatz)))
                If Val(cLBSatz) > 0 Then
                    If gbBonusBNB = True Then
                        If gbFILBONI = True Then
                            If ermfilfromKUNDE(gckundnr) = CInt(gcFilNr) Then
                                If KundeBonusfähig(gckundnr) Then
                                    frmWK20e.Show 1
                                End If
                            End If
                        Else
                            If KundeBonusfähig(gckundnr) Then
                                frmWK20e.Show 1
                            End If
                        End If
                    Else
                        If gbFILBONI = True Then
                            If ermfilfromKUNDE(gckundnr) = CInt(gcFilNr) Then
                            
                                dBonusfaehigjetzt = ermittleBonusjetzt
                                dBonusvomKundevoher = ermittleBonusVorher(gckundnr)
                                
                                dBonusfaehig = dBonusfaehigjetzt + dBonusvomKundevoher
                    
                                If dBonusfaehig >= gdBonusGrenze Then
                                    If KundeBonusfähig(gckundnr) Then
                                        frmWK20h.Show 1
                                    End If
                                    
                                    If gbbonusHerab = True Then
                                        Command4_Click 4
                                        Exit Sub
                                    End If
                                    
                                End If
                            Else
                                MsgBox "Bonusauszahlungen nur in der Stammfiliale!", vbInformation, "Winkiss Hinweis:"
                            End If
                        Else
                            dBonusfaehigjetzt = ermittleBonusjetzt
                            dBonusvomKundevoher = ermittleBonusVorher(gckundnr)
                            
                            dBonusfaehig = dBonusfaehigjetzt + dBonusvomKundevoher
                
                            If dBonusfaehig >= gdBonusGrenze Then
                                If KundeBonusfähig(gckundnr) Then
                                    frmWK20h.Show 1
                                End If
                                
                                If gbbonusHerab = True Then
                                    Command4_Click 4
                                    Exit Sub
                                End If
                                
                            End If
                        End If
                    End If
                    
                    Me.Refresh
                    Gridneu gckundnr
                    gckundnr = ""
                End If
            End If
            
        Case 13 'Bonusprotokoll
        
            
            cPfad = gcDBPfad
            If Right(cPfad, 1) <> "\" Then
                cPfad = cPfad & "\"
            End If
            
            zeigeHilfe "LPROTOK", "BonusPro.rtf", cPfad
            
        Case 14 'Bonusanzeige
        
            
            cPfad = gcDBPfad
            If Right(cPfad, 1) <> "\" Then
                cPfad = cPfad & "\"
            End If
            
            zeigeHilfe "LPROTOK", "BONUSANZEIGE.txt", cPfad
        Case 15
            List4.Visible = False
            List2.Visible = False
            List4.Nodes.Clear
            
            Me.Refresh
            
            If Command4(15).Caption = "weitere Artikel" Then
                ermweitereArtikel
            ElseIf Command4(15).Caption = "noch mehr Artikel" Then
                ermweitereArtikelT2
            End If
        Case Is = 16     '** Kosmetik **
        
            If glSelect < 1 Then
                Screen.MousePointer = 0
                MsgBox "Bitte einen Satz in der Tabelle markieren!", vbInformation, "Winkiss Hinweis:"
                Exit Sub
            Else
                grd1.Row = glSelect
                grd1.Col = 0
                cLBSatz = grd1.Text
                cLBSatz = Trim$(cLBSatz)
                If Val(cLBSatz) > 0 Then
                
                    gckundnr = cLBSatz
                    gckundnr = Trim$(gckundnr)
                    gsARTNR = ""
                    
                    If gckundnr <> "" Then
                        Screen.MousePointer = 0
                        frmWKL94.Show 1
                    End If
'                    setzedrucker gcBonDrucker
                End If
            End If
        
    End Select
        
    Screen.MousePointer = 0
    
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 8012 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Command4_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & index
        
        Fehlermeldung1
'        Resume Next
    End If
End Sub
Private Sub HoleKundenDatenWKL20(cKdnr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL            As String
    Dim rsrs            As Recordset
    Dim ctmp            As String
    Dim ctmpNotizen     As String
    Dim dWert           As Double
    Dim dBonus          As Double
    Dim SFarbe          As String
    Dim sEmail          As String
    Dim bPreisKZAnd     As Boolean
    
    Dim cECIdent        As String
    Dim cGesperrt       As String
    
    Dim sZielpfad       As String
    Dim lbildcount      As Long
    lbildcount = 0
    
    sZielpfad = gcDBPfad
    If Right(sZielpfad, 1) <> "\" Then
        sZielpfad = sZielpfad & "\"
    End If
    sZielpfad = sZielpfad & "PICTURE\KUNDEN"
    
    
    If FileExists(sZielpfad & "\" & cKdnr & ".jpg") = True Then
        lbildcount = lbildcount + 1
    End If
    
    If FileExists(sZielpfad & "\" & cKdnr & "_1.jpg") = True Then
        lbildcount = lbildcount + 1
    End If
    
    If FileExists(sZielpfad & "\" & cKdnr & "_2.jpg") = True Then
        lbildcount = lbildcount + 1
    End If
    
    If lbildcount > 1 Then
        Timer2.Enabled = True
    End If
    
    bPreisKZAnd = False
    
    Kunden_Bildzeigen cKdnr, Image4, Picture4, 100, cKdnr
    
    cSQL = "Select * from KUNDEN where KUNDNR = " & cKdnr & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!RABATT) Then
            ctmp = rsrs!RABATT
        Else
            ctmp = "0"
        End If
        
        If Not IsNull(rsrs!name) Then
            Label8(0).Caption = rsrs!name
        Else
            Label8(0).Caption = ""
        End If
        If Not IsNull(rsrs!vorname) Then
            Label8(1).Caption = rsrs!vorname
        Else
            Label8(1).Caption = ""
        End If
        If Not IsNull(rsrs!PREISKZ) Then
            Label8(3).Caption = rsrs!PREISKZ
        Else
            Label8(3).Caption = "0"
        End If
        
        giPreisKz = Val(Label8(3).Caption)
        
        If giPreisKz <> iOldPreisKZ Then
            bPreisKZAnd = True
        End If
        iOldPreisKZ = giPreisKz
        
        If Not IsNull(rsrs!Plz) Then
            Label1(11).Caption = rsrs!Plz
            Label1(11).Visible = True
        Else
            Label1(11).Caption = ""
        End If
        
        If Not IsNull(rsrs!STADT) Then
            Label1(12).Caption = rsrs!STADT
            Label1(12).Visible = True
        Else
            Label1(12).Caption = ""
        End If
        
        If Not IsNull(rsrs!titel) Then
            Label1(19).Caption = rsrs!titel
            Label1(19).Visible = True
        Else
            Label1(19).Caption = ""
        End If
        
        If Not IsNull(rsrs!strasse) Then
            Label1(13).Caption = rsrs!strasse
            Label1(13).Visible = True
        Else
            Label1(13).Caption = ""
        End If
        
        If Not IsNull(rsrs!FILIALNR) Then
            Label1(15).Caption = rsrs!FILIALNR
            Label1(15).Visible = True
        Else
            Label1(15).Caption = ""
        End If
        
        If Not IsNull(rsrs!Email) Then
            Label1(17).Caption = rsrs!Email
            Label1(17).Visible = True
        Else
            Label1(17).Caption = ""
        End If
        
        If Not IsNull(rsrs!KurzTEXT2) Then
            If Len(Label1(17).Caption) > 0 Then
                Label1(17).Caption = Label1(17).Caption & " / " & rsrs!KurzTEXT2
            Else
                Label1(17).Caption = rsrs!KurzTEXT2
            End If
            Label1(17).Visible = True
        Else
            Label1(17).Caption = ""
        End If
        
        If Not IsNull(rsrs!NOTIZEN) Then
            ctmpNotizen = rsrs!NOTIZEN
            ctmpNotizen = SwapStr(ctmpNotizen, Chr(10), " ")
            ctmpNotizen = SwapStr(ctmpNotizen, Chr(13), " ")
            Label1(28).Caption = ctmpNotizen
            Label1(28).Visible = True
        Else
            Label1(28).Caption = ""
        End If
        
        If Not IsNull(rsrs!BONUS) Then
            dBonus = rsrs!BONUS
            Label1(14).Caption = Format(dBonus, "###0.00")
            If Check7.value = vbChecked Then
                Label1(14).Visible = True
            Else
                Label1(14).Visible = False
            End If
        Else
            dBonus = 0
        End If
        
        If Not IsNull(rsrs!ECIDENT) Then
            cECIdent = rsrs!ECIDENT
        Else
            cECIdent = ""
        End If
        
        If Not IsNull(rsrs!GESPERRT) Then
            cGesperrt = rsrs!GESPERRT
        Else
            cGesperrt = "N"
        End If
        
        If Not IsNull(rsrs!MERKMAL) Then
            sMerkmal = rsrs!MERKMAL
        Else
            sMerkmal = ""
        End If
        
        If Not IsNull(rsrs!AWM) Then
            SFarbe = rsrs!AWM
        Else
            SFarbe = "0"
        End If
        
        
        If InStr(sMerkmal, "ø") Then
             gbMerkmal = True
        Else
             gbMerkmal = False
        End If
        
        If Not IsNull(rsrs!Email) Then
            sEmail = rsrs!Email
            
        Else
            sEmail = ""
        End If
        
    Else
        ctmp = "0"
        Label8(0).Caption = ""
        Label8(1).Caption = ""
        dBonus = 0
        cECIdent = ""
        cGesperrt = "N"
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If gbKUWAHLROT = True Then
        If SFarbe = "3" Then
            MsgBox ermFarbeKU("3"), vbInformation, "Winkiss Hinweis:"
        End If
    End If
    Dim k As Integer
    Dim cFarbtemp As String
    
    If gbKUWAHLfbimmer = True Then
        If SFarbe <> "0" Then
            
            cFarbtemp = ermFarbeKU(SFarbe)
    
            gsKundenfarbbeschreib = cFarbtemp
            frmWK21r.Show 1
            gsKundenfarbbeschreib = ""

            
        End If
    End If
    
    Dim sAntwort As String
    If gbKUWAHLMAIL = True Then
        If UCase(sEmail) <> "KEINE" Then
            If UCase(sEmail) = "" Then
        
                sAntwort = InputBox("Emailadresse erfragen!", "Winkiss Frage:", "hier die Emailadresse eintragen...")
                
                If sAntwort = "hier die Emailadresse eintragen..." Then
                    cSQL = "Update KUNDEN Set Email = 'KEINE'"
                    cSQL = cSQL & " where KUNDNR = " & cKdnr & " "
                    gdBase.Execute cSQL, dbFailOnError
                Else
                    If InStr(1, sAntwort, "@") = 0 Then
                        'wiederholen @ fehlt
                        sAntwort = InputBox("Emailadresse ist ungültig, @ fehlt!", "Winkiss Frage:", sAntwort)
                    End If
                    
                    If InStr(1, sAntwort, ".") = 0 Then
                        'wiederholen @ fehlt
                        sAntwort = InputBox("Emailadresse ist ungültig, . fehlt!", "Winkiss Frage:", sAntwort)
                    End If
                    
                    If sAntwort <> "" Then
                        cSQL = "Update KUNDEN Set Email = '" & sAntwort & "'"
                        cSQL = cSQL & " where KUNDNR = " & cKdnr & " "
                        gdBase.Execute cSQL, dbFailOnError
                        
                        
                        Dim lbednu As Long
                        lbednu = Val(Text1(0).Text)
                        
                        cSQL = "Insert into MAILFB (Datum,Filiale,Bednu,Kundnr,Email,SENDOK) values "
                        cSQL = cSQL & " ( "
                        cSQL = cSQL & "'" & DateValue(Now) & "'"
                        cSQL = cSQL & " ," & gcFilNr
                        cSQL = cSQL & " ," & lbednu & " "
                        cSQL = cSQL & " ," & cKdnr & " "
                        cSQL = cSQL & " ,'" & sAntwort & "'"
                        cSQL = cSQL & " , false "
                        cSQL = cSQL & " ) "
                        gdBase.Execute cSQL, dbFailOnError
                        
                         
                    End If
                End If
                
                
                'MsgBox "Emailadresse erfragen!" & vbCrLf & "Tragen Sie 'Keine' ein, wenn dieser Hinweis nicht mehr erscheinen soll.", vbRetryCancel, "Winkiss Hinweis:"
            End If
        End If
    End If
    
    Label1(7).Caption = Label8(1).Caption & " " & Label8(0).Caption

    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)
    
    If bPreisKZAnd = True Then 'hat sich das PreisKZ geändert dann neue Preise holen
        AktualisiereListboxWKL20aufGrundPreisKZand

    End If
    
    If gbKundRabattDeaktiv Then
        dWert = 0
        
        If gsiGESRAB > 0 Then
            zeigeZwangsrabatt
        End If
    End If
    
    If dWert <> 0 Then
        Label1(3).Visible = True
        Label2(3).Visible = True
        
        If gbRabVs = True Then
            Label2(4).Visible = False
        Else
            Label2(4).Visible = True
        End If
        
        If gbParknetto Then
            Command1(3).BackColor = vbGreen
        Else
            Command1(3).BackColor = &H80000004
        End If
        Label2(3).Caption = Format$(dWert, "##0.00")
        
        If gbNoKUBONUS_wenn_Art_and_Ges_rab = True Then
            AktualisiereListboxWKL20_wegenNOKUNDENBONUS_AG_RAB
        End If
        AktualisiereListboxWKL20

    End If
    AktualisiereZeileZwischenSummeWKL20
    
'    Label27.FontBold = False
    If cGesperrt = "J" Then
        anzeige "rot", "Kunde ist für Zahlungen mit EC-Karten gesperrt!", Label27
        Command1(0).Enabled = False
    Else
        If SFarbe <> "0" Then
            ctmp = ermFarbeKU(SFarbe)
            
'            Label27.BackColor = glfarbe(SFarbe)
            
            anzeige "rot", ctmp, Label27
        End If
    
        Command1(0).Enabled = bmerkEC
    End If
    
    
    If gbBonusBNB = True Then
        If dBonus > gdBonusGrenze And gdBonusGrenze > 0 Then
            gckundnr = cKdnr
            If gbFILBONI = True Then
                If ermfilfromKUNDE(gckundnr) = CInt(gcFilNr) Then
                    If KundeBonusfähig(gckundnr) Then
                        frmWK20e.Show 1
                    End If
                Else
                
                End If
            Else
                If KundeBonusfähig(gckundnr) Then
                    frmWK20e.Show 1
                End If
            End If
            
            
            gckundnr = ""
        End If
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "HoleKundenDatenWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub PublicHoleKundenDatenWKL20(cKdnr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    Dim rsrs As Recordset
    Dim ctmp As String
    Dim ctmpNotizen As String
    Dim dWert As Double
    Dim dBonus As Double
    
    Dim cECIdent As String
    Dim cGesperrt As String
    
    If Trim(cKdnr) = "" Then Exit Sub
    
    cSQL = "Select * from KUNDEN where KUNDNR = " & cKdnr & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!RABATT) Then
            ctmp = rsrs!RABATT
        Else
            ctmp = "0"
        End If
        
        If Not IsNull(rsrs!name) Then
            Label8(0).Caption = rsrs!name
        Else
            Label8(0).Caption = ""
        End If
        If Not IsNull(rsrs!vorname) Then
            Label8(1).Caption = rsrs!vorname
        Else
            Label8(1).Caption = ""
        End If
        If Not IsNull(rsrs!PREISKZ) Then
            Label8(3).Caption = rsrs!PREISKZ
        Else
            Label8(3).Caption = "0"
        End If
        giPreisKz = Val(Label8(3).Caption)
        
        If Not IsNull(rsrs!Plz) Then
            Label1(11).Caption = rsrs!Plz
            Label1(11).Visible = True
        Else
            Label1(11).Caption = ""
        End If
        
        If Not IsNull(rsrs!STADT) Then
            Label1(12).Caption = rsrs!STADT
            Label1(12).Visible = True
        Else
            Label1(12).Caption = ""
        End If
        
        If Not IsNull(rsrs!titel) Then
            Label1(19).Caption = rsrs!titel
            Label1(19).Visible = True
        Else
            Label1(19).Caption = ""
        End If
        
        
        If Not IsNull(rsrs!strasse) Then
            Label1(13).Caption = rsrs!strasse
            Label1(13).Visible = True
        Else
            Label1(13).Caption = ""
        End If
        
        If Not IsNull(rsrs!FILIALNR) Then
            Label1(15).Caption = rsrs!FILIALNR
            Label1(15).Visible = True
        Else
            Label1(15).Caption = ""
        End If
        
        If Not IsNull(rsrs!KurzTEXT2) Then
            Label1(17).Caption = rsrs!KurzTEXT2
            Label1(17).Visible = True
        Else
            Label1(17).Caption = ""
        End If
        
        If Not IsNull(rsrs!NOTIZEN) Then
        
            ctmpNotizen = rsrs!NOTIZEN
            ctmpNotizen = SwapStr(ctmpNotizen, Chr(10), " ")
            ctmpNotizen = SwapStr(ctmpNotizen, Chr(13), " ")
            Label1(28).Caption = ctmpNotizen
            Label1(28).Visible = True
        Else
            Label1(28).Caption = ""
        End If
        
        If Not IsNull(rsrs!BONUS) Then
            dBonus = rsrs!BONUS
            Label1(14).Caption = Format(dBonus, "###0.00")
            If Check7.value = vbChecked Then
                Label1(14).Visible = True
            Else
                Label1(14).Visible = False
            End If
        Else
            dBonus = 0
        End If
        
'        If Not IsNull(rsrs!Bonus) Then
'            dBonus = rsrs!Bonus
'        Else
'            dBonus = 0
'        End If
        
        If Not IsNull(rsrs!ECIDENT) Then
            cECIdent = rsrs!ECIDENT
        Else
            cECIdent = ""
        End If
        
        If Not IsNull(rsrs!GESPERRT) Then
            cGesperrt = rsrs!GESPERRT
        Else
            cGesperrt = "N"
        End If
        
        If Not IsNull(rsrs!MERKMAL) Then
            sMerkmal = rsrs!MERKMAL
        Else
            sMerkmal = ""
        End If
        
        If InStr(sMerkmal, "ø") Then
             gbMerkmal = True
        Else
             gbMerkmal = False
        End If
        
    Else
        ctmp = "0"
        Label8(0).Caption = ""
        Label8(1).Caption = ""
        dBonus = 0
        cECIdent = ""
        cGesperrt = "N"
    End If
    rsrs.Close: Set rsrs = Nothing
    
    Label1(7).Caption = Label8(1).Caption & " " & Label8(0).Caption
    
    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)
    
    If dWert > 0 Then
        Label1(3).Visible = True
        Label2(3).Visible = True
        
        If gbRabVs = True Then
            Label2(4).Visible = False
        Else
            Label2(4).Visible = True
        End If
        
        Label2(3).Caption = Format$(dWert, "##0.00")
        
        If gbNoKUBONUS_wenn_Art_and_Ges_rab = True Then
            AktualisiereListboxWKL20_wegenNOKUNDENBONUS_AG_RAB
        End If
        
        AktualisiereListboxWKL20
        AktualisiereZeileZwischenSummeWKL20
    End If
    
    If cGesperrt = "J" Then
        anzeige "rot", "Kunde ist für Zahlungen mit EC-Karten gesperrt!", Label27
'        MsgBox "Kunde ist für Zahlungen mit EC-Karten gesperrt!", vbInformation, "EC-KARTE"
    End If
    
    If gbBonusBNB = True Then 'Bonus beim nächsten besuch
        If dBonus > gdBonusGrenze And gdBonusGrenze > 0 Then
            gckundnr = cKdnr
            If KundeBonusfähig(gckundnr) Then
                frmWK20e.Show 1
            End If
            gckundnr = ""
        End If
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "PublicHoleKundenDatenWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Spezliste()
    On Error GoTo LOKAL_ERROR
    
    If gsSpezArtikel = "" Then
        Exit Sub
    End If
    
    Dim sSQL As String
    Dim sWelcheArtikel As String
    Dim i As Integer
    
    sWelcheArtikel = SwapStr(gsSpezArtikel, "$", ",")
    
    Screen.MousePointer = 11
    
    loeschNEW "PRINT_SPEZLISTE", gdBase
    CreateTableT2 "PRINT_SPEZLISTE", gdBase
    
    'so
    
'    Dim sArray() As String
'    sArray = Split(sWelcheArtikel, ",")
'
'    For i = 0 To UBound(sArray) - 1
'        sSQL = "Insert into PRINT_SPEZLISTE Select artnr, bezeich, Menge, preis, adate, azeit, bediener, '" & sWelcheArtikel & "' as WelcheArtikel from kassjour  "
'        sSQL = sSQL & " where artnr = " & sArray(i) & " "
'        sSQL = sSQL & " and adate >= " & CLng(DateValue(Now) - 14)
'        gdBase.Execute sSQL, dbFailOnError
'
'    Next i
    

    'oder so
    
    sSQL = "Insert into PRINT_SPEZLISTE Select artnr, bezeich, Menge, preis, adate, azeit, bediener, '" & sWelcheArtikel & "' as WelcheArtikel from kassjour where artnr in (" & sWelcheArtikel & ") "
    sSQL = sSQL & " and adate >= " & CLng(DateValue(Now) - 14)
    gdBase.Execute sSQL, dbFailOnError
    

    
    

    
    
    reportbildschirm "xxx", "aWKL20f"
    
    Screen.MousePointer = 0
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Spezliste"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function ermPaket_summe_del() As String
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    Dim rsrs As Recordset
    
    ermPaket_summe_del = ""
    
    cSQL = "Select sum(Preis) as Summe from Paket where sendok = False "
    FnOpenrecordset rsrs, cSQL, 1, gdBase
    
    If Not rsrs.EOF Then
        
        If Not IsNull(rsrs!Summe) Then
            ermPaket_summe_del = rsrs!Summe
        End If

    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Update Paket set sendok = True where sendok = False "
    gdBase.Execute cSQL, dbFailOnError
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermPaket_summe_del"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub Command5_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp As String
    Dim lcount As Long
    Dim iFehler As Integer
    
    Dim lCents  As Long
    Dim sCent   As String
    Dim lret1    As Long
    Dim sBLZ As String * 2000
    Dim lBuffer As Long

    Dim lerrCode As Long
    Dim serrMeldung As String * 8000
    Dim lForcePIN As Long
    
    Dim lRet        As Long
    Dim iRet        As Integer
    Dim sTraceNr    As String
    
    Dim hwnd&
    Dim Y As String
    Dim result&
    Dim Title$
    
    Dim sVerfall As String
    Dim sMon As String
    
    Dim lAnzLbSatz As Long
    Dim cArtNr As String
    Dim cLBSatz As String
    
    iFehler = 0
    
    Command5(0).Enabled = True
    
    gbZVT2_vTIDdrucken = False
    
    Select Case index
        Case Is = 0 'ok
            Screen.MousePointer = 11
            '************************************************************
            '* Einzahlungen / Auszahlungen explizit mit Text speichern!!!
            '************************************************************
            If InStr(UCase$(Label15.Caption), "EINZAHLUNG") > 0 Then
                frmWK20f.Show 1
            End If
        
            If InStr(UCase$(Label15.Caption), "AUSZAHLUNG") > 0 Then
                If NewTableSuchenDBKombi("AUSZAHLUNGSGRUND", gdBase) Then
                    If DatendrinWieviel("AUSZAHLUNGSGRUND", gdBase) > 0 Then
                        dlgAuszahlung.Show 1
                    Else
                        frmWK20f.Show 1
                    End If
                Else
                    frmWK20f.Show 1
                End If
            End If
        
        
        
            Command5(0).Enabled = False ' Button aus
            Command5(1).Enabled = False 'Ok Button aus
            
            '''''''' Oliver Alte TSE START
            
'            If InStr(UCase$(Label15.Caption), "EINZAHLUNG") > 0 And chkEinzKarte.value = vbUnchecked Then
'
'
'                'TSS Finish
'                 TSS.Finish WinsockTSE, Beleg, 0, 0, Label6(1).Caption, "EUR", Label6(1).Caption, 0
'
'            End If
'
'            If InStr(UCase$(Label15.Caption), "AUSZAHLUNG") > 0 Then
'
'                'TSS Finish
'                TSS.Finish WinsockTSE, Beleg, 0, 0, Label6(1).Caption, "EUR", Label6(1).Caption, 0
'
'            End If
            
            
            '''''''' Oliver Alte TSE ENDE
            
            
            If InStr(UCase$(Label15.Caption), "EINZAHLUNG") > 0 And chkEinzKarte.value = vbChecked Then
            
                'Einzahlung durch Kartenterminal
                
                If gbEcash Then
                    Select Case gsEPartner
                        
                        Case "ELP"
                            BerechneZwischenSummeWKL20
                                
                            Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                            Label28.Refresh
                                
                            'Zahlung
                            sCent = Label6(1).Caption
                            sCent = SwapStr(sCent, ",", "")
                            
                            'hier ansetzen
                            Zahlung_elPAY sCent
                            
                            If giELPAY_Fehler > 0 Then
                            
                                'Abbruch, so geht Abbruch
                                Screen.MousePointer = 0
                                Command5(0).Enabled = True
                                Command5(1).Enabled = True
                                
                                Label28.Caption = "Fehler am Kartenterminal!"
                                Label28.Refresh
                                
                                Exit Sub
                                'Abbruch
                            End If
                        Case "ZVT"
                            BerechneZwischenSummeWKL20
                                
                            Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                            Label28.Refresh
                                
                            'Zahlung
                            sCent = Label6(1).Caption
                            sCent = SwapStr(sCent, ",", "")
                            
                            'hier ansetzen
                            Zahlung_ZVT sCent
                            
                            If giZVT_Fehler > 0 Then
                            
                                'Abbruch, so geht Abbruch
                                Screen.MousePointer = 0
                                Command5(0).Enabled = True
                                Command5(1).Enabled = True
                                
                                Label28.Caption = "Fehler am Kartenterminal!"
                                Label28.Refresh
                                
                                Exit Sub
                                'Abbruch
                            End If
                        Case "ZV2"
                            BerechneZwischenSummeWKL20
                            
                            
                                
                            Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                            Label28.Refresh
                                
                            'Zahlung
                            sCent = Label6(1).Caption
                            sCent = SwapStr(sCent, ",", "")
                            
                            'hier ansetzen
                            Zahlung_ZVT2 sCent, False
                            
                            If giZVT2_Fehler > 0 Then
                            
                                'Abbruch, so geht Abbruch
                                Screen.MousePointer = 0
                                Command5(0).Enabled = True
                                Command5(1).Enabled = True
                                
                                Label28.Caption = "Fehler am Kartenterminal!"
                                Label28.Refresh
                                
                                Exit Sub
                                'Abbruch
                            End If
                            
                            
                            
                        Case Else

                    End Select
                End If
            End If
            
            
            
            
            
            
            'Neu Kreditverkauf mit manueller Keditkarteneingabe
            
            
            
            
            If InStr(UCase$(Label15.Caption), "KREDITVERKAUF") > 0 Then
                '************************hier E - Cash
                '*************************************
                If gbEcash Then
                    Select Case gsEPartner
                        
                        Case "ELP"
                        
                            'Beginnt Elpay
                            
                            If Check15.value = vbChecked Then
                                'der manuelle Weg
                                
                                BerechneZwischenSummeWKL20
                                
                                If CDbl(Label6(1).Caption) < 0 Then
                                    'Storno
                                    
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
                                    sCent = SwapStr(sCent, "-", "")
                                    
                                    sTraceNr = InputBox("Geben Sie bitte die" & vbCrLf & "TA Nr.:(steht auf dem Bon) ein!" & vbCrLf & "Bedienen Sie dann das Kartenterminal", "Winkiss Stornierung einer Kartenzahlung:")
                                        
                                    sVerfall = cboVerfall.Text
                                    sMon = Mid(sVerfall, 1, 2)
            
                                    If Right(sMon, 1) = "/" Then
                                        sMon = "0" & Left(sMon, 1)
                                    End If
                                    
                                    sVerfall = Right(sVerfall, 2) & sMon
            
                                    'hier ansetzen
                                    Storno_elPAY_Manuell sTraceNr, sCent, Trim(Text2(9).Text), sVerfall
                                    
                                    If giELPAY_Fehler > 0 Then
                                    
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
                                        
                                        Label28.Caption = "Fehler!"
                                        Label28.Refresh
                                        
                                        Exit Sub
                                        'Abbruch
                                    End If
                                    
                                Else
                    
                                    'Zahlung
                                    
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
            
                                    
            
                                    sVerfall = cboVerfall.Text
                                    sMon = Mid(sVerfall, 1, 2)
            
                                    If Right(sMon, 1) = "/" Then
                                        sMon = "0" & Left(sMon, 1)
                                    End If
            
                                    sVerfall = Right(sVerfall, 2) & sMon
            
                                    'hier ansetzen
                                    Zahlung_elPAY_Manuell sCent, Trim(Text2(9).Text), sVerfall
            
                                    If giELPAY_Fehler > 0 Then
            
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
            
                                        Label28.Caption = "Fehler!"
                                        Label28.Refresh
            
                                        Exit Sub
                                        'Abbruch
                                    End If
                                    
                                End If
                                
                                
                                Check15.value = vbUnchecked
                                cboVerfall.Text = ""
                                Text2(9).Text = ""
                                Text2(8).Text = ""
                                
                            End If
                            'Ende Elpay

                        Case "ZV2"
                        
                            If Check15.value = vbChecked Then
                                'der manuelle Weg
                                
                                sVerfall = cboVerfall.Text
                                sMon = Mid(sVerfall, 1, 2)

                                If Right(sMon, 1) = "/" Then
                                    sMon = "0" & Left(sMon, 1)
                                End If

                                sVerfall = Right(sVerfall, 2) & sMon

                                If Text2(9).Text = "" Or Text2(8).Text = "" Then
                                    Label28.Caption = "Fehler bei der Eingabe!"
                                    Label28.Refresh

                                    Exit Sub
                                End If
                                
                                BerechneZwischenSummeWKL20
                                    
                                Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                                Label28.Refresh
                                    
                                If CDbl(Label6(1).Caption) < 0 Then
                                    'Storno
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
                                    sCent = SwapStr(sCent, "-", "")
                                    
                                    dlgTaNr.Show 1
                        
                                    sTraceNr = dlgTaNr.Back
            
                                    Storno_ZVT2 sTraceNr, sCent, False, Text2(9).Text, sVerfall, Text2(8).Text
                                    
                                    If giZVT2_Fehler > 0 Then
                                    
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
                                        
                                        Label28.Caption = "Fehler am Kartenterminal!"
                                        Label28.Refresh
                                        
                                        Exit Sub
                                        'Abbruch
                                    End If
                                Else
                                
                                    
                                
                                    'Zahlung
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
                                    
                                    'hier ansetzen
                                    Zahlung_ZVT2 sCent, False, Text2(9).Text, sVerfall, Text2(8).Text
                                    
                                    If giZVT2_Fehler > 0 Then
                                    
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
                                        
                                        Label28.Caption = "Fehler am Kartenterminal!"
                                        Label28.Refresh
                                        
                                        Exit Sub
                                        'Abbruch
                                    End If
                                    
                                    
                                End If
                                
                            
                            End If
                        Case Else

                    End Select
                End If
                
       
                
                Label28.Caption = ""
                Label28.Refresh
                '************************hier E - Cash Ende
                '******************************************
                

                
            End If
            'Ende Neu Kreditverkauf mit manueller Keditkarteneingabe
            
        
        
            
            If InStr(UCase$(Label15.Caption), "KARTENVERKAUF") > 0 Then
                '************************hier E - Cash
                '*************************************
                If gbEcash Then
                    Select Case gsEPartner
                        Case Is = "ADT"
        
                            If gsAdtVerfahren = "XML" Then
        
                                BerechneZwischenSummeWKL20
                                
                                Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                                Label28.Refresh
                                
                                If CDbl(Label6(1).Caption) < 0 Then
                                
                                    If CInt(gADTclientId) = 0 Then
                                        'Storno
                                        sTraceNr = InputBox("Geben Sie bitte die" & vbCrLf & "TA Nr.:(steht auf dem Bon) ein!" & vbCrLf & "Bedienen Sie dann das Kartenterminal", "Winkiss Stornierung einer Kartenzahlung:")
                                        lRet = Shell("C:\Programme\EL-ME\SECpos\SECposPay\SECposPay.exe", vbHide) 'secpos
                                        AppActivate lRet ' True
                                        
                                        'erstmal zum storno navigieren
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        
                                        SendKeys "{Down}", True
                                        
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        SendKeys "{TAB}", True
                                        
                                        SendKeys "{Down}", True
                                        
                                        SendKeys sTraceNr, True
                                        SendKeys "{enter}", True
                        
                                        Call keybd_event(VK_LWIN, 0, 0, 0)
                                        Call keybd_event(77, 0, 0, 0)
                                        Call keybd_event(VK_LWIN, 0, KEYEVENTF_KEYUP, 0)
                          
                                        iRet = MsgBox("Storno ok? ", vbInformation + vbYesNo, "Winkiss Frage:")
                                        Pause 5
                                        
                                         'secpospay suchen finden und schließen
                                        
                                    
                                        Y = "SECpos Pay" '  (Terminal-ID: " & gsTerminalid & ")"
                                    
                                        hwnd = GetWindow(Me.hwnd, GW_HWNDFIRST)
                                    
                                        Do
                                            result = GetWindowTextLength(hwnd) + 1
                                            Title = Space(result)
                                            result = GetWindowText(hwnd, Title, result)
                                            Title = Left$(Title, Len(Title) - 1)
                                    
                                            If InStr(1, Title, Y) Then
                                                SendMessage hwnd, WM_CLOSE, ByVal 0&, ByVal 0&
                                    
                                            End If
                                    
                                            hwnd = GetWindow(hwnd, GW_HWNDNEXT)
                                        Loop Until hwnd = 0
                                        
                                        setzedrucker gcBonDrucker
    
                                        If iRet = vbNo Then
                                            Screen.MousePointer = 0
                                            Command5(0).Enabled = True
                                            Command5(1).Enabled = True
                                            Exit Sub
                                        End If
                                    Else
                iFehler = 5
                                        'Storno neuer Weg
                                        
                                        If CInt(gADTclientId) > 0 Then
                                        
                                            If gADTipAdress <> "" And gADTport <> "" Then
                                                '192.168.1.14 '20002
                                                lRet = ELMESettings(vbNullString, gADTclientId, vbNullString, gADTipAdress, gADTport, -1, -1, -1, vbNullString)
                                            Else
                                                lRet = ELMESettings(vbNullString, gADTclientId, vbNullString, vbNullString, -1, -1, -1, -1, vbNullString)
                                            End If
                                            
                                        End If
                                        
                                        sTraceNr = InputBox("Geben Sie bitte die" & vbCrLf & "TA Nr.:(steht auf dem Bon) ein!" & vbCrLf & "Bedienen Sie dann das Kartenterminal", "Winkiss Stornierung einer Kartenzahlung:")
                            
                                        lRet = ELMEReversal(CLng(sTraceNr))
  
                                        If lRet = 0 Then
                                            lRet = ELMEGetPrint(sBLZ, 8000)
                                            If lRet = 0 Then
'                                                MsgBox sBLZ
                                                gsAdtBeleg = sBLZ
                                            Else
                                                MsgBox "Fehler ELMEGetPrint: " & lRet, vbCritical, "Winkiss Fehler:"
                                                gsAdtBeleg = ""
                                            End If
                                        Else
'                                            MsgBox "Fehler ELMEPay: " & lRet
                                            lRet = ELMEGetLastError(lerrCode, serrMeldung, 8000)
                                            If lRet = 0 Then
                                                MsgBox serrMeldung, vbCritical, "Winkiss Fehler:"
                                            Else
                                                MsgBox "Fehler ELMEGetLastError: " & lRet, vbCritical, "Winkiss Fehler:"
                                            End If
                                            'Abbruch
                                            Screen.MousePointer = 0
                                            Command5(0).Enabled = True
                                            Command5(1).Enabled = True
                                            Exit Sub
                                            'Abbruch
                                        End If
                                    End If
                                Else
                iFehler = 6
                                    If CInt(gADTclientId) = 0 Then
                                       
                                        'Zahlung
                                        lRet = Shell("C:\Programme\EL-ME\SECpos\SECposPay\SECposPay.exe", vbHide) 'secpos
                                        AppActivate lRet
                                        SendKeys Label6(1).Caption, True
                                        SendKeys "{enter}", True
                                        Call keybd_event(VK_LWIN, 0, 0, 0)
                                        Call keybd_event(77, 0, 0, 0)
                                        Call keybd_event(VK_LWIN, 0, KEYEVENTF_KEYUP, 0)
                                        iRet = MsgBox("Zahlung ok? ", vbInformation + vbYesNo, "Winkiss Frage:")
                                        Pause 5
                                        'secpospay suchen finden und schließen
                                        Y = "SECpos Pay" '  (Terminal-ID: " & gsTerminalid & ")"
                                        hwnd = GetWindow(Me.hwnd, GW_HWNDFIRST)
                                        Do
                                            result = GetWindowTextLength(hwnd) + 1
                                            Title = Space(result)
                                            result = GetWindowText(hwnd, Title, result)
                                            Title = Left$(Title, Len(Title) - 1)
    
                                            If InStr(1, Title, Y) Then
                                                SendMessage hwnd, WM_CLOSE, ByVal 0&, ByVal 0&
                                            End If
    
                                            hwnd = GetWindow(hwnd, GW_HWNDNEXT)
                                        Loop Until hwnd = 0
                                        setzedrucker gcBonDrucker
                                        If iRet = vbNo Then
                                            Screen.MousePointer = 0
                                            Command5(0).Enabled = True
                                            Command5(1).Enabled = True
                                            Exit Sub
                                        End If
                                    
                                    Else
            iFehler = 7
                                        'Zahlung der neue Weg
                                        If CInt(gADTclientId) > 0 Then
                                            If gADTipAdress <> "" And gADTport <> "" Then
                                                '192.168.1.14 '20002
                                                lRet = ELMESettings(vbNullString, gADTclientId, vbNullString, gADTipAdress, gADTport, -1, -1, -1, vbNullString)
                                            Else
                                                lRet = ELMESettings(vbNullString, gADTclientId, vbNullString, vbNullString, -1, -1, -1, -1, vbNullString)
                                            End If
                                        End If
                                    
                                        lForcePIN = 0

                                        sCent = Label6(1).Caption
                                        sCent = SwapStr(sCent, ",", "")
                                        lCents = CLng(sCent)
                                        
                                        lret1 = ELMEPay(lCents, lForcePIN)
                                       
                                        If lret1 = 0 Then
                                            lret1 = ELMEGetPrint(sBLZ, 8000)
                                            
                                            If lret1 = 0 Then

                                                gsAdtBeleg = sBLZ
                                            Else
                                                MsgBox "Fehler ELMEGetPrint: " & lret1, vbCritical, "Winkiss Fehler:"
                                                gsAdtBeleg = ""
                                            End If
                                        Else
                                            lret1 = ELMEGetLastError(lerrCode, serrMeldung, 8000)
                                            If lret1 = 0 Then
                                                MsgBox serrMeldung, vbCritical, "Winkiss Fehler:"
                                            Else
                                                MsgBox "Fehler ELMEGetLastError: " & lret1, vbCritical, "Winkiss Fehler:"
                                            End If
                                        
                                            'Abbruch
                                            Screen.MousePointer = 0
                                            Command5(0).Enabled = True
                                            Command5(1).Enabled = True
                                            Exit Sub
                                            'Abbruch
                                        End If
                                    End If
                                End If
                                
                            ElseIf gsAdtVerfahren = "INOUT" Then
                            
                            End If
                            
                        Case "ELP"
                        
                            'Beginnt Elpay
                            
                            If Check15.value = vbChecked Then
                                'der manuelle Weg
                                
                                BerechneZwischenSummeWKL20
                                
                                If CDbl(Label6(1).Caption) < 0 Then
                                    'Storno
                                    
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
                                    sCent = SwapStr(sCent, "-", "")
                                    
                                    sTraceNr = InputBox("Geben Sie bitte die" & vbCrLf & "TA Nr.:(steht auf dem Bon) ein!" & vbCrLf & "Bedienen Sie dann das Kartenterminal", "Winkiss Stornierung einer Kartenzahlung:")
                                        
                                    
                                    
            
                                    sVerfall = cboVerfall.Text
                                    sMon = Mid(sVerfall, 1, 2)
            
                                    If Right(sMon, 1) = "/" Then
                                        sMon = "0" & Left(sMon, 1)
                                    End If
                                    
                                    sVerfall = Right(sVerfall, 2) & sMon
            
                                    'hier ansetzen
                                    Storno_elPAY_Manuell sTraceNr, sCent, Trim(Text2(9).Text), sVerfall
                                    
                                    If giELPAY_Fehler > 0 Then
                                    
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
                                        
                                        Label28.Caption = "Fehler!"
                                        Label28.Refresh
                                        
                                        Exit Sub
                                        'Abbruch
                                    End If
                                    
                                Else
                    
                                    'Zahlung
                                    
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
            
                                    
            
                                    sVerfall = cboVerfall.Text
                                    sMon = Mid(sVerfall, 1, 2)
            
                                    If Right(sMon, 1) = "/" Then
                                        sMon = "0" & Left(sMon, 1)
                                    End If
            
                                    sVerfall = Right(sVerfall, 2) & sMon
            
                                    'hier ansetzen
                                    Zahlung_elPAY_Manuell sCent, Trim(Text2(9).Text), sVerfall
            
                                    If giELPAY_Fehler > 0 Then
            
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
            
                                        Label28.Caption = "Fehler!"
                                        Label28.Refresh
            
                                        Exit Sub
                                        'Abbruch
                                    End If
                                    
                                End If
                                
                                
                                Check15.value = vbUnchecked
                                cboVerfall.Text = ""
                                Text2(9).Text = ""
                                Text2(8).Text = ""
                                
                                
                                
                            Else
                                'übers Kartenterminal
                                BerechneZwischenSummeWKL20
                                    
                                Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                                Label28.Refresh
                                    
                                If CDbl(Label6(1).Caption) < 0 Then
                                    'Storno
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
                                    sCent = SwapStr(sCent, "-", "")
                                    
                                    sTraceNr = InputBox("Geben Sie bitte die" & vbCrLf & "TA Nr.:(steht auf dem Bon) ein!" & vbCrLf & "Bedienen Sie dann das Kartenterminal", "Winkiss Stornierung einer Kartenzahlung:")
                                           
                                    Storno_elPAY sTraceNr, sCent
                                    
                                    If giELPAY_Fehler > 0 Then
                                    
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
                                        
                                        Label28.Caption = "Fehler am Kartenterminal!"
                                        Label28.Refresh
                                        
                                        Exit Sub
                                        'Abbruch
                                    End If
                                Else
                    
                                    'Zahlung
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
                                    
                                    'hier ansetzen
                                    Zahlung_elPAY sCent
                                    
                                    If giELPAY_Fehler > 0 Then
                                    
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
                                        
                                        Label28.Caption = "Fehler am Kartenterminal!"
                                        Label28.Refresh
                                        
                                        Exit Sub
                                        'Abbruch
                                    End If
                                End If
                                
                                
                            End If
                            
                            
                            'Ende Elpay

                        Case "ZVT"
                        
                            BerechneZwischenSummeWKL20
                                
                            Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                            Label28.Refresh
                                
                
                            If CDbl(Label6(1).Caption) < 0 Then
                                'Storno
                                sCent = Label6(1).Caption
                                sCent = SwapStr(sCent, ",", "")
                                sCent = SwapStr(sCent, "-", "")
                                
                                
                                
                                dlgTaNr.Show 1
                    
                                sTraceNr = dlgTaNr.Back
        
'                                sTraceNr = InputBox("Geben Sie bitte die" & vbCrLf & "BNr.:(steht auf dem Bon) ein!" & vbCrLf & "Bedienen Sie dann das Kartenterminal", "Winkiss Stornierung einer Kartenzahlung:")
                                       
                                Storno_ZVT sTraceNr
                                
                                If giZVT_Fehler > 0 Then
                                
                                    'Abbruch, so geht Abbruch
                                    Screen.MousePointer = 0
                                    Command5(0).Enabled = True
                                    Command5(1).Enabled = True
                                    
                                    Label28.Caption = "Fehler am Kartenterminal!"
                                    Label28.Refresh
                                    
                                    Exit Sub
                                    'Abbruch
                                End If
    
                                       
                                        
                            Else
                                'Zahlung
                                sCent = Label6(1).Caption
                                sCent = SwapStr(sCent, ",", "")
                                
                                'hier ansetzen
                                Zahlung_ZVT sCent
                                
                                If giZVT_Fehler > 0 Then
                                
                                    'Abbruch, so geht Abbruch
                                    Screen.MousePointer = 0
                                    Command5(0).Enabled = True
                                    Command5(1).Enabled = True
                                    
                                    Label28.Caption = "Fehler am Kartenterminal!"
                                    Label28.Refresh
                                    
                                    Exit Sub
                                    'Abbruch
                                End If
                            End If
                            
                        Case "ZV2"
                        
                            If Check15.value = vbChecked Then
                                'der manuelle Weg
                                
                                sVerfall = cboVerfall.Text
                                sMon = Mid(sVerfall, 1, 2)

                                If Right(sMon, 1) = "/" Then
                                    sMon = "0" & Left(sMon, 1)
                                End If

                                sVerfall = Right(sVerfall, 2) & sMon

                                If Text2(9).Text = "" Or Text2(8).Text = "" Then
                                    Label28.Caption = "Fehler bei der Eingabe!"
                                    Label28.Refresh

                                    Exit Sub
                                End If
                                
                                
                                
                                BerechneZwischenSummeWKL20
                                    
                                Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                                Label28.Refresh
                                    
                                If CDbl(Label6(1).Caption) < 0 Then
                                
                                
                                
                                
                                
                                    
                                    
                                    
                                    
                                    'ist eine Virtuelle ID gesetzt, dann nix an das Kartenterminal
'                                    'nur die virtuelle drucken
'
                                    If gsZVT2_VirtuellID = "" Then
                                    
                                        'Storno
                                        sCent = Label6(1).Caption
                                        sCent = SwapStr(sCent, ",", "")
                                        sCent = SwapStr(sCent, "-", "")
                                        
                                        dlgTaNr.Show 1
                            
                                        sTraceNr = dlgTaNr.Back
                
                                        Storno_ZVT2 sTraceNr, sCent, False, Text2(9).Text, sVerfall, Text2(8).Text
                                        
                                        If giZVT2_Fehler > 0 Then
                                        
                                            'Abbruch, so geht Abbruch
                                            Screen.MousePointer = 0
                                            Command5(0).Enabled = True
                                            Command5(1).Enabled = True
                                            
                                            Label28.Caption = "Fehler am Kartenterminal!"
                                            Label28.Refresh
                                            
                                            Exit Sub
                                            'Abbruch
                                        End If
                                    
                                    Else
                                    
                                        gbZVT2_vTIDdrucken = True
                                    
                                    End If
                                Else
                                
                                
                                
                                    'ist eine Virtuelle ID gesetzt, dann nix an das Kartenterminal
'                                    'nur die virtuelle drucken
'
                                    If gsZVT2_VirtuellID = "" Then
                                
                                
                                
                                
                                        'Zahlung
                                        sCent = Label6(1).Caption
                                        sCent = SwapStr(sCent, ",", "")
                                        
                                        'hier ansetzen
                                        Zahlung_ZVT2 sCent, False, Text2(9).Text, sVerfall, Text2(8).Text
                                        
                                        If giZVT2_Fehler > 0 Then
                                        
                                            'Abbruch, so geht Abbruch
                                            Screen.MousePointer = 0
                                            Command5(0).Enabled = True
                                            Command5(1).Enabled = True
                                            
                                            Label28.Caption = "Fehler am Kartenterminal!"
                                            Label28.Refresh
                                            
                                            Exit Sub
                                            'Abbruch
                                        End If
                                        
                                    Else
                                    
                                        gbZVT2_vTIDdrucken = True
                                    
                                    End If
                                    
                                End If
                           
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                            Else
                        
                                BerechneZwischenSummeWKL20
                                    
                                Label28.Caption = "Bedienen Sie jetzt das Kartenterminal!"
                                Label28.Refresh
                                    
                                If CDbl(Label6(1).Caption) < 0 Then
                                    'Storno
                                    sCent = Label6(1).Caption
                                    sCent = SwapStr(sCent, ",", "")
                                    sCent = SwapStr(sCent, "-", "")
                                    
                                    dlgTaNr.Show 1
                        
                                    sTraceNr = dlgTaNr.Back
            
                                    Storno_ZVT2 sTraceNr, sCent, False
                                    
                                    If giZVT2_Fehler > 0 Then
                                    
                                        'Abbruch, so geht Abbruch
                                        Screen.MousePointer = 0
                                        Command5(0).Enabled = True
                                        Command5(1).Enabled = True
                                        
                                        Label28.Caption = "Fehler am Kartenterminal!"
                                        Label28.Refresh
                                        
                                        Exit Sub
                                        'Abbruch
                                    End If
                                Else
                                
                                
'                                    'ist eine Virtuelle ID gesetzt, dann nix an das Kartenterminal
'                                    'nur die virtuelle drucken
'
'                                    If gsZVT2_VirtuellID = "" Then
                                
                                
                                        'Zahlung
                                        sCent = Label6(1).Caption
                                        sCent = SwapStr(sCent, ",", "")
                                        
                                        'hier ansetzen
                                        Zahlung_ZVT2 sCent, False
                                        
                                        If giZVT2_Fehler > 0 Then
                                        
                                            'Abbruch, so geht Abbruch
                                            Screen.MousePointer = 0
                                            Command5(0).Enabled = True
                                            Command5(1).Enabled = True
                                            
                                            Label28.Caption = "Fehler am Kartenterminal!"
                                            Label28.Refresh
                                            
                                            Exit Sub
                                            'Abbruch
                                        End If
                                    
'                                    Else
'
'                                    End If
                                    
                                End If
                            End If
                        Case Else

                    End Select
                End If
                
        iFehler = 9
                
                Label28.Caption = ""
                Label28.Refresh
                '************************hier E - Cash Ende
                '******************************************
                
                Dim cFeld As String
                Dim dWert As Double
                Dim dECAuszahlWert As Double
                
                dECAuszahlWert = 0
                
                
                If glECAuszahlArtnr > 0 Then
                    'wenn, dann warenkorb nach EC-Auszahlung absuchen und eine Barauszahlung veranlassen
                    
                    '***GUTSCHEINE trotzdem
                    lAnzLbSatz = List1.ListCount
                    For lcount = 0 To lAnzLbSatz - 1
                        cLBSatz = List1.list(lcount)
                        cArtNr = Trim(Mid(cLBSatz, 7, 6))
                        
                        cFeld = Trim(Mid(cLBSatz, 60, 9))
                        dWert = CDbl(cFeld)
                        
                        If CLng(cArtNr) = glECAuszahlArtnr Then
                            dECAuszahlWert = dECAuszahlWert + dWert
                            
                            'wert ermitteln
                        End If
                    Next lcount
                    
                    If dECAuszahlWert > 0 Then
                        EinAusEcAuszahlung dECAuszahlWert
                    End If
                
                End If
                
                
                
                If Check4.value = vbChecked Then 'also dina4 druck
'                    setzedrucker gcListenDrucker
                    DruckeKassenBonDinA4 "Kartenzahlung", gbDINA4RECHFU
'                    setzedrucker gcBonDrucker
                End If
                
            End If
            
            ctmp = Label6(1).Caption
            ctmp = fnMoveComma2Point$(ctmp)
            gdSumme = Val(ctmp)
            gdGegeben = gdSumme
    
            gdZurueck = 0
                        
    iFehler = 10
    
            HoleNeueBonNrWKL20_NEU 'hier wird die verwendete Bonnummer auch eingetragen
    
    
    
    
            If InStr(UCase$(Label15.Caption), "EINZAHLUNG") > 0 And chkEinzKarte.value = vbChecked Then
            
            Else
            
                If Label15.Caption <> "Kollegenverkauf" Then
                    UpdateAFCStatAndersWKL20
                End If
            End If
    iFehler = 11
            If giAndersZahlung = giKREDIT Or giAndersZahlung = giKOLLEGE Then
            
                If Check4.value = vbChecked Then 'also dina4 druck
                    DruckeKassenBonDinA4 "Lieferschein", gbDINA4RECHFU
                    
                    
                    '***GUTSCHEINE trotzdem
                    lAnzLbSatz = List1.ListCount
                    For lcount = 0 To lAnzLbSatz - 1
                        cLBSatz = List1.list(lcount)
                        cArtNr = Mid(cLBSatz, 7, 6)
                        If cArtNr = "666666" Then
                            If gbNoBonGu = False Then
                                DruckeGutscheinBonWKL20 cLBSatz
                            End If
                        End If
                    Next lcount
                End If

                SchreibeDaten2KreditWKL20
            End If
            
            If giZahlArt = giKOLLEGE Then
    
            End If
            
    iFehler = 14
            Command5(0).Visible = False
    iFehler = 15
    
            ctmp = Label6(1).Caption
            ctmp = fnMoveComma2Point$(ctmp)
            gdSummeKK = Val(ctmp)
            
            
            
                
           
            
            
            DruckeKassenBonWKL20
            
            If gbBONNEIN = False Then
                gbBonDruck = True
            Else
                gbBonDruck = False
            End If
    iFehler = 16
            DoEvents
    iFehler = 17
            gdBonNr = -1
   
            gcKreditKarte = ""
    
            Screen.MousePointer = 0
            
            Command5(1).Enabled = True
            Command5(1).Caption = "Schließen"
    
            If InStr(UCase$(Label15.Caption), "KARTENVERKAUF") > 0 Then
    
                If gbBONWAHL = False Then
                    cmdBonKK.Visible = False
                    Command5_Click 1
                Else
                    cmdBonKK.Visible = True
                    cmdBonKK.Enabled = True
                    
                    Text1(4).Text = ""
                    Text1(4).SetFocus
                    
                End If
                
            ElseIf InStr(UCase$(Label15.Caption), "AUSZAHLUNG") > 0 Then
    
                If gbBONWAHL = False Then
                    cmdBonKK.Visible = False
                    Command5_Click 1
                Else
                    cmdBonKK.Visible = True
                    cmdBonKK.Enabled = True
                    
                    Text1(4).Text = ""
                    Text1(4).SetFocus
                End If
            ElseIf InStr(UCase$(Label15.Caption), "EINZAHLUNG") > 0 Then
    
                If gbBONWAHL = False Then
                    cmdBonKK.Visible = False
                    Command5_Click 1
                Else
                    cmdBonKK.Visible = True
                    cmdBonKK.Enabled = True
                    
                    Text1(4).Text = ""
                    Text1(4).SetFocus
                End If
            ElseIf InStr(UCase$(Label15.Caption), "KREDITVERKAUF") > 0 Then
    
                If gbBONWAHL = False Then
                    cmdBonKK.Visible = False
                    Command5_Click 1
                Else
                    cmdBonKK.Visible = True
                    cmdBonKK.Enabled = True
                    
                    Text1(4).Text = ""
                    Text1(4).SetFocus
                End If
            Else
                Command5(1).SetFocus
            
            End If
    
    
        Case Is = 1 'schließen
    
            Screen.MousePointer = 11
    iFehler = 23
            Frame1.Visible = True
            
            If gbLeiste2Start = True Then
                Frame23.Visible = True
                Frame2.Visible = False
            Else
                Frame2.Visible = True
                Frame23.Visible = False
            End If
            
            Frame3.Visible = True
            Frame4.Visible = True
            Frame33.Visible = False
            
            
            
            
            
            
            gbNumTaste = True
            Text1(0).Text = gcBedienerNr
            Text1(1).SetFocus
'            Command33(0).Visible = True
'            gcKreditKarte = ""
'            gcZahlMittel = ""
        
            If gbBEDLEER = True Then
                If Command5(1).Caption = "Schließen" Then
                    Text1(0).Text = ""
                    Label1(8).Caption = ""
                    Text1(0).SetFocus
                    indentmitKarte
                End If
            End If
            
            
            
            
            
            
            
            If Command5(1).Caption = "Zurück" Then
            
                '''''''' Oliver Alte TSE START
            
'                If InStr(UCase$(Label15.Caption), "EINZAHLUNG") > 0 Then
'                    'TSS Cancel
'                    TSS.Cancel WinsockTSE
'                End If
'
'                If InStr(UCase$(Label15.Caption), "AUSZAHLUNG") > 0 Then
'                    'TSS Cancel
'                    TSS.Cancel WinsockTSE
'                End If
            
                '''''''' Oliver Alte TSE ENDE
            
                'mach die Automatik_Bonus_Geschichte rückgängig
                If glBONUSAA_Artnr > 0 Then
                    'suche_und_lösche_Bonusartikel
                    If sind_bestimmte_Artnr_drin(glBONUSAA_Artnr) Then
                        'dann lösch diese raus
                        sind_bestimmte_Artnr_drin_then_del (glBONUSAA_Artnr)
                        
                        'setze den Kundenbonus wieder hoch
                        If Val(Label2(7).Caption) > 0 Then
                        
                            Dim rsrs As Recordset
                            Set rsrs = gdBase.OpenRecordset("Select * from Kunden where kundnr = " & Val(Label2(7).Caption))
                            If Not rsrs.EOF Then
                                rsrs.Edit
                                rsrs!Status = "E"
                                rsrs!SYNStatus = "E"
                                
                                If Not IsNull(rsrs!BONUS) Then
                                    rsrs!BONUS = rsrs!BONUS + (giAnzBonus_Erreicht * gdBonusGrenze)
                                End If
                                
                                If Not IsNull(rsrs!TBONUS) Then
                                    rsrs!TBONUS = CDbl(rsrs!TBONUS) + (giAnzBonus_Erreicht * gdBonusGrenze)
                                End If
                                
                                rsrs!LASTDATE = DateValue(Now)
                                rsrs!LASTTIME = TimeValue(Now)
                                rsrs.Update
                                
                            End If
                            rsrs.Close
                        End If
                    
                    End If
                    
                    BerechneZwischenSummeWKL20
                End If
            End If
            
            
            If Command5(0).Visible = False Then
    iFehler = 30
                List1.Clear
                List3.Nodes.Clear
                Label41(1).Caption = 0
                Label2(6).Caption = "0,00"
                LeereDialogModul20
            End If
    iFehler = 31

            Command5(0).Visible = True
    iFehler = 32
            Frame10.Visible = False
            
            

''            If gbBEDLEER = False Then
''                gbNumTaste = True
''                Text1(0).Text = gcBedienerNr
''                Text1(1).SetFocus
''            Else
''                Text1(0).Text = ""
''                Label1(8).Caption = ""
''                Text1(0).SetFocus
''            End If
    
            giAndersZahlung = 0
    iFehler = 52
            gcKreditKarte = ""
    iFehler = 53
            gcZahlMittel = ""
    iFehler = 54
'            If gbBEDLEER = True Then
'                If Command5(1).Caption = "Schließen" Then
'                    Text1(0).Text = ""
'                    Label1(8).Caption = ""
'                    Text1(0).SetFocus
'                    indentmitKarte
'                End If
'            End If
            
            If gsiGESRAB > 0 Then
                zeigeZwangsrabatt
            End If
            
            Check15.value = vbUnchecked
            cboVerfall.Text = ""
            Text2(9).Text = ""
            Text2(8).Text = ""
            
           
'           If Not gbDisplay Then

'           geändert am 02.01.14 hat Nagelschmitz festgestellt
'           wenn Fehler dann die oberste Codezeile wieder aktivieren
            If gbDisplay Or gbZweitMoni Then
                InitKundenDisplayModul20
            End If

            Screen.MousePointer = 0
               
            If Check4.value = vbChecked Then
                If Modul6.FindFile(gcDBPfad, "alrs3s.rpt") Then
                    If gbDINA4RECHFU Then
                        If Modul6.FindFile(gcDBPfad, "alrs3sfu.rpt") Then
                            reportbildschirm "alr", "alrs3sfu"
                        Else
                            MsgBox "Ihre spezielle Druckansicht(alrs3sfu.rpt) muss angepasst werden, bitte rufen Sie die Hotline (Thomas Heinz, 0511 9559112) an!", vbOKOnly, "Winkiss Hinweis:"
                        End If
                    Else
                        reportbildschirm "alr", "alrs3s"
                    End If
                Else
                    If gbDINA4RECHFU Then
                        reportbildschirm "alr", "alrs3fu"
                    Else
                        reportbildschirm "alr", "alrs3"
                    End If
                End If
                setzedrucker gcBonDrucker
                Check4.value = vbUnchecked
            End If
        
        
    End Select
    
    
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 5 Or err.Number = 53 Then
        Resume Next
    Else
    
        Command5(1).Enabled = True
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Command5_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten." & iFehler
        
        Fehlermeldung1
    End If
End Sub
Private Sub EinAusEcAuszahlung(dBetrag As Double)
    On Error GoTo LOKAL_ERROR
    
    Dim lDatum      As Long
    Dim czeit       As String
    Dim iBedNr      As Integer
    Dim cBezeich    As String
    Dim cART        As String
    Dim byKasnum    As Byte
    Dim ctmp        As String
    Dim cSQL        As String
    Dim rsrs        As Recordset
    
    byKasnum = CByte(gcKasNum)
    lDatum = Fix(Now)
    czeit = Format$(Now, "HH:MM:SS")
    
    iBedNr = Val(gcBedienerNr)
 
    If dBetrag < 0 Then
        Exit Sub
    Else
        cBezeich = "EC-Auszahlung"
        cART = "AUSZAHLUNG"
        
        UpdateAFCStatEinUndAuszahlungen cART, dBetrag
    End If
    
    cSQL = "Select * from KAEINAUS"
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    rsrs.AddNew
    rsrs!ADATE = lDatum
    rsrs!AZEIT = czeit
    rsrs!BEDNU = iBedNr
    rsrs!Betrag = dBetrag
    rsrs!BEZEICH = cBezeich
    rsrs!art = cART
    rsrs!kasnum = byKasnum
    rsrs.Update
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Select * from KAEINAUSF"
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    rsrs.AddNew
    rsrs!ADATE = lDatum
    rsrs!AZEIT = czeit
    rsrs!BEDNU = iBedNr
    rsrs!Betrag = dBetrag
    rsrs!BEZEICH = cBezeich
    rsrs!art = cART
    rsrs!kasnum = byKasnum
    rsrs!SENDOK = False
    rsrs!FILIALE = gcFilNr
    rsrs.Update
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Select * from EINAUSKB"
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    rsrs.AddNew
    rsrs!ADATE = lDatum
    rsrs!AZEIT = czeit
    rsrs!BEDNU = iBedNr
    rsrs!Betrag = dBetrag
    rsrs!BEZEICH = cBezeich
    rsrs!art = cART
    rsrs!kasnum = byKasnum
    rsrs!SENDOK = False
    rsrs!FILIALE = gcFilNr
    rsrs.Update
    rsrs.Close: Set rsrs = Nothing
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "EinAusEcAuszahlung"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub UpdateAFCStatEinUndAuszahlungen(sArt As String, dBetrag As Double)
    On Error GoTo LOKAL_ERROR

    Dim lDatum          As Long
    Dim cSQL            As String
    Dim rsrs            As Recordset

    lDatum = Fix(Now)

    cSQL = "Select * from AFCSTAT where ADATE = " & Trim$(Str$(lDatum)) & " and KASNUM = " & gcKasNum & " "
    FnOpenrecordset rsrs, cSQL, 1, gdBase

    If Not rsrs.EOF Then
        rsrs.Edit
    Else
        rsrs.AddNew
    End If

    Select Case UCase(sArt)
        Case "AUSZAHLUNG"
'            HoleNeueBonNrWKL20
            If Not IsNull(rsrs!AUSZAHLUNG) Then
                rsrs!AUSZAHLUNG = rsrs!AUSZAHLUNG + dBetrag
            Else
                rsrs!AUSZAHLUNG = dBetrag
            End If

    End Select
    'Datum und Kassennummer setzen
    rsrs!ADATE = lDatum
    rsrs!kasnum = Val(gcKasNum)

'    If Not IsNull(rsrs!BELEGNR) Then
'        If gdBonNr < CLng(rsrs!BELEGNR) Then
'
'        Else
'            rsrs!BELEGNR = gdBonNr
'        End If
'    Else
'        rsrs!BELEGNR = gdBonNr
'    End If

    rsrs.Update
    rsrs.Close: Set rsrs = Nothing

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "UpdateAFCStatEinUndAuszahlungen"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Kasse auf."

    Fehlermeldung1
End Sub
Private Sub Command5_KeyUp(index As Integer, KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    If index = 0 Then
        If KeyCode = vbKeyEscape Then
            Command5_Click 1
        End If
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command5_KeyUp"
    Fehler.gsFehlertext = "Bei der Kreditkartenauswahl ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command6_Click()
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    Dim rsrs As DAO.Recordset
    
       'Passwort prüfen
    If Text1(2).Text = gsKassPass Then
        allObjectsEinschalten Me
        
        Frame15.Enabled = False
        Frame15.Visible = False
        Label2(5).Caption = "1"
        
        isperre = 0
        
        If gbBEDKARTE Then
            If Identi(93) = True Then
                gcIdentBedienerNr = ""
                glIdentLevel = -1

                gsMeldestatus = "Identifikation"
                frmWK12a.Show 1

                Text1(0).Text = gcIdentBedienerNr
                gcBedienerNr = gcIdentBedienerNr
                SSCommand2_Click 15
                Command2(17).Visible = True

            End If
        End If
        
    Else
    
        If gbBEDKARTE = True Then
        'prüf mal auf Bedienerkarte
        
            cSQL = "Select * from BEDNAME where BEDcode = '" & Text1(2).Text & "' "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
    
    
                allObjectsEinschalten Me
        
                Frame15.Enabled = False
                Frame15.Visible = False
                Label2(5).Caption = "1"
                
                isperre = 0
                
                
                
'                If gbBEDLEER = True Then
'                    Text1(0).Text = ""
'                    Label1(8).Caption = ""
'                    Text1(0).SetFocus
'                End If
                
                
                If Text1(0).Text <> "" Then
                    Text1(1).Text = ""
                    Text1(1).SetFocus
                End If
                
                If gbBEDKARTE Then
                    If Identi(93) = True Then
                        gcIdentBedienerNr = ""
                        glIdentLevel = -1

                        gsMeldestatus = "Identifikation"
                        frmWK12a.Show 1

                        Text1(0).Text = gcIdentBedienerNr
                        gcBedienerNr = gcIdentBedienerNr
                        SSCommand2_Click 15
                        Command2(17).Visible = True

                    End If
                End If
                    
            Else
                Text1(2).Text = ""
                Text1(2).SetFocus
            End If
            rsrs.Close: Set rsrs = Nothing
            
        Else
                
        
        
            Text1(2).Text = ""
            Text1(2).SetFocus
            
        End If
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command6_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command66_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Select Case index
        Case Is = 0
            Text3_KeyUp 4, vbKeyF2, 0
        Case Is = 1
            Text3_KeyUp 6, vbKeyF2, 0
        Case Is = 2
            Text3_KeyUp 5, vbKeyF2, 0
        Case Is = 3
            Text3_KeyUp 77, vbKeyF2, 0
    End Select
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command66_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub voreinstellungspeichernE20B()
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL As String
    
    
    Dim bo0 As Integer
    Dim bo1 As Integer
    Dim bo2 As Integer
    Dim bo3 As Integer
    Dim bo4 As Integer
    
    loeschNEW "E20B", gdApp
    CreateTable "E20B", gdApp
    
    If Check1.value = vbChecked Then
        bo0 = 0
    Else
        bo0 = -1
    End If
    
    If Check7.value = vbChecked Then
        bo1 = 0
    Else
        bo1 = -1
    End If
    
    If Check8.value = vbChecked Then
        bo2 = 0
    Else
        bo2 = -1
    End If
    
    If Check11.value = vbChecked Then
        bo3 = 0
    Else
        bo3 = -1
    End If
    
    If Check12.value = vbChecked Then
        bo4 = 0
    Else
        bo4 = -1
    End If
    
    
    sSQL = "Insert into E20B ( bo0,bo1,bo2,bo3,bo4) "
    sSQL = sSQL & " values (" & bo0 & "," & bo1 & "," & bo2 & "," & bo3 & "," & bo4 & ")"

    gdApp.Execute sSQL, dbFailOnError
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungspeichernE20B"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub voreinstellungladenE20B()
    On Error GoTo LOKAL_ERROR
    
    Dim rs As Recordset
    Dim bo0 As Integer
    Dim bo1 As Integer
    Dim bo2 As Integer
    Dim bo3 As Integer
    
    Set rs = gdApp.OpenRecordset("E20B")
    If Not rs.EOF Then
    
        If rs!bo0 = True Then
            Check1.value = vbUnchecked
        Else
            Check1.value = vbChecked
        End If
        
        If rs!bo1 = True Then
            Check7.value = vbUnchecked
        Else
            Check7.value = vbChecked
        End If
        
        If rs!bo2 = True Then
            Check8.value = vbUnchecked
        Else
            Check8.value = vbChecked
        End If
        
        If rs!bo3 = True Then
            Check11.value = vbUnchecked
        Else
            Check11.value = vbChecked
        End If
        
        If rs!bo4 = True Then
            Check12.value = vbUnchecked
        Else
            Check12.value = vbChecked
        End If

    End If
    rs.Close: Set rs = Nothing

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungladenE20B"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub voreinstellungspeichernE20C()
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL As String
    Dim bo0 As Integer
    Dim bo1 As Integer
    Dim bo2 As Integer
    Dim bo3 As Integer
    
    loeschNEW "E20C", gdApp
    CreateTable "E20C", gdApp
    
    If Check9.value = vbChecked Then
        bo0 = 0
    Else
        bo0 = -1
    End If
    
    If Check14.value = vbChecked Then
        bo1 = 0
    Else
        bo1 = -1
    End If
    
    If Check16.value = vbChecked Then
        bo2 = 0
    Else
        bo2 = -1
    End If
    
    If Check18.value = vbChecked Then
        bo3 = 0
    Else
        bo3 = -1
    End If
    
    sSQL = "Insert into E20C ( bo0,bo1,bo2,bo3) "
    sSQL = sSQL & " values (" & bo0 & "," & bo1 & "," & bo2 & "," & bo3 & ")"

    gdApp.Execute sSQL, dbFailOnError
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungspeichernE20C"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub voreinstellungladenE20C()
    On Error GoTo LOKAL_ERROR
    
    Dim rs As Recordset
    Dim bo0 As Integer
    Dim bo1 As Integer
    
    Set rs = gdApp.OpenRecordset("E20C")
    If Not rs.EOF Then
        If rs!bo0 = True Then
            Check9.value = vbUnchecked
        Else
            Check9.value = vbChecked
        End If
        
        If rs!bo1 = True Then
            Check14.value = vbUnchecked
        Else
            Check14.value = vbChecked
        End If
        
        If rs!bo2 = True Then
            Check16.value = vbUnchecked
        Else
            Check16.value = vbChecked
        End If
        
        If rs!bo3 = True Then
            Check18.value = vbUnchecked
        Else
            Check18.value = vbChecked
        End If
    End If
    rs.Close: Set rs = Nothing
     
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungladenE20C"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Command8_Click(index As Integer)
On Error GoTo LOKAL_ERROR

    Select Case index
    
        Case 118
        
            List4.SetFocus
            SendKeys "{PGUP}"
        
        Case 119
            List4.SetFocus
            SendKeys "{PGDN}"
            
        Case 120
        
            grd1.SetFocus
            SendKeys "{PGUP}"
        
        Case 121
            grd1.SetFocus
            SendKeys "{PGDN}"
    End Select
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command8_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command9_Click()
On Error GoTo LOKAL_ERROR

    Frame30.Visible = False
'    Text1(1).Text = "nicht gefunden"

'    Text1(1).Text = ""
    Text1(1).SetFocus

    bfromFrame36 = True

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command9_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Sub Form_Activate()
    On Error GoTo LOKAL_ERROR

    indentmitKarte
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Form_Activate"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Public Sub indentmitKarte()
    On Error GoTo LOKAL_ERROR

    If Text1(0).Text = "" Then
        If gbBEDKARTE Then
            If Identi(93) = True Then
                gcIdentBedienerNr = ""
                glIdentLevel = -1
                    
                gsMeldestatus = "Identifikation"
                frmWK12a.Show 1
                
                Text1(0).Text = gcIdentBedienerNr
                gcBedienerNr = gcIdentBedienerNr
                SSCommand2_Click 15
                Command2(17).Visible = True
                
            End If
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "indentmitKarte"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Form_Load()
    On Error GoTo LOKAL_ERROR
    
    Dim lcount  As Long
    Dim iStep   As Integer
    Dim lRet    As Long
    Dim i       As Integer
    Dim rsrs    As Recordset
    Dim sSQL    As String
    
    Screen.MousePointer = 11
    
    frmWKL00.picprogress.Visible = True
    frmWKL00.Label2.Visible = True
    
    iStep = 1
    frmWKL00.txtStatus.Text = iStep * 8
    frmWKL00.Label2.Caption = "Bildschirm anpassen..."
    frmWKL00.Label2.Refresh
    
    PositionierenWKL20
    
    iStep = 2
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Größen festlegen..."
    frmWKL00.Label2.Refresh
    
    Modul6.Skalieren_Kasse Me, True, True
    
    
    Me.WindowState = 2
    
    
    Frame40.Left = Frame33.Width / 2 - Frame40.Width / 2
    
    iStep = 3
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Farben festlegen..."
    frmWKL00.Label2.Refresh
    
    If gbISDEMO = True Then
        Modul6.Farbform Me, Nothing
    Else
        Modul6.Farbform_nurButtons Me, Nothing
    End If
    
    iStep = 4
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Schriftarten laden..."
    frmWKL00.Label2.Refresh
    
    Modul6.Schrift Me
    
    iStep = 5
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Standardwerte setzen..."
    frmWKL00.Label2.Refresh
    
    Modul6.Log Me
    
'    iStep = 5
'    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Landeswährung einstellen..."
    frmWKL00.Label2.Refresh
    
    'Moni
'    Moni verbinden
'    Command15_Click

    iCheck = 0
    
'    Label27.Caption = "Druckerstatus: wird ermittelt..."
'    Label27.Caption = "Druckerstatus: " & WerIstDefaultDrucker 'gcDefaultDrucker
    

    If Datendrin("NOEURO", gdBase) Then
        Check6.value = vbUnchecked
        cboNoEuro.Visible = False
        gsFremdKuerzel = ""
        gsUK = "0"
    Else
        NoFremdMoney
    End If

'    iStep = 6
'    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Münzen/Scheine setzen..."
    frmWKL00.Label2.Refresh

    zeigwaehrung "EUR"
    
'    iStep = 7
'    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Standardwerte setzen..."
    frmWKL00.Label2.Refresh
    
    Frame15.Left = Screen.Width / 2 - Frame15.Width / 2
    isperre = 0
    
    
    Label18.Caption = ""
    Label18.Refresh

    gbbonusHerab = False
    bAbschluss = False
    gbMerkmal = False
    Screen.MousePointer = 11
    Timer1.Interval = 1000
    Timer1.Enabled = True
    
    Label20(0).Caption = Format$(Time, "HH:MM:SS")
    Label20(0).Refresh
    Label20(3).Caption = Format$(Now, "DD.MM.YY")
    Label20(3).Refresh
    
    If Val(gcKasNum) > 0 And Val(gcKasNum) < 10 Then
        Label23.BackColor = glfarbe(gcKasNum)
    End If
            
    Label23.Caption = gcKasNum
    Label23.ToolTipText = "Kassennummer: " & gcKasNum
    
    Dim cPfad As String
    
    cPfad = gcDBPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    Set Picture5.Picture = LoadPicture(cPfad & "Picture\System\" & "brief.gif")
    Picture5.Tag = "brief"
    Picture5.Visible = True
    
    
    
    
    
    
    
    
    
    Label78.Caption = frmWKL00!Label1(1).Caption
    Frame33.Visible = False

    For lcount = 0 To 17
        Command1(lcount).Visible = False
    Next lcount
    Command1(11).Visible = True
    
    gbBonDruck = True
    gbNochOffen = False
    
    If gbLokalModus And gbEcash Then

        Command1(36).Enabled = False
        Command1(31).Enabled = False

    Else

        Command1(36).Enabled = True

    End If
    
    If gbLokalModus Then
        Command1(39).Enabled = False
    Else
        Command1(39).Enabled = True
    End If
    
    CheckIndex "ARTIKEL", "ARTNR", "", gdBase
    
    'Message über Drucker an Display senden

    iStep = 6
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Warengruppen Teil 1 setzen..."
    frmWKL00.Label2.Refresh
    
    LeseWarengruppenWKL20
    
    iStep = 7
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Warengruppen Teil 2 setzen..."
    frmWKL00.Label2.Refresh
    
    LeseWarengruppenWKL20T2
    
    iStep = 8
    frmWKL00.txtStatus.Text = iStep * 8

    frmWKL00.Label2.Caption = "Standardwerte setzen..."
    frmWKL00.Label2.Refresh
    
    If FileExists(gcPfad & "BUTTONS.CFG") Then
        SchalteCommand1WKL20
    Else
        If NewTableSuchenDBKombi("BUTTON", gdBase) Then
            lesebutton
        End If
    End If
    
    bmerkEC = Command1(0).Enabled

    faerbeRot
    faerbeRot_ArtAuswahl
    
    LeseDISINH
    LeseDIsPause
    
    iStep = 9
    frmWKL00.txtStatus.Text = iStep * 8
    
    If NewTableSuchenDBKombi("E20B", gdApp) Then
        If SpalteInTabellegefundenNEW("E20B", "BO4", gdApp) Then
            voreinstellungladenE20B
        End If
    End If
    
    If NewTableSuchenDBKombi("E20C", gdApp) Then
        If SpalteInTabellegefundenNEW("E20C", "BO2", gdApp) = False Then
            SpalteAnfuegenNEW "E20C", "BO2", "Bit", gdApp
        End If
        If SpalteInTabellegefundenNEW("E20C", "BO3", gdApp) = False Then
            SpalteAnfuegenNEW "E20C", "BO3", "Bit", gdApp
        End If
        voreinstellungladenE20C
    End If
    
    iStep = 10
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "letzte Einstellung - Drucker setzen..."
    frmWKL00.Label2.Refresh
    
    setzedrucker gcBonDrucker
    Label27.Caption = "Druckerstatus: " & WerIstDefaultDrucker & "      Kasse: " & gcKasNum 'gcDefaultDrucker
    
    giPreisKz = 0
    gb28 = False
    
    leseadtopt
    If CInt(gADTclientId) > 0 Then
    
        If gADTipAdress <> "" And gADTport <> "" Then
            '192.168.1.14 '20002
            lRet = ELMESettings(vbNullString, gADTclientId, vbNullString, gADTipAdress, gADTport, -1, -1, -1, vbNullString)
        Else
            lRet = ELMESettings(vbNullString, gADTclientId, vbNullString, vbNullString, -1, -1, -1, -1, vbNullString)
        End If
    End If
    
    lese_ELPAY_opt
    
    lese_ZVT_opt
    
    lese_ZVT_opt2
    
    
    
    iStep = 12
    frmWKL00.txtStatus.Text = iStep * 8
    
    Combo2.Clear
    Combo2.AddItem "Alle Zahlungsarten"
    Combo2.AddItem "BA Barzahlung"
    Combo2.AddItem "EC Kartenzahlung EC"
    Combo2.AddItem "AE Kartenzahlung American Express"
    Combo2.AddItem "VI Kartenzahlung VISA"
    Combo2.AddItem "EU Kartenzahlung Eurocard / Mastercard"
    Combo2.AddItem "DC Kartenzahlung Diners Club"
    Combo2.AddItem "BC Kartenzahlung Barclaycard"
    Combo2.AddItem "SO Kartenzahlung sonstige"
    Combo2.AddItem "GZ gemischte Zahlung"
    Combo2.AddItem "LS Lastschrift"
    Combo2.AddItem "KR Kreditkauf"
    Combo2.Text = "Alle Zahlungsarten"
    
    frmWKL00.Label2.Caption = "Neukunden berechnen..."
    frmWKL00.Label2.Refresh
    
    
    If gbAutoLokalModus = False Then
        If gbNeukunden Then
            rechneNeuKunden
            ermBestMitarbeiter
            
            Label1(22).Caption = ermNeuKunden(1)
            Label1(22).Refresh
            
            Label1(20).Caption = ermNeuKunden(2)
            Label1(20).Refresh
            
            Label1(23).Caption = ermNeuKunden(3)
            Label1(23).Refresh
            
            Label1(21).Caption = ermNeuKunden(4)
            Label1(21).Refresh
            
            Label1(25).Caption = zeigeBestenMitarbeiterNeukunde
            Label1(25).ForeColor = &H8080&
            Label1(25).Refresh
        Else
            Label1(22).Visible = False
            Label1(20).Visible = False
            Label1(23).Visible = False
            Label1(21).Visible = False
            Label1(25).Visible = False
            Label1(24).Visible = False
        End If
    Else
        Label1(22).Visible = False
        Label1(20).Visible = False
        Label1(23).Visible = False
        Label1(21).Visible = False
        Label1(25).Visible = False
        Label1(24).Visible = False
    End If
    
    If gbRabVs = True Then
        Command1(4).Caption = "AR"
        Command1(3).Caption = "GR"
        
        Label1(2).Caption = "AR"
        Label1(3).Caption = "GR"
    End If
    
    If gsGZBez <> "" Then
        Command1(6).Caption = gsGZBez
        Command1(6).FontSize = 10
    End If
    
    leseBonusArt
    
    If giBonusNr = 0 Then
        leseBonusBonTexte
    End If
    
    If giBonusNr = 1 Then
        leseBWWBonTexte
    End If
    
    WasistmitBONUSAA
    ist_Aboplus
    ist_Bonus_nummer
    

    
    
    iStep = 13
    frmWKL00.txtStatus.Text = iStep * 8
    
    frmWKL00.Label2.Caption = "Kassbon prüfen..."
    frmWKL00.Label2.Refresh
    
    
    Dim KASSBON_DB    As Database
    
    cPfad = gcDBPfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad = cPfad & "GDPdU\KASSBON.MDB"
    
    sErrDabapfad = cPfad
    
    Set KASSBON_DB = OpenDatabase(cPfad, False, False, "MS Access;PWD=" & gsKASSBON_Passwort)
    
    CheckIndex "KASSBOND", "DATUM", "", KASSBON_DB
    CheckIndex "KASSBOND", "BONNR", "", KASSBON_DB
    CheckIndex "KASSBOND", "KASNUM", "", KASSBON_DB
    CheckIndex "KASSBOND", "UHRZEIT", "", KASSBON_DB
    
    KASSBON_DB.Close

    
    Dim ServerIP As String

    If gbSPY Then
        Winsock22.Connect gsServerIP, gsServerPort
    End If
    
    
    loeschNEW "AFCB" & rechnername, gdBase
    loeschNEW "KJ" & rechnername, gdBase
    
    sSQL = "Select * into AFCB" & rechnername & " FROM AFCBUCH where aartnr = -1"
    gdBase.Execute sSQL, dbFailOnError
    
    sSQL = "Select * into KJ" & rechnername & " FROM Kassjour where artnr = -1"
    gdBase.Execute sSQL, dbFailOnError
    
    'Lese Konfiguration Kasse je nach Bediener
    LeseKonfigurationKasseWKL20
    
    bfromFrame36 = False
    bfromFrame46 = False
    
    Dim Task$
    
    If gbZweitMoni Then
        loeschNEW "DISPLAY_" & rechnername, gdBase
        CreateTableT2 "DISPLAY_" & rechnername, gdBase
        
        
        Dim hwnd&
        Dim Y As String
        Dim result&
        Dim Title$

        Y = "Ihre Kundeninformationen"

        hwnd = GetWindow(Me.hwnd, GW_HWNDFIRST)

        Do
            result = GetWindowTextLength(hwnd) + 1
            Title = Space(result)
            result = GetWindowText(hwnd, Title, result)
            Title = Left$(Title, Len(Title) - 1)

            If InStr(1, Title, Y) Then

                SendMessage hwnd, WM_CLOSE, ByVal 0&, ByVal 0&

            End If

            hwnd = GetWindow(hwnd, GW_HWNDNEXT)
        Loop Until hwnd = 0
        
        
        
        
        Task = Shell(App.Path & "\Display.exe", 1) 'Display öffnen
        
        If gbZweitMoniMinimieren = True Then
            Pause 1
            
'            Dim hwnd&
'            Dim Y As String
'            Dim Result&
'            Dim Title$
    
            Y = "Ihre Kundeninformationen"
    
            hwnd = GetWindow(Me.hwnd, GW_HWNDFIRST)
    
            Do
                result = GetWindowTextLength(hwnd) + 1
                Title = Space(result)
                result = GetWindowText(hwnd, Title, result)
                Title = Left$(Title, Len(Title) - 1)
    
                If InStr(1, Title, Y) Then
    
                    ShowWindow hwnd, vbMinimizedNoFocus
    
                End If
    
                hwnd = GetWindow(hwnd, GW_HWNDNEXT)
            Loop Until hwnd = 0
        End If

    End If
    
    
  
    
    
    
    
    
    
    
    
    
    If gbDINA4VIS Then
        Check3.Visible = True
        Check4.Visible = True
    Else
        Check3.Visible = False
        Check4.Visible = False
    End If
    
    Picture2.BackColor = Frame3.BackColor
    Picture4.BackColor = Frame3.BackColor
    
    Shape1.Visible = False
    Shape2.Visible = False
    Shape3.Visible = False
    
    Label39(3).Caption = ""
    Label39(4).Caption = ""
    
    Label39(0).Caption = ""
    
    
    'Grund.cfg
    Dim cpfaddb As String


    cpfaddb = gcDBPfad
    If Right$(cpfaddb, 1) <> "\" Then
        cpfaddb = cpfaddb & "\"
    End If

    If FileExists(cpfaddb & "Grund.cfg") Then

        If NewTableSuchenDBKombi("AFCBUCH_GRUND", gdBase) = False Then

            CreateTableT2 "AFCBUCH_GRUND", gdBase

        End If

    End If
    'Ende Grund.cfg
    
    'wenn zvt, dann hier starten
    If gsEPartner = "ZVT" Then
    
        Dim bZvtfound As Boolean
        lese_ZVT_opt
        
        bZvtfound = False
        
        'close anwendung
'        Dim hwnd&
'        Dim Y As String
'        Dim Result&
'        Dim Title$
    
        Y = gZVTPTitel
                                
        hwnd = GetWindow(Me.hwnd, GW_HWNDFIRST)
    
        Do
            result = GetWindowTextLength(hwnd) + 1
            Title = Space(result)
            result = GetWindowText(hwnd, Title, result)
            Title = Left$(Title, Len(Title) - 1)
    
            If InStr(1, Title, Y) Then
                bZvtfound = True
                Exit Do
            End If
    
            hwnd = GetWindow(hwnd, GW_HWNDNEXT)
        Loop Until hwnd = 0
        
        If bZvtfound = False Then
            'Starte anwendung
            Dim prev_dir As String
            ' Save the current directory.
            prev_dir = CurDir
            ' Go to the desired startup directory.
            ChDrive Left(gZVTioPfad, 1)
            ChDir gZVTioPfad
            ' Shell the application.
            lRet = Shell(gZVTPName, vbNormalFocus)
            ' Restore the saved directory.
            ChDir prev_dir
        End If
    End If
    
    If gbAA = True Then
        Command1(52).Enabled = True
        Command1(43).Enabled = True
    Else
        Command1(52).Enabled = False
        Command1(43).Enabled = False
    End If
    
    Command1(55).BackColorFrom = vbWhite
    Command1(55).BackColorTo = vbWhite
    
    Command1(55).DownColorFrom = vbWhite
    Command1(55).DownColorTo = vbWhite
    
    Command1(55).HoverColorFrom = vbWhite
    Command1(55).HoverColorTo = vbWhite
    
    
    frmWKL00.picprogress.Visible = False
    
    frmWKL00.Label2.Caption = ""
    frmWKL00.Label2.Refresh
    frmWKL00.Label2.Visible = False
    
    ''''''''''''Oliver Alte TSE START
    
'    TSS.Connect WinsockTSE, TimerNetwork
'
'    If gbTSE_SCHREIBEN Then
'        anzeige "normal", TSS.NotConnectedText, LabelTSS
'    Else
'        LabelTSS.Caption = ""
'    End If

    ''''''''''''Oliver Alte TSE ENDE
    
    Screen.MousePointer = 0

Exit Sub
LOKAL_ERROR:



    If err.Number = 3343 Then
    
        giUmleitgrund = 2 'Datenbankpfad muß rep
        
        gcUmleittxt = "Ihre Datenbank ist beschädigt. " & sErrDabapfad & vbCrLf
        gcUmleittxt = gcUmleittxt & "Beenden Sie alle anderen Programme auf allen anderen Computern! " & vbCrLf & vbCrLf
        gcUmleittxt = gcUmleittxt & "Drücken Sie 'reparieren', um dann die Datenbank zu reparieren!" & vbCrLf
        
        frmWKL60.Show 1
    
        Resume
    Else


        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Form_Load"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
        
    End If
End Sub
Private Sub lesebutton()
On Error GoTo LOKAL_ERROR
    
    Dim rsrs As Recordset
    Dim sSQL As String
    
    Set rsrs = gdBase.OpenRecordset("Button")
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
        
            If Not IsNull(rsrs!buttonnr) Then
                Command1(rsrs!buttonnr).Enabled = False
            End If
        
        rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "lesebutton"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub NoFremdMoney()
    On Error GoTo LOKAL_ERROR
    
    Check6.Visible = False
    Check6.value = vbUnchecked
    NoFremdMoneyAuswahl
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "NoFremdMoney"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub NoFremdMoneyAuswahl()
    On Error GoTo LOKAL_ERROR
    

    Label88(1).Visible = False
    Label88(0).Visible = False
    Text88.Visible = False
    
    Label88(2).Visible = False
    Label88(3).Visible = False
    Label88(4).Visible = False
    
    Label88(1).Caption = ""
    Label88(2).Caption = "noch offen"
    Label88(3).Caption = "0,00"
    Text88.Text = ""
'    Text333.SetFocus
    gsUK = "0"
    gsFremdKuerzel = ""
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "NoFremdMoneyAuswahl"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Frame8_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
On Error GoTo LOKAL_ERROR
    
    Label1(24).ForeColor = glS1
    Label1(27).ForeColor = glS1
    
    If gbAutoLokalModus = False Then
        Label1(25).Caption = zeigeBestenMitarbeiterNeukunde
        Label1(25).ForeColor = &H8080&
        Label1(25).Refresh
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Frame8_MouseMove"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub grd1_Click()
    On Error GoTo LOKAL_ERROR
    
    glSelect = grd1.Row
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "grd1_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub grd1_DblClick()
    On Error GoTo LOKAL_ERROR
    
    glSelect = grd1.Row
    
    If glSelect > 1 Then
        Command4_Click 4
    Else
        sortierenHGrid grd1
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "grd1_DblClick"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub grd1_EnterCell()
    On Error GoTo LOKAL_ERROR
    
    glSelect = grd1.Row
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "grd1_EnterCell"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub grd1_KeyUp(KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyReturn Then
        Command4_Click 4
    End If
    If KeyCode = vbKeyEscape Then
        Command4_Click 3
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "grd1_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub grd1_LeaveCell()
    On Error GoTo LOKAL_ERROR
    
    glSelect = grd1.Row
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "grd1_LeaveCell"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Label1_Click(index As Integer)
On Error GoTo LOKAL_ERROR

    If index = 6 Then 'Klick aufZwischensumme
         List3.Nodes.Add Text:="    0 000000 Zwischensumme: " & Label2(6).Caption
         List1.AddItem "    0 000000 Zwischensumme: " & Label2(6).Caption & Space(90)
    End If

    If index = 27 Then
        If Label1(27).Caption = "Karte/KdNr/Name" Then
            Label1(27).Caption = "Strasse"
        ElseIf Label1(27).Caption = "Strasse" Then
            Label1(27).Caption = "Ort"
        ElseIf Label1(27).Caption = "Ort" Then
            Label1(27).Caption = "PLZ"
        ElseIf Label1(27).Caption = "PLZ" Then
            Label1(27).Caption = "Firma"
        ElseIf Label1(27).Caption = "Firma" Then
            Label1(27).Caption = "Kundenkarte"
        ElseIf Label1(27).Caption = "Kundenkarte" Then
            Label1(27).Caption = "Telefon"
        ElseIf Label1(27).Caption = "Telefon" Then
            Label1(27).Caption = "Karte/KdNr/Name"
        End If
    End If

    If index = 24 Then
        Screen.MousePointer = 11
    
        Label1(22).Caption = "...warten"
        Label1(22).Refresh
        
        Label1(20).Caption = "...warten"
        Label1(20).Refresh
        
        Label1(23).Caption = "...warten"
        Label1(23).Refresh
        
        Label1(21).Caption = "...warten"
        Label1(21).Refresh
        
        Label1(25).Caption = "...warten"
        Label1(25).Refresh
        
        rechneNeuKunden
        ermBestMitarbeiter
        Label1(25).Caption = zeigeBestenMitarbeiterNeukunde
        Label1(25).ForeColor = &H8080&
        Label1(25).Refresh
        
        Label1(22).Caption = ermNeuKunden(1)
        Label1(22).Refresh
        
        Label1(20).Caption = ermNeuKunden(2)
        Label1(20).Refresh
        
        Label1(23).Caption = ermNeuKunden(3)
        Label1(23).Refresh
        
        Label1(21).Caption = ermNeuKunden(4)
        Label1(21).Refresh
        
        Screen.MousePointer = 0
    End If
    
    If index = 25 Then
    
        'zeige Rangfolge Mitarbeite Neukunden 14 Tage
        Screen.MousePointer = 11
        ermBestMitarbeiter14 Label1(25)
        anzeige "normal", "Druckvorschau wird erstellt...", Label1(25)
        
        Dim sSQL As String
    
    
        loeschNEW "MITKU", gdBase
        CreateTable "MITKU", gdBase
        
        sSQL = "Insert Into MITKU select * from MITKU" & srechnertab
        gdBase.Execute sSQL, dbFailOnError
        
        reportbildschirm "", "aWKL20"
        
        setzedrucker gcBonDrucker
        Screen.MousePointer = 0
    
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Label1_Click"
    Fehler.gsFehlertext = "Es ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Label1_DblClick(index As Integer)
On Error GoTo LOKAL_ERROR

    If index = 10 Then
        Label1(index).Caption = "alle Farben"
        Label1(index).Tag = ""
        Label1(index).BackColor = Label5(5).BackColor
        Label1(index).ForeColor = Label5(5).ForeColor
    End If
    
    If index = 9 Then
        Label1(index).Caption = "alle Farben"
        Label1(index).Tag = ""
        Label1(index).BackColor = Label5(5).BackColor
        Label1(index).ForeColor = Label5(5).ForeColor
    End If
    
    If index = 7 Then
        frmWKL65.Show 1
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Label1_dblClick"
    Fehler.gsFehlertext = "Es ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Label1_MouseMove(index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
On Error GoTo LOKAL_ERROR

    If index = 24 Then
        Label1(24).ForeColor = glLink
    End If
    
    If index = 25 Then
'        Label1(25).ForeColor = vbRed
        Label1(25).Caption = "Klicke, Rangfolge der Mitarbeiter"
    End If
    
    If index = 27 Then
        Label1(27).ForeColor = glLink
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Label1_Click"
    Fehler.gsFehlertext = "Es ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Label2_Change(index As Integer)
On Error GoTo LOKAL_ERROR

    Dim SFarbe As String

    If index = 7 Then
        If IsNumeric(Label2(7).Caption) Then
            SFarbe = ermFarbe(Trim(Label2(7).Caption))
            If CInt(Trim(SFarbe)) <= 0 Then
                Label1(7).BackColor = &HC0C0C0
            ElseIf CInt(Trim(SFarbe)) > 9 Then
                Label1(7).BackColor = &HC0C0C0
            Else
                Label1(7).BackColor = glfarbe(SFarbe)
            End If
        End If
    End If

Exit Sub
LOKAL_ERROR:
    If err.Number = 13 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Label2_Change"
        Fehler.gsFehlertext = "Es ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
End Sub
Private Sub Label2_dblClick(index As Integer)
On Error GoTo LOKAL_ERROR

    If index = 7 Then
        gckundnr = Trim$(Label2(7).Caption)
        frmWKL74.Show 1
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Label2_dblClick"
    Fehler.gsFehlertext = "Es ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Label9_Click()
On Error GoTo LOKAL_ERROR

    If List4.Nodes.Count > 0 Then
        Frame9.Visible = False
        List2.Visible = True
        List4.Visible = True
        
        Command4(10).Visible = True
        Command4(9).Visible = True
        Command4(1).Visible = True
        cmdFoto.Visible = True
        
        Command8(118).Visible = True
        Command8(119).Visible = True
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List9_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub List12_Click()
On Error GoTo LOKAL_ERROR

ZeigeZweitenKassenBon List12.list(List12.ListIndex)
gbQRFlag = True

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List12_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub List12_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR

    If KeyCode = vbKeyEscape Then
        Command11_Click (2)
    ElseIf KeyCode = vbKeyReturn Then
        Command11_Click (1)
    End If
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List12_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub EinzelPosStorno()
On Error GoTo LOKAL_ERROR

    Dim iIndexEinzelList3 As Integer
    Dim iIndexEinzelList1 As Integer
    Dim iIndextemp As Integer
    Dim cLBSatz As String
    Dim cFeld As String
    Dim dWert As Double
    Dim cArtNr As String
    Dim dRestMenge As Double
    Dim cBezeich As String
    Dim iAktiverSatz As Integer
    Dim cZeile1 As String
    Dim cZeile2 As String

    iIndexEinzelList3 = List3.SelectedItem.index
    iIndextemp = List3.SelectedItem.index
    iIndexEinzelList1 = iIndextemp - 1

    cLBSatz = List1.list(iIndexEinzelList1)
    
    If Mid(cLBSatz, 7, 6) = "000000" Then
        List1.RemoveItem iIndexEinzelList1
        List3.Nodes.Remove iIndexEinzelList3
        Exit Sub
    End If
    iAktiverSatz = iIndexEinzelList1
   
    cLBSatz = List1.list(iIndexEinzelList1)
    
    cBezeich = Mid(cLBSatz, 14, 35)
    cBezeich = Trim$(cBezeich)
    cFeld = Left(cLBSatz, 5)
    cFeld = Trim$(cFeld)
    cFeld = fnMoveComma2Point$(cFeld)
    dWert = Val(cFeld)
    dWert = dWert * (-1)
    cArtNr = Mid(cLBSatz, 7, 6)

    If cArtNr = "666666" Then
        If Len(cBezeich) > 11 Then
            cBezeich = Mid(cBezeich, 11, Len(cBezeich) - 10)
            DeleteGutscheinWKL20 cBezeich
        End If
    End If
    '3. Einzel Rücknahme an Kasse Plus und Minus möglich
    dRestMenge = fnAktualisiereBestandWKL20(cArtNr, dWert, 3)
   
    List1.RemoveItem iIndexEinzelList1
    List3.Nodes.Remove iIndexEinzelList3
    gbAutomaticClick = True
    
    If LeseStaffelpreisArt_NEU(cArtNr) Then
        
        'wenn schon eine Einzeile rausfliegt, dann auch Staffelpreise prüfen
        
        Dim bStaffelpreisgeschrieben As Boolean
        bStaffelpreisgeschrieben = False
        
        Dim lAnzSatz As Long
        Dim lAktSatz As Long
        Dim cSQL As String
        lAnzSatz = frmWKL20.List1.ListCount
    
        For lAktSatz = 0 To lAnzSatz - 1
            
            cLBSatz = frmWKL20.List1.list(lAktSatz)
            
            cArtNr = Trim(Mid(cLBSatz, 7, 6))
            
            If LeseStaffelpreisArt_NEU(cArtNr) Then
            
                'Verarbeite Staffel
                
                'hole Staffnummer
                Dim sStaffNr As String
                sStaffNr = ermStaffNr(cArtNr)
            
                Dim lStaffelmenge As Long
                Dim dKVKStaffelpreis As Double
                
                Dim lStaffelmenge2 As Long
                Dim dKVKStaffelpreis2 As Double
                
                Dim lStaffelmenge3 As Long
                Dim dKVKStaffelpreis3 As Double
                
                
                Dim lVKMengeinWarenkorb As Long
                lVKMengeinWarenkorb = ermittleVKMenge_UeberStaffelNR(CLng(sStaffNr))
                
                
                Dim rsStaff As Recordset
                cSQL = "Select * from STAFFEL_KVK_GRUPPE where STAFFNR = " & sStaffNr
                FnOpenrecordset rsStaff, cSQL, 1, gdBase
                If Not rsStaff.EOF Then
                
                    rsStaff.MoveFirst
        
                    If Not IsNull(rsStaff!Menge) Then
                        lStaffelmenge = rsStaff!Menge
                    Else
                        lStaffelmenge = 0
                    End If
                    
                    If Not IsNull(rsStaff!Menge2) Then
                        lStaffelmenge2 = rsStaff!Menge2
                    Else
                        lStaffelmenge2 = 0
                    End If
                    
                    If Not IsNull(rsStaff!Menge3) Then
                        lStaffelmenge3 = rsStaff!Menge3
                    Else
                        lStaffelmenge3 = 0
                    End If
                    
                    
                    
                    If lStaffelmenge3 > 0 Then
                        If lVKMengeinWarenkorb >= lStaffelmenge3 Then
                            If Not IsNull(rsStaff!KVKPR3) Then
                                dKVKStaffelpreis3 = rsStaff!KVKPR3
                            Else
                                dKVKStaffelpreis3 = 0
                            End If
                            
                            If dKVKStaffelpreis3 > 0 Then
                                schreibeNeuenPreisInWarenkorb_ueberStaffNr CLng(sStaffNr), dKVKStaffelpreis3
                                bStaffelpreisgeschrieben = True
                            End If
                        End If
                    End If
                    
                    If lStaffelmenge2 > 0 Then
                        If lVKMengeinWarenkorb >= lStaffelmenge2 Then
                            If Not IsNull(rsStaff!KVKPR2) Then
                                dKVKStaffelpreis2 = rsStaff!KVKPR2
                            Else
                                dKVKStaffelpreis2 = 0
                            End If
                            
                            If dKVKStaffelpreis2 > 0 Then
                                schreibeNeuenPreisInWarenkorb_ueberStaffNr CLng(sStaffNr), dKVKStaffelpreis2
                                bStaffelpreisgeschrieben = True
                            End If
                        End If
                    End If
                    
                    
                    If lVKMengeinWarenkorb >= lStaffelmenge Then
                    
                        If Not IsNull(rsStaff!KVKPR1) Then
                            dKVKStaffelpreis = rsStaff!KVKPR1
                        Else
                            dKVKStaffelpreis = 0
                        End If
                        
                        If dKVKStaffelpreis > 0 Then
                            schreibeNeuenPreisInWarenkorb_ueberStaffNr CLng(sStaffNr), dKVKStaffelpreis
                            bStaffelpreisgeschrieben = True
                        End If
                    End If
                    
                    If bStaffelpreisgeschrieben = False Then
                        'hier wieder den regulären schreiben
                        schreibeRegulaerenPreisInWarenkorb_ueberStaffNr CLng(sStaffNr), Val(Label8(3).Caption)
'                        schreibeNeuenPreisInWarenkorb CLng(cArtNr), ermPreisMitPreisZK(cArtNr, Val(Label8(3).Caption))
                    
                    End If
                    
                End If
                rsStaff.Close: Set rsStaff = Nothing
            End If
            
           
           
        Next lAktSatz
        'Staffelpreisprüfung Ende
        
    End If
        
        
    'neu 13.12.17
    AktualisiereListboxWKL20
    AktualisiereZeileZwischenSummeWKL20
    'neu ende
        
        
        
    BerechneZwischenSummeWKL20
     
    cZeile1 = "Position storniert"
    cZeile2 = Space$(19)
     
    ZeigeKundenDisplay cZeile1, cZeile2
     
    Text1(1).SetFocus
     
    If List1.ListCount > 0 Then
        
    Else
        If gbBEDLEER = True Then
           Text1(0).Text = ""
           Label1(8).Caption = ""
           Text1(0).SetFocus
       End If
       
       kundenauswahlausblend
       
       Picture2.Tag = ""
       Picture2.Visible = False
       
       Shape1.Visible = False
       Shape2.Visible = False
       
       Label39(3).Caption = ""
       Label39(4).Caption = ""
       
   End If

   If gsiGESRAB > 0 Then
       zeigeZwangsrabatt
   End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "EinzelPosStorno"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub EinzelPosStorno_bestimmte_Zeile(iZeile As Integer)
On Error GoTo LOKAL_ERROR

    Dim iIndexEinzelList3 As Integer
    Dim iIndexEinzelList1 As Integer
    Dim iIndextemp As Integer
    Dim cLBSatz As String
    Dim cFeld As String
    Dim dWert As Double
    Dim cArtNr As String
    Dim dRestMenge As Double
    Dim cBezeich As String
    Dim iAktiverSatz As Integer
    Dim cZeile1 As String
    Dim cZeile2 As String

        iIndexEinzelList3 = iZeile
        iIndextemp = iZeile
        iIndexEinzelList1 = iIndextemp - 1
     
        cLBSatz = List1.list(iIndexEinzelList1)
         
        If Mid(cLBSatz, 7, 6) = "000000" Then
            List1.RemoveItem iIndexEinzelList1
            List3.Nodes.Remove iIndexEinzelList3
            Exit Sub
        End If
        iAktiverSatz = iIndexEinzelList1
        
        cLBSatz = List1.list(iIndexEinzelList1)
         
        cBezeich = Mid(cLBSatz, 14, 35)
        cBezeich = Trim$(cBezeich)
        cFeld = Left(cLBSatz, 5)
        cFeld = Trim$(cFeld)
        cFeld = fnMoveComma2Point$(cFeld)
        dWert = Val(cFeld)
        dWert = dWert * (-1)
        cArtNr = Mid(cLBSatz, 7, 6)
     
        If cArtNr = "666666" Then
            If Len(cBezeich) > 11 Then
                cBezeich = Mid(cBezeich, 11, Len(cBezeich) - 10)
                DeleteGutscheinWKL20 cBezeich
            End If
        End If
        '3. Einzel Rücknahme an Kasse Plus und Minus möglich
        dRestMenge = fnAktualisiereBestandWKL20(cArtNr, dWert, 3)
        
        List1.RemoveItem iIndexEinzelList1
        List3.Nodes.Remove iIndexEinzelList3
        gbAutomaticClick = True
        BerechneZwischenSummeWKL20
     
        cZeile1 = "Position storniert"
        cZeile2 = Space$(19)
     
        ZeigeKundenDisplay cZeile1, cZeile2
     
        Text1(1).SetFocus
     
        If List1.ListCount > 0 Then
        
        Else
            If gbBEDLEER = True Then
                Text1(0).Text = ""
                Label1(8).Caption = ""
                Text1(0).SetFocus
            End If
            
            kundenauswahlausblend
            
            Picture2.Tag = ""
            Picture2.Visible = False
            
            Shape1.Visible = False
            Shape2.Visible = False
            
            Label39(3).Caption = ""
            Label39(4).Caption = ""
            
        End If
     
        If gsiGESRAB > 0 Then
            zeigeZwangsrabatt
        End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "EinzelPosStorno_bestimmte_Zeile"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
'    Resume Next
End Sub
Private Sub List3_Click()
On Error GoTo LOKAL_ERROR
    
    Dim iinde As Integer
    Dim lRet As Long
    Dim lcount As Long
    Dim cLBSatz As String
    Dim cZiel As String
    Dim cFeld As String
    Dim dWert As Double
    Dim cArtNr As String
    Dim dRestMenge As Double
    Dim cBezeich As String
    Dim iAktiverSatz As Integer
    Dim cZeile1 As String
    Dim cZeile2 As String
    Dim iStufe As Integer
    Dim iStufe2 As Integer
    Dim ibignde As Integer
            
    If gbAutomaticClick Then
        gbAutomaticClick = False
        Exit Sub
    End If
    iStufe2 = 1
    iStufe = 1
    
    If List3.SelectedItem Is Nothing Then
        Exit Sub
    Else
        ibignde = List3.SelectedItem.index
        frmWKL00b.Show 1
    End If
    lRet = glPosStorno
    
    iStufe = 2
    
    Select Case lRet
        Case Is = 1 'posi einzeln storno
            'Wenn Zeile Zwischensumme, dann raus damit!
            
            ibignde = 0
            EinzelPosStorno
            
            
            iStufe = 10
            
            '''''''' Oliver Alte TSE START
            
'            If List1.ListCount = 0 Then
'                'TSS Cancel
'                TSS.Cancel WinsockTSE
'            End If

            '''''''' Oliver Alte TSE ENDE
            
        Case Is = 2 'alles stornieren
        
            kundenauswahlausblend
            Picture2.Tag = ""
            Picture2.Visible = False
            Shape1.Visible = False
            Shape2.Visible = False
            Shape3.Visible = False
            
            Label39(3).Caption = ""
            Label39(4).Caption = ""
            Label39(0).Caption = ""

            iStufe = 11
            ibignde = 0
            Do While List1.ListCount > 0
                iStufe2 = 2
                lcount = 0
                'Wenn Zeile Zwischensumme, dann raus damit!
                cLBSatz = List1.list(lcount)
                iStufe2 = 3
                If Mid(cLBSatz, 7, 6) = "000000" Then
                    iStufe2 = 4
                    List1.RemoveItem 0
                    List3.Nodes.Remove 1
                Else
                    iStufe2 = 5
                    iAktiverSatz = 0
                    cLBSatz = List1.list(0)
                    cBezeich = Mid(cLBSatz, 14, 35)
                    
                    iStufe2 = 6
                    cBezeich = Trim$(cBezeich)
                    cFeld = Left(cLBSatz, 5)
                    
                    iStufe2 = 7
                    cFeld = Trim$(cFeld)
                    cFeld = fnMoveComma2Point$(cFeld)
                    
                    iStufe2 = 8
                    dWert = Val(cFeld)
                    dWert = dWert * (-1)
                    cArtNr = Mid(cLBSatz, 7, 6)
                    
                    iStufe2 = 9
                    
                    If cArtNr = "666666" Then
                    
                        iStufe2 = 10
                        If Len(cBezeich) > 11 Then
                            iStufe2 = 11
                            cBezeich = Mid(cBezeich, 11, Len(cBezeich) - 10)
                            DeleteGutscheinWKL20 cBezeich
                        End If
                    End If
                    '2.Von Kasse zurück Plus und Minus möglich
                    iStufe2 = 12
                    dRestMenge = fnAktualisiereBestandWKL20(cArtNr, dWert, 2)
                    
                    iStufe2 = 13
                    cFeld = Format$(dWert, "####0")
                    cFeld = Space$(5 - Len(cFeld)) & cFeld
                    cZiel = cFeld
                    
                    iStufe2 = 14
                    cFeld = Mid(cLBSatz, 60, 9)
                    cFeld = Trim$(cFeld)
                    cFeld = fnMoveComma2Point$(cFeld)
                    
                    List1.RemoveItem 0
                    
                    iStufe2 = 17
                    List3.Nodes.Remove 1
                    
                    iStufe2 = 18
                    gbAutomaticClick = True
                    
                    iStufe2 = 19
                    BerechneZwischenSummeWKL20
                    
                    iStufe2 = 20
                End If
            Loop
            
            If gbDisplay Or gbZweitMoni Then
                InitKundenDisplayModul20
            End If
            
            
'            cZeile1 = "Position storniert"
'            cZeile2 = Space$(19)
'
'            ZeigeKundenDisplay cZeile1, cZeile2
            
            Text1(1).SetFocus
            Command1(3).BackColor = &H80000004
            If gbBEDLEER = True Then
                Text1(0).Text = ""
                Label1(8).Caption = ""
                Text1(0).SetFocus
            End If
            
            If gsiGESRAB > 0 Then
                zeigeZwangsrabatt
            End If
            
            '''''''' Oliver Alte TSE START
'
'            If List1.ListCount = 0 Then
'                'TSS Cancel
'                TSS.Cancel WinsockTSE
'            End If
            
            '''''''' Oliver Alte TSE ENDE
            
        Case Is = 3
            iStufe = 12
            If gbBEDKARTE = True Then
            
                If Identi(77) Then
                'ja man muss sich hier identifizieren
                
                
                    'Ja
                    Dim ctemp As String
                    Dim bErlaubt As Boolean
                    bErlaubt = False
                    
                    gcIdentUserName = ""
                    gcIdentPass = ""
                    gcIdentBedienerNr = ""
                    glIdentLevel = -1
                        iStufe = 13
                    gsMeldestatus = "Identifikation"
                    
                    frmWK12a.Show 1
                    iStufe = 14
                    If glIdentLevel = -1 Then
                        bErlaubt = False
                    Else
                        
                        If gbZugriffNew Then
                            If glIdentLevel >= ermittlezugriff(77) Then
                                schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                                bErlaubt = True
                            Else
                                
                                ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                                ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                                schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                                MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                                bErlaubt = False
                            End If
                        Else
                            bErlaubt = True
                        End If
                        
                    End If
                    iStufe = 15
                    If Not bErlaubt Then
                    
                        If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                        
                        Exit Sub
                    Else
                        
                    End If
                End If
    
                iStufe = 16
            Else
                If glLevel >= 5 Then
                
                Else
                    MsgBox "Keine Zugangsberechtigung ! Zugangsberechtigung muss mindestens 5 sein.", vbOKOnly, "KEIN ZUGANG !"
                    Exit Sub
                End If
            End If
                
            iStufe = 17
            iinde = List3.SelectedItem.index
            
            gindi = iinde
    
            cLBSatz = List1.list(iinde - 1)
            

            If Mid(cLBSatz, 7, 6) = "000000" Then
                Exit Sub
                
            End If
            
            If IstDasEineWGN(CLng(Trim(Mid(cLBSatz, 7, 6)))) = True Then
                Command14(15).Enabled = False
            Else
                Command14(15).Enabled = True
            End If
                            
            Frame27.Visible = True
            Frame1.Visible = False
            Frame2.Visible = False
            Frame3.Visible = False
            Frame4.Visible = False
            Frame23.Visible = False
            Text8(0).Text = ""
            Text8(1).Text = ""
            Text8(2).Text = ""
            Text8(3).Text = ""
            Text8(4).Text = ""
            Text8(5).Text = ""
            
            iStufe = 18
            
            bErsterAnschlag = True
            ZerlegeLbSatzWKL20
            Text8(0).SetFocus
            
            
        
        Case Is = 4 'zurück
            'nichts tun
            
        Case Is = 5 'Garantie Eingabe
            
            iStufe = 17
            iinde = List3.SelectedItem.index
            
            gindi = iinde
    
            cLBSatz = List1.list(iinde - 1)
            

            If Mid(cLBSatz, 7, 6) = "000000" Then
                Exit Sub
            End If
                            
            Frame5.Visible = True
            Frame9.Top = Command14(17).Top - Frame9.Height
            Frame9.BackColor = Label29.BackColor
            Frame9.Visible = True
            Frame1.Visible = False
            Frame2.Visible = False
            Frame3.Visible = False
            Frame4.Visible = False
            Frame23.Visible = False
            Frame27.Visible = False
            Frame12.Visible = False
'            Frame9.Visible = False
            Text8(13).Text = ""
            Text8(9).Text = ""
           
            iStufe = 18
            
            ZerlegeLbSatzWKL20forGarantie
            Text8(13).SetFocus
            
        Case Is = 6 'Gutschein Eingabe
            
            iStufe = 19
            iinde = List3.SelectedItem.index
            
            gindi = iinde
    
            cLBSatz = List1.list(iinde - 1)
            

            If Mid(cLBSatz, 7, 6) = "000000" Then
                Exit Sub
            End If
            
            Check13.value = vbChecked
                            
            Frame12.Visible = True
            Frame9.Top = Command14(20).Top - Frame9.Height
            Frame9.BackColor = Label30.BackColor
            Frame9.Visible = True
            Frame1.Visible = False
            Frame2.Visible = False
            Frame3.Visible = False
            Frame4.Visible = False
            Frame23.Visible = False
            Frame27.Visible = False
            Frame5.Visible = False
            
            Text8(7).Text = ""
            Text8(8).Text = ""
           
            iStufe = 20
            
            ZerlegeLbSatzWKL20forGutschein
            
            alleGutscheineZeigen
            
            Text8(7).SetFocus
            
        Case Is = "10" 'Markierung
            iinde = List3.SelectedItem.index
            AktualisiereZeileXMarkierung iinde
            
            Text1(1).SetFocus
     
    End Select
    
    'Da eine Position aus dem Kassenbon rausgefallen sein könnte oder
    'eine Position ihren Verkaufspreis verändert hat, ist eine Neuberechnung
    'einer möglicherweise vorhandenen Zwischensummen-Zeile notwendig
    iStufe = 19
    AktualisiereZeileZwischenSummeWKL20
    
    If ibignde = 0 Then
    
    Else
        List3.Nodes(ibignde).Selected = True
        List3.Nodes(ibignde).EnsureVisible
    End If
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List3_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten." & iStufe & " " & iStufe2
    
    Fehlermeldung1
    
'    Resume Next
End Sub
Private Sub fleischerbon(cwgnNr As String)
On Error GoTo LOKAL_ERROR

    gdSumme = CDbl(Label2(6).Caption)
    If gbParknetto Then
        SendeDaten2DruckerFleischernetto CLng(cwgnNr), gsWGart, gsWGBEZEICH 'ermBezeichausWGN(cart)
    Else
        SendeDaten2DruckerFleischer CLng(cwgnNr), gsWGart, gsWGBEZEICH 'ermBezeichausWGN(cart)
    End If
    gdSumme = 0

    'ab in die Kassjour
    InsertAFCBuchWKL20Fleischer
    
    'ende Kassjour
    LeereDialogModul20
    
    Label1(3).Visible = False
    Label2(3).Caption = "0,00"
    Label2(3).Visible = False
    Label2(4).Visible = False
    
    
    Label2(6).Caption = "0,00"

    List1.Clear
    List3.Nodes.Clear
    Label41(1).Caption = 0
    If gbBEDLEER = True Then
        Label1(8).Caption = ""
        Text1(0).SetFocus
        Text1(0).Text = ""
        indentmitKarte
    End If
    
    Command1(3).BackColor = &H80000004


Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fleischerbon"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Sub List3_NodeClick(ByVal Node As MSComctlLib.Node)
On Error GoTo LOKAL_ERROR

    Dim cART As String

    cART = List3.SelectedItem.Text
    cART = Mid(cART, 7, 6)
    cART = Trim$(cART)
    
    Bildzeigen cART, Image2, Picture2, 100
    
    Shape1.Visible = False
    Shape2.Visible = False
    
    Label39(3).Caption = ""
    Label39(4).Caption = ""
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List3_NodeClick"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub List4_NodeClick(ByVal Node As MSComctlLib.Node)
On Error GoTo LOKAL_ERROR

    Dim cART As String

    cART = List4.SelectedItem.Text
    cART = Left(cART, 6)
    cART = Trim$(cART)
    
    Bildzeigen cART, Image1, Picture3, 80
    
    'ab hier auf Wunsch von Gottmann und Mussler neu
    
    Dim lcount As Long
    
    If List4.Nodes.Count > 0 Then
        For lcount = 1 To List4.Nodes.Count
            List4.Nodes(lcount).Bold = False
        Next lcount
    End If
    
    List4.SelectedItem.Bold = True
    
    
    Dim cAWM As String
    cAWM = Trim(Mid(List4.SelectedItem.Text, 72, 2))
    
    aufloesFarbe cAWM
    
'    Label40.Caption = Label40.Caption & " gewählt: " & Trim(Mid(List4.SelectedItem.Text, 8, 35))
                
                
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List4_NodeClick"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub aufloesFarbe(ctmp As String)
On Error GoTo LOKAL_ERROR

    
    Label40.ForeColor = vbBlack
    Label40.BackColor = Frame6.BackColor

    If ctmp <> "" Then
    
        If ctmp = "0" Then
            Label40.Caption = ""
            Label40.ForeColor = vbBlack
            Label40.BackColor = Frame6.BackColor
        ElseIf ctmp = "98" Then
            Label40.Caption = "Neu"
            Label40.BackColor = vbWhite
            Label40.ForeColor = vbRed
        ElseIf ctmp = "95" Then
            Label40.Caption = "nicht lieferbar"
            Label40.BackColor = vbBlue
            Label40.ForeColor = vbWhite
        ElseIf ctmp = "94" Then
            Label40.Caption = "Preisaktion vorbereitet"
            Label40.BackColor = glfarbe(0)
            Label40.ForeColor = vbBlue
        ElseIf ctmp = "93" Then
            Label40.Caption = "Preisaktion jetzt"
            Label40.BackColor = vbWhite
            Label40.ForeColor = vbGreen
        ElseIf ctmp = "92" Then
            Label40.Caption = "lange nicht verkauft"
            
            Label40.BackColor = &H80000012
            Label40.ForeColor = vbWhite
        Else
            If CByte(ctmp) < 10 Then
            
                Label40.BackColor = glfarbe(ctmp)
                Label40.Caption = ermFarbeBez(ctmp)
                
            ElseIf CByte(ctmp) > 10 And CByte(ctmp) < 20 Then
            
                Label40.BackColor = glfarbe2(CInt(ctmp) - 10)
                Label40.Caption = ermFarbeBez(CStr(CInt(ctmp)))
            Else
                Label40.BackColor = Frame6.BackColor
                Label40.Caption = ""
            End If
        End If
    Else
        Label40.BackColor = Frame6.BackColor
        Label40.Caption = ""
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List4_NodeClick"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub

Private Sub Option1_Click(index As Integer)
On Error GoTo LOKAL_ERROR

    Command11_Click 0

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Option1_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Picture1_Click(index As Integer)
On Error GoTo LOKAL_ERROR

    If Label2(7).Visible = True Then
        gckundnr = Label2(7).Caption
        If IsNumeric(gckundnr) Then
            frmWKL74.Show 1
            gckundnr = ""
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Picture1_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Picture2_Click()
On Error GoTo LOKAL_ERROR

    gsARTNR = Picture2.Tag
    frmWKL163.Show 1

    gsARTNR = ""

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Picture2_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Picture3_Click()
On Error GoTo LOKAL_ERROR

    
            gsARTNR = Picture3.Tag
            frmWKL163.Show 1
            
            gsARTNR = ""

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Picture3_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SSCommand3_Click()
On Error GoTo LOKAL_ERROR

    SendKeysEx "{WIN}"
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SSCommand3_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub SSCommand33_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cGeld               As String
    Dim cBetrag             As String
    Dim dBetrag             As Double
    Dim d2Betrag            As Double
    Dim dGeld               As Double
    Dim dSumme              As Double
    Dim cSumme              As String
    Dim cEUR                As String
    Dim dEUR                As Double
    Dim dNochOffen          As Double
    Dim i                   As Integer
    Dim dBetrag1            As Double
    Dim dBetrag2            As Double
    Dim dFremdwBetrag       As Double
    Dim dAnzeigeBetrag      As Double
    Dim dOffen              As Double
    Dim dzurück             As Double
    Dim iStufe              As Integer
    
    iStufe = 0
    dBetrag1 = 0
    
    If index >= 0 Or index <= 14 Then
        For i = 0 To 12
            iStufe = 1
            SSCommand2(i).Enabled = False
        Next i
        iStufe = 2
        SSCommand2(15).Enabled = False
        iStufe = 3
        SSCommand2(16).Enabled = False
    
    End If
    
    '1.Betrag vom Button
    
    iStufe = 4
    If index = 15 Then 'Dukate
        dSumDukaten = dSumDukaten + 10
        Label333(1).Caption = Format$(dSumDukaten, "#####0.00")
    End If
    
    iStufe = 5
    
    dGeld = 0
    If index = 15 Then 'Dukate
        cGeld = "10"
    Else
        cGeld = SSCommand33(index).Tag
    End If
    iStufe = 6
    cGeld = fnMoveComma2Point$(cGeld)
    dGeld = Val(cGeld)
    
    '2.Betrag addieren
    iStufe = 7
    dieKleineTextKontrolle
    
    If gsFremdKuerzel <> "" Then
        iStufe = 8
        cBetrag = Text88.Text
        cBetrag = fnMoveComma2Point$(cBetrag)
        
        dAnzeigeBetrag = Val(cBetrag) + dGeld
        
        cBetrag = Format$(dAnzeigeBetrag, "#####0.00")
        Text88.Text = cBetrag
        Text88.SetFocus
    Else
        iStufe = 9
        cBetrag = Text333.Text
        cBetrag = fnMoveComma2Point$(cBetrag)
        
        dAnzeigeBetrag = Val(cBetrag) + dGeld
        
        cBetrag = Format$(dAnzeigeBetrag, "#####0.00")
        Text333.Text = cBetrag
        Text333.SetFocus
    End If
        
    '3.Eurobetrag erstellen
    
    iStufe = 10
    cBetrag = Text88.Text
    cBetrag = fnMoveComma2Point$(cBetrag)
    dFremdwBetrag = Val(cBetrag)
    dBetrag = dFremdwBetrag * CDbl(gsUK)
        
    iStufe = 11
    
    cBetrag = Text333.Text
    cBetrag = fnMoveComma2Point$(cBetrag)
    dBetrag2 = Val(cBetrag)
    
    dBetrag = dBetrag + dBetrag2
    
    iStufe = 12

    cSumme = Label333(0).Caption
    cSumme = fnMoveComma2Point$(cSumme)
    dSumme = Val(cSumme)
    
    '4.noch Offen" füllen
    dNochOffen = dSumme - dBetrag
    
    If dNochOffen > 0 Then
        iStufe = 13
        Command33(0).Enabled = False
        Label333(2).Caption = Format$(dNochOffen, "#####0.00")
        Label333(3).Caption = "0,00" 'zurück
    ElseIf dNochOffen <= 0 Then
        iStufe = 14
        Command33(0).Enabled = True
        Label333(2).Caption = "0,00"
        dzurück = dNochOffen * (-1)
        Label333(3).Caption = Format$(dzurück, "#####0.00") 'zurück
    End If
    
    iStufe = 15
    If gsUK <> "0" Then
        dOffen = dNochOffen / CDbl(gsUK)
        
        iStufe = 16
        If dOffen > 0 Then
            iStufe = 17
            Label88(2).Caption = "noch offen"
            Label88(3).Caption = Format$(dOffen, "#####0.00")
        ElseIf dOffen <= 0 Then
            iStufe = 18
            dzurück = dOffen * (-1)
            Label88(2).Caption = "zurück"
            Label88(3).Caption = Format$(dzurück, "#####0.00") 'zurück
            
        End If
        
    End If

Exit Sub
LOKAL_ERROR:
    If err.Number = 5 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SSCommand33_Click"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten. " & iStufe
        
        Fehlermeldung1
    End If
End Sub

Private Sub dieKleineTextKontrolle()
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp                As String
    Dim dWert               As Double
    Dim bKommaVorhanden     As Boolean
    
    If gsUK <> "0" Then
        ctmp = ""
        dWert = 0
    
        bKommaVorhanden = False
    
    
        ctmp = Trim(Text88.Text)
        ctmp = fnMoveComma2Point$(ctmp)
    
        If InStr(ctmp, ",") Then
            bKommaVorhanden = True
        End If
    
        ctmp = fnMoveComma2Point$(ctmp)
        dWert = Val(ctmp)
    
        If Not bKommaVorhanden Then
            dWert = dWert / 100
        End If
    
        If dWert > 0 Then
            Text88.Text = Format$(dWert, "#####0.00")
        Else
            Text88.Text = ""
        End If
    End If
    
    ctmp = ""
    dWert = 0

    bKommaVorhanden = False


    ctmp = Trim(Text333.Text)
    ctmp = fnMoveComma2Point$(ctmp)

    If InStr(ctmp, ",") Then
        bKommaVorhanden = True
    End If

    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)

    If Not bKommaVorhanden Then
        dWert = dWert / 100
    End If

    If dWert > 0 Then
        Text333.Text = Format$(dWert, "#####0.00")
    Else
        Text333.Text = ""
    End If
    

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "dieKleineTextKontrolle"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function Zurückrechnen() As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim cGeld               As String
    Dim cBetrag             As String
    Dim dBetrag             As Double
    Dim d2Betrag            As Double
    Dim dGeld               As Double
    Dim dSumme              As Double
    Dim cSumme              As String
    Dim cEUR                As String
    Dim dEUR                As Double
    Dim dNochOffen          As Double
    Dim i                   As Integer
    Dim dBetrag1            As Double
    Dim dBetrag2            As Double
    Dim dFremdwBetrag       As Double
    Dim dAnzeigeBetrag      As Double
    Dim dOffen              As Double
    Dim dzurück             As Double
    
    Zurückrechnen = False
    
    
    
    dBetrag1 = 0
    dGeld = 0
    
    '2.Betrag addieren
    
    dieKleineTextKontrolle

    If gsFremdKuerzel <> "" Then
    
        cBetrag = Text88.Text
        cBetrag = fnMoveComma2Point$(cBetrag)
        
        dAnzeigeBetrag = Val(cBetrag) + dGeld
        
        If dAnzeigeBetrag > 0 Then
            cBetrag = Format$(dAnzeigeBetrag, "#####0.00")
            Text88.Text = cBetrag
            
        Else
            Text88.Text = ""
        End If
        Text88.SetFocus
    Else
        cBetrag = Text333.Text
        cBetrag = fnMoveComma2Point$(cBetrag)
        
        dAnzeigeBetrag = Val(cBetrag) + dGeld
        
        If dAnzeigeBetrag > 0 Then
            cBetrag = Format$(dAnzeigeBetrag, "#####0.00")
            Text333.Text = cBetrag
            
        Else
            Text333.Text = ""
        End If
        Text333.SetFocus
    
    End If
        
    '3.Eurobetrag erstellen
    
    
    cBetrag = Text88.Text
    cBetrag = fnMoveComma2Point$(cBetrag)
    dFremdwBetrag = Val(cBetrag)
    dBetrag = dFremdwBetrag * CDbl(gsUK)
        
    
    cBetrag = Text333.Text
    cBetrag = fnMoveComma2Point$(cBetrag)
    dBetrag2 = Val(cBetrag)
    
    dBetrag = dBetrag + dBetrag2
    
    

    cSumme = Label333(0).Caption
    cSumme = fnMoveComma2Point$(cSumme)
    dSumme = Val(cSumme)
    
    

    '4.noch Offen" füllen
    dNochOffen = dSumme - dBetrag
    
    If dNochOffen > 0 Then

        Label333(2).Caption = Format$(dNochOffen, "#####0.00")
        Label333(3).Caption = "0,00" 'zurück
    ElseIf dNochOffen <= 0 Then
    
        Zurückrechnen = True
        

        Label333(2).Caption = "0,00"
        dzurück = dNochOffen * (-1)
        Label333(3).Caption = Format$(dzurück, "#####0.00") 'zurück
    End If
    

    If gsUK <> "0" Then
        dOffen = dNochOffen / CDbl(gsUK)
        
        If dOffen > 0 Then
            Label88(2).Caption = "noch offen"
            Label88(3).Caption = Format$(dOffen, "#####0.00")
        ElseIf dOffen <= 0 Then
        
            dzurück = dOffen * (-1)
            Label88(2).Caption = "zurück"
            Label88(3).Caption = Format$(dzurück, "#####0.00") 'zurück
        End If
    End If
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "zurückrechnen"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function



Private Sub Text3_Change(index As Integer)
On Error GoTo LOKAL_ERROR
    Dim sNeuLinr As String
    Dim sNeuPGNNr As String
    Dim searchstr As String

    If index = 3 Then
        If Len(Text3(3).Text) >= 8 Then
            If IsNumeric(Text3(3).Text) = False Then
                SucheKundenKasseWKL20Alphas Text3(3).Text
            End If
        End If
        
        If Label1(27).Caption = "Karte/KdNr/Name" Then
            If Len(Text3(3).Text) >= 5 Then
                fillecbo Text3(3).Text, Combo1
            End If
        End If
        
    End If
    
    If index = 5 Then
        LiefKuerzelAufloesung Label5(3), Text3(5)
    End If
    
    If index = 4 Then
        If Len(Text3(4).Text) = 0 Then
            Label5(8).Caption = "keine Auswahl"
            Label5(8).Refresh
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_Change"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Text3_Click(index As Integer)
On Error GoTo LOKAL_ERROR

If index = 3 Then

Else
    bFocusonList4 = False
    Text3(0).SetFocus
    Text3(index).SetFocus
End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_Click"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Text3_KeyPress(index As Integer, KeyAscii As Integer)
On Error GoTo LOKAL_ERROR

    Dim cZeichen As String
    Dim cValid As String
    
    If index = 0 Then
    
        cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
        cValid = cValid & Chr(38) & Chr(45) & Chr(46) '& - .
        cValid = cValid & "+äÄÜüÖöß"
        
        cZeichen = Chr$(KeyAscii)
        
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
        
    ElseIf index = 3 Then
    
        cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
        cValid = cValid & Chr(38) & Chr(45) & Chr(46) '& - .
        cValid = cValid & "+äÄÜüÖöß"
        
        cZeichen = Chr$(KeyAscii)
        
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
        
    ElseIf index = 4 Then
        cValid = gcNUM & Chr$(8)
        
        
        cZeichen = Chr$(KeyAscii)
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
    ElseIf index = 7 Then
        cValid = gcNUM & Chr$(8)
        
        
        cZeichen = Chr$(KeyAscii)
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
        
    ElseIf index = 19 Then
        cValid = gcNUM & Chr$(8)
        
        
        cZeichen = Chr$(KeyAscii)
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
    
    ElseIf index = 5 Then
    
        cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
        cValid = cValid & Chr(38) & Chr(45) & Chr(46) '& - .
        cValid = cValid & "+äÄÜüÖöß"
        
        cZeichen = Chr$(KeyAscii)
        
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
    

    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Text333_GotFocus()
    On Error GoTo LOKAL_ERROR
    
    Text333.BackColor = glSelBack1
    If gsUK <> "0" Then
        zeigwaehrung "EUR"
    End If
    
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text333_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text333_KeyUp(KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    
    
    If KeyCode = vbKeyEscape Then
        Command33_Click (1)
    ElseIf KeyCode = vbKeyReturn Then
    

            If Command33(0).Visible = True Then

                Command33_Click (0)
                If gbNochOffen = False Then
                    Pause (1)
                    SchließenNachBarbon
                Else
                    Label333(2).Caption = Label333(0).Caption
                    Label333(2).Refresh
                    
                End If
                

            End If
 
        
    End If
    
    Select Case KeyCode
        Case Is = 46    '//Del
            Text333.Text = ""
            Zurückrechnen
    End Select
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text333_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text333_LostFocus()
    On Error GoTo LOKAL_ERROR

    Text333.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text333_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text88_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyEscape Then
        Command33_Click (1)
    ElseIf KeyCode = vbKeyReturn Then
          'Command33_Click (0)
    End If
    
    Select Case KeyCode
        Case Is = 46    '//Del
            Text88.Text = ""
            Zurückrechnen
    End Select
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text88_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Text88_LostFocus()
    On Error GoTo LOKAL_ERROR

    Text88.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text88_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text8_KeyPress(index As Integer, KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cZeichen = Chr$(KeyAscii)
    
    Select Case index
    
        
    
        Case 4
            cValid = gcNUM & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
                Beep
            End If
        
        Case 13, 9
            cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
            cValid = cValid & Chr(38) & Chr(45) & Chr(46) '& - .
            cValid = cValid & "+äÄÜüÖöß"
            
            cZeichen = Chr$(KeyAscii)
            
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
    End Select
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub Text8_KeyUp(index As Integer, KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    If index = 4 Then
        If KeyCode = vbKeyReturn Then
            Command14_Click 13
        End If
    End If
        
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text88_GotFocus()
    On Error GoTo LOKAL_ERROR
    
    Text88.BackColor = glSelBack1
    
    zeigwaehrung Label88(1)
'    Text88.SetFocus
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text88_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Form_Unload(Cancel As Integer)
    On Error GoTo LOKAL_ERROR
    
    Screen.MousePointer = 11
    
    loeschNEW srechnertab & "ASEEK", gdBase
    setzedrucker gcListenDrucker
    LogtoEnd Me
    
    Timer1.Enabled = False
    
    ''''''''''''Oliver Alte TSE START
'    TSS.Disconnect WinsockTSE, TimerNetwork
    ''''''''''''Oliver Alte TSE ENDE
    
    Screen.MousePointer = 0

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Form_Unload"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub List11_KeyPress(KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR

    Dim cZeichen As String
    Dim lPos As Long
    Dim iRet As Integer
    Dim ctmp1 As String
    Dim cTmp2 As String
    Dim cZiel As String

    cZeichen = Chr$(KeyAscii)

    gECKarte.Datenstrom = gECKarte.Datenstrom & cZeichen

    lPos = InStr(1, gECKarte.Datenstrom, vbCr)
    If lPos > 0 Then
        lPos = lPos + 1
        lPos = InStr(lPos, gECKarte.Datenstrom, vbCr)
        If lPos > 0 Then
            'Kartenlesen (Datenstrom) abgeschlossen
            iRet = fnPruefeDatenstromECKarteWKL20()
            If iRet <> 0 Then
                LeereDatenECKarteWKL20
            Else
            
                'jetzt optional nach Hakensetzung
                'Lucks
                If gbNachKBbeiEC Then
                    If Val(gckundnr) > 0 Then
                        HoleKundenDatenWKL20 gckundnr
                        Label2(7).Caption = gckundnr
                        gckundnr = ""
    
                        If gbSterne Then
                            AllesinKUNDAZEeinzel Label2(7).Caption, False
                            Zeigdiesterne Picture1(1), Picture1(2), Picture1(3), Picture1(4), Picture1(5), wievieleSterne(Label2(7).Caption, "KUNDA" & srechnertab, 180), wievieleSterneAlt
    
                        End If
    
                        Label2(7).Visible = True
                        Label1(7).Visible = True
                        Label1(19).Visible = True
                    End If
                End If
                LeseDatenECLastschriftWKL20
            End If
        End If
    Else
        lPos = InStr(1, gECKarte.Datenstrom, Chr$(95))
        If lPos > 0 Then
            lPos = lPos + 1
            lPos = InStr(lPos, gECKarte.Datenstrom, Chr$(95))
            If lPos > 0 Then

                'jetzt Sonderzeichen rauswerfen!
                ctmp1 = gECKarte.Datenstrom
                cZiel = ""
                For iRet = 1 To Len(ctmp1)
                    cTmp2 = Mid(ctmp1, iRet, 1)
                    If InStr("1234567890" & Chr$(95) & Chr$(180), cTmp2) <> 0 Then
                        cZiel = cZiel & cTmp2
                    End If
                Next iRet

                'jetzt alle Chr$(95) durch Chr$(13) ersetzen
                ctmp1 = cZiel
                cZiel = ""
                For iRet = 1 To Len(ctmp1)
                    cTmp2 = Mid(ctmp1, iRet, 1)
                    If InStr("1234567890" & Chr$(180), cTmp2) <> 0 Then
                        cZiel = cZiel & cTmp2
                    Else
                        cZiel = cZiel & Chr$(13)
                    End If
                Next iRet

                gECKarte.Datenstrom = cZiel

                iRet = fnPruefeDatenstromECKarteWKL20()
                If iRet <> 0 Then
                    LeereDatenECKarteWKL20
                Else
                    LeseDatenECLastschriftWKL20
                End If
            End If
        End If
    End If


Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List11_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Function fnPruefeDatenstromECKarteWKL20() As Integer
    On Error GoTo LOKAL_ERROR
    
    Dim lPos As Long
    Dim lcount As Long
    Dim lJahr As Long
    Dim lMonat As Long
    Dim cZeichen As String
    Dim cSQL As String
    Dim rsrs As Recordset
    Dim iFehlerstufe As Integer
    Dim lTrenner1 As Long
    Dim lTrenner2 As Long
    Dim cMerker As String
    fnPruefeDatenstromECKarteWKL20 = 0
    
    iFehlerstufe = 1
    
    If Len(gECKarte.Datenstrom) > 1 Then
        
        iFehlerstufe = 2
        cMerker = gECKarte.Datenstrom
        'MsgBox cMerker
        
        If Left(gECKarte.Datenstrom, 1) = "&" Then
            'Drei-Spur-Leser!!!
            lTrenner1 = InStr(1, gECKarte.Datenstrom, "_")
            gECKarte.Datenstrom = Mid(gECKarte.Datenstrom, lTrenner1 + 1, Len(gECKarte.Datenstrom) - lTrenner1)
            gECKarte.Datenstrom = gECKarte.Datenstrom & vbCrLf & Space$(2)
            gECKarte.Datenstrom = gECKarte.Datenstrom & Mid(cMerker, 6, 8)
            gECKarte.Datenstrom = gECKarte.Datenstrom & Space$(1) & Mid(cMerker, 15, 10)
            gECKarte.Datenstrom = gECKarte.Datenstrom & Space$(10)
            'MsgBox gECKarte.Datenstrom
        ElseIf Left(gECKarte.Datenstrom, 1) = "ö" Then
            'Aures Leser!!!
            gECKarte.Datenstrom = Right(gECKarte.Datenstrom, Len(gECKarte.Datenstrom) - 1)
            gECKarte.Datenstrom = SwapStr(gECKarte.Datenstrom, "_", "")
            gECKarte.Datenstrom = SwapStr(gECKarte.Datenstrom, "`", "")
            gECKarte.Datenstrom = SwapStr(gECKarte.Datenstrom, "'", "=")
            gECKarte.Datenstrom = SwapStr(gECKarte.Datenstrom, "ö", "")
            'MsgBox gECKarte.Datenstrom
        End If
        
        
'        If Left(gECKarte.Datenstrom, 2) <> "67" Then
'            iFehlerstufe = 3
'            MsgBox "Karte konnte nicht als EC-Karte identifiziert werden!" & vbCrLf & "Startkennung ist " & Left(gECKarte.Datenstrom, 2), vbCritical, "STOP!"
'            fnPruefeDatenstromECKarteWKL20 = 1
'            Exit Function
'        End If
        
        If Mid(gECKarte.Datenstrom, 39, 4) <> "0159" Then
            iFehlerstufe = 3
            MsgBox "Karte konnte nicht als EC-Karte identifiziert werden!", vbCritical, "STOP!"
            fnPruefeDatenstromECKarteWKL20 = 1
            Exit Function
        End If
        
        
        If Len(gECKarte.Datenstrom) >= 19 Then
            iFehlerstufe = 4
            gECKarte.Konto1 = Mid(gECKarte.Datenstrom, 9, 10)
        Else
            gECKarte.Konto1 = ""
        End If
        
        lPos = InStr(gECKarte.Datenstrom, vbCr)
        
        If Len(gECKarte.Datenstrom) > lPos + 24 Then
            iFehlerstufe = 5
            gECKarte.BLZ = Mid(gECKarte.Datenstrom, lPos + 5, 8)
            gECKarte.Konto2 = Mid(gECKarte.Datenstrom, lPos + 14, 10)
        Else
            gECKarte.Konto2 = ""
        End If
        
        If gECKarte.Konto1 <> "" And gECKarte.Konto2 <> "" Then
            iFehlerstufe = 6
            If gECKarte.Konto1 <> gECKarte.Konto2 Then
                iFehlerstufe = 7
                MsgBox "Karte konnte nicht als EC-Karte identifiziert werden!" & vbCrLf & "(ungleiche Kontonummern auf Spur 1 und Spur 2)", vbCritical, "STOP!"
                fnPruefeDatenstromECKarteWKL20 = 1
                Exit Function
            End If
        Else
            iFehlerstufe = 8
            MsgBox "Karte konnte nicht als EC-Karte identifiziert werden!" & vbCrLf & "(Kontonummer Spur 1 nicht überprüfbar gegen Spur 2)", vbCritical, "STOP!"
            fnPruefeDatenstromECKarteWKL20 = 1
            Exit Function
        End If
        iFehlerstufe = 9
        If Val(gECKarte.BLZ) < 10000000 Then
            MsgBox "Karte konnte nicht als EC-Karte identifiziert werden!" & vbCrLf & "(ungültige Bankleitzahl)", vbCritical, "STOP!"
            fnPruefeDatenstromECKarteWKL20 = 1
            Exit Function
        End If
        iFehlerstufe = 10
        If Val(gECKarte.Konto1) = 0 Then
            MsgBox "Karte konnte nicht als EC-Karte identifiziert werden!" & vbCrLf & "(ungültige Kontonummer)", vbCritical, "STOP!"
            fnPruefeDatenstromECKarteWKL20 = 1
            Exit Function
        End If
        iFehlerstufe = 11
        lPos = 0
        For lcount = 1 To Len(gECKarte.Datenstrom)
            cZeichen = Mid(gECKarte.Datenstrom, lcount, 1)
            If InStr("1234567890", cZeichen) = 0 Then
                lPos = lcount
                Exit For
            End If
        Next lcount
        iFehlerstufe = 12
        If lPos > 0 Then
            lPos = lPos + 1
            gECKarte.jahr = Mid(gECKarte.Datenstrom, lPos, 2)
            If Val(gECKarte.jahr) < 80 Then
                gECKarte.jahr = "20" & gECKarte.jahr
            Else
                gECKarte.jahr = "19" & gECKarte.jahr
            End If
            iFehlerstufe = 13
            lPos = lPos + 2
            gECKarte.Monat = Mid(gECKarte.Datenstrom, lPos, 2)
            gECKarte.Monat = String$(2 - Len(gECKarte.Monat), "0") & gECKarte.Monat
        Else
            gECKarte.jahr = ""
            gECKarte.Monat = ""
        End If
        iFehlerstufe = 14
        If gECKarte.jahr <> "" And gECKarte.Monat <> "" Then
            lJahr = Year(Now)
            lMonat = Month(Now)
            iFehlerstufe = 15
            If Val(gECKarte.jahr) < lJahr Then
                MsgBox "Die EC-Karte ist abgelaufen!", vbCritical, "STOP!"
                fnPruefeDatenstromECKarteWKL20 = 1
                Exit Function
            ElseIf Val(gECKarte.jahr) = lJahr And Val(gECKarte.Monat) < lMonat Then
                MsgBox "Die EC-Karte ist abgelaufen!", vbCritical, "STOP!"
                fnPruefeDatenstromECKarteWKL20 = 1
                Exit Function
            End If
        Else
            MsgBox "Karte konnte nicht als EC-Karte identifiziert werden!" & vbCrLf & "(ungültiges Verfalldatum)", vbCritical, "STOP!"
            fnPruefeDatenstromECKarteWKL20 = 1
            Exit Function
        End If
        iFehlerstufe = 16
        LeseBankLeitZahlWKL20 Label2(7).Caption
        iFehlerstufe = 17
        
        If gECKarte.BankName = "" Then
            MsgBox "Bankleitzahl konnte nicht zugeordnet werden!", vbCritical, "STOP!"
            fnPruefeDatenstromECKarteWKL20 = 1
            Exit Function
        End If
        iFehlerstufe = 18

        lcount = 0
        cSQL = "Select max(BELEGNR) as MAXBELEG from DTA"
        FnOpenrecordset rsrs, cSQL, 1, gdBase
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!MAXBELEG) Then
                lcount = rsrs!MAXBELEG
            End If
        End If
        rsrs.Close: Set rsrs = Nothing
        iFehlerstufe = 19

        gECKarte.LastSchriftNr = Trim$(Str$(lcount + 1))
        
    Else
        MsgBox "Lesefehler!", vbCritical, "STOP!"
        fnPruefeDatenstromECKarteWKL20 = 1
        Exit Function
    End If
    
    iFehlerstufe = 20

Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "PruefeDatenstromECKarteWKL20"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub List4_KeyUp(KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim lcount As Long
    
    
    If KeyCode = 13 Then
        Command4_Click 1
    End If
    If KeyCode = vbKeyEscape Then
        Command4_Click 2
    End If
    
    If KeyCode = vbKeyF2 Then
    
        If gbBEDKARTE = True Then
            
            If Identi(87) Then
            'ja man muss sich hier identifizieren
            
            
                'Ja
                Dim ctemp As String
                Dim bErlaubt As Boolean
                bErlaubt = False
                
                gcIdentUserName = ""
                gcIdentPass = ""
                gcIdentBedienerNr = ""
                glIdentLevel = -1
                    
                gsMeldestatus = "Identifikation"
                
                frmWK12a.Show 1
                
                If glIdentLevel = -1 Then
                    bErlaubt = False
                Else
                    
                    If gbZugriffNew Then
                        If glIdentLevel >= ermittlezugriff(87) Then
                            schreibeBEDIdentProtokoll "erfolgreich '" & gsProteil & "' geöffnet"
                            bErlaubt = True
                        Else
                            
                            ctemp = gcIdentUserName & " wurde identifiziert." & vbCrLf
                            ctemp = ctemp & gcIdentUserName & " hat nicht das Recht '" & gsProteil & "' zu nutzen."
                            schreibeBEDIdentProtokoll "versuchte erfolglos '" & gsProteil & "' durchzuführen"
                            MsgBox ctemp, vbInformation, "Winkiss Hinweis:"
                            bErlaubt = False
                        End If
                    Else
                        bErlaubt = True
                    End If
                    
                End If
                
                If Not bErlaubt Then
                
                    If glIdentLevel = -1 Then
'                            MsgBox "Keine Zulassung für Stornos!", vbCritical, "STOP!"
                        End If
                    Exit Sub
                Else
                    
                End If
            End If
        Else
            If glLevel >= 5 Then
                
            Else
                MsgBox "Keine Zugangsberechtigung!", vbCritical, "KEIN ZUGRIFF"
                Exit Sub
            End If
        End If
    
        If List4.Nodes.Count > 0 Then
            For lcount = 1 To List4.Nodes.Count
                If List4.Nodes(lcount).Selected = True Then
                    gsARTNR = List4.Nodes(lcount)
                    gsARTNR = Trim$(Left(gsARTNR, 6))
                    Exit For
                End If
            Next lcount
        End If
        
        If gsARTNR <> "" Then
            frmWKL10.Show 1
            Me.Refresh
            Screen.MousePointer = 0
        End If
        gsARTNR = ""
        
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List4_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub
Private Sub List6_KeyUp(KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyEscape Then
        Command4_Click 7
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List6_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub MSComm1_OnComm()
    On Error GoTo LOKAL_ERROR
    Dim lPos As Long
    Dim iRet As Integer
    Dim ctmp As String
    Dim ctmp1 As String
    Dim cTmp2 As String
    Dim lStart As Long
    Dim lAktuell As Long
    
    Select Case MSComm1.CommEvent
        Case comEvReceive                   ' Anzahl empfangener Zeichen gleich RThreshold
            
            lStart = Timer
            Do
                lAktuell = Timer
            Loop While lAktuell < lStart + 1
            
            gECKarte.Datenstrom = gECKarte.Datenstrom & MSComm1.Input
            gECKarte.Original = gECKarte.Datenstrom
            ctmp = MSComm1.Input
            ctmp1 = MSComm1.Input
            cTmp2 = MSComm1.Input
            
            If ctmp <> "" Then
                gECKarte.Datenstrom = gECKarte.Datenstrom & ctmp
            End If
            If ctmp1 <> "" Then
                gECKarte.Datenstrom = gECKarte.Datenstrom & ctmp1
            End If
            If cTmp2 <> "" Then
                gECKarte.Datenstrom = gECKarte.Datenstrom & cTmp2
            End If
            
            gECKarte.Original = gECKarte.Datenstrom

            
            If Left(gECKarte.Datenstrom, 1) = Chr$(2) Then
                gECKarte.Datenstrom = Right(gECKarte.Datenstrom, Len(gECKarte.Datenstrom) - 4)
            End If
            If gbDebug Then
                MsgBox gECKarte.Datenstrom
            End If
            lPos = InStr(1, gECKarte.Datenstrom, "?")
            If lPos > 0 Then
                'Mid(gECKarte.Datenstrom, lPos, 1) = Chr$(13)
                ctmp1 = Left(gECKarte.Datenstrom, lPos)
                'MsgBox Asc(Right(cTmp1, 1))
                ctmp = Mid(gECKarte.Datenstrom, lPos + 1, Len(gECKarte.Datenstrom) - lPos)
                'MsgBox cTmp
                If Len(ctmp) < 3 Then
                    MsgBox "Karte konnte 2.Spur nicht als EC-Karte identifizieren!", vbCritical, "STOP!"
                    LeereDatenECKarteWKL20
                    MSComm1.PortOpen = False
                    MSComm1.CommPort = gVerbindung.iComPort
                    MSComm1.InputLen = 0
                    MSComm1.Settings = gVerbindung.cSettings
                    MSComm1.RThreshold = 1
                    If Not MSComm1.PortOpen = True Then
                        MSComm1.PortOpen = True
                    End If

                    Exit Sub
                End If
                ctmp = Right(ctmp, Len(ctmp) - 3)
                'MsgBox cTmp
                gECKarte.Datenstrom = ctmp1 & ctmp
                'MsgBox gECKarte.Datenstrom
                lPos = InStr(lPos, gECKarte.Datenstrom, "?")
                If lPos > 0 Then
                    Mid(gECKarte.Datenstrom, lPos, 1) = Chr$(13)
                    'Kartenlesen (Datenstrom) abgeschlossen
                    iRet = fnPruefeDatenstromECKarteWKL20()
                    If iRet <> 0 Then
                        LeereDatenECKarteWKL20
                    Else
                    
                        'jetzt optional nach Hakensetzung
                        'Lucks
                        If gbNachKBbeiEC Then
                            If Val(gckundnr) > 0 Then
                                HoleKundenDatenWKL20 gckundnr
                                Label2(7).Caption = gckundnr
                                gckundnr = ""
    
                                If gbSterne Then
                                    AllesinKUNDAZEeinzel Label2(7).Caption, False
                                    Zeigdiesterne Picture1(1), Picture1(2), Picture1(3), Picture1(4), Picture1(5), wievieleSterne(Label2(7).Caption, "KUNDA" & srechnertab, 180), wievieleSterneAlt
    
                                End If
    
                                Label2(7).Visible = True
                                Label1(7).Visible = True
                                Label1(19).Visible = True
                            End If
                        End If
                        
                        LeseDatenECLastschriftWKL20
                    
                        
                    End If
                Else
                    iRet = MsgBox("Karte konnte nicht oder nur unvollständig gelesen werden (Fehler 2.Spur)!" & vbCrLf & "Details?", vbQuestion + vbYesNo + vbDefaultButton2, "HINWEIS")
                    If iRet = vbYes Then
                        MsgBox gECKarte.Datenstrom, vbInformation, "gelesene Daten"
                    End If
                    LeereDatenECKarteWKL20
                End If
            Else
                iRet = MsgBox("Karte konnte nicht oder nur unvollständig gelesen werden (Fehler 1.Spur)!" & vbCrLf & "Details?", vbQuestion + vbYesNo + vbDefaultButton2, "HINWEIS")
                If iRet = vbYes Then
                    MsgBox gECKarte.Datenstrom, vbInformation, "gelesene Daten"
                End If
                LeereDatenECKarteWKL20
            End If
            MSComm1.PortOpen = False
            MSComm1.CommPort = gVerbindung.iComPort
            MSComm1.InputLen = 0
            MSComm1.Settings = gVerbindung.cSettings
            MSComm1.RThreshold = 1
            If Not MSComm1.PortOpen = True Then
                MSComm1.PortOpen = True
            End If

           ' Fehler
        
        Case comBreak     'gestoppt
        Case comCDTO    ' CD-Zeitüberschreitung
        Case comCTSTO   ' CTS-Zeitüberschreitung
        Case comDSRTO   ' DSR-Zeitüberschreitung
        Case comFrame   ' Fehler im Übertragungsraster (Framing Error)
        Case comOverrun ' Datenverlust
        Case comRxOver  ' Überlauf des Empfangspuffers
        Case comRxParity    ' Paritätsfehler

        Case comTxFull  ' Sendepuffer voll
    ' Ereignisse
        Case comEvCD    ' Pegeländerung auf DCD
        Case comEvCTS   ' Pegeländerung auf CTS
        Case comEvDSR   ' Pegeländerung auf DSR
        Case comEvRing  ' Pegeländerung auf RI (Ring Indicator)

        Case comEvSend  ' Im Sendepuffer befinden sich SThreshold Zeichen
    End Select
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 8005 Or err.Number = 8012 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "MSComm1_OnComm"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
        
        Fehlermeldung1
    End If
End Sub
Private Sub MSComm2_OnComm()
    On Error GoTo LOKAL_ERROR
    
    Dim lPosE As Long
    Dim lPosA As Long
    Dim iRet As Integer
    Dim ctmp As String
    Dim ctmp1 As String
    Dim cTmp2 As String
    Dim cKundnr As String
    Dim lStart As Long
    Dim lAktuell As Long
    Dim iStufe As Integer

    iStufe = 1
    Select Case MSComm2.CommEvent
        Case comEvReceive                   ' Anzahl empfangener Zeichen gleich RThreshold
            iStufe = 2
            lStart = Timer
            Do
                lAktuell = Timer
            Loop While lAktuell < lStart + 1

            iStufe = 3
            gECKarte.Datenstrom = MSComm2.Input
            ctmp = MSComm2.Input
            ctmp1 = MSComm2.Input
            cTmp2 = MSComm2.Input

            iStufe = 4
            If ctmp <> "" Then
                gECKarte.Datenstrom = gECKarte.Datenstrom & ctmp
            End If
            If ctmp1 <> "" Then
                gECKarte.Datenstrom = gECKarte.Datenstrom & ctmp1
            End If
            If cTmp2 <> "" Then
                gECKarte.Datenstrom = gECKarte.Datenstrom & cTmp2
            End If
            
            iStufe = 5
            
            lPosA = InStr(1, gECKarte.Datenstrom, ";")
            If lPosA = 0 Then 'neu 28112005

                
                Exit Sub
            End If
            
            ctmp1 = Right(gECKarte.Datenstrom, Len(gECKarte.Datenstrom) - lPosA)
            lPosE = InStr(1, ctmp1, "?")
            cKundnr = Mid(ctmp1, 1, lPosE - 1)
            
            iStufe = 6
            Text3(3).Text = cKundnr
            
            

            
            Command4_Click 5    'Kunde suchen
            
            iStufe = 7
            grd1_Click          'in Tabelle markieren
            
            iStufe = 8
            Command4_Click 4    'Kunde auswählen
            
            iStufe = 9
            
            MSComm2.PortOpen = False
           ' Fehler

        Case comBreak     'gestoppt
        Case comCDTO    ' CD-Zeitüberschreitung
        Case comCTSTO   ' CTS-Zeitüberschreitung
        Case comDSRTO   ' DSR-Zeitüberschreitung
        Case comFrame   ' Fehler im Übertragungsraster (Framing Error)
        Case comOverrun ' Datenverlust
        Case comRxOver  ' Überlauf des Empfangspuffers
        Case comRxParity    ' Paritätsfehler

        Case comTxFull  ' Sendepuffer voll
    ' Ereignisse
        Case comEvCD    ' Pegeländerung auf DCD
        Case comEvCTS   ' Pegeländerung auf CTS
        Case comEvDSR   ' Pegeländerung auf DSR
        Case comEvRing  ' Pegeländerung auf RI (Ring Indicator)

        Case comEvSend  ' Im Sendepuffer befinden sich SThreshold Zeichen
    End Select

Exit Sub
LOKAL_ERROR:
    If err.Number = 8005 Or err.Number = 8012 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "MSComm2_OnComm"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten." & iStufe
        
        Fehlermeldung1
    End If
End Sub
Private Sub MSComm3_OnComm()
    On Error GoTo LOKAL_ERROR
    
    Dim lPosE As Long
    Dim lPosA As Long
    Dim iRet As Integer
    Dim ctmp As String
    Dim ctmp1 As String
    Dim cTmp2 As String
    Dim lStart As Long
    Dim lAktuell As Long
    Dim iStufe As Integer
    Dim i As Integer
    Dim k As Integer
    Dim cNum As String
    Dim cBez As String
    Dim cSQL As String
    Dim rsrs As Recordset

    iStufe = 1
    Select Case MSComm3.CommEvent
        Case comEvReceive                   ' Anzahl empfangener Zeichen gleich RThreshold
        
            iStufe = 2
            
            Pause 1
            

            iStufe = 3
            k = 0
            ctmp = ""
            ctmp = MSComm3.Input
            MSComm3.InputLen = 0
            
            schreibeProtowaage ctmp & " " & Len(ctmp)
            
            iStufe = 31
            
            If Len(ctmp) <> 209 Then
                Exit Sub
            End If
            
            If Trim(ctmp) = "" Then
                Exit Sub
            End If
            
            iStufe = 32
            
            If Not MSComm3.PortOpen = False Then MSComm3.PortOpen = False
            
            iStufe = 33
   
            For i = 1 To Len(ctmp)
                cNum = Mid(ctmp, i, 1)
                If IsNumeric(cNum) Then
                    k = i - 1
                    Exit For
                End If
            Next i
            
            iStufe = 34
            
            If k = 0 Then
                If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True

                Exit Sub
            End If
            
            iStufe = 35
            
            ctmp1 = Right(ctmp, Len(ctmp) - k)
            
            lPosA = InStr(1, ctmp1, Chr$(13))
            
            If lPosA = 0 Then
                If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
                
                Exit Sub
            End If
            ctmp = Left(ctmp1, lPosA - 1)
            
            cGewicht = ""
            cPreisKILO = ""
            cEndpreis = ""
            
            iStufe = 36
            
            'Gewicht
            lPosA = InStr(1, ctmp, " ")
            cGewicht = Left(ctmp, lPosA)
            cGewicht = Trim$(cGewicht)
            cGewicht = SwapStr(cGewicht, ".", "")
            
            If Trim(cGewicht) = "" Then
                If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
                Exit Sub
            End If
            Dim ilen As Integer
            ilen = Len(cGewicht)
            
            For i = 1 To ilen
                If Left(cGewicht, 1) = "0" Then
                    cGewicht = Right(cGewicht, Len(cGewicht) - 1)
                End If
            Next i
            
            iStufe = 37
            
            ctmp = Right(ctmp, Len(ctmp) - lPosA)
            ctmp = Trim$(ctmp)
             
            'preiskilo
            lPosA = InStr(1, ctmp, " ")
            cPreisKILO = Left(ctmp, lPosA)
            cPreisKILO = Trim$(cPreisKILO)
            cPreisKILO = SwapStr(cPreisKILO, ".", ",")
            
            iStufe = 38
            
            If Trim(cPreisKILO) = "" Then
                If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
                Exit Sub
            End If
            
            
            ctmp = Right(ctmp, Len(ctmp) - lPosA)
            'endpreis
            cEndpreis = Trim$(ctmp)
            cEndpreis = SwapStr(cEndpreis, ".", ",")
            If Trim(cEndpreis) = "" Then
                If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
                Exit Sub
            End If
            
            iStufe = 39
            
            anzeige "erfolg", "", Label27
            
            If List3.Nodes.Count > 0 Then

                If List3.SelectedItem Is Nothing Then
                    anzeige "rot2", "Markieren Sie einen Artikel!", Label27
                    If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
                    Exit Sub
                Else
                    gindi = List3.SelectedItem.index

                    Frame27.Visible = True
                    Frame1.Visible = False
                    Frame2.Visible = False
                    Frame3.Visible = False
                    Frame4.Visible = False
                    Frame23.Visible = False
                    Text8(0).Text = ""
                    Text8(1).Text = ""
                    Text8(2).Text = ""
                    Text8(3).Text = ""
                    Text8(4).Text = ""
                    Text8(5).Text = ""

                    iStufe = 18

                    bErsterAnschlag = True
                    ZerlegeLbSatzWKL20

                    Text4.Text = "TEE " & cGewicht & " g " & cPreisKILO
                    Text8(0).Text = cEndpreis
                    Command14_Click 13
                End If
            Else
                anzeige "rot", "Wählen Sie vorher einen Artikel!", Label27
                If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
                Exit Sub
            End If

           ' Fehler

        iStufe = 40
        Case comBreak     'gestoppt
        Case comCDTO    ' CD-Zeitüberschreitung
        Case comCTSTO   ' CTS-Zeitüberschreitung
        Case comDSRTO   ' DSR-Zeitüberschreitung
        Case comFrame   ' Fehler im Übertragungsraster (Framing Error)
        Case comOverrun ' Datenverlust
        Case comRxOver  ' Überlauf des Empfangspuffers
        Case comRxParity    ' Paritätsfehler

        Case comTxFull  ' Sendepuffer voll
    ' Ereignisse
        Case comEvCD    ' Pegeländerung auf DCD
        Case comEvCTS   ' Pegeländerung auf CTS
        Case comEvDSR   ' Pegeländerung auf DSR
        Case comEvRing  ' Pegeländerung auf RI (Ring Indicator)

        Case comEvSend  ' Im Sendepuffer befinden sich SThreshold Zeichen
    End Select
    iStufe = 50
    If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True

Exit Sub
LOKAL_ERROR:
    If err.Number = 8005 Or err.Number = 8012 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "MSComm3_OnComm"
        Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten." & iStufe & " " & Len(ctmp)
        
        Fehlermeldung1
        If Not MSComm3.PortOpen = True Then MSComm3.PortOpen = True
    End If
End Sub
Private Sub Text1_Change(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    If index = 0 Then
        If Len(Text1(index).Text) = 3 Then
            SSCommand2_Click 15
        End If
    End If
    
    If index = 1 Then
        If Right(Text1(index).Text, 1) = "," Then
            If InStr(1, Text1(index).Text, ",") <> Len(Text1(index).Text) Then
                Text1(index).Text = Left(Text1(index).Text, Len(Text1(index).Text) - 1)
            End If
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_Change"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text1_GotFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    If index = 1 Then
        If (GetKeyState(vbKeyCapital) = 1) Then
    
            'CAPS-Lock deaktivieren (falls aktiviert)
            MsgBox "CAPS-Lock (Großschreibmodus) ist eingeschaltet und wird jetzt abgestellt!", vbInformation, "Winkiss Hinweis:"
            
            
            KeyboardChangeState vbKeyCapital
        End If
    End If
    
    If gbBEDKARTE Then
        If Identi(93) = True Then
        
        Else
            If index = 0 And Not gbNumTaste And Not Frame15.Visible Then 'neu seit 06.11.13 And Not Frame15.Visible
                If bfromFrame36 = False And bfromFrame46 = False Then
                    Text1(index).Text = ""
                    Label1(8).Caption = ""
                End If
            End If
        End If
    Else
        If index = 0 And Not gbNumTaste And Not Frame15.Visible Then 'neu seit 06.11.13 And Not Frame15.Visible
            If bfromFrame36 = False And bfromFrame46 = False Then
                Text1(index).Text = ""
            End If
        End If
    End If
    
    Text1(index).BackColor = glSelBack1
    Text1(index).SelStart = 0
    Text1(index).SelLength = Len(Text1(index).Text)
    Label8(2).Caption = index
    gbNumTaste = False
    bfromFrame36 = False
    bfromFrame46 = False
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text1_KeyPress(index As Integer, KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cZeichen = Chr$(KeyAscii)
    
    If index = 0 Then
        cValid = gcNUM & Chr$(8)
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
            Beep
        End If
    ElseIf index = 1 Then
    
        cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
        cValid = cValid & Chr(38) & Chr(45) & Chr(46) '& - .
        cValid = cValid & "äÄÜüÖöß,"
        
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
    ElseIf index = 3 Then
    
        cValid = gcNUM & Chr$(8)
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
        
    ElseIf index = 4 Then
    
        cValid = gcNUM & Chr$(8)
        If InStr(cValid, cZeichen) = 0 Then
            KeyAscii = 0
        End If
        
    
    End If
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text1_KeyUp(index As Integer, KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp As String
    
    If index = 0 Then
        If KeyCode = 13 Then                        'CR gesendet
            SSCommand2_Click 15
            Exit Sub
        ElseIf KeyCode = vbKeyEscape Then
            Command1_Click 11       'Ende Button
            Exit Sub
        End If
    End If
    
    If index = 2 Then
        If KeyCode = vbKeyReturn Then
            Command6_Click
            Exit Sub
        End If
    End If
    
    If index = 3 Then
        If KeyCode = vbKeyReturn Then
            Command33_Click 1
            Text1(1).Text = Text1(3).Text
            Label8(2).Caption = "1"
            Text1_KeyUp 1, vbKeyReturn, 0
        End If
    End If
    
    If index = 4 Then
        If KeyCode = vbKeyReturn Then
            
            Command5_Click 1
            
            Text1(1).Text = Text1(4).Text
            Label8(2).Caption = "1"
            
            Text1_KeyUp 1, vbKeyReturn, 0
        End If
    End If
    
    
    
    If index = 1 Then
        Select Case Shift
            Case Is = 0     'ohne Zusatztaste
                If KeyCode = vbKeyEscape Then
                    Command1_Click 11       'Ende Button
                    Exit Sub
                End If
            
                If KeyCode = 13 Then                        'CR gesendet
                    ctmp = Text1(1).Text
                    ctmp = Trim$(ctmp)
                    If ctmp <> "" Then
                        If InStr(ctmp, ",") = 0 Then
                            SSCommand2_Click 15
                        Else
                            anzeige "rot", "Ungültige Eingabe! Artikelsuche bitte ohne Komma!", Label27
                            Text1(1).SetFocus
                        End If
                    Else
                        anzeige "knormal", "Bitte nehmen Sie eine Eingabe vor!", Label27
                        Text1(1).SetFocus
                    End If
                    
                    Exit Sub
                End If
                
                If KeyCode = vbKeySubtract Then             'Minus
                    SSCommand2_Click 16
                    Text1(1).Text = ""
                    Exit Sub
                End If
                
                If KeyCode = 106 Then                       'Multiplikator
                    SSCommand2_Click 12
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF2 Then                   'Taste F2 EC-Lastschrift
                    Command1_Click 0
                    Exit Sub
                End If
                
                
                If KeyCode = vbKeyF3 Then                   'Taste F3 Kundensuche
                    Command1_Click 1
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF4 Then                   'Taste F4 SonPr
                    Command1_Click 2
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF5 Then                   'Taste F5 GesRab
                    Command1_Click 3
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF6 Then                   'Taste F6 ArtRab
                    Command1_Click 4
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF7 Then                   'Taste F7 Kreditkarte
                    Command1_Click 17
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF8 Then                   'Taste F8 Scheck
                    Command1_Click 6
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF9 Then                   'Taste F9 Zahlung per Gutschein
                    Command1_Click 15
                    Exit Sub
                End If
                
                
                If KeyCode = vbKeyF10 Then                  'Taste F10 Barverkauf
                    Command1_Click 8
                    '//new
                    Frame23.Visible = False
                    Exit Sub
                End If
            
                If KeyCode = vbKeyDelete Then               'Taste F10 Barverkauf
                    Label2(5).Caption = "1"
                    Text1(1).Text = ""
                    Exit Sub
                End If
                
'''''                If KeyCode = vbKeyF11 Then                   'Taste F11 Spezi Bon
'''''                    spezi_bon_drucken
'''''                    Exit Sub
'''''                End If
            
            
            Case Is = 1     'SHIFT ist gedrückt
            
                If KeyCode = vbKeyF1 Then               'Taste Shift + F1 = Auszahlung
                    Command1_Click 45
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF2 Then               'Taste Shift + F2 Einzahlung
                    Command1_Click 46
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF3 Then               'Taste Shift + F3 Ende
                    Command1_Click 11
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF5 Then               'Taste Shift + F5 2.Bon
                    Command1_Click 34
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF7 Then               'Taste Shift + F7 Bon ein/Bon aus
                    Command1_Click 12
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF8 Then               'Taste Shift + F8 Vk Gutschein
                    Command1_Click 14
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF9 Then               'Taste Shift + F9 Artikelsuche
                    Command1_Click 16
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF10 Then              'Taste Shift + F10 BAR
                    Command1_Click 32
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF11 Then              'Taste Shift + F11 Position
                    
'                    If List3.SelectedItem Is Nothing Then
                        List3.SetFocus
'                    Else
                    
'                    End If
                    gbAutomaticClick = False
                    List3_Click
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF12 Then              'Taste Shift + F12 unterbrech
                    Command1_Click 9
                    Exit Sub
                End If
            
                
            Case Is = 2     'STRG ist gedrückt
            
            '//new
            If KeyCode = vbKeyF6 Then       '//Taste STRG + F6 WG6
                Command1_Click 23
                Exit Sub
            End If

                
            Case Is = 3     'SHIFT + STRG sind gedrückt
                MsgBox "3 = SHIFT + STRG"
                
            Case Is = 4     'ALT ist gedrückt
                If KeyCode = vbKeyF1 Then               'Taste Alt + F1 WG1
                    Command1_Click 18
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF2 Then               'Taste Alt + F2 WG2
                    Command1_Click 19
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF3 Then               'Taste Alt + F3 WG3
                    Command1_Click 20
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF4 Then               'Taste Alt + F4 WG4
                    Command1_Click 21
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF5 Then               'Taste Alt + F5 WG5
                    Command1_Click 22
                    Exit Sub
                End If

                
                If KeyCode = vbKeyF7 Then               'Taste Alt + F7 WG7
                    Command1_Click 24
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF8 Then               'Taste Alt + F8 WG8
                    Command1_Click 25
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF9 Then               'Taste Alt + F9 WG9
                    Command1_Click 26
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF10 Then              'Taste Alt + F10 WG10
                    Command1_Click 27
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF11 Then               'Taste Alt + F11 WG11
                    Command1_Click 28
                    Exit Sub
                End If
                
                If KeyCode = vbKeyF12 Then              'Taste Alt + F12 WG12
                    Command1_Click 29
                    Exit Sub
                End If
                
                If KeyCode = 70 Then              'Taste Alt + F Filialtausch
                    Command1_Click 48
                    Exit Sub
                End If
                
                If KeyCode = 82 Then              'Taste Alt + r retoure
                    Command1_Click 49
                    Exit Sub
                End If


                
            Case Is = 5     'SHIFT + ALT sind gedrückt
                
            Case Is = 6     'ALT GR bzw. STRG + ALT sind gedrückt
                
                
            Case Is = 7     'SHIFT + STRG + ALT sind gedrückt
                
            Case Else       'was noch?
            
        End Select
    End If
 
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub Text1_LostFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    Dim iRet As Integer
    
    If index = 0 And Trim$(Text1(0).Text) <> "" Then
    
        If gbNumTaste Then
            iRet = fnLogonBedienerWKL20%()
        End If
        
        If iRet <> 0 Then
            Text1(0).SetFocus
            Exit Sub
        End If
        gbNumTaste = False
    Else
        If index = 0 Then
            Label1(8).Caption = ""
        End If
        gbNumTaste = False
    End If
    
    Text1(index).BackColor = vbWhite
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text3_GotFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Text3(index).BackColor = glSelBack1
    Text3(index).SelStart = 0
    Text3(index).SelLength = Len(Text3(index).Text)
    
    
    If index = 19 Then
        Zahlen_schalten False
        
    Else
        Zahlen_schalten True
        
    End If
    
    Picture3.Visible = False
    
    Label3(5).Caption = Trim$(Str$(index))
    
    
    If bFocusonList4 = False Then
        Frame9.Visible = True
        Frame9.BackColor = Label9.BackColor
        List2.Visible = False
        List4.Visible = False

        Command4(10).Visible = False
        Command4(9).Visible = False
        Command4(1).Visible = False
        cmdFoto.Visible = False
        Command8(118).Visible = False
        Command8(119).Visible = False
    End If
    
    If index = 2 Then
    
       
        If (GetKeyState(vbKeyCapital) = 1) Then
    
            'CAPS-Lock deaktivieren (falls aktiviert)
            MsgBox "CAPS-Lock (Großschreibmodus) ist eingeschaltet und wird jetzt abgestellt!", vbInformation, "Winkiss Hinweis:"
            
            
            KeyboardChangeState vbKeyCapital
        End If
    
        Frame7.Visible = True
    Else
        
        Frame7.Visible = False
    
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Zahlen_schalten(bEinschalten As Boolean)
    On Error GoTo LOKAL_ERROR
    
    Dim i As Integer
    
    'alles andere ausser Zahlen
    
    For i = 78 To 87
        SSCommand100(i).Enabled = bEinschalten
    Next i
    
    For i = 0 To 34
        SSCommand100(i).Enabled = bEinschalten
    Next i
    
   
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Zahlen_schalten"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text3_KeyUp(index As Integer, KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp As String
    Dim sAuswahlfeld As String
    
    If KeyCode = vbKeyReturn Then
        If index < 3 Or index = 4 Or index = 5 Or index = 19 Then
            Command4_Click 0
        End If
        If index = 3 Then
            Command4_Click 5
        End If
    End If
    
    If KeyCode = vbKeyEscape Then
        If index < 3 Or index = 4 Or index = 5 Then
            Command4_Click 2
        End If
        If index = 3 Then
            Command4_Click 3
        End If
    End If
    
    gF2Prompt.cFeld = ""
    gF2Prompt.cWert = ""
    gF2Prompt.cWert2 = ""
    gF2Prompt.cWahl = ""
    gF2Prompt.bMultiple = False
    
            

        
    If KeyCode = vbKeyF2 Then
        Select Case index
            Case 4 'Pgn
                gF2Prompt.cFeld = "PGN"
            Case 77 'Linie
            
            
                ctmp = Text3(6).Text 'Marke
                ctmp = Trim$(ctmp)
                If ctmp = "" Then
                    ctmp = Text3(5).Text 'lieferant
                    ctmp = Trim$(ctmp)
                    If ctmp = "" Then
                        MsgBox "Bitte einen Lieferanten oder eine Marke angeben!", vbInformation, gsPname & " Hinweis:"
                        Text3(6).SetFocus
                        Exit Sub
                    Else
                        If IsNumeric(ctmp) = False Then
                            MsgBox "Bitte einen Lieferanten oder eine Marke angeben!", vbInformation, gsPname & " Hinweis:"
                            Text3(6).SetFocus
                            Exit Sub
                        Else
                            sAuswahlfeld = "LINR"
                        End If
                    End If
                Else
                    sAuswahlfeld = "MARKE"
                End If
                
                gF2Prompt.cFeld = "LPZ"
                gF2Prompt.cWert = ctmp
                gF2Prompt.cEsFeld = sAuswahlfeld
            
                
            Case 5 'linr
                gF2Prompt.cFeld = "LINR"
            Case 6 'Marke
                gF2Prompt.cFeld = "MARKE"
        End Select
        
        If gF2Prompt.cFeld <> "" Then
            frmWK00a.Show 1
            If gF2Prompt.cWahl <> "" Then
                Text3(index).SetFocus
                Text3(index).Text = gF2Prompt.cWahl
            End If
            
            If index = 5 Then
                Label5(3).Caption = gF2Prompt.cWert
                Label5(3).Refresh
            End If
            
            If index = 4 Then
                Label5(8).Caption = gF2Prompt.cWert
                Label5(8).Refresh
            End If
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text3_LostFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Text3(index).BackColor = vbWhite
    
    
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text6_GotFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Text6(index).BackColor = glSelBack1
    Text6(index).SelStart = 0
    Text6(index).SelLength = Len(Text6(index).Text)
    Label12.Caption = Trim$(Str$(index))
    
    
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text6_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text6_KeyPress(index As Integer, KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cValid = "1234567890" & Chr$(8)
    
    cZeichen = Chr$(KeyAscii)
    
    If InStr(cValid, cZeichen) = 0 Then
        KeyAscii = 0
    End If
    
    If KeyAscii <> 0 And KeyAscii <> 8 Then
        If index < 3 Then
            If Len(Text6(index).Text) = Text6(index).MaxLength - 1 Then
                Text6(index + 1).SetFocus
            End If
        Else
            If Len(Text6(index).Text) = Text6(index).MaxLength - 1 Then
                Command12(0).SetFocus
            End If
        End If
    End If
            
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text6_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text4_KeyPress(KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
    cValid = cValid & Chr(38) & Chr(45) & Chr(46) '& - .
    cValid = cValid & "+äÄÜüÖöß/"
    
    cZeichen = Chr$(KeyAscii)
    
    If InStr(cValid, cZeichen) = 0 Then
        KeyAscii = 0
    End If
    
    
            
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text4_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text6_LostFocus(index As Integer)
    On Error GoTo LOKAL_ERROR

    Text6(index).BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text6_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text8_GotFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Text8(index).BackColor = glSelBack1
    Text8(index).SelStart = 0
    Text8(index).SelLength = Len(Text8(index).Text)
    
    If index = 9 Then
        Label3(5).Caption = Trim$(Str$(index))
    ElseIf index = 13 Then
        Label3(5).Caption = Trim$(Str$(index))
    ElseIf index = 7 Then
        Label3(5).Caption = Trim$(Str$(index))
    ElseIf index = 8 Then
        Label3(5).Caption = Trim$(Str$(index))
    Else
        Label16(11).Caption = Trim$(Str$(index))
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text8_LostFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Text8(index).BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text4_GotFocus()
    On Error GoTo LOKAL_ERROR
    
    Text4.BackColor = glSelBack1
    Text4.SelStart = 0
    Text4.SelLength = Len(Text4.Text)
    
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text4_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Text4_LostFocus()
    On Error GoTo LOKAL_ERROR
    
    Text4.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text4_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Timer1_Timer()
    On Error GoTo LOKAL_ERROR
    
    Dim cPfad   As String
    
    cPfad = gcDBPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    Label20(0).Caption = Format$(Time, "HH:MM:SS")
    
    If Picture5.Tag = "brief" Then
    
        If Format$(Time, "SS") = 20 Then
    
            If gbKL_LIVENACHRICHTEN = True Then
                If NewTableSuchenDBKombi("NACHRICHTEN", gdBase) = False Then
                    CreateTableT3 "NACHRICHTEN", gdBase
                End If
    
                If FRAGENeueNachrichten = True Then
    
                    Set Picture5.Picture = LoadPicture(cPfad & "Picture\System\" & "briefrot.gif")
                    Picture5.Visible = True
                    Picture5.Tag = "briefrot"
    
                End If
    
            End If
    
        End If
    Else
    
    
    
        
    
    End If

 
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Timer1_Timer"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Public Sub zeigeZwangsrabatt()
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp As String
    Dim dWert As Double
    
    ctmp = CStr(gsiGESRAB)
    ctmp = fnMoveComma2Point$(ctmp)
    dWert = Val(ctmp)
    If dWert > 100 Then
        MsgBox "Rabatte dürfen nicht größer als 100 % sein!", vbInformation, "Winkiss Hinweis:"
'        Text1(1).SetFocus
        Exit Sub
    End If
    
    Label2(3).Caption = Format$(dWert, "######0.00")
    If dWert <> 0 Then
        Label2(3).Visible = True
        
        If gbRabVs = True Then
            Label2(4).Visible = False
        Else
            Label2(4).Visible = True
        End If
        
        Label1(3).Visible = True
        Label2(3).ForeColor = &H8080&
        Label2(4).ForeColor = &H8080&
        Label1(3).ForeColor = &H8080&
        Label1(3).Caption = gsGESRABBEZ
        Label1(3).Refresh
        Label2(3).Refresh
        Label2(4).Refresh
    Else
        Label2(3).ForeColor = &HFF0000
        Label2(3).Visible = False
        Label2(4).Visible = False
        
        If gbRabVs = False Then
            Label1(3).Caption = gsGESRABBEZ
        Else
            Label1(3).Caption = "GR"
        End If
        
        Label1(3).ForeColor = &H80000012
        Label2(4).ForeColor = &HFF0000
        Label1(3).Visible = False
        Label1(3).Refresh
        Label2(3).Refresh
        Label2(4).Refresh
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "zeigeZwangsrabatt"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Timer2_Timer()
On Error GoTo LOKAL_ERROR

    'wenn dieser Timer tickt
    'dann alle 2 sec Kundenbild wechseln
    
    Timer2.Interval = 2000
    
    Dim sZielpfad As String
    Dim sAngezeigterBildname As String
    Dim cKdnr   As String
    cKdnr = Label2(7).Caption
    
    sZielpfad = gcDBPfad
    If Right(sZielpfad, 1) <> "\" Then
        sZielpfad = sZielpfad & "\"
    End If
    sZielpfad = sZielpfad & "PICTURE\KUNDEN"
    
    sAngezeigterBildname = Picture4.Tag
    
    Select Case sAngezeigterBildname
    
        Case cKdnr
        
            If FileExists(sZielpfad & "\" & cKdnr & "_1.jpg") Then
                Kunden_Bildzeigen cKdnr, Image4, Picture4, 100, cKdnr & "_1"
                Exit Sub
            End If
            
            If FileExists(sZielpfad & "\" & cKdnr & "_2.jpg") Then
                Kunden_Bildzeigen cKdnr, Image4, Picture4, 100, cKdnr & "_2"
                Exit Sub
            End If
        
        Case cKdnr & "_1"
        
            If FileExists(sZielpfad & "\" & cKdnr & "_2.jpg") Then
                Kunden_Bildzeigen cKdnr, Image4, Picture4, 100, cKdnr & "_2"
                Exit Sub
            End If
            
            If FileExists(sZielpfad & "\" & cKdnr & ".jpg") Then
                Kunden_Bildzeigen cKdnr, Image4, Picture4, 100, cKdnr & ""
                Exit Sub
            End If
        
        Case cKdnr & "_2"
        
            If FileExists(sZielpfad & "\" & cKdnr & ".jpg") Then
                Kunden_Bildzeigen cKdnr, Image4, Picture4, 100, cKdnr & ""
                Exit Sub
            End If
            
            If FileExists(sZielpfad & "\" & cKdnr & "_1.jpg") Then
                Kunden_Bildzeigen cKdnr, Image4, Picture4, 100, cKdnr & "_1"
                Exit Sub
            End If
            
    End Select
    
    
    
    
    
    
'
    

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Timer2_Timer"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub


Private Sub txtStatus_Change()
On Error GoTo LOKAL_ERROR

    Dim nProz As Long
  
    nProz = Val(txtStatus.Text)
    ShowProgress picprogress, nProz, 0, 100, True
    picprogress.Refresh
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "txtstatus_Change"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Programmeinstellungen auf. "
    
    Fehlermeldung1
    
End Sub

Private Sub txtZollEr_GotFocus()
On Error GoTo LOKAL_ERROR
    
    txtZollEr.BackColor = glSelBack1
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "txtZollEr_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub


Private Sub txtZollEr_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR

    Dim dZollErBetrag As Double
   
    
    
    
    If KeyCode = vbKeyReturn Then
        
        
        'Zollerstattungen werden vom offenen Betrag abgezogen
        
        If txtZollEr.Text <> "" Then
        
            If IsNumeric(txtZollEr.Text) Then
            
            
                Dim cGeld               As String
                Dim cBetrag             As String
                Dim dBetrag             As Double
                Dim d2Betrag            As Double
                Dim dGeld               As Double
                Dim dSumme              As Double
                Dim cSumme              As String
                Dim cEUR                As String
                Dim dEUR                As Double
                Dim dNochOffen          As Double
                Dim i                   As Integer
                Dim dBetrag1            As Double
                Dim dBetrag2            As Double
                Dim dFremdwBetrag       As Double
                Dim dAnzeigeBetrag      As Double
                Dim dOffen              As Double
                Dim dzurück             As Double
                Dim iStufe              As Integer
                
                iStufe = 0
                dBetrag1 = 0
                
                
                'abschalten
                For i = 0 To 12
                    iStufe = 1
                    SSCommand2(i).Enabled = False
                Next i
                iStufe = 2
                SSCommand2(15).Enabled = False
                iStufe = 3
                SSCommand2(16).Enabled = False
                
                
                
                '1.Betrag vom Button
                
                
                
                iStufe = 5
                
                dGeld = 0
                
                cGeld = txtZollEr.Text 'SSCommand33(Index).Tag
                
                iStufe = 6
                cGeld = fnMoveComma2Point$(cGeld)
                dGeld = Val(cGeld)
                
                
                'hier schon mal alle Zollerstattungsbeträge sammeln
                For i = 0 To 10
                    If dZollEr(i) = 0 Then
                    
                        List7.AddItem dGeld
                        dZollEr(i) = dGeld
                        Exit For
                    End If
                Next i
                
                
                '2.Betrag addieren
                iStufe = 7
                dieKleineTextKontrolle
                
                If gsFremdKuerzel <> "" Then
                
                
                    'auch mal umrechnen!
                    dGeld = dGeld / CDbl(gsUK)
    
                
                
                
                    iStufe = 8
                    cBetrag = Text88.Text
                    cBetrag = fnMoveComma2Point$(cBetrag)
                    
                    dAnzeigeBetrag = Val(cBetrag) + dGeld
                    
                    cBetrag = Format$(dAnzeigeBetrag, "#####0.00")
                    Text88.Text = cBetrag
                    Text88.SetFocus
                Else
                    iStufe = 9
                    cBetrag = Text333.Text
                    cBetrag = fnMoveComma2Point$(cBetrag)
                    
                    dAnzeigeBetrag = Val(cBetrag) + dGeld
                    
                    cBetrag = Format$(dAnzeigeBetrag, "#####0.00")
                    Text333.Text = cBetrag
                    Text333.SetFocus
                End If
                    
                '3.Eurobetrag erstellen
                
                iStufe = 10
                cBetrag = Text88.Text
                cBetrag = fnMoveComma2Point$(cBetrag)
                dFremdwBetrag = Val(cBetrag)
                dBetrag = dFremdwBetrag * CDbl(gsUK)
                    
                iStufe = 11
                
                cBetrag = Text333.Text
                cBetrag = fnMoveComma2Point$(cBetrag)
                dBetrag2 = Val(cBetrag)
                
                dBetrag = dBetrag + dBetrag2
                
                iStufe = 12
            
                cSumme = Label333(0).Caption
                cSumme = fnMoveComma2Point$(cSumme)
                dSumme = Val(cSumme)
                
                '4.noch Offen" füllen
                dNochOffen = dSumme - dBetrag
                
                If dNochOffen > 0 Then
                    iStufe = 13
                    Command33(0).Enabled = False
                    Label333(2).Caption = Format$(dNochOffen, "#####0.00")
                    Label333(3).Caption = "0,00" 'zurück
                    
                    txtZollEr.Text = ""
                    txtZollEr.SetFocus
                    
                    
                ElseIf dNochOffen <= 0 Then
                    iStufe = 14
                    Command33(0).Enabled = True
                    Label333(2).Caption = "0,00"
                    dzurück = dNochOffen * (-1)
                    Label333(3).Caption = Format$(dzurück, "#####0.00") 'zurück
                    
                    txtZollEr.Text = ""
                    txtZollEr.Visible = False
                    
                End If
                
                iStufe = 15
                If gsUK <> "0" Then
                    dOffen = dNochOffen / CDbl(gsUK)
                    
                    iStufe = 16
                    If dOffen > 0 Then
                        iStufe = 17
                        Label88(2).Caption = "noch offen"
                        Label88(3).Caption = Format$(dOffen, "#####0.00")
                        
                        txtZollEr.Text = ""
                        txtZollEr.SetFocus
                        
                        
                    ElseIf dOffen <= 0 Then
                        iStufe = 18
                        dzurück = dOffen * (-1)
                        Label88(2).Caption = "zurück"
                        Label88(3).Caption = Format$(dzurück, "#####0.00") 'zurück
                        
                        txtZollEr.Text = ""
                        txtZollEr.Visible = False
                        
                    End If
                    
                End If
            
       
                
                
                
            End If
        
        End If
        
        
        
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "txtZollEr_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub spezi_bon_drucken()
    On Error GoTo LOKAL_ERROR
    
    Screen.MousePointer = 11
    
    ReDim cZeile(0 To 0) As String
    Dim iAnzZeile As Integer
    
    iAnzZeile = -1
    
    Dim iLenZeile As Integer
    iLenZeile = 32
    Dim sEinText As String
    
    Dim sWort As String
    Dim cLBSatz As String
    
    cLBSatz = gsSpezBontextU
    
    iAnzZeile = iAnzZeile + 1
    ReDim Preserve cZeile(0 To iAnzZeile) As String
                
    cZeile(iAnzZeile) = cLBSatz
    cLBSatz = ""
    
    cLBSatz = "________________________________"
    
    
    iAnzZeile = iAnzZeile + 1
    ReDim Preserve cZeile(0 To iAnzZeile) As String
                
    cZeile(iAnzZeile) = cLBSatz
    cLBSatz = ""
    
    
    
    
    sEinText = gsSpezBontext & " "
    
    If Len(sEinText) > iLenZeile Then
        Do While Len(sEinText) > 0
            sWort = Mid(sEinText, 1, InStr(1, sEinText, " ") - 1)
            
            If Len(cLBSatz & sWort & Space(1)) > iLenZeile Then
                
                iAnzZeile = iAnzZeile + 1
                ReDim Preserve cZeile(0 To iAnzZeile) As String
                
                cZeile(iAnzZeile) = cLBSatz
                cLBSatz = ""
            End If
        
            cLBSatz = cLBSatz & sWort & Space(1)
            sEinText = Mid(sEinText, Len(sWort) + 2, Len(sEinText) - Len(sWort) + 1)
        Loop
        
        iAnzZeile = iAnzZeile + 1
        ReDim Preserve cZeile(0 To iAnzZeile) As String
                
        cZeile(iAnzZeile) = cLBSatz
        cLBSatz = ""
        
    Else
    
        cLBSatz = sEinText
        iAnzZeile = iAnzZeile + 1
        ReDim Preserve cZeile(0 To iAnzZeile) As String
                
        cZeile(iAnzZeile) = cLBSatz
        cLBSatz = ""
    
    
    End If
    
    cLBSatz = Space(32)
    iAnzZeile = iAnzZeile + 1
    ReDim Preserve cZeile(0 To iAnzZeile) As String
    cZeile(iAnzZeile) = cLBSatz

    cLBSatz = ""
    sWort = ""
    
    sEinText = gsSpezBontext2 & " "
    
    If Len(sEinText) > iLenZeile Then
        Do While Len(sEinText) > 0
            sWort = Mid(sEinText, 1, InStr(1, sEinText, " ") - 1)
            
            If Len(cLBSatz & sWort & Space(1)) > iLenZeile Then
                
                iAnzZeile = iAnzZeile + 1
                ReDim Preserve cZeile(0 To iAnzZeile) As String
                
                cZeile(iAnzZeile) = cLBSatz
                cLBSatz = ""
            End If
        
            cLBSatz = cLBSatz & sWort & Space(1)
            sEinText = Mid(sEinText, Len(sWort) + 2, Len(sEinText) - Len(sWort) + 1)
        Loop
        
        iAnzZeile = iAnzZeile + 1
        ReDim Preserve cZeile(0 To iAnzZeile) As String
                
        cZeile(iAnzZeile) = cLBSatz
        cLBSatz = ""
    Else
    
        cLBSatz = sEinText
        iAnzZeile = iAnzZeile + 1
        ReDim Preserve cZeile(0 To iAnzZeile) As String
                
        cZeile(iAnzZeile) = cLBSatz
        cLBSatz = ""
    End If
    
    cLBSatz = Space(32)
    iAnzZeile = iAnzZeile + 1
    ReDim Preserve cZeile(0 To iAnzZeile) As String
    cZeile(iAnzZeile) = cLBSatz

    cLBSatz = ""
    sWort = ""
    
    sEinText = gsSpezBontext3 & " "
    
    If Len(sEinText) > iLenZeile Then
        Do While Len(sEinText) > 0
            sWort = Mid(sEinText, 1, InStr(1, sEinText, " ") - 1)
            
            If Len(cLBSatz & sWort & Space(1)) > iLenZeile Then
                
                iAnzZeile = iAnzZeile + 1
                ReDim Preserve cZeile(0 To iAnzZeile) As String
                
                cZeile(iAnzZeile) = cLBSatz
                cLBSatz = ""
            End If
        
            cLBSatz = cLBSatz & sWort & Space(1)
            sEinText = Mid(sEinText, Len(sWort) + 2, Len(sEinText) - Len(sWort) + 1)
        Loop
        
        iAnzZeile = iAnzZeile + 1
        ReDim Preserve cZeile(0 To iAnzZeile) As String
                
        cZeile(iAnzZeile) = cLBSatz
        cLBSatz = ""
    Else
    
        cLBSatz = sEinText
        iAnzZeile = iAnzZeile + 1
        ReDim Preserve cZeile(0 To iAnzZeile) As String
                
        cZeile(iAnzZeile) = cLBSatz
        cLBSatz = ""
    End If
    
    'Drucke den Beleg
    DruckeBonusV3Beleg cZeile(), iAnzZeile, True
    
    Screen.MousePointer = 0
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "spezi_bon_drucken"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
'    Resume Next
End Sub
Private Sub txtZollEr_LostFocus()
On Error GoTo LOKAL_ERROR

    txtZollEr.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "txtZollEr_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Kasse ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub


Private Sub TimerNetwork_Timer()
    ''''''''''''Oliver Alte TSE START
    'TSS.TimerTick WinsockTSE, TimerNetwork
    ''''''''''''Oliver Alte TSE ENDE
End Sub

Private Sub WinsockTSE_DataArrival(ByVal bytesTotal As Long)
    ''''''''''''Oliver Alte TSE START
    'TSS.Receive WinsockTSE
    ''''''''''''Oliver Alte TSE ENDE
End Sub

Private Sub WinsockTSE_Error(ByVal Number As Integer, Description As String, ByVal sCode As Long, ByVal Source As String, ByVal HelpFile As String, ByVal HelpContext As Long, CancelDisplay As Boolean)
    
    ''''''''''''Oliver Alte TSE START
    'TSS.Error WinsockTSE, TimerNetwork
    ''''''''''''Oliver Alte TSE ENDE
End Sub
