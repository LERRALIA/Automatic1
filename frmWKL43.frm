VERSION 5.00
Object = "{7D622DE6-0ABC-471E-9234-97DEC5E0A708}#3.8#0"; "sevCmd3.ocx"
Object = "{5E9E78A0-531B-11CF-91F6-C2863C385E30}#1.0#0"; "msflxgrd.ocx"
Object = "{0BA686C6-F7D3-101A-993E-0000C0EF6F5E}#1.0#0"; "threed32.ocx"
Begin VB.Form frmWKL43 
   BackColor       =   &H00C0C000&
   Caption         =   "Bestellungen"
   ClientHeight    =   8625
   ClientLeft      =   3435
   ClientTop       =   2325
   ClientWidth     =   11910
   Icon            =   "frmWKL43.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   PaletteMode     =   1  'ZReihenfolge
   ScaleHeight     =   8625
   ScaleWidth      =   11910
   StartUpPosition =   2  'Bildschirmmitte
   Begin VB.Frame Frame12 
      BackColor       =   &H00C0FFFF&
      Caption         =   "fra12"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   975
      Left            =   6360
      TabIndex        =   470
      Top             =   8040
      Visible         =   0   'False
      Width           =   735
      Begin VB.TextBox Text14 
         Height          =   4575
         Left            =   360
         MultiLine       =   -1  'True
         ScrollBars      =   2  'Vertikal
         TabIndex        =   471
         Top             =   3000
         Width           =   11415
      End
      Begin sevCommand3.Command Command14 
         Height          =   495
         Left            =   9840
         TabIndex        =   472
         Top             =   7680
         Width           =   1935
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Speichern"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label6 
         BackColor       =   &H80000001&
         Caption         =   "Mitteilung an den Lieferanten:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   375
         Index           =   2
         Left            =   360
         TabIndex        =   478
         Top             =   2520
         Width           =   4215
      End
      Begin VB.Label Label6 
         BackColor       =   &H80000001&
         Caption         =   "Lieferant:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   255
         Index           =   3
         Left            =   360
         TabIndex        =   477
         Top             =   2160
         Width           =   1215
      End
      Begin VB.Label Label6 
         BackColor       =   &H80000001&
         Caption         =   "Linr"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   255
         Index           =   8
         Left            =   1680
         TabIndex        =   476
         Top             =   2160
         Width           =   1095
      End
      Begin VB.Label Label6 
         BackColor       =   &H80000001&
         Caption         =   "Liefbez"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   255
         Index           =   9
         Left            =   2880
         TabIndex        =   475
         Top             =   2160
         Width           =   3975
      End
      Begin VB.Label Label6 
         BackColor       =   &H80000001&
         Caption         =   "Zusatztext für die Bestellung per Email"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   375
         Index           =   10
         Left            =   360
         TabIndex        =   474
         Top             =   480
         Width           =   6375
      End
      Begin VB.Label Label6 
         BackColor       =   &H80000001&
         Caption         =   "Dieser Zusatztext wird automatisch der Email-Mitteilung unterhalb der Artikelauflistung angefügt."
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   615
         Index           =   11
         Left            =   360
         TabIndex        =   473
         Top             =   960
         Width           =   6975
      End
   End
   Begin VB.Frame Frame10 
      BackColor       =   &H00FFC0C0&
      BorderStyle     =   0  'Kein
      Caption         =   "Bestellvorschlag laden"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   975
      Left            =   3000
      TabIndex        =   359
      Top             =   6600
      Visible         =   0   'False
      Width           =   1575
      Begin VB.TextBox Text15 
         Height          =   285
         Index           =   2
         Left            =   3600
         MaxLength       =   2
         TabIndex        =   486
         ToolTipText     =   "Geben Sie hier den Anfang der Artikelbezeichnung ein."
         Top             =   4800
         Width           =   705
      End
      Begin VB.TextBox Text15 
         Height          =   285
         Index           =   1
         Left            =   3600
         MaxLength       =   2
         TabIndex        =   484
         ToolTipText     =   "Geben Sie hier den Anfang der Artikelbezeichnung ein."
         Top             =   4440
         Width           =   705
      End
      Begin VB.TextBox Text15 
         Height          =   285
         Index           =   0
         Left            =   3600
         MaxLength       =   2
         TabIndex        =   483
         ToolTipText     =   "Geben Sie hier den Anfang der Artikelbezeichnung ein."
         Top             =   4080
         Width           =   705
      End
      Begin VB.CheckBox Check18 
         BackColor       =   &H00C0C000&
         Caption         =   "EAN - Angabe des MDE-Geräts als Original-EAN behandeln"
         Height          =   255
         Left            =   480
         TabIndex        =   462
         Top             =   3600
         Width           =   6495
      End
      Begin VB.CheckBox Check17 
         BackColor       =   &H00C0C000&
         Caption         =   "Bestellvorschlagsermittlung: nur Artikel mit Vorschlag anzeigen"
         Height          =   255
         Left            =   480
         TabIndex        =   456
         Top             =   3120
         Width           =   6495
      End
      Begin VB.CheckBox Check16 
         BackColor       =   &H00C0C000&
         Caption         =   "auch unbekannte Artikel anfügen (MDE)"
         Height          =   255
         Left            =   480
         TabIndex        =   453
         Top             =   2640
         Width           =   6495
      End
      Begin VB.CheckBox Check15 
         BackColor       =   &H00C0C000&
         Caption         =   "Mengenangabe des MDE-Geräts als VPE - Faktor verarbeiten"
         Height          =   255
         Left            =   480
         TabIndex        =   451
         Top             =   2160
         Width           =   6495
      End
      Begin VB.CheckBox Check14 
         BackColor       =   &H00C0C000&
         Caption         =   "Bestandsveränderung nicht möglich"
         Height          =   255
         Left            =   480
         TabIndex        =   449
         Top             =   1680
         Width           =   6495
      End
      Begin VB.CheckBox Check13 
         BackColor       =   &H00C0C000&
         Caption         =   "3 Jahre im Diagramm anzeigen"
         Height          =   255
         Left            =   480
         TabIndex        =   398
         Top             =   1200
         Width           =   6495
      End
      Begin VB.CheckBox Check12 
         BackColor       =   &H00C0C000&
         Caption         =   "Bei Wechsel Artikelfarbe ""rot"" gleichzeitig auf geführt ""N"" setzen"
         Height          =   255
         Left            =   480
         TabIndex        =   362
         Top             =   720
         Width           =   6495
      End
      Begin sevCommand3.Command Command5 
         Height          =   615
         Index           =   6
         Left            =   8640
         TabIndex        =   360
         Top             =   3840
         Width           =   2775
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Zurück"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label lbl1 
         Alignment       =   1  'Rechts
         BackStyle       =   0  'Transparent
         Caption         =   "Bei dieser FarbNr BVO = 0"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   7
         Left            =   840
         TabIndex        =   487
         Top             =   4800
         Width           =   2535
      End
      Begin VB.Label lbl1 
         Alignment       =   1  'Rechts
         BackStyle       =   0  'Transparent
         Caption         =   "Bei dieser FarbNr BVO = 0"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   6
         Left            =   840
         TabIndex        =   485
         Top             =   4440
         Width           =   2535
      End
      Begin VB.Label lbl1 
         Alignment       =   1  'Rechts
         BackStyle       =   0  'Transparent
         Caption         =   "Bei dieser FarbNr BVO = 0"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   5
         Left            =   840
         TabIndex        =   482
         Top             =   4080
         Width           =   2535
      End
      Begin VB.Label Label16 
         Alignment       =   2  'Zentriert
         BackColor       =   &H00808000&
         Caption         =   "Einstellungen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00404000&
         Height          =   375
         Left            =   3120
         TabIndex        =   361
         Top             =   120
         Width           =   5415
      End
   End
   Begin VB.Frame fraArtAnfuegen 
      BackColor       =   &H00808000&
      BorderStyle     =   0  'Kein
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   1455
      Left            =   9360
      TabIndex        =   1
      Top             =   4560
      Width           =   2535
      Begin VB.ListBox List2 
         BeginProperty Font 
            Name            =   "Courier New"
            Size            =   11.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   3885
         Left            =   120
         MultiSelect     =   2  'Erweitert
         TabIndex        =   468
         Top             =   960
         Width           =   11655
      End
      Begin VB.Frame Frame8 
         BackColor       =   &H008080FF&
         BorderStyle     =   0  'Kein
         Height          =   3015
         Left            =   120
         TabIndex        =   325
         Top             =   5040
         Visible         =   0   'False
         Width           =   2535
         Begin VB.Label Label3 
            BackColor       =   &H00C0C000&
            Caption         =   "Notizen:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   4
            Left            =   0
            TabIndex        =   341
            Top             =   2520
            Width           =   2535
         End
         Begin VB.Label Label3 
            BackColor       =   &H00C0C000&
            Caption         =   "keine:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   3
            Left            =   0
            TabIndex        =   340
            Top             =   2760
            Width           =   2535
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   39
            Left            =   960
            TabIndex        =   339
            Top             =   960
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Filiale"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   38
            Left            =   0
            TabIndex        =   338
            Top             =   960
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   37
            Left            =   960
            TabIndex        =   337
            Top             =   2160
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   36
            Left            =   960
            TabIndex        =   336
            Top             =   1920
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   35
            Left            =   960
            TabIndex        =   335
            Top             =   1680
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   34
            Left            =   960
            TabIndex        =   334
            Top             =   1440
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   33
            Left            =   960
            TabIndex        =   333
            Top             =   1200
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKVJ"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   32
            Left            =   0
            TabIndex        =   332
            Top             =   2160
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKLJ"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   31
            Left            =   0
            TabIndex        =   331
            Top             =   1920
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKVM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   30
            Left            =   0
            TabIndex        =   330
            Top             =   1680
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKAM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   29
            Left            =   0
            TabIndex        =   329
            Top             =   1440
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Bestand"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   28
            Left            =   0
            TabIndex        =   328
            Top             =   1200
            Width           =   735
         End
         Begin VB.Label Label15 
            BackColor       =   &H00C0C000&
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   735
            Left            =   0
            TabIndex        =   327
            Top             =   240
            Width           =   2535
         End
         Begin VB.Label Label14 
            BackColor       =   &H00C0C000&
            Caption         =   "ArtNr  : "
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Left            =   0
            TabIndex        =   326
            Top             =   0
            Width           =   2535
         End
      End
      Begin VB.Frame Frame3 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Height          =   3015
         Left            =   3240
         TabIndex        =   271
         Top             =   5040
         Visible         =   0   'False
         Width           =   6735
         Begin sevCommand3.Command Command4 
            Height          =   330
            Index           =   3
            Left            =   6240
            TabIndex        =   273
            Top             =   120
            Width           =   375
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "+"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command4 
            Height          =   330
            Index           =   2
            Left            =   120
            TabIndex        =   272
            Top             =   120
            Width           =   375
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "-"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.Label Label13 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "Verkaufszahlen (Menge in Stück)"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Left            =   840
            TabIndex        =   324
            Top             =   120
            Width           =   5055
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   23
            Left            =   6360
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   22
            Left            =   6120
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   21
            Left            =   5880
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   20
            Left            =   5640
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   19
            Left            =   5400
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   18
            Left            =   5160
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   17
            Left            =   4920
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   16
            Left            =   4680
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   15
            Left            =   4440
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   14
            Left            =   4200
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   13
            Left            =   3960
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   12
            Left            =   3720
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "D"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   47
            Left            =   6360
            TabIndex        =   323
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "N"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   46
            Left            =   6120
            TabIndex        =   322
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "O"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   45
            Left            =   5880
            TabIndex        =   321
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "S"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   44
            Left            =   5640
            TabIndex        =   320
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "A"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   43
            Left            =   5400
            TabIndex        =   319
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "J"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   42
            Left            =   5160
            TabIndex        =   318
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "J"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   41
            Left            =   4920
            TabIndex        =   317
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "M"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   40
            Left            =   4680
            TabIndex        =   316
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "A"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   39
            Left            =   4440
            TabIndex        =   315
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "M"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   38
            Left            =   4200
            TabIndex        =   314
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "F"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   37
            Left            =   3960
            TabIndex        =   313
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "J"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   36
            Left            =   3720
            TabIndex        =   312
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   23
            Left            =   6360
            TabIndex        =   311
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   22
            Left            =   6120
            TabIndex        =   310
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   21
            Left            =   5880
            TabIndex        =   309
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   20
            Left            =   5640
            TabIndex        =   308
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   19
            Left            =   5400
            TabIndex        =   307
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   18
            Left            =   5160
            TabIndex        =   306
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   17
            Left            =   4920
            TabIndex        =   305
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   16
            Left            =   4680
            TabIndex        =   304
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   15
            Left            =   4440
            TabIndex        =   303
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   14
            Left            =   4200
            TabIndex        =   302
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   13
            Left            =   3960
            TabIndex        =   301
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0E0FF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   12
            Left            =   3720
            TabIndex        =   300
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label9 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   1
            Left            =   4800
            TabIndex        =   299
            Top             =   2640
            Width           =   780
         End
         Begin VB.Label Label9 
            BackColor       =   &H00C0C000&
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   0
            Left            =   1200
            TabIndex        =   298
            Top             =   2640
            Width           =   825
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackColor       =   &H0000FFFF&
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   11
            Left            =   2760
            TabIndex        =   297
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   4
            Left            =   1080
            TabIndex        =   296
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   0
            Left            =   120
            TabIndex        =   295
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   1
            Left            =   360
            TabIndex        =   294
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   2
            Left            =   600
            TabIndex        =   293
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   3
            Left            =   840
            TabIndex        =   292
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   5
            Left            =   1320
            TabIndex        =   291
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   6
            Left            =   1560
            TabIndex        =   290
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   7
            Left            =   1800
            TabIndex        =   289
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   8
            Left            =   2040
            TabIndex        =   288
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   9
            Left            =   2280
            TabIndex        =   287
            Top             =   2040
            Width           =   195
         End
         Begin VB.Label Label20 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   10
            Left            =   2520
            TabIndex        =   286
            Top             =   2040
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   0
            Left            =   120
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   1
            Left            =   360
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   2
            Left            =   600
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   3
            Left            =   840
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   4
            Left            =   1080
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   5
            Left            =   1320
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   6
            Left            =   1560
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   7
            Left            =   1800
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   8
            Left            =   2040
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   9
            Left            =   2280
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   10
            Left            =   2520
            Top             =   2400
            Width           =   195
         End
         Begin VB.Shape Shape2 
            FillColor       =   &H0000FFFF&
            FillStyle       =   0  'Ausgefüllt
            Height          =   15
            Index           =   11
            Left            =   2760
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "J"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   35
            Left            =   120
            TabIndex        =   285
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "F"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   34
            Left            =   360
            TabIndex        =   284
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "M"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   33
            Left            =   600
            TabIndex        =   283
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "A"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   32
            Left            =   840
            TabIndex        =   282
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "M"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   31
            Left            =   1080
            TabIndex        =   281
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "J"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   30
            Left            =   1320
            TabIndex        =   280
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "J"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   29
            Left            =   1560
            TabIndex        =   279
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "A"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   28
            Left            =   1800
            TabIndex        =   278
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "S"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   27
            Left            =   2040
            TabIndex        =   277
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "O"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   26
            Left            =   2280
            TabIndex        =   276
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "N"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   25
            Left            =   2520
            TabIndex        =   275
            Top             =   2400
            Width           =   195
         End
         Begin VB.Label Label4 
            Alignment       =   2  'Zentriert
            BackStyle       =   0  'Transparent
            Caption         =   "D"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   24
            Left            =   2760
            TabIndex        =   274
            Top             =   2400
            Width           =   195
         End
      End
      Begin VB.TextBox Text2 
         Height          =   288
         Left            =   7920
         TabIndex        =   213
         Top             =   480
         Width           =   2055
      End
      Begin sevCommand3.Command cmdAnfuegen 
         Height          =   492
         Index           =   2
         Left            =   10080
         TabIndex        =   7
         Top             =   5040
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Auswählen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox Text6 
         Height          =   288
         Left            =   4560
         TabIndex        =   6
         Top             =   120
         Width           =   1335
      End
      Begin VB.TextBox Text7 
         Height          =   288
         Left            =   7920
         TabIndex        =   5
         Top             =   120
         Width           =   2055
      End
      Begin VB.TextBox Text8 
         Height          =   288
         Left            =   2760
         TabIndex        =   4
         Top             =   480
         Width           =   3135
      End
      Begin sevCommand3.Command cmdAnfuegen 
         Height          =   492
         Index           =   0
         Left            =   10080
         TabIndex        =   3
         ToolTipText     =   "Ohne Eingabe erhalten Sie alle  Artikel des Lieferanten."
         Top             =   120
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Suchen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command cmdAnfuegen 
         Height          =   492
         Index           =   1
         Left            =   10080
         TabIndex        =   2
         Top             =   7560
         Width           =   1695
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Zurück"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.ListBox List1 
         BeginProperty Font 
            Name            =   "Courier New"
            Size            =   11.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1335
         Left            =   8640
         MultiSelect     =   2  'Erweitert
         TabIndex        =   469
         Top             =   1560
         Visible         =   0   'False
         Width           =   1935
      End
      Begin VB.CheckBox Check19 
         BackColor       =   &H00C0C000&
         Caption         =   "EX ausblenden"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   120
         TabIndex        =   481
         Top             =   720
         Width           =   1695
      End
      Begin VB.CheckBox Check20 
         BackColor       =   &H00C0C000&
         Caption         =   "noch nie bestellte"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   10080
         TabIndex        =   488
         Top             =   720
         Width           =   1695
      End
      Begin VB.Label Label6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "ArtNr. :"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   357
         Top             =   480
         Visible         =   0   'False
         Width           =   855
      End
      Begin VB.Label Label12 
         Alignment       =   1  'Rechts
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "Liefbestnr :"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   255
         Left            =   6000
         TabIndex        =   214
         Top             =   480
         Width           =   1695
      End
      Begin VB.Label Label6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "ArtNr. :"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   255
         Index           =   4
         Left            =   3000
         TabIndex        =   11
         Top             =   120
         Width           =   1455
      End
      Begin VB.Label Label7 
         Alignment       =   1  'Rechts
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "EAN :"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   255
         Left            =   6720
         TabIndex        =   10
         Top             =   120
         Width           =   975
      End
      Begin VB.Label Label8 
         Alignment       =   1  'Rechts
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "Artikelbez. :"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   255
         Left            =   1080
         TabIndex        =   9
         Top             =   480
         Width           =   1575
      End
      Begin VB.Label Label6 
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "Artikel Anfügen:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   15.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00404000&
         Height          =   375
         Index           =   5
         Left            =   120
         TabIndex        =   8
         Top             =   120
         Width           =   3255
      End
   End
   Begin VB.TextBox txtStatus 
      Height          =   315
      Left            =   4560
      TabIndex        =   262
      Top             =   120
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.PictureBox picprogress 
      BeginProperty Font 
         Name            =   "Arial Narrow"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   5040
      ScaleHeight     =   315
      ScaleWidth      =   6675
      TabIndex        =   261
      Top             =   120
      Visible         =   0   'False
      Width           =   6735
   End
   Begin VB.Frame fra4 
      BackColor       =   &H00C0C0FF&
      Caption         =   "fra4"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   975
      Left            =   120
      TabIndex        =   248
      Top             =   5520
      Visible         =   0   'False
      Width           =   1455
      Begin sevCommand3.Command cmdMittClose 
         Height          =   495
         Left            =   9720
         TabIndex        =   256
         Top             =   6720
         Width           =   1935
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Übernehmen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command cmdMittSave 
         Height          =   495
         Left            =   9720
         TabIndex        =   255
         Top             =   6120
         Width           =   1935
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Speichern"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.TextBox txt2 
         Height          =   2655
         Left            =   4440
         MaxLength       =   250
         MultiLine       =   -1  'True
         TabIndex        =   254
         Top             =   2640
         Width           =   6015
      End
      Begin VB.TextBox Text11 
         Height          =   375
         Left            =   7800
         MaxLength       =   250
         MultiLine       =   -1  'True
         TabIndex        =   253
         Top             =   1680
         Width           =   2655
      End
      Begin sevCommand3.Command Command1 
         Height          =   495
         Index           =   4
         Left            =   240
         TabIndex        =   252
         Top             =   5520
         Width           =   1935
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Löschen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   495
         Index           =   5
         Left            =   2280
         TabIndex        =   251
         Top             =   5520
         Width           =   1935
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Auswählen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.ListBox List5 
         Height          =   3180
         Left            =   240
         TabIndex        =   250
         Top             =   2160
         Width           =   3975
      End
      Begin sevCommand3.Command Command1 
         Height          =   495
         Index           =   6
         Left            =   4440
         TabIndex        =   249
         Top             =   5520
         Width           =   1935
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Leeren"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label6 
         BackColor       =   &H80000001&
         Caption         =   "Kurzmitteilung an Lieferanten (max. 250 Zeichen)"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   375
         Index           =   6
         Left            =   4440
         TabIndex        =   260
         Top             =   2160
         Width           =   6015
      End
      Begin VB.Label Label6 
         Alignment       =   1  'Rechts
         BackColor       =   &H80000001&
         Caption         =   "Kurzbeschreibung"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0C0C0&
         Height          =   255
         Index           =   0
         Left            =   4440
         TabIndex        =   259
         Top             =   1800
         Width           =   3255
      End
      Begin VB.Label Label1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   240
         TabIndex        =   258
         Top             =   6840
         Width           =   9135
      End
      Begin VB.Label Label1 
         Caption         =   "vorhandene Texte"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   6
         Left            =   240
         TabIndex        =   257
         Top             =   1800
         Width           =   2895
      End
   End
   Begin VB.Frame Frame7 
      BackColor       =   &H00FF00FF&
      BorderStyle     =   0  'Kein
      Caption         =   "Bestellvorschlag laden"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   1335
      Left            =   2160
      TabIndex        =   57
      Top             =   7800
      Visible         =   0   'False
      Width           =   1455
      Begin VB.FileListBox File1 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   300
         Left            =   9840
         Pattern         =   "X*.DBF"
         TabIndex        =   62
         Top             =   120
         Visible         =   0   'False
         Width           =   1695
      End
      Begin sevCommand3.Command Command5 
         Height          =   615
         Index           =   0
         Left            =   2880
         TabIndex        =   61
         Top             =   3840
         Width           =   2775
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Laden"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command5 
         Height          =   615
         Index           =   1
         Left            =   5760
         TabIndex        =   60
         Top             =   3840
         Width           =   2775
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Löschen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command5 
         Height          =   615
         Index           =   2
         Left            =   8640
         TabIndex        =   59
         Top             =   3840
         Width           =   2775
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Zurück"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.ListBox List4 
         BeginProperty Font 
            Name            =   "Courier New"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   2940
         Left            =   120
         MultiSelect     =   1  '1 -Einfach
         TabIndex        =   58
         Top             =   720
         Width           =   11295
      End
      Begin VB.Label Label5 
         Alignment       =   2  'Zentriert
         BackColor       =   &H00808000&
         Caption         =   "Vorschlag laden"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00404000&
         Height          =   375
         Left            =   3120
         TabIndex        =   63
         Top             =   120
         Width           =   5415
      End
   End
   Begin VB.Frame Frame5 
      BackColor       =   &H00808000&
      BorderStyle     =   0  'Kein
      Caption         =   "Bestellvorschlag speichern"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   495
      Left            =   720
      TabIndex        =   12
      Top             =   5520
      Visible         =   0   'False
      Width           =   855
      Begin VB.TextBox Text4 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   375
         Left            =   3840
         MaxLength       =   20
         TabIndex        =   237
         Top             =   600
         Width           =   4815
      End
      Begin VB.TextBox Text3 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00800000&
         Height          =   375
         Left            =   1560
         MaxLength       =   7
         TabIndex        =   53
         Text            =   "Text3"
         Top             =   600
         Width           =   1335
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   0
         Left            =   5640
         TabIndex        =   52
         Top             =   1200
         Width           =   1455
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "OK"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command4 
         Height          =   495
         Index           =   1
         Left            =   7200
         TabIndex        =   51
         Top             =   1200
         Width           =   1455
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schließen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Frame Frame6 
         BackColor       =   &H00000000&
         BorderStyle     =   0  'Kein
         ForeColor       =   &H00004000&
         Height          =   3255
         Left            =   120
         TabIndex        =   13
         Top             =   1680
         Width           =   11175
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   16
            Left            =   120
            TabIndex        =   50
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "1"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   17
            Left            =   960
            TabIndex        =   49
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   18
            Left            =   1800
            TabIndex        =   48
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "3"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   19
            Left            =   2640
            TabIndex        =   47
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "4"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   20
            Left            =   3480
            TabIndex        =   46
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "5"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   21
            Left            =   4320
            TabIndex        =   45
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "6"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   22
            Left            =   5160
            TabIndex        =   44
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "7"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   23
            Left            =   6000
            TabIndex        =   43
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "8"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   26
            Left            =   480
            TabIndex        =   42
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Q"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   27
            Left            =   1320
            TabIndex        =   41
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "W"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   28
            Left            =   2160
            TabIndex        =   40
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "E"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   29
            Left            =   3000
            TabIndex        =   39
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "R"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   30
            Left            =   3840
            TabIndex        =   38
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "T"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   31
            Left            =   4680
            TabIndex        =   37
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Z"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   32
            Left            =   5520
            TabIndex        =   36
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "U"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   24
            Left            =   6840
            TabIndex        =   35
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "9"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   25
            Left            =   7680
            TabIndex        =   34
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "0"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   33
            Left            =   6360
            TabIndex        =   33
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "I"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   34
            Left            =   7200
            TabIndex        =   32
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "O"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   35
            Left            =   8040
            TabIndex        =   31
            Top             =   960
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "P"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   36
            Left            =   960
            TabIndex        =   30
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "A"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   37
            Left            =   1800
            TabIndex        =   29
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "S"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   38
            Left            =   2640
            TabIndex        =   28
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "D"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   39
            Left            =   3480
            TabIndex        =   27
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "F"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   40
            Left            =   4320
            TabIndex        =   26
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "G"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   41
            Left            =   5160
            TabIndex        =   25
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "H"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   42
            Left            =   6000
            TabIndex        =   24
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "J"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   43
            Left            =   6840
            TabIndex        =   23
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "K"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   44
            Left            =   7680
            TabIndex        =   22
            Top             =   1680
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "L"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   45
            Left            =   1320
            TabIndex        =   21
            Top             =   2400
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Y"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   46
            Left            =   2160
            TabIndex        =   20
            Top             =   2400
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "X"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   47
            Left            =   3000
            TabIndex        =   19
            Top             =   2400
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "C"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   48
            Left            =   3840
            TabIndex        =   18
            Top             =   2400
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "V"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   49
            Left            =   4680
            TabIndex        =   17
            Top             =   2400
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "B"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   50
            Left            =   5520
            TabIndex        =   16
            Top             =   2400
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "N"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   51
            Left            =   6360
            TabIndex        =   15
            Top             =   2400
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "M"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   735
            Index           =   52
            Left            =   7200
            TabIndex        =   14
            Top             =   2400
            Width           =   2535
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Leeren"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
      End
      Begin VB.Label Label6 
         BackColor       =   &H00808000&
         Caption         =   "Bestellvorschlag speichern"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   15.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00404000&
         Height          =   375
         Index           =   7
         Left            =   1440
         TabIndex        =   139
         Top             =   6600
         Width           =   9855
      End
      Begin VB.Label Label2 
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "Datei-Name:"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   255
         Index           =   7
         Left            =   120
         TabIndex        =   56
         Top             =   720
         Width           =   1095
      End
      Begin VB.Label Label2 
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   ".DBF"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   375
         Index           =   8
         Left            =   2880
         TabIndex        =   55
         Top             =   600
         Width           =   735
      End
      Begin VB.Label Label2 
         Alignment       =   1  'Rechts
         BackColor       =   &H00808000&
         BackStyle       =   0  'Transparent
         Caption         =   "X"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   375
         Index           =   9
         Left            =   1200
         TabIndex        =   54
         Top             =   600
         Width           =   375
      End
   End
   Begin VB.Frame fra0 
      BackColor       =   &H008080FF&
      BorderStyle     =   0  'Kein
      Height          =   10695
      Left            =   1800
      TabIndex        =   64
      Top             =   600
      Visible         =   0   'False
      Width           =   10215
      Begin VB.Frame fra1 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Caption         =   "Basis-Daten"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   975
         Left            =   120
         TabIndex        =   73
         Top             =   120
         Width           =   12225
         Begin VB.TextBox Text9 
            Height          =   195
            Left            =   10080
            TabIndex        =   343
            ToolTipText     =   "Durchsuchen Sie hier die Tabelle nach Artikelnummer, EAN - Code oder nach Lieferantenbestellnummer."
            Top             =   0
            Width           =   855
         End
         Begin sevCommand3.Command Command11 
            Height          =   230
            Left            =   2040
            TabIndex        =   247
            Top             =   240
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Farbe?"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command10 
            Height          =   230
            Left            =   2040
            TabIndex        =   246
            Top             =   0
            Width           =   855
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Spalten?"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command8 
            Height          =   230
            Left            =   960
            TabIndex        =   243
            Top             =   0
            Width           =   1075
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Farbe BVO?"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command6 
            Height          =   230
            Left            =   960
            TabIndex        =   238
            Top             =   240
            Width           =   1075
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "Command6"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin Threed.SSCommand SSCommand1 
            Height          =   220
            Left            =   9000
            TabIndex        =   74
            Top             =   600
            Width           =   1300
            _Version        =   65536
            _ExtentX        =   2293
            _ExtentY        =   388
            _StockProps     =   78
            Caption         =   "Vorschlag > 0"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   220
            Index           =   8
            Left            =   9000
            TabIndex        =   75
            Top             =   360
            Width           =   1300
            _Version        =   65536
            _ExtentX        =   2293
            _ExtentY        =   388
            _StockProps     =   78
            Caption         =   "Artikel Info"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   220
            Index           =   4
            Left            =   10320
            TabIndex        =   76
            Top             =   360
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   388
            _StockProps     =   78
            Caption         =   "Bestell auf 0 "
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   220
            Index           =   10
            Left            =   10320
            TabIndex        =   77
            Top             =   600
            Width           =   1335
            _Version        =   65536
            _ExtentX        =   2355
            _ExtentY        =   388
            _StockProps     =   78
            Caption         =   "Grafik Aus"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   255
            Index           =   3
            Left            =   11040
            TabIndex        =   345
            ToolTipText     =   "Durchsuchen Sie hier die Tabelle nach Artikelnummer, EAN - Code oder nach Lieferantenbestellnummer."
            Top             =   0
            Width           =   615
            _Version        =   65536
            _ExtentX        =   1085
            _ExtentY        =   450
            _StockProps     =   78
            Caption         =   "Suche"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   220
            Index           =   11
            Left            =   8280
            TabIndex        =   367
            ToolTipText     =   "nach Artikelbezeichnung sortieren"
            Top             =   360
            Width           =   700
            _Version        =   65536
            _ExtentX        =   1235
            _ExtentY        =   388
            _StockProps     =   78
            Caption         =   "Sort"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin VB.TextBox Text10 
            Height          =   285
            Left            =   8280
            TabIndex        =   366
            ToolTipText     =   "Geben Sie hier den Anfang der Artikelbezeichnung ein."
            Top             =   0
            Width           =   705
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   225
            Index           =   12
            Left            =   8280
            TabIndex        =   479
            ToolTipText     =   "Möchten Sie Artikel mit gleichen Einkaufspreisen eines bestimmten Lieferanten aus diesem Bestellvorschlag entfernen?"
            Top             =   600
            Width           =   705
            _Version        =   65536
            _ExtentX        =   1235
            _ExtentY        =   388
            _StockProps     =   78
            Caption         =   "= LEK "
            ForeColor       =   49152
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin VB.Label lbl1 
            Alignment       =   1  'Rechts
            BackStyle       =   0  'Transparent
            Caption         =   "Konditionen"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   6
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   8
            Left            =   6120
            TabIndex        =   489
            Top             =   675
            Width           =   975
         End
         Begin VB.Label lbl1 
            BackStyle       =   0  'Transparent
            Caption         =   "F2: Artikelbearbeitung F3: Bestand F4: Notizen F5: Verkäufe F6: Kundenbestellungen"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   6
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   4
            Left            =   120
            TabIndex        =   480
            Top             =   680
            Width           =   5535
         End
         Begin VB.Label lbl1 
            Alignment       =   1  'Rechts
            BackStyle       =   0  'Transparent
            Caption         =   "Artnr/EAN"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   -1  'True
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   3
            Left            =   8760
            MouseIcon       =   "frmWKL43.frx":0442
            MousePointer    =   99  'Benutzerdefiniert
            TabIndex        =   344
            Top             =   0
            Width           =   1215
         End
         Begin VB.Label lbl1 
            Alignment       =   1  'Rechts
            BackStyle       =   0  'Transparent
            Caption         =   "Anz Artikel:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   1
            Left            =   5880
            TabIndex        =   223
            Top             =   240
            Width           =   1335
         End
         Begin VB.Label lbl2 
            BackStyle       =   0  'Transparent
            Caption         =   "Label2"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00FFFFFF&
            Height          =   255
            Index           =   0
            Left            =   7320
            TabIndex        =   222
            Top             =   240
            Width           =   855
         End
         Begin VB.Label lbl5 
            BackColor       =   &H00C0C000&
            Caption         =   "lbl5(5)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00FFFFFF&
            Height          =   255
            Index           =   5
            Left            =   4560
            TabIndex        =   221
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label lbl5 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Lager LEK-Wert ges:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   4
            Left            =   2520
            TabIndex        =   220
            Top             =   480
            Width           =   1935
         End
         Begin VB.Label lbl5 
            BackColor       =   &H00C0C000&
            Caption         =   "lbl5(3)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00FFFFFF&
            Height          =   495
            Index           =   3
            Left            =   4560
            TabIndex        =   142
            Top             =   0
            Width           =   1215
         End
         Begin VB.Label lbl5 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Einkaufsumsatz:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   2
            Left            =   2760
            TabIndex        =   141
            Top             =   0
            Width           =   1695
         End
         Begin VB.Label lbl6 
            BackColor       =   &H00C0C000&
            Caption         =   "Label6"
            Height          =   255
            Index           =   3
            Left            =   1680
            TabIndex        =   87
            Top             =   0
            Visible         =   0   'False
            Width           =   735
         End
         Begin VB.Label lbl6 
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   2
            Left            =   2400
            TabIndex        =   86
            Top             =   0
            Visible         =   0   'False
            Width           =   735
         End
         Begin VB.Label lbl6 
            BackColor       =   &H00C0C000&
            Caption         =   "Label6"
            Height          =   255
            Index           =   1
            Left            =   840
            TabIndex        =   85
            Top             =   0
            Visible         =   0   'False
            Width           =   735
         End
         Begin VB.Label lbl6 
            BackColor       =   &H00C0C000&
            Caption         =   "Label6"
            Height          =   255
            Index           =   0
            Left            =   0
            TabIndex        =   84
            Top             =   0
            Visible         =   0   'False
            Width           =   735
         End
         Begin VB.Label lbl2 
            BackStyle       =   0  'Transparent
            Caption         =   "Label2"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   -1  'True
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00FFFFFF&
            Height          =   255
            Index           =   3
            Left            =   120
            MouseIcon       =   "frmWKL43.frx":074C
            MousePointer    =   99  'Benutzerdefiniert
            TabIndex        =   83
            Top             =   480
            Width           =   3375
         End
         Begin VB.Label lbl2 
            BackStyle       =   0  'Transparent
            Caption         =   "Label2"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00FFFFFF&
            Height          =   255
            Index           =   1
            Left            =   7320
            TabIndex        =   82
            Top             =   480
            Width           =   1215
         End
         Begin VB.Label lbl1 
            Alignment       =   1  'Rechts
            BackStyle       =   0  'Transparent
            Caption         =   "Bestellwert:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   2
            Left            =   6000
            TabIndex        =   81
            Top             =   480
            Width           =   1215
         End
         Begin VB.Label lbl1 
            BackStyle       =   0  'Transparent
            Caption         =   "Lieferant:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   0
            Left            =   120
            TabIndex        =   80
            Top             =   240
            Width           =   975
         End
         Begin VB.Label lbl5 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Auftragswert:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   0
            Left            =   6000
            TabIndex        =   79
            Top             =   0
            Width           =   1215
         End
         Begin VB.Label lbl5 
            BackColor       =   &H00C0C000&
            Caption         =   "lbl5(1)"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00FFFFFF&
            Height          =   255
            Index           =   1
            Left            =   7320
            TabIndex        =   78
            Top             =   0
            Width           =   1215
         End
      End
      Begin VB.Frame fra5 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Caption         =   "Artikel INFO : "
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   2415
         Left            =   600
         TabIndex        =   143
         Top             =   4320
         Width           =   8145
         Begin VB.ListBox List7 
            BeginProperty Font 
               Name            =   "Courier New"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   900
            Left            =   2160
            TabIndex        =   461
            Top             =   1560
            Width           =   2055
         End
         Begin VB.Frame Frame11 
            BackColor       =   &H00008000&
            BorderStyle     =   0  'Kein
            Height          =   3135
            Left            =   5520
            TabIndex        =   368
            Top             =   -1800
            Visible         =   0   'False
            Width           =   6855
            Begin sevCommand3.Command Command2 
               Height          =   330
               Index           =   4
               Left            =   120
               TabIndex        =   370
               Top             =   120
               Visible         =   0   'False
               Width           =   375
               _ExtentX        =   0
               _ExtentY        =   0
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BackColorDisabled=   15398133
               BackColorFrom   =   16514300
               BackColorTo     =   15462640
               BackColorCheckedFrom=   15462640
               BackColorCheckedTo=   16514300
               BackColorDownFrom=   12700881
               BackColorDownTo =   15659506
               BackColorHoverFrom=   16514300
               BackColorHoverTo=   15462640
               BorderColor     =   7617536
               BorderColorDisabled=   12240841
               BorderColorFocus=   14986635
               BorderColorHover=   3913721
               ForeColorDisabled=   9609633
               MenuBackColor   =   16448250
               MenuBackColorChecked=   7323903
               MenuBackColorHover=   10935807
               MenuBorderColor =   8388608
               MenuCheckMarkColorFrom=   16514300
               MenuCheckMarkColorTo=   15462640
               MenuForeColor   =   -2147483640
               MenuForeColorHover=   -2147483640
               ButtonStyle     =   2
               Caption         =   "-"
               PictureAlign    =   2
               PictureVisible  =   0   'False
               Version3        =   -1  'True
            End
            Begin sevCommand3.Command Command12 
               Height          =   330
               Left            =   6240
               TabIndex        =   369
               Top             =   120
               Visible         =   0   'False
               Width           =   375
               _ExtentX        =   0
               _ExtentY        =   0
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BackColorDisabled=   15398133
               BackColorFrom   =   16514300
               BackColorTo     =   15462640
               BackColorCheckedFrom=   15462640
               BackColorCheckedTo=   16514300
               BackColorDownFrom=   12700881
               BackColorDownTo =   15659506
               BackColorHoverFrom=   16514300
               BackColorHoverTo=   15462640
               BorderColor     =   7617536
               BorderColorDisabled=   12240841
               BorderColorFocus=   14986635
               BorderColorHover=   3913721
               ForeColorDisabled=   9609633
               MenuBackColor   =   16448250
               MenuBackColorChecked=   7323903
               MenuBackColorHover=   10935807
               MenuBorderColor =   8388608
               MenuCheckMarkColorFrom=   16514300
               MenuCheckMarkColorTo=   15462640
               MenuForeColor   =   -2147483640
               MenuForeColorHover=   -2147483640
               ButtonStyle     =   2
               Caption         =   "+"
               PictureAlign    =   2
               PictureVisible  =   0   'False
               Version3        =   -1  'True
            End
            Begin VB.Line Line2 
               X1              =   4400
               X2              =   4400
               Y1              =   2640
               Y2              =   720
            End
            Begin VB.Line Line1 
               X1              =   2240
               X2              =   2240
               Y1              =   2640
               Y2              =   720
            End
            Begin VB.Label Label9 
               Alignment       =   1  'Rechts
               BackColor       =   &H00C0C000&
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   4
               Left            =   2880
               TabIndex        =   448
               Top             =   2640
               Width           =   1140
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   0
               Left            =   120
               TabIndex        =   447
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackColor       =   &H0000FFFF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   35
               Left            =   6420
               TabIndex        =   446
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   28
               Left            =   5160
               TabIndex        =   445
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   24
               Left            =   4440
               TabIndex        =   444
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   25
               Left            =   4620
               TabIndex        =   443
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   26
               Left            =   4800
               TabIndex        =   442
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   27
               Left            =   4980
               TabIndex        =   441
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   29
               Left            =   5340
               TabIndex        =   440
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   30
               Left            =   5520
               TabIndex        =   439
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   31
               Left            =   5700
               TabIndex        =   438
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   32
               Left            =   5880
               TabIndex        =   437
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   33
               Left            =   6060
               TabIndex        =   436
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   34
               Left            =   6240
               TabIndex        =   435
               Top             =   2040
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   24
               Left            =   4440
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   25
               Left            =   4620
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   26
               Left            =   4800
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   27
               Left            =   4980
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   28
               Left            =   5160
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   29
               Left            =   5340
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   30
               Left            =   5520
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   31
               Left            =   5700
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   32
               Left            =   5880
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   33
               Left            =   6060
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   34
               Left            =   6240
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   35
               Left            =   6420
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   83
               Left            =   4440
               TabIndex        =   434
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "F"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   82
               Left            =   4620
               TabIndex        =   433
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   81
               Left            =   4800
               TabIndex        =   432
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   80
               Left            =   4980
               TabIndex        =   431
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   79
               Left            =   5160
               TabIndex        =   430
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   78
               Left            =   5340
               TabIndex        =   429
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   77
               Left            =   5520
               TabIndex        =   428
               Top             =   2400
               Width           =   135
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   76
               Left            =   5700
               TabIndex        =   427
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "S"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   75
               Left            =   5880
               TabIndex        =   426
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "O"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   74
               Left            =   6060
               TabIndex        =   425
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "N"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   73
               Left            =   6240
               TabIndex        =   424
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "D"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   72
               Left            =   6420
               TabIndex        =   423
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackColor       =   &H0000FFFF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   23
               Left            =   4260
               TabIndex        =   422
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   16
               Left            =   3000
               TabIndex        =   421
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   12
               Left            =   2280
               TabIndex        =   420
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   13
               Left            =   2460
               TabIndex        =   419
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   14
               Left            =   2640
               TabIndex        =   418
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   15
               Left            =   2820
               TabIndex        =   417
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   17
               Left            =   3180
               TabIndex        =   416
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   18
               Left            =   3360
               TabIndex        =   415
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   19
               Left            =   3540
               TabIndex        =   414
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   20
               Left            =   3720
               TabIndex        =   413
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   21
               Left            =   3900
               TabIndex        =   412
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   22
               Left            =   4080
               TabIndex        =   411
               Top             =   2040
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   12
               Left            =   2280
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   13
               Left            =   2460
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   14
               Left            =   2640
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   15
               Left            =   2820
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   16
               Left            =   3000
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   17
               Left            =   3180
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   18
               Left            =   3360
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   19
               Left            =   3540
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   20
               Left            =   3720
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   21
               Left            =   3900
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   22
               Left            =   4080
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   23
               Left            =   4260
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   59
               Left            =   2280
               TabIndex        =   410
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "F"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   58
               Left            =   2460
               TabIndex        =   409
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   57
               Left            =   2640
               TabIndex        =   408
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   56
               Left            =   2820
               TabIndex        =   407
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   55
               Left            =   3000
               TabIndex        =   406
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   54
               Left            =   3180
               TabIndex        =   405
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   53
               Left            =   3360
               TabIndex        =   404
               Top             =   2400
               Width           =   135
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   52
               Left            =   3540
               TabIndex        =   403
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "S"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   51
               Left            =   3720
               TabIndex        =   402
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "O"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   50
               Left            =   3900
               TabIndex        =   401
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "N"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   49
               Left            =   4080
               TabIndex        =   400
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "D"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   48
               Left            =   4260
               TabIndex        =   399
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "D"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   71
               Left            =   2100
               TabIndex        =   397
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "N"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   70
               Left            =   1920
               TabIndex        =   396
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "O"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   69
               Left            =   1740
               TabIndex        =   395
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "S"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   68
               Left            =   1560
               TabIndex        =   394
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   67
               Left            =   1380
               TabIndex        =   393
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   66
               Left            =   1200
               TabIndex        =   392
               Top             =   2400
               Width           =   135
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   65
               Left            =   1020
               TabIndex        =   391
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   64
               Left            =   840
               TabIndex        =   390
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   63
               Left            =   660
               TabIndex        =   389
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   62
               Left            =   480
               TabIndex        =   388
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "F"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   61
               Left            =   300
               TabIndex        =   387
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   9
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   60
               Left            =   120
               TabIndex        =   386
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   11
               Left            =   2100
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   10
               Left            =   1920
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   9
               Left            =   1740
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   8
               Left            =   1560
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   7
               Left            =   1380
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   6
               Left            =   1200
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   5
               Left            =   1020
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   4
               Left            =   840
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   3
               Left            =   660
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   2
               Left            =   480
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   1
               Left            =   300
               Top             =   2400
               Width           =   120
            End
            Begin VB.Shape Shape3 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   0
               Left            =   120
               Top             =   2400
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   10
               Left            =   1920
               TabIndex        =   385
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   9
               Left            =   1740
               TabIndex        =   384
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   8
               Left            =   1560
               TabIndex        =   383
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   7
               Left            =   1380
               TabIndex        =   382
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   6
               Left            =   1200
               TabIndex        =   381
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   5
               Left            =   1020
               TabIndex        =   380
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   3
               Left            =   660
               TabIndex        =   379
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   2
               Left            =   480
               TabIndex        =   378
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   1
               Left            =   300
               TabIndex        =   377
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   38
               Left            =   480
               TabIndex        =   376
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   4
               Left            =   840
               TabIndex        =   375
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label30 
               Alignment       =   2  'Zentriert
               BackColor       =   &H0000FFFF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   6
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   11
               Left            =   2100
               TabIndex        =   374
               Top             =   2040
               Width           =   120
            End
            Begin VB.Label Label9 
               BackColor       =   &H00C0C000&
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   3
               Left            =   720
               TabIndex        =   373
               Top             =   2640
               Width           =   1065
            End
            Begin VB.Label Label9 
               Alignment       =   1  'Rechts
               BackColor       =   &H00C0C000&
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   5
               Left            =   5040
               TabIndex        =   372
               Top             =   2640
               Width           =   1140
            End
            Begin VB.Label Label17 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "Verkaufszahlen (Menge in Stück)"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H0000FFFF&
               Height          =   255
               Left            =   720
               TabIndex        =   371
               Top             =   120
               Width           =   5175
            End
         End
         Begin VB.Frame Frame2 
            BackColor       =   &H00C0C000&
            BorderStyle     =   0  'Kein
            Height          =   3015
            Left            =   4320
            TabIndex        =   161
            Top             =   120
            Visible         =   0   'False
            Width           =   7095
            Begin sevCommand3.Command Command3 
               Height          =   330
               Left            =   6240
               TabIndex        =   230
               Top             =   120
               Width           =   375
               _ExtentX        =   0
               _ExtentY        =   0
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BackColorDisabled=   15398133
               BackColorFrom   =   16514300
               BackColorTo     =   15462640
               BackColorCheckedFrom=   15462640
               BackColorCheckedTo=   16514300
               BackColorDownFrom=   12700881
               BackColorDownTo =   15659506
               BackColorHoverFrom=   16514300
               BackColorHoverTo=   15462640
               BorderColor     =   7617536
               BorderColorDisabled=   12240841
               BorderColorFocus=   14986635
               BorderColorHover=   3913721
               ForeColorDisabled=   9609633
               MenuBackColor   =   16448250
               MenuBackColorChecked=   7323903
               MenuBackColorHover=   10935807
               MenuBorderColor =   8388608
               MenuCheckMarkColorFrom=   16514300
               MenuCheckMarkColorTo=   15462640
               MenuForeColor   =   -2147483640
               MenuForeColorHover=   -2147483640
               ButtonStyle     =   2
               Caption         =   "+"
               PictureAlign    =   2
               PictureVisible  =   0   'False
               Version3        =   -1  'True
            End
            Begin sevCommand3.Command Command2 
               Height          =   330
               Index           =   0
               Left            =   120
               TabIndex        =   229
               Top             =   120
               Width           =   375
               _ExtentX        =   0
               _ExtentY        =   0
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "Arial"
                  Size            =   14.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               BackColorDisabled=   15398133
               BackColorFrom   =   16514300
               BackColorTo     =   15462640
               BackColorCheckedFrom=   15462640
               BackColorCheckedTo=   16514300
               BackColorDownFrom=   12700881
               BackColorDownTo =   15659506
               BackColorHoverFrom=   16514300
               BackColorHoverTo=   15462640
               BorderColor     =   7617536
               BorderColorDisabled=   12240841
               BorderColorFocus=   14986635
               BorderColorHover=   3913721
               ForeColorDisabled=   9609633
               MenuBackColor   =   16448250
               MenuBackColorChecked=   7323903
               MenuBackColorHover=   10935807
               MenuBorderColor =   8388608
               MenuCheckMarkColorFrom=   16514300
               MenuCheckMarkColorTo=   15462640
               MenuForeColor   =   -2147483640
               MenuForeColorHover=   -2147483640
               ButtonStyle     =   2
               Caption         =   "-"
               PictureAlign    =   2
               PictureVisible  =   0   'False
               Version3        =   -1  'True
            End
            Begin VB.Label Label11 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "Verkaufszahlen (Menge in Stück)"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H0000FFFF&
               Height          =   255
               Left            =   720
               TabIndex        =   212
               Top             =   120
               Width           =   5175
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   23
               Left            =   6360
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   22
               Left            =   6120
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   21
               Left            =   5880
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   20
               Left            =   5640
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   19
               Left            =   5400
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   18
               Left            =   5160
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   17
               Left            =   4920
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   16
               Left            =   4680
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   15
               Left            =   4440
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   14
               Left            =   4200
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   13
               Left            =   3960
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   12
               Left            =   3720
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "D"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   23
               Left            =   6360
               TabIndex        =   211
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "N"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   22
               Left            =   6120
               TabIndex        =   210
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "O"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   21
               Left            =   5880
               TabIndex        =   209
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "S"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   20
               Left            =   5640
               TabIndex        =   208
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   19
               Left            =   5400
               TabIndex        =   207
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   18
               Left            =   5160
               TabIndex        =   206
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   17
               Left            =   4920
               TabIndex        =   205
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   16
               Left            =   4680
               TabIndex        =   204
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   15
               Left            =   4440
               TabIndex        =   203
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   14
               Left            =   4200
               TabIndex        =   202
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "F"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   13
               Left            =   3960
               TabIndex        =   201
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   12
               Left            =   3720
               TabIndex        =   200
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   23
               Left            =   6360
               TabIndex        =   199
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   22
               Left            =   6120
               TabIndex        =   198
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   21
               Left            =   5880
               TabIndex        =   197
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   20
               Left            =   5640
               TabIndex        =   196
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   19
               Left            =   5400
               TabIndex        =   195
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   18
               Left            =   5160
               TabIndex        =   194
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   17
               Left            =   4920
               TabIndex        =   193
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   16
               Left            =   4680
               TabIndex        =   192
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   15
               Left            =   4440
               TabIndex        =   191
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   14
               Left            =   4200
               TabIndex        =   190
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   13
               Left            =   3960
               TabIndex        =   189
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H00C0E0FF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   12
               Left            =   3720
               TabIndex        =   188
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label9 
               Alignment       =   1  'Rechts
               BackColor       =   &H00C0C000&
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   50
               Left            =   4800
               TabIndex        =   187
               Top             =   2640
               Width           =   780
            End
            Begin VB.Label Label9 
               BackColor       =   &H00C0C000&
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   49
               Left            =   1200
               TabIndex        =   186
               Top             =   2640
               Width           =   825
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackColor       =   &H0000FFFF&
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   11
               Left            =   2760
               TabIndex        =   174
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   4
               Left            =   1080
               TabIndex        =   181
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   0
               Left            =   120
               TabIndex        =   185
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   1
               Left            =   360
               TabIndex        =   184
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   2
               Left            =   600
               TabIndex        =   183
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   3
               Left            =   840
               TabIndex        =   182
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   5
               Left            =   1320
               TabIndex        =   180
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   6
               Left            =   1560
               TabIndex        =   179
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   7
               Left            =   1800
               TabIndex        =   178
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   8
               Left            =   2040
               TabIndex        =   177
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   9
               Left            =   2280
               TabIndex        =   176
               Top             =   2040
               Width           =   195
            End
            Begin VB.Label Label10 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   8.25
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   10
               Left            =   2520
               TabIndex        =   175
               Top             =   2040
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   0
               Left            =   120
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   1
               Left            =   360
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   2
               Left            =   600
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   3
               Left            =   840
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   4
               Left            =   1080
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   5
               Left            =   1320
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   6
               Left            =   1560
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   7
               Left            =   1800
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   8
               Left            =   2040
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   9
               Left            =   2280
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   10
               Left            =   2520
               Top             =   2400
               Width           =   195
            End
            Begin VB.Shape Shape1 
               FillColor       =   &H0000FFFF&
               FillStyle       =   0  'Ausgefüllt
               Height          =   15
               Index           =   11
               Left            =   2760
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   0
               Left            =   120
               TabIndex        =   173
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "F"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   1
               Left            =   360
               TabIndex        =   172
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   2
               Left            =   600
               TabIndex        =   171
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   3
               Left            =   840
               TabIndex        =   170
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "M"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   4
               Left            =   1080
               TabIndex        =   169
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   5
               Left            =   1320
               TabIndex        =   168
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "J"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   6
               Left            =   1560
               TabIndex        =   167
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "A"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   7
               Left            =   1800
               TabIndex        =   166
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "S"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   8
               Left            =   2040
               TabIndex        =   165
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "O"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   9
               Left            =   2280
               TabIndex        =   164
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "N"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   10
               Left            =   2520
               TabIndex        =   163
               Top             =   2400
               Width           =   195
            End
            Begin VB.Label Label4 
               Alignment       =   2  'Zentriert
               BackStyle       =   0  'Transparent
               Caption         =   "D"
               BeginProperty Font 
                  Name            =   "Arial"
                  Size            =   12
                  Charset         =   0
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   11
               Left            =   2760
               TabIndex        =   162
               Top             =   2400
               Width           =   195
            End
         End
         Begin VB.Label lbl6 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0C000&
            Caption         =   "l. WE"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   42
            Left            =   2280
            TabIndex        =   355
            Top             =   1320
            Width           =   1215
         End
         Begin VB.Label lbl6 
            BackColor       =   &H00FFFFC0&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   41
            Left            =   1200
            TabIndex        =   348
            Top             =   2640
            Width           =   495
         End
         Begin VB.Label Label3 
            BackColor       =   &H00C0C000&
            Caption         =   "keine:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H000000FF&
            Height          =   255
            Index           =   2
            Left            =   120
            TabIndex        =   224
            Top             =   3120
            Visible         =   0   'False
            Width           =   8535
         End
         Begin VB.Label lbl3 
            BackColor       =   &H00C0C000&
            Caption         =   "ArtNr  : "
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   252
            Left            =   120
            TabIndex        =   160
            Top             =   240
            Width           =   2532
         End
         Begin VB.Label lbl4 
            BackColor       =   &H00C0C000&
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   735
            Left            =   120
            TabIndex        =   159
            Top             =   480
            Width           =   3375
         End
         Begin VB.Label Label9 
            BackColor       =   &H00C0C000&
            Caption         =   "De"
            Height          =   255
            Index           =   12
            Left            =   2.45745e5
            TabIndex        =   158
            Top             =   2640
            Width           =   300
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Bestand"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   4
            Left            =   120
            TabIndex        =   157
            Top             =   1440
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKAM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   5
            Left            =   120
            TabIndex        =   156
            Top             =   1680
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKVM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   6
            Left            =   120
            TabIndex        =   155
            Top             =   1920
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKLJ"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   7
            Left            =   120
            TabIndex        =   154
            Top             =   2160
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "VKVJ"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   8
            Left            =   120
            TabIndex        =   153
            Top             =   2400
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   9
            Left            =   1080
            TabIndex        =   152
            Top             =   1440
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   10
            Left            =   1080
            TabIndex        =   151
            Top             =   1680
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   11
            Left            =   1080
            TabIndex        =   150
            Top             =   1920
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   12
            Left            =   1080
            TabIndex        =   149
            Top             =   2160
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   13
            Left            =   1080
            TabIndex        =   148
            Top             =   2400
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Filiale"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   14
            Left            =   120
            TabIndex        =   147
            Top             =   1200
            Width           =   735
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Height          =   255
            Index           =   15
            Left            =   1080
            TabIndex        =   146
            Top             =   1200
            Width           =   735
         End
         Begin VB.Label Label3 
            BackColor       =   &H00C0C000&
            Caption         =   "keine:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   0
            Left            =   120
            TabIndex        =   145
            Top             =   2880
            Width           =   3375
         End
         Begin VB.Label Label3 
            BackColor       =   &H00C0C000&
            Caption         =   "Notizen:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   255
            Index           =   1
            Left            =   120
            TabIndex        =   144
            Top             =   2640
            Width           =   975
         End
      End
      Begin MSFlexGridLib.MSFlexGrid MSFlexGrid2 
         Height          =   3135
         Left            =   120
         TabIndex        =   88
         Top             =   1080
         Width           =   11625
         _ExtentX        =   20505
         _ExtentY        =   5530
         _Version        =   393216
         Cols            =   23
         FixedCols       =   0
         BackColor       =   16777215
         BackColorSel    =   8404992
         ForeColorSel    =   65535
         AllowBigSelection=   0   'False
         FocusRect       =   0
         HighLight       =   2
         GridLines       =   3
         GridLinesFixed  =   3
         AllowUserResizing=   1
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
      End
      Begin VB.Frame fra2 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Height          =   1400
         Left            =   0
         TabIndex        =   65
         Top             =   7440
         Width           =   11750
         Begin VB.TextBox Text13 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   6960
            MaxLength       =   10
            TabIndex        =   454
            Top             =   720
            Width           =   1095
         End
         Begin VB.TextBox Text5 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   6960
            MaxLength       =   10
            TabIndex        =   269
            Top             =   360
            Width           =   1095
         End
         Begin VB.CheckBox Check7 
            BackColor       =   &H00C0C000&
            Caption         =   "Email mit Druck"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   4080
            TabIndex        =   268
            Top             =   720
            Width           =   1575
         End
         Begin VB.TextBox Text12 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   6960
            MaxLength       =   6
            TabIndex        =   266
            Top             =   0
            Width           =   1095
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   450
            Index           =   9
            Left            =   9840
            TabIndex        =   66
            Top             =   0
            Width           =   1215
            _Version        =   65536
            _ExtentX        =   2143
            _ExtentY        =   794
            _StockProps     =   78
            Caption         =   "Anfügen"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   495
            Index           =   6
            Left            =   240
            TabIndex        =   67
            Top             =   480
            Width           =   2010
            _Version        =   65536
            _ExtentX        =   3545
            _ExtentY        =   873
            _StockProps     =   78
            Caption         =   "Zwischenspeichern"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   495
            Index           =   2
            Left            =   2280
            TabIndex        =   68
            Top             =   480
            Width           =   1695
            _Version        =   65536
            _ExtentX        =   2990
            _ExtentY        =   873
            _StockProps     =   78
            Caption         =   "als Email"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   450
            Index           =   1
            Left            =   8640
            TabIndex        =   69
            Top             =   0
            Width           =   1170
            _Version        =   65536
            _ExtentX        =   2064
            _ExtentY        =   794
            _StockProps     =   78
            Caption         =   "Speichern"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   495
            Index           =   0
            Left            =   9840
            TabIndex        =   70
            Top             =   480
            Width           =   1215
            _Version        =   65536
            _ExtentX        =   2143
            _ExtentY        =   873
            _StockProps     =   78
            Caption         =   "Schließen"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   450
            Index           =   7
            Left            =   240
            TabIndex        =   71
            Top             =   0
            Width           =   2010
            _Version        =   65536
            _ExtentX        =   3545
            _ExtentY        =   794
            _StockProps     =   78
            Caption         =   "Vorschlag drucken"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin Threed.SSCommand SSCommand2 
            Height          =   495
            Index           =   5
            Left            =   8640
            TabIndex        =   72
            Top             =   480
            Width           =   1170
            _Version        =   65536
            _ExtentX        =   2064
            _ExtentY        =   873
            _StockProps     =   78
            Caption         =   "Mitteilung "
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BevelWidth      =   1
         End
         Begin VB.CheckBox Check5 
            Alignment       =   1  'Rechts ausgerichtet
            BackColor       =   &H00C0C000&
            Caption         =   "Druck mit Notizen"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   2280
            TabIndex        =   264
            Top             =   60
            Width           =   1695
         End
         Begin sevCommand3.Command Command2 
            Height          =   420
            Index           =   2
            Left            =   8160
            TabIndex        =   460
            ToolTipText     =   "Kalender"
            Top             =   280
            Width           =   405
            _ExtentX        =   714
            _ExtentY        =   741
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            AlwaysShowPopUp =   -1  'True
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ToolTip         =   "Wählen Sie hier das Datum aus."
            ToolTipTitle    =   "Kalender"
            ButtonStyle     =   2
            Caption         =   ""
            PictureAlign    =   3
            Version3        =   -1  'True
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Dealer Number:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   44
            Left            =   5640
            TabIndex        =   455
            Top             =   720
            Width           =   1335
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "Lieferdatum:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   27
            Left            =   5760
            TabIndex        =   270
            Top             =   360
            Width           =   1215
         End
         Begin VB.Label lbl6 
            Alignment       =   1  'Rechts
            BackColor       =   &H00C0C000&
            Caption         =   "AuftragsNr.:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   26
            Left            =   5880
            TabIndex        =   267
            Top             =   0
            Width           =   1095
         End
      End
      Begin VB.Label Label3 
         BackColor       =   &H00C0C000&
         Caption         =   "keine:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   255
         Index           =   5
         Left            =   240
         TabIndex        =   365
         Top             =   6960
         Visible         =   0   'False
         Width           =   8535
      End
      Begin VB.Label lbl6 
         BackColor       =   &H00FFFFC0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   40
         Left            =   5160
         TabIndex        =   347
         Top             =   7200
         Width           =   495
      End
      Begin VB.Label lbl6 
         BackColor       =   &H00C0C000&
         Height          =   255
         Index           =   25
         Left            =   1080
         TabIndex        =   236
         Top             =   7200
         Width           =   4095
      End
      Begin VB.Label lbl6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "Artikel:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   24
         Left            =   240
         TabIndex        =   235
         Top             =   7200
         Width           =   735
      End
      Begin VB.Label lbl6 
         BackColor       =   &H00C0C000&
         Height          =   255
         Index           =   23
         Left            =   7920
         TabIndex        =   234
         Top             =   7200
         Width           =   615
      End
      Begin VB.Label lbl6 
         BackColor       =   &H00C0C000&
         Height          =   255
         Index           =   22
         Left            =   6360
         TabIndex        =   233
         Top             =   7200
         Width           =   615
      End
      Begin VB.Label lbl6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "VKVM"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   21
         Left            =   7200
         TabIndex        =   232
         Top             =   7200
         Width           =   615
      End
      Begin VB.Label lbl6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "VKAM"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   20
         Left            =   5640
         TabIndex        =   231
         Top             =   7200
         Width           =   615
      End
      Begin VB.Label lbl6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "VKLJ"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   16
         Left            =   8520
         TabIndex        =   228
         Top             =   7200
         Width           =   615
      End
      Begin VB.Label lbl6 
         BackColor       =   &H00C0C000&
         Height          =   255
         Index           =   17
         Left            =   9240
         TabIndex        =   227
         Top             =   7200
         Width           =   615
      End
      Begin VB.Label lbl6 
         Alignment       =   1  'Rechts
         BackColor       =   &H00C0C000&
         Caption         =   "VKVJ"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Index           =   18
         Left            =   9840
         TabIndex        =   226
         Top             =   7200
         Width           =   615
      End
      Begin VB.Label lbl6 
         BackColor       =   &H00C0C000&
         Height          =   255
         Index           =   19
         Left            =   10560
         TabIndex        =   225
         Top             =   7200
         Width           =   615
      End
   End
   Begin VB.Frame Frame1 
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   0  'Kein
      Height          =   5475
      Left            =   240
      TabIndex        =   89
      Top             =   1440
      Width           =   15255
      Begin sevCommand3.Command Command5 
         Height          =   375
         Index           =   5
         Left            =   10680
         TabIndex        =   452
         Top             =   1560
         Width           =   975
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Import"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command5 
         Height          =   240
         Index           =   4
         Left            =   9840
         TabIndex        =   450
         Top             =   2040
         Visible         =   0   'False
         Width           =   1815
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "unbestellbare"
         PictureAlign    =   2
         Version3        =   -1  'True
      End
      Begin VB.Frame Frame0 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Height          =   1455
         Left            =   120
         TabIndex        =   90
         Top             =   5760
         Width           =   11772
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   0
            Left            =   120
            TabIndex        =   107
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "1"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   1
            Left            =   1080
            TabIndex        =   106
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   2
            Left            =   2040
            TabIndex        =   105
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "3"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   3
            Left            =   3000
            TabIndex        =   104
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "4"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   4
            Left            =   3960
            TabIndex        =   103
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "5"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   5
            Left            =   4920
            TabIndex        =   102
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "6"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   6
            Left            =   5880
            TabIndex        =   101
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "7"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   7
            Left            =   6840
            TabIndex        =   100
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "8"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   8
            Left            =   7800
            TabIndex        =   99
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "9"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   9
            Left            =   8760
            TabIndex        =   98
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "0"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   10
            Left            =   9720
            TabIndex        =   97
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "<"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   11
            Left            =   10680
            TabIndex        =   96
            Top             =   120
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "C"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   53
            Left            =   9720
            TabIndex        =   95
            Top             =   720
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   ","
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   15
            Left            =   10680
            TabIndex        =   94
            Top             =   720
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "."
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   13
            Left            =   3960
            TabIndex        =   93
            Top             =   720
            Width           =   1935
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "<<<"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   14
            Left            =   5880
            TabIndex        =   92
            Top             =   720
            Width           =   1935
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   ">>>"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   615
            Index           =   12
            Left            =   120
            TabIndex        =   91
            Top             =   720
            Width           =   975
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   14.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "F2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.Label Label0 
            BackColor       =   &H00C0C000&
            Height          =   375
            Index           =   1
            Left            =   2040
            TabIndex        =   109
            Top             =   1800
            Visible         =   0   'False
            Width           =   3735
         End
         Begin VB.Label Label0 
            BackColor       =   &H00C0C000&
            Height          =   375
            Index           =   0
            Left            =   1200
            TabIndex        =   108
            Top             =   960
            Visible         =   0   'False
            Width           =   2415
         End
      End
      Begin sevCommand3.Command Command5 
         Height          =   375
         Index           =   3
         Left            =   9840
         TabIndex        =   356
         Top             =   1560
         Width           =   735
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Mde"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   300
         Index           =   7
         Left            =   9840
         TabIndex        =   351
         Top             =   3360
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   529
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "alle Lieferanten"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.CheckBox Check6 
         BackColor       =   &H00C0C000&
         Caption         =   "ohne Berechnung (schnell)"
         Height          =   375
         Left            =   9840
         TabIndex        =   265
         Top             =   2400
         Width           =   1815
      End
      Begin sevCommand3.Command Command9 
         Height          =   255
         Left            =   11280
         TabIndex        =   245
         Top             =   360
         Visible         =   0   'False
         Width           =   375
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.CheckBox Check4 
         Caption         =   "auf Konditionsvorgaben auffüllen bei BVO von :"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   6000
         TabIndex        =   244
         Top             =   360
         Visible         =   0   'False
         Width           =   5175
      End
      Begin sevCommand3.Command Command7 
         Height          =   255
         Left            =   11280
         TabIndex        =   242
         Top             =   0
         Visible         =   0   'False
         Width           =   375
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "F2"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.CheckBox Check3 
         Caption         =   "offene Kundenbestellungen berücksichtigen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   6000
         TabIndex        =   241
         Top             =   0
         Visible         =   0   'False
         Width           =   4935
      End
      Begin VB.ComboBox Combo1 
         Height          =   315
         Left            =   10440
         Style           =   2  'Dropdown-Liste
         TabIndex        =   240
         Top             =   720
         Visible         =   0   'False
         Width           =   1215
      End
      Begin sevCommand3.Command Command1 
         Height          =   375
         Index           =   0
         Left            =   9840
         TabIndex        =   137
         Top             =   2880
         Width           =   1815
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Ermitteln"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   375
         Index           =   1
         Left            =   9840
         TabIndex        =   136
         Top             =   4800
         Width           =   1815
         _ExtentX        =   0
         _ExtentY        =   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Schließen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin sevCommand3.Command Command1 
         Height          =   300
         Index           =   2
         Left            =   9840
         TabIndex        =   135
         Top             =   3720
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   529
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Laden"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Frame Frame9 
         BackColor       =   &H00C0C000&
         Caption         =   "Berechnung nach Wochen und Vormonat :"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   4092
         Left            =   120
         TabIndex        =   118
         Top             =   1080
         Width           =   9495
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   360
            Index           =   8
            Left            =   2760
            MaxLength       =   5
            TabIndex        =   465
            Text            =   "Text1"
            Top             =   1920
            Width           =   735
         End
         Begin sevCommand3.Command Command0 
            Height          =   360
            Index           =   56
            Left            =   8520
            TabIndex        =   364
            Top             =   480
            Width           =   375
            _ExtentX        =   661
            _ExtentY        =   635
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "F2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.ListBox List6 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   900
            Left            =   7320
            MultiSelect     =   2  'Erweitert
            TabIndex        =   363
            Top             =   480
            Width           =   1095
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   225
            Index           =   7
            Left            =   5760
            MaxLength       =   6
            TabIndex        =   354
            Top             =   480
            Visible         =   0   'False
            Width           =   975
         End
         Begin VB.CheckBox Check10 
            BackColor       =   &H00C0C000&
            Caption         =   "A. ausblenden, wenn woanders günstiger"
            Height          =   255
            Left            =   3600
            TabIndex        =   352
            Top             =   240
            Width           =   3615
         End
         Begin VB.CheckBox Check9 
            BackColor       =   &H00C0C000&
            Caption         =   "aber Artikel mit Bestand einblenden"
            Height          =   255
            Left            =   240
            TabIndex        =   350
            Top             =   480
            Visible         =   0   'False
            Width           =   3615
         End
         Begin VB.CheckBox Check8 
            BackColor       =   &H00C0C000&
            Caption         =   "geräumte ausblenden"
            Height          =   255
            Left            =   120
            TabIndex        =   346
            Top             =   240
            Width           =   2295
         End
         Begin VB.CheckBox Check2 
            BackColor       =   &H00C0C000&
            Caption         =   "Kollegen VK auch"
            Height          =   255
            Left            =   5400
            TabIndex        =   263
            Top             =   720
            Width           =   1935
         End
         Begin VB.CheckBox checkLPZ 
            BackColor       =   &H00C0C000&
            Caption         =   "Linie '0' ausblenden"
            Height          =   255
            Left            =   5400
            TabIndex        =   219
            Top             =   1200
            Visible         =   0   'False
            Width           =   1935
         End
         Begin VB.CheckBox CheckAlle 
            BackColor       =   &H00C0C000&
            Caption         =   "alle markieren"
            Height          =   255
            Left            =   5400
            TabIndex        =   217
            Top             =   960
            Visible         =   0   'False
            Width           =   1935
         End
         Begin sevCommand3.Command Command0 
            Height          =   375
            Index           =   55
            Left            =   4800
            TabIndex        =   216
            Top             =   1440
            Width           =   375
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "F2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   375
            Index           =   54
            Left            =   4800
            TabIndex        =   215
            Top             =   960
            Width           =   375
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "F2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   2
            Left            =   3960
            MaxLength       =   3
            TabIndex        =   125
            Text            =   "Text1"
            Top             =   1440
            Width           =   735
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   360
            Index           =   1
            Left            =   2760
            MaxLength       =   3
            TabIndex        =   124
            Text            =   "Text1"
            Top             =   1440
            Width           =   735
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   360
            Index           =   0
            Left            =   2760
            MaxLength       =   6
            TabIndex        =   0
            Text            =   "Text1"
            ToolTipText     =   "Sind Ihre Lieferantenkürzel ordentlich gepflegt, so können Sie mit dem Kürzel arbeiten. Geben Sie z.B. Joop ein!"
            Top             =   960
            Width           =   1935
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   360
            Index           =   4
            Left            =   2760
            MaxLength       =   4
            TabIndex        =   123
            Text            =   "Text1"
            Top             =   2880
            Width           =   732
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   360
            Index           =   3
            Left            =   2760
            MaxLength       =   2
            TabIndex        =   122
            Text            =   "Text1"
            Top             =   2400
            Width           =   732
         End
         Begin VB.ListBox List3 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   1320
            Left            =   5400
            MultiSelect     =   2  'Erweitert
            TabIndex        =   121
            Top             =   1680
            Width           =   3975
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   360
            Index           =   5
            Left            =   2760
            Locked          =   -1  'True
            MaxLength       =   10
            TabIndex        =   120
            Text            =   "Text1"
            Top             =   3360
            Visible         =   0   'False
            Width           =   1455
         End
         Begin VB.TextBox Text1 
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   6
            Left            =   5160
            Locked          =   -1  'True
            MaxLength       =   10
            TabIndex        =   119
            Text            =   "Text1"
            Top             =   3360
            Visible         =   0   'False
            Width           =   1455
         End
         Begin sevCommand3.Command Command98 
            Height          =   360
            Left            =   9000
            TabIndex        =   457
            Top             =   480
            Width           =   405
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ToolTip         =   "Spaltenanordung der Tabelle bestimmen"
            ToolTipTitle    =   "Spaltenanordung"
            ButtonStyle     =   2
            Caption         =   ""
            Filename        =   "D:\Thomas\VB6\Winkiss\Zubehör\tab24.gif"
            Picture         =   "frmWKL43.frx":0A56
            PictureAlign    =   3
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command2 
            Height          =   360
            Index           =   1
            Left            =   4320
            TabIndex        =   458
            ToolTipText     =   "Kalender"
            Top             =   3360
            Visible         =   0   'False
            Width           =   405
            _ExtentX        =   714
            _ExtentY        =   635
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ToolTip         =   "Wählen Sie hier das Datum aus."
            ToolTipTitle    =   "Kalender"
            ButtonStyle     =   2
            Caption         =   ""
            PictureAlign    =   2
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command2 
            Height          =   360
            Index           =   3
            Left            =   6720
            TabIndex        =   459
            ToolTipText     =   "Kalender"
            Top             =   3360
            Visible         =   0   'False
            Width           =   405
            _ExtentX        =   714
            _ExtentY        =   635
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ToolTip         =   "Wählen Sie hier das Datum aus."
            ToolTipTitle    =   "Kalender"
            ButtonStyle     =   2
            Caption         =   ""
            PictureAlign    =   2
            Version3        =   -1  'True
         End
         Begin sevCommand3.Command Command0 
            Height          =   375
            Index           =   57
            Left            =   3600
            TabIndex        =   467
            Top             =   1920
            Width           =   375
            _ExtentX        =   0
            _ExtentY        =   0
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            BackColorDisabled=   15398133
            BackColorFrom   =   16514300
            BackColorTo     =   15462640
            BackColorCheckedFrom=   15462640
            BackColorCheckedTo=   16514300
            BackColorDownFrom=   12700881
            BackColorDownTo =   15659506
            BackColorHoverFrom=   16514300
            BackColorHoverTo=   15462640
            BorderColor     =   7617536
            BorderColorDisabled=   12240841
            BorderColorFocus=   14986635
            BorderColorHover=   3913721
            ForeColorDisabled=   9609633
            MenuBackColor   =   16448250
            MenuBackColorChecked=   7323903
            MenuBackColorHover=   10935807
            MenuBorderColor =   8388608
            MenuCheckMarkColorFrom=   16514300
            MenuCheckMarkColorTo=   15462640
            MenuForeColor   =   -2147483640
            MenuForeColorHover=   -2147483640
            ButtonStyle     =   2
            Caption         =   "F2"
            PictureAlign    =   2
            PictureVisible  =   0   'False
            Version3        =   -1  'True
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Artikelgruppe:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   12
            Left            =   120
            TabIndex        =   466
            Top             =   2040
            Width           =   2655
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Vergleichs-Lieferanten"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   11
            Left            =   7320
            TabIndex        =   463
            Top             =   240
            Width           =   2055
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Lieferanten-Nummer:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   8.25
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   10
            Left            =   2760
            TabIndex        =   342
            Top             =   720
            Width           =   3855
         End
         Begin VB.Label Label1 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0C000&
            Caption         =   " - "
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   4
            Left            =   3600
            TabIndex        =   134
            Top             =   1560
            Width           =   375
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Produkt-Linien (von - bis):"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   1
            Left            =   120
            TabIndex        =   133
            Top             =   1560
            Width           =   2655
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Lieferanten-Nummer:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   375
            Index           =   0
            Left            =   120
            TabIndex        =   132
            Top             =   1080
            Width           =   2655
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Bevorratungsfaktor:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   3
            Left            =   120
            TabIndex        =   131
            Top             =   3000
            Width           =   2655
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Eindeckwochenzeit:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   2
            Left            =   120
            TabIndex        =   130
            Top             =   2520
            Width           =   2655
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "gewählte Linien:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   7
            Left            =   5400
            TabIndex        =   129
            Top             =   1440
            Width           =   3975
         End
         Begin VB.Label Label1 
            BackColor       =   &H00C0C000&
            Caption         =   "Vergleichszeitraum:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   8
            Left            =   120
            TabIndex        =   128
            Top             =   3480
            Visible         =   0   'False
            Width           =   2175
         End
         Begin VB.Label Label1 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0C000&
            Caption         =   " - "
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   9
            Left            =   4800
            TabIndex        =   127
            Top             =   3360
            Visible         =   0   'False
            Width           =   255
         End
         Begin VB.Label lbl7 
            Alignment       =   2  'Zentriert
            BackColor       =   &H00C0C000&
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   375
            Left            =   120
            TabIndex        =   126
            Top             =   3240
            Width           =   2535
         End
      End
      Begin VB.OptionButton Option1 
         BackColor       =   &H00C0C000&
         Caption         =   "Mengen-Berechnung nach Wochen und Vormonat"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   300
         Index           =   0
         Left            =   120
         TabIndex        =   117
         Top             =   0
         Value           =   -1  'True
         Width           =   6735
      End
      Begin VB.OptionButton Option1 
         BackColor       =   &H00C0C000&
         Caption         =   "Mengen-Ber. nach Datum und Vergleichszeitraum"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   300
         Index           =   1
         Left            =   120
         TabIndex        =   116
         Top             =   360
         Width           =   5655
      End
      Begin VB.CheckBox Check1 
         BackColor       =   &H00C0C000&
         Caption         =   "Bestellmengen nur auf Mindest-Bevorratung (Feld: Min.Bestand) abstimmen"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   300
         Left            =   120
         TabIndex        =   115
         Top             =   720
         Width           =   7695
      End
      Begin sevCommand3.Command Command1 
         Height          =   300
         Index           =   3
         Left            =   9840
         TabIndex        =   114
         Top             =   4080
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   529
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "Einstellungen"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Frame Frame4 
         BackColor       =   &H00C0C000&
         BorderStyle     =   0  'Kein
         Caption         =   "Sortierung"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   495
         Left            =   120
         TabIndex        =   110
         Top             =   5280
         Width           =   11175
         Begin VB.CheckBox Check11 
            BackColor       =   &H00C0C000&
            Caption         =   "numerisch"
            Height          =   255
            Left            =   4680
            TabIndex        =   358
            Top             =   240
            Width           =   2535
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00C0C000&
            Caption         =   "AGN"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   252
            Index           =   5
            Left            =   6600
            TabIndex        =   353
            Top             =   0
            Width           =   1095
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00C0C000&
            Caption         =   "Bestand"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   252
            Index           =   4
            Left            =   8760
            TabIndex        =   349
            Top             =   0
            Width           =   1335
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00C0C000&
            Caption         =   "Farbe"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   252
            Index           =   3
            Left            =   7680
            TabIndex        =   239
            Top             =   0
            Width           =   1215
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00C0C000&
            Caption         =   "Linie"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   252
            Index           =   0
            Left            =   1440
            TabIndex        =   113
            Top             =   0
            Width           =   1095
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00C0C000&
            Caption         =   "Bezeichnung"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   252
            Index           =   1
            Left            =   2520
            TabIndex        =   112
            Top             =   0
            Width           =   1695
         End
         Begin VB.OptionButton Option2 
            BackColor       =   &H00C0C000&
            Caption         =   "LieferantenbestNr"
            BeginProperty Font 
               Name            =   "MS Sans Serif"
               Size            =   8.25
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H0000FFFF&
            Height          =   252
            Index           =   2
            Left            =   4320
            TabIndex        =   111
            Top             =   0
            Width           =   2295
         End
         Begin VB.Label Label0 
            BackColor       =   &H00C0C000&
            Caption         =   "sortiert nach:"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   9.75
               Charset         =   0
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   255
            Index           =   4
            Left            =   120
            TabIndex        =   140
            Top             =   0
            Width           =   1875
         End
      End
      Begin sevCommand3.Command Command1 
         Height          =   300
         Index           =   8
         Left            =   9840
         TabIndex        =   464
         Top             =   4440
         Width           =   1815
         _ExtentX        =   3201
         _ExtentY        =   529
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty MenuFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BackColorDisabled=   15398133
         BackColorFrom   =   16514300
         BackColorTo     =   15462640
         BackColorCheckedFrom=   15462640
         BackColorCheckedTo=   16514300
         BackColorDownFrom=   12700881
         BackColorDownTo =   15659506
         BackColorHoverFrom=   16514300
         BackColorHoverTo=   15462640
         BorderColor     =   7617536
         BorderColorDisabled=   12240841
         BorderColorFocus=   14986635
         BorderColorHover=   3913721
         ForeColorDisabled=   9609633
         MenuBackColor   =   16448250
         MenuBackColorChecked=   7323903
         MenuBackColorHover=   10935807
         MenuBorderColor =   8388608
         MenuCheckMarkColorFrom=   16514300
         MenuCheckMarkColorTo=   15462640
         MenuForeColor   =   -2147483640
         MenuForeColorHover=   -2147483640
         ButtonStyle     =   2
         Caption         =   "zum Wareneingang"
         PictureAlign    =   2
         PictureVisible  =   0   'False
         Version3        =   -1  'True
      End
      Begin VB.Label Label0 
         BackColor       =   &H00C0C000&
         Caption         =   "Bestellvorschlag:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808000&
         Height          =   255
         Index           =   3
         Left            =   9840
         TabIndex        =   218
         Top             =   1200
         Width           =   2025
      End
   End
   Begin VB.Label Label0 
      BackColor       =   &H00C0C000&
      Caption         =   "Bestellungen"
      BeginProperty Font 
         Name            =   "Arial Black"
         Size            =   21.75
         Charset         =   0
         Weight          =   900
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00808000&
      Height          =   615
      Index           =   2
      Left            =   120
      TabIndex        =   138
      Top             =   0
      Width           =   8385
   End
End
Attribute VB_Name = "frmWKL43"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim cCol1Col2       As String
Dim cLinr           As String
Dim gcBestellName   As String
Dim gcMitteilung    As String
Dim cArtANFU        As String
Dim gbAender        As Boolean
Dim gbAenderBEST    As Boolean
Dim gbAenderMINBEST As Boolean
Dim gbAenderMINMEN  As Boolean
Dim gbAenderAWM     As Boolean
Dim gbAenderAWM2    As Boolean
Dim gbAenderRKZ     As Boolean
Dim gbAenderNOTIZEN As Boolean

Dim gbAenderPROBEN  As Boolean
Dim gbAenderTESTER  As Boolean
Dim gbAenderNR      As Boolean

Dim gbBestVorOk     As Boolean
Dim bclickAusb      As Boolean
Dim iPrueD          As Integer
Dim gitop           As Integer
Dim gitop3          As Integer
Dim giMehrLinr      As Integer

Dim sGLNEmpfänger   As String
Dim sFormat         As String
Dim sKund           As String
Dim sKenn           As String
Dim sPass           As String
Dim sUser           As String
Dim sadress         As String
Dim a(80)           As Boolean
Dim gbenterC        As Boolean
Dim beinschr        As Boolean
Dim gcStsatz        As String
Dim sMerke_Focus    As String
Dim sFarbe1         As String
Dim sFarbe2         As String
Dim sFarbe3         As String
Dim mdeErr          As Boolean
Dim sVorschlaege(10) As String

Dim glmaxtabzeilenanz           As Long
Dim SpaltennummerKVKPR          As Byte
Dim SpaltennummerVKPR           As Byte
Dim SpaltennummerArtnr          As Byte
Dim SpaltennummerBEZEICH        As Byte
Dim SpaltennummerBESTVOR        As Byte
Dim SpaltennummerMINBEST        As Byte
Dim SpaltennummerMINMEN         As Byte
Dim SpaltennummerBESTAND        As Byte
Dim SpaltennummerRKZ            As Byte
Dim SpaltennummerAWM            As Byte
Dim SpaltennummerAWM2           As Byte
Dim SpaltennummerEAN            As Byte
Dim SpaltennummerNOTIZEN        As Byte
Dim SpaltennummerRab            As Byte
Dim SpaltennummerInBe           As Byte

Dim SpaltennummerBESTVOR_PROBEN As Byte
Dim SpaltennummerBESTVOR_TESTER As Byte
Dim SpaltennummerBESTVOR_NR     As Byte

Dim iBestellungAls              As Integer


Private Sub WKL43Positionieren()
    On Error GoTo LOKAL_ERROR
    
    Dim i As Integer
    
    Frame2.Height = 2895
    Frame2.Left = 4320
    Frame2.Top = 120
    Frame2.Width = 8655
    
    Frame11.Height = 2895
    Frame11.Left = 4320
    Frame11.Top = 120
    Frame11.Width = 8655
    
    With Frame5
        .Top = 2040
        .Left = 360
        .Height = 5295
        .Width = 11415
    End With
    
    With MSFlexGrid2
        .Top = 960
        .Left = 120
'        .Height = .RowHeight(0) * 10
        .Height = 3012
        .Width = 11652
    End With
    
    With Frame1
        .Top = 720
        .Left = 0
        .Height = 7875
        .Width = 11895
    End With
    
    With Frame7
        .Top = 720
        .Left = 120
        .Height = 5775
        .Width = 11655
    End With
    
    With Frame10
        .Top = 720
        .Left = 120
        .Height = 5775
        .Width = 11655
    End With
    
    With fra0
        .Top = 0
        .Left = 0
        .Width = 11895
        .Height = 8600
    End With
    
    With fra1
        .Top = 120
        .Left = 120
        .Width = 11750
        .Height = 852
    End With
    
    With fra4
        .Height = 8655
        .Left = 0
        .Top = 0
        .Width = 11895
        .BorderStyle = 0
    End With
    
    With Frame12
        .Height = 8655
        .Left = 0
        .Top = 0
        .Width = 11895
        .BorderStyle = 0
    End With
    
    With fra5
        .Top = 3960
        .Left = 120
        .Width = 11750
        .Height = 3495
    End With
    
    With fra2
        .Top = 7440
        .Left = 120
        .Width = 11750
        .Height = 1400
    End With
    
    With Frame0
        .Top = 5760
        .Left = 0
        .Width = 11772
        .Height = 1455
    End With
    
    With fraArtAnfuegen
        .Top = 0
        .Height = 9000
        .Left = 0
        .Width = 12000
    End With

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "WKL43Positionieren"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub artikel_suchen()
    On Error GoTo LOKAL_ERROR:
    
    Dim sSQL            As String
    Dim cLBSatz         As String
    Dim sFeld           As String
    Dim rec             As Recordset
    Dim cBezeichSuche   As String
    Dim bAnd            As Boolean
    
    bAnd = False
    
    sSQL = "Select * from AN" & srechnertab & " "
    
    If Text6.Text <> "" Then
        If bAnd Then
            sSQL = sSQL & " and "
        Else
            sSQL = sSQL & " where "
        End If
        sSQL = sSQL & " artnr= " & Text6.Text
        beinschr = True
        bAnd = True
    End If
    
    If Text8.Text <> "" Then
        If bAnd Then
            sSQL = sSQL & " and "
        Else
            sSQL = sSQL & " where "
        End If
    
        cBezeichSuche = Text8.Text
        cBezeichSuche = SwapStr(cBezeichSuche, " ", "*")
        sSQL = sSQL & " bezeich like '*" & cBezeichSuche & "*'"
        beinschr = True
        bAnd = True
    End If
    
    If Text7.Text <> "" Then
        If bAnd Then
            sSQL = sSQL & " and "
        Else
            sSQL = sSQL & " where "
        End If
        
        If Anfügen_Ist_in_ARTEAN_K(Text7.Text) Then
                
        End If
        
        sSQL = sSQL & " (ean like '" & Text7.Text & "*'"
        sSQL = sSQL & " or EAN2 like '" & Text7.Text & "*' "
        sSQL = sSQL & " or EAN3 like '" & Text7.Text & "*' )"
        
        beinschr = True
        bAnd = True
    End If
    
    If Text2.Text <> "" Then
        If bAnd Then
            sSQL = sSQL & " and "
        Else
            sSQL = sSQL & " where "
        End If

        sSQL = sSQL & " libesnr like '" & Text2.Text & "*'"
        beinschr = True
        bAnd = True
    End If
    
    
    If Check19.value = vbChecked Then
        If bAnd Then
            sSQL = sSQL & " and "
        Else
            sSQL = sSQL & " where "
        End If

        sSQL = sSQL & " RKZ = 'N'"
        beinschr = True
        bAnd = True
    End If
    
    If Check20.value = vbChecked Then
        If bAnd Then
            sSQL = sSQL & " and "
        Else
            sSQL = sSQL & " where "
        End If

        sSQL = sSQL & " lastdate is null "
        beinschr = True
        bAnd = True
    End If
    
    
    
    sSQL = sSQL & " order by bezeich"

    artikel_zeigen sSQL
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "artikel_suchen"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function Anfügen_Ist_in_ARTEAN_K(cWasSuchteMan As String) As Boolean
On Error GoTo LOKAL_ERROR

    Dim rsrs As Recordset
    Dim rsArt As Recordset
    
    Dim sSQL As String
    Dim cArtNr As String
    Dim cEAN As String

    Anfügen_Ist_in_ARTEAN_K = False
    
    sSQL = "Select * from ARTEAN_K where EAN =  '" & cWasSuchteMan & "'"
    
    Set rsrs = gdBase.OpenRecordset(sSQL)
    If Not rsrs.EOF Then
    
        If Not IsNull(rsrs!artnr) Then
            cArtNr = rsrs!artnr
        End If
        
        sSQL = "Select * from artikel where artnr = " & cArtNr
        Set rsArt = gdBase.OpenRecordset(sSQL)
        If Not rsArt.EOF Then
        
            cEAN = ""
            
            If cEAN = "" Then
                If Not IsNull(rsArt!EAN3) Then
                    cEAN = Trim(rsArt!EAN3)
                End If
            End If
            
'            If cEAN = "" Then
'                If Not IsNull(rsArt!EAN2) Then
'                    cEAN = Trim(rsArt!EAN2)
'                End If
'            End If
'
'            If cEAN = "" Then
'                If Not IsNull(rsArt!EAN) Then
'                    cEAN = Trim(rsArt!EAN)
'                End If
'            End If
            
            If cEAN <> "" Then
                sSQL = "Insert into ARTEAN_K (Artnr,EAN) values (" & cArtNr & ", '" & cEAN & "') "
                gdBase.Execute sSQL, dbSQLPassThrough + dbFailOnError
            End If
            
        End If
        rsArt.Close
        
        


        sSQL = "Update Artikel set EAN3 = ean2 Where artnr = " & cArtNr & ""
        gdBase.Execute sSQL, dbSQLPassThrough + dbFailOnError
        
        sSQL = "Update Artikel set EAN2 = ean Where artnr = " & cArtNr & ""
        gdBase.Execute sSQL, dbSQLPassThrough + dbFailOnError
        
        sSQL = "Update Artikel set EAN = '" & cWasSuchteMan & "' Where artnr = " & cArtNr & ""
        gdBase.Execute sSQL, dbSQLPassThrough + dbFailOnError
        
        
        'Plus
        sSQL = "Delete * from AN" & srechnertab & " Where artnr = " & cArtNr & ""
        gdBase.Execute sSQL, dbSQLPassThrough + dbFailOnError
        
        
        sSQL = "Insert into AN" & srechnertab & " select artikel.*  from artikel inner join artlief"
        sSQL = sSQL & " on artikel.artnr = artlief.artnr "
        sSQL = sSQL & " Where artlief.linr = " & Command6.Caption
        sSQL = sSQL & " and artikel.artnr = " & cArtNr & " "
        gdBase.Execute sSQL, dbFailOnError
        
        sSQL = "Update AN" & srechnertab & " inner join artlief"
        sSQL = sSQL & " on AN" & srechnertab & ".artnr = artlief.artnr "
        sSQL = sSQL & " set AN" & srechnertab & ".libesnr = artlief.libesnr "
        sSQL = sSQL & " , AN" & srechnertab & ".minmen = artlief.minmen "
        sSQL = sSQL & " , AN" & srechnertab & ".LEKPR = artlief.LEKPR "
        sSQL = sSQL & " , AN" & srechnertab & ".LINR = artlief.LINR "
        sSQL = sSQL & " , AN" & srechnertab & ".RKZ = artlief.RKZ "
        sSQL = sSQL & " , AN" & srechnertab & ".EXDAT = artlief.EXDAT "
        sSQL = sSQL & " Where artlief.linr = " & Command6.Caption
        sSQL = sSQL & " and artlief.artnr = " & cArtNr & " "
        gdBase.Execute sSQL, dbFailOnError

        'Plus
        
        sSQL = "Delete * from ARTEAN_K where EAN = '" & cWasSuchteMan & "' "
        gdBase.Execute sSQL, dbSQLPassThrough + dbFailOnError
        
        
        Anfügen_Ist_in_ARTEAN_K = True
        
    End If
    
    rsrs.Close
    
    



Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Anfügen_Ist_in_ARTEAN_K"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub artikel_zeigen(sSQL As String)
    On Error GoTo LOKAL_ERROR:
    
    Dim cLBSatz     As String
    Dim sFeld       As String
    Dim rec         As Recordset
    Dim lcount      As Long
    Dim lAnz        As Long
    lcount = 0
    lAnz = 0
    
    If beinschr = False Then
        List1.Clear
    End If
    
    List2.Clear
    List2.Visible = False

    Set rec = gdBase.OpenRecordset(sSQL)
    If Not rec.EOF Then
        rec.MoveLast
        lAnz = rec.RecordCount
        rec.MoveFirst
        Do While Not rec.EOF
            lcount = lcount + 1
            
            Label6(5).Caption = lAnz
            Label6(5).Refresh
            
            lAnz = lAnz - 1
        
            If Not IsNull(rec!artnr) Then
                sFeld = rec!artnr
            End If
           
            sFeld = sFeld & Space$(7 - Len(sFeld))
            cLBSatz = cLBSatz & sFeld
            sFeld = ""
           
            If Not IsNull(rec!RKZ) Then
                 If UCase(rec!RKZ) = "J" Then
                     sFeld = "EX"
                 Else
                     sFeld = ""
                 End If
            Else
                sFeld = ""
            End If
            
            sFeld = sFeld & Space$(3 - Len(sFeld))
            cLBSatz = cLBSatz & sFeld
            sFeld = ""
           
           If Not IsNull(rec!BEZEICH) Then
               If Len(rec!BEZEICH) > 35 Then
                   sFeld = Mid$(rec!BEZEICH, 1, 32) & "..."
               Else
                   sFeld = rec!BEZEICH
               End If
           End If
           
           sFeld = sFeld & Space$(37 - Len(sFeld))
           cLBSatz = cLBSatz & sFeld
           sFeld = ""
           
           If Not IsNull(rec!EAN) Then
               sFeld = rec!EAN
           Else
               sFeld = ""
           End If
           
           sFeld = Space$(15 - Len(sFeld)) & sFeld
           cLBSatz = cLBSatz & sFeld
           sFeld = ""
           
           If Not IsNull(rec!LIBESNR) Then
               sFeld = rec!LIBESNR
           End If
           
           sFeld = Space$(13 - Len(sFeld)) & sFeld
           cLBSatz = cLBSatz & sFeld
           sFeld = ""
           
           List2.AddItem cLBSatz
           
           cLBSatz = ""
           rec.MoveNext
        Loop
    End If
    rec.Close: Set rec = Nothing
    
    If beinschr = False Then
        For lcount = 0 To List2.ListCount - 1
            List1.AddItem List2.list(lcount)
        Next lcount
'        List1.list = List2.list
    End If
    
    Dim cArtNr      As String
    Dim Datum1 As Date
    
    If lcount > 0 Then
        Datum1 = DateValue("01.01." & Label9(1).Caption)
        cArtNr = Left(List2.list(0), 6)
        
        diagrammfuellenMod3 cArtNr, Datum1
    
        Detaildatenermitteln2 cArtNr
    End If
    
    Frame8.Visible = True
    Frame3.Visible = True
    
    List2.Visible = True
    
    If lcount = 0 Then
        Label6(5).ForeColor = vbRed
    Else
        Label6(5).ForeColor = glS1
    End If
    Label6(5).Caption = lcount & " Artikel"
    Label6(5).Refresh
    
    Select Case sMerke_Focus
        Case "Text8"
            Text8.SetFocus
        Case "Text2"
            Text2.SetFocus
        Case "Text6"
            Text6.SetFocus
        Case "Text7"
            Text7.SetFocus
    End Select
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "artikel_zeigen"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    Resume Next
End Sub
Private Sub ArtikelAnfuegenWKL43()
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lAnz        As Long
    Dim lrow        As Long
    Dim lcol        As Long
    Dim ctmp        As String
    Dim cSQL        As String
    Dim cJahr       As String
    Dim cMonat      As String
    Dim cJahrV      As String
    Dim cMonatV     As String
    Dim iTmp        As Integer
    Dim rsrs        As Recordset
    Dim rsrs1       As Recordset
    Dim bFound      As Boolean
    
    Dim cZiel           As String
    
    cZiel = gcPfad
    If Right$(cZiel, 1) <> "\" Then
        cZiel = cZiel & "\"
    End If
    
    loeschNEW "AN" & srechnertab, gdApp
    TransferTab gdBase, cZiel & "Kissapp.mdb", "AN" & srechnertab
    
    bFound = False

    For lcount = 0 To List2.ListCount - 1
        If List2.Selected(lcount) = True Then
            bFound = True
        End If
    Next lcount
    
    If Not bFound And List2.ListCount = 1 Then
        List2.Selected(0) = True
        bFound = True
    End If

    If Not bFound Then
        MsgBox "Bitte markieren Sie einen Artikel", vbInformation, "Winkiss Hinweis:"
        Exit Sub
    End If
    
    fra0.Visible = False
    Me.Refresh
    
    cJahr = Year(Now)
    cMonat = Month(Now)
    If cMonat = "1" Then
        cMonatV = "12"
        cJahrV = Trim$(Str$(((Val(cJahr)) - 1)))
    Else
        cMonatV = cMonat - 1
        cJahrV = cJahr
    End If
    
    cArtANFU = ""
    lAnz = List2.ListCount - 1
    
    List2.Visible = False
    
    For lcount = 0 To lAnz
    
        If lcount > lAnz Then
            Exit For
        End If
        
        If List2.Selected(lcount) = True Then
            cArtANFU = List2.list(lcount)
            cArtANFU = Left(cArtANFU, 6)
            cArtANFU = Trim$(cArtANFU)
            
            cSQL = "Insert into vorschlz Select  "
            cSQL = cSQL & " a.ARTNR"
            cSQL = cSQL & ", a.BEZEICH"
            cSQL = cSQL & ", a.BESTAND"
            cSQL = cSQL & ", a.AGN"
            cSQL = cSQL & ", a.LEKPR"
            cSQL = cSQL & ", a.VKPR"
            cSQL = cSQL & ", a.LINR"
            cSQL = cSQL & ", a.LIBESNR"
            cSQL = cSQL & ", a.KVKPR1 "
            cSQL = cSQL & ", a.EAN"
            cSQL = cSQL & ", a.GROESSE"
            cSQL = cSQL & ", a.MOPREIS"
            cSQL = cSQL & ", a.RKZ"
            cSQL = cSQL & ", a.LPZ"
            cSQL = cSQL & ", a.NOTIZEN"
            cSQL = cSQL & ", a.MINMEN"
            cSQL = cSQL & ", a.MINBEST"
            cSQL = cSQL & ", a.EKPR"
            cSQL = cSQL & ", 99 as AWM"
            cSQL = cSQL & ", 1 as ANZEIGE "
            cSQL = cSQL & ", 0 as INBEST"
            cSQL = cSQL & ", 0 as Faktor "
            cSQL = cSQL & ", 0 as BEstvor"
            cSQL = cSQL & ", 0 as EINDECK"
            cSQL = cSQL & ", 0 as BEVORRAT"
            cSQL = cSQL & ", 0 as LPZ_VON"
            cSQL = cSQL & ", 0 as LPZ_BIS"
            cSQL = cSQL & " from AN" & srechnertab & " a where a.ARTNR = " & cArtANFU
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Delete from AN" & srechnertab & " a where a.ARTNR = " & cArtANFU
            gdBase.Execute cSQL, dbFailOnError
            
            cSQL = "Update VORSCHLZ set VORSCHLZ.SOKO = 999999 "
            cSQL = cSQL & " where VORSCHLZ.ARTNR = " & cArtANFU
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Update VORSCHLZ inner join KONTIN on VORSCHLZ.artnr = KONTIN.artnr "
            cSQL = cSQL & " set VORSCHLZ.SOKO = clng(VORSCHLZ.bestand) - clng(KONTIN.abestand) "
            cSQL = cSQL & " where VORSCHLZ.ARTNR = " & cArtANFU
            gdApp.Execute cSQL, dbFailOnError
            
            '** VKLJ1 **
            
            cSQL = "Select * from VORSCHLZ where VORSCHLZ.ARTNR = " & cArtANFU
            Set rsrs = gdApp.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.Edit
                
                cSQL = "Select * from UMSARTJ where ARTNR = " & cArtANFU
                cSQL = cSQL & " and JAHR = " & cJahr
                Set rsrs1 = gdBase.OpenRecordset(cSQL)
                If Not rsrs1.EOF Then
                    If Not IsNull(rsrs1!ANZAHLJ) Then
                        rsrs!VKLJ1 = rsrs1!ANZAHLJ
                    Else
                        rsrs!VKLJ1 = "0"
                    End If
                Else
                    rsrs!VKLJ1 = "0"
                End If
                rsrs1.Close: Set rsrs1 = Nothing
    
                '** VKVJ1 **
                cSQL = "Select * from UMSARTJ where ARTNR = " & cArtANFU
                cSQL = cSQL & " and JAHR = " & cJahr - 1
                Set rsrs1 = gdBase.OpenRecordset(cSQL)
                If Not rsrs1.EOF Then
                    If Not IsNull(rsrs1!ANZAHLJ) Then
                        rsrs!VKVJ1 = rsrs1!ANZAHLJ
                    Else
                        rsrs!VKVJ1 = "0"
                    End If
                Else
                    rsrs!VKVJ1 = "0"
                End If
                rsrs1.Close: Set rsrs1 = Nothing
    
                '** VKVMo1 **
                cSQL = "Select * from UMS_ART where ARTNR = " & cArtANFU
                cSQL = cSQL & " and JAHR = " & cJahrV
                cSQL = cSQL & " and MONAT = " & cMonatV
                Set rsrs1 = gdBase.OpenRecordset(cSQL)
                If Not rsrs1.EOF Then
                    If Not IsNull(rsrs1!ANZAHL) Then
                        rsrs!VKVMO1 = rsrs1!ANZAHL
                    Else
                        rsrs!VKVMO1 = "0"
                    End If
                Else
                        rsrs!VKLJ1 = "0"
                End If
                rsrs1.Close: Set rsrs1 = Nothing
    
                '** VKAMo1 **
                cSQL = "Select * from UMS_ART where ARTNR = " & cArtANFU
                cSQL = cSQL & " and JAHR = " & cJahr
                 cSQL = cSQL & " and MONAT = " & cMonat
                Set rsrs1 = gdBase.OpenRecordset(cSQL)
                If Not rsrs1.EOF Then
                    If Not IsNull(rsrs1!ANZAHL) Then
                        rsrs!VKAMo1 = rsrs1!ANZAHL
                    Else
                        rsrs!VKAMo1 = "0"
                    End If
                Else
                    rsrs!VKAMo1 = "0"
                End If
                rsrs1.Close: Set rsrs1 = Nothing
                rsrs.Update
                
                List2.RemoveItem (lcount)
                lcount = lcount - 1
                lAnz = lAnz - 1
            End If
            rsrs.Close: Set rsrs = Nothing
        End If
    
    Next lcount
    
    For lcount = 0 To List2.ListCount - 1
        List1.AddItem List2.list(lcount)
    Next lcount
    
    
    
    
    '********** GraphFüllenWKL43 ************
        
    If Check2.value = vbChecked Then
    
        'mit KollegenVerkauf
        GraphFuellenWKL43 Bilde_Umsatz_plusKollVK(cLinr)
    
    Else
        GraphFuellenWKL43 "UMS_ART"
    End If
    
    

    
    cSQL = "Update VORSCHLZ inner join ARTFARB2 on VORSCHLZ.artnr = ARTFARB2.artnr "
    cSQL = cSQL & " set VORSCHLZ.awm2 = artfarb2.awm2 "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Update VORSCHLZ inner join ARTMERK on VORSCHLZ.artnr = ARTMERK.artnr "
    cSQL = cSQL & " set VORSCHLZ.MERK = ARTMERK.MERK "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Update VORSCHLZ inner join INTERART on VORSCHLZ.artnr = INTERART.artnr "
    cSQL = cSQL & " set VORSCHLZ.SHOP = 'J' "
    gdApp.Execute cSQL, dbFailOnError
    
    updatesorti
    
    zeige_Grid False
    fraArtAnfuegen.Visible = False

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ArtikelAnfuegenWKL43"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
    
End Sub
Private Sub ArtikelAnfuegenausKUB(cARTI As String)
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lrow        As Long
    Dim lcol        As Long
    Dim ctmp        As String
    Dim cSQL        As String
    Dim cJahr       As String
    Dim cMonat      As String
    Dim cJahrV      As String
    Dim cMonatV     As String
    Dim iTmp        As Integer
    Dim rsrs        As Recordset
    Dim rsrs1       As Recordset
    Dim cPfad       As String
    Dim cPfad1      As String
    Dim cMinArt    As String
    
    cPfad = gcPfad  'Anwendungspfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad1 = gcDBPfad   'Datenbankpfad
    If Right$(cPfad1, 1) <> "\" Then
        cPfad1 = cPfad1 & "\"
    End If
   
    cJahr = Year(Now)
    cMonat = Month(Now)
    If cMonat = "1" Then
        cMonatV = "12"
        cJahrV = Trim$(Str$(((Val(cJahr)) - 1)))
    Else
        cMonatV = cMonat - 1
        cJahrV = cJahr
    End If
    
    ''''****
    
    cArtANFU = Trim$(cARTI)
    
    loeschNEW "Winanfu1", gdBase
    
    cSQL = "Select min(artnr) as minart from artikel "
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If rsrs.EOF Then
        Screen.MousePointer = 0
        rsrs.Close: Set rsrs = Nothing
        Exit Sub
    Else
        cMinArt = rsrs!minart
    End If
    rsrs.Close: Set rsrs = Nothing

    cSQL = "Select * into WINANFU1 from Artikel where ARTNR = " & cMinArt & " "
    schreibeProtokollDabaAblauf cSQL: gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Delete from WINANFU1"
    schreibeProtokollDabaAblauf cSQL: gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Insert into WINANFU1 SELECT "
    cSQL = cSQL & " B.ARTNR"
    cSQL = cSQL & ", A.BEZEICH"
    cSQL = cSQL & ", A.AGN"
    cSQL = cSQL & ", B.LEKPR"
    cSQL = cSQL & ", A.VKPR"
    cSQL = cSQL & ", A.MWST"
    cSQL = cSQL & ", B.LINR"
    cSQL = cSQL & ", B.LIBESNR"
    cSQL = cSQL & ", A.EAN"
    cSQL = cSQL & ", A.EAN2"
    
    cSQL = cSQL & ", A.EAN3"
    cSQL = cSQL & ", A.ETIMERK "
    cSQL = cSQL & ", A.MOPREIS"
    cSQL = cSQL & ", A.RKZ"
    cSQL = cSQL & ", A.LPZ"
    cSQL = cSQL & ", A.NOTIZEN"
    cSQL = cSQL & ", A.BESTAND"
    cSQL = cSQL & ", A.VKMENGE"
    cSQL = cSQL & ", A.VKDATUM"
    cSQL = cSQL & ", B.MINMEN"
    
    cSQL = cSQL & ", A.INHALT"
    cSQL = cSQL & ", A.INHALTBEZ"
    cSQL = cSQL & ", A.GRUNDPREIS"
    cSQL = cSQL & ", A.MINBEST"
    cSQL = cSQL & ", A.RABATT_OK"
    cSQL = cSQL & ", A.GEFUEHRT"
    cSQL = cSQL & ", A.KVKPR1"
    cSQL = cSQL & ", A.EKPR"
    cSQL = cSQL & ", A.PREISSCHU"
    cSQL = cSQL & ", A.BONUS_OK"
    
    cSQL = cSQL & ", A.UMS_OK"
    cSQL = cSQL & ", A.AWM"
    cSQL = cSQL & ", A.LASTDATE"
    cSQL = cSQL & ", A.LASTTIME"
    cSQL = cSQL & ", A.AUFDAT"
    cSQL = cSQL & ", A.EXDAT"
    cSQL = cSQL & ", A.FARBNR"
    cSQL = cSQL & ", A.GROESSE"
    cSQL = cSQL & ", A.SPANNE"
    
    cSQL = cSQL & " from ARTLIEF B inner join ARTIKEL A on A.ARTNR = B.ARTNR where B.LINR = " & cLinr
    If cArtANFU <> "" Then cSQL = cSQL & " and B.ARTNR = " & cArtANFU & " "
    schreibeProtokollDabaAblauf cSQL: gdBase.Execute cSQL, dbFailOnError
    
    loeschapp "WINANFU"

    Dim cdatei As String
    cdatei = cPfad & "kissapp.mdb"
    cSQL = "Select winanfu1.* INTO winanfu IN '" & cdatei & "' from winanfu1"
    schreibeProtokollDabaAblauf cSQL: gdBase.Execute cSQL, dbFailOnError
        
    cSQL = "Delete  WINANFU.* from WINANFU inner join VORSCHLZ on "
    cSQL = cSQL & " WINANFU.ARTNR = VORSCHLZ.ARTNR where "
    cSQL = cSQL & " WINANFU.ARTNR = VORSCHLZ.ARTNR "
    gdApp.Execute cSQL, dbFailOnError
    
    
    
    
    '*******
    
    
    
    
    
    
    
    
    
    
    
    
    cSQL = "Insert into vorschlz Select  "
    cSQL = cSQL & " WINANFU.ARTNR"
    cSQL = cSQL & ", WINANFU.BEZEICH"
    cSQL = cSQL & ", WINANFU.BESTAND"
    cSQL = cSQL & ", WINANFU.AGN"
    cSQL = cSQL & ", WINANFU.LEKPR"
    cSQL = cSQL & ", WINANFU.VKPR"
    cSQL = cSQL & ", WINANFU.LINR"
    cSQL = cSQL & ", WINANFU.LIBESNR"
    cSQL = cSQL & ", WINANFU.KVKPR1 "
    cSQL = cSQL & ", WINANFU.EAN"
    cSQL = cSQL & ", WINANFU.MOPREIS"
    cSQL = cSQL & ", WINANFU.RKZ"
    cSQL = cSQL & ", WINANFU.LPZ"
    cSQL = cSQL & ", WINANFU.NOTIZEN"
    cSQL = cSQL & ", WINANFU.MINMEN"
    cSQL = cSQL & ", WINANFU.MINBEST"
    cSQL = cSQL & ", WINANFU.EKPR"
    cSQL = cSQL & ", 99 as AWM"
    cSQL = cSQL & ", 1 as ANZEIGE "
    cSQL = cSQL & ", 0 as INBEST"
    cSQL = cSQL & ", 0 as Faktor "
    cSQL = cSQL & ", 0 as BEstvor"
    cSQL = cSQL & ", 0 as EINDECK"
    cSQL = cSQL & ", 0 as BEVORRAT"
    cSQL = cSQL & ", 0 as LPZ_VON"
    cSQL = cSQL & ", 0 as LPZ_BIS"
    cSQL = cSQL & " from WINANFU where WINANFU.ARTNR = " & cArtANFU
    gdApp.Execute cSQL, dbFailOnError
    
    
    '** VKLJ1 **
    Set rsrs = gdApp.OpenRecordset("vorschlz", dbOpenTable)
    If Not rsrs.EOF Then
        rsrs.Edit
        
        cSQL = "Select * from UMSARTJ where ARTNR = " & cArtANFU
        cSQL = cSQL & " and JAHR = " & cJahr
        Set rsrs1 = gdBase.OpenRecordset(cSQL)
        If Not rsrs1.EOF Then
            If Not IsNull(rsrs1!ANZAHLJ) Then
                rsrs!VKLJ1 = rsrs1!ANZAHLJ
            Else
                rsrs!VKLJ1 = "0"
            End If
        Else
            rsrs!VKLJ1 = "0"
        End If
        rsrs1.Close: Set rsrs1 = Nothing

        '** VKVJ1 **
        cSQL = "Select * from UMSARTJ where ARTNR = " & cArtANFU
        cSQL = cSQL & " and JAHR = " & cJahr - 1
        Set rsrs1 = gdBase.OpenRecordset(cSQL)
        If Not rsrs1.EOF Then
            If Not IsNull(rsrs1!ANZAHLJ) Then
                rsrs!VKVJ1 = rsrs1!ANZAHLJ
            Else
                rsrs!VKVJ1 = "0"
            End If
        Else
            rsrs!VKVJ1 = "0"
        End If
        rsrs1.Close: Set rsrs1 = Nothing

        '** VKVMo1 **
        cSQL = "Select * from UMS_ART where ARTNR = " & cArtANFU
        cSQL = cSQL & " and JAHR = " & cJahrV
        cSQL = cSQL & " and MONAT = " & cMonatV
        Set rsrs1 = gdBase.OpenRecordset(cSQL)
        If Not rsrs1.EOF Then
            If Not IsNull(rsrs1!ANZAHL) Then
                rsrs!VKVMO1 = rsrs1!ANZAHL
            Else
                rsrs!VKVMO1 = "0"
            End If
        Else
                rsrs!VKLJ1 = "0"
        End If
        rsrs1.Close: Set rsrs1 = Nothing

        '** VKAMo1 **
        cSQL = "Select * from UMS_ART where ARTNR = " & cArtANFU
        cSQL = cSQL & " and JAHR = " & cJahr
         cSQL = cSQL & " and MONAT = " & cMonat
        Set rsrs1 = gdBase.OpenRecordset(cSQL)
        If Not rsrs1.EOF Then
            If Not IsNull(rsrs1!ANZAHL) Then
                rsrs!VKAMo1 = rsrs1!ANZAHL
            Else
                rsrs!VKAMo1 = "0"
            End If
        Else
            rsrs!VKAMo1 = "0"
        End If
        rsrs1.Close: Set rsrs1 = Nothing
        rsrs.Update
    End If
    rsrs.Close: Set rsrs = Nothing

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ArtikelAnfuegenausKUB"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
    
End Sub
Private Sub LeseMitteilungWKL43()
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL        As String
    Dim cPfad       As String
    Dim cPfad2      As String
    Dim bFeldFehler As Boolean
    Dim rsrs        As Recordset
    
    cPfad = gcPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad2 = gcDBPfad
    If Right(cPfad2, 1) <> "\" Then
        cPfad2 = cPfad2 & "\"
    End If
    
    bFeldFehler = False
    
    cSQL = "Select MITTEILUNG from VORSCHLZ"
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not bFeldFehler Then
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            If Not IsNull(rsrs!Mitteilung) Then
                gcMitteilung = rsrs!Mitteilung
            Else
                gcMitteilung = ""
            End If
        Else
            gcMitteilung = ""
        End If
        rsrs.Close: Set rsrs = Nothing
    Else
        rsrs.Close: Set rsrs = Nothing
        loeschapp "TEMPXXXX"
        
        cSQL = "Select *, '' as MITTEILUNG into TEMPXXXX from VORSCHLZ"
        gdApp.Execute cSQL, dbFailOnError
        

        loeschapp "VORSCHLZ"
        
                
        cSQL = "Select * into VORSCHLZ from TEMPXXXX"
        gdApp.Execute cSQL, dbFailOnError
                
        cSQL = "Create Index ARTNR on VORSCHLZ (ARTNR)"
        gdApp.Execute cSQL, dbFailOnError
        cSQL = "Create Index LINR on VORSCHLZ (LINR)"
        gdApp.Execute cSQL, dbFailOnError
        cSQL = "Create Index ANZEIGE on VORSCHLZ (ANZEIGE)"
        gdApp.Execute cSQL, dbFailOnError


        loeschapp "TEMPXXXX"
    End If
        

    
Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    ElseIf err.Number = 3061 Then
        bFeldFehler = True
        Resume Next
    Else
    
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "LeseMitteilungWKL43"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
    
        
    End If
End Sub

Private Function fnPruefeDialogEingabenWKL43() As Integer
    On Error GoTo LOKAL_ERROR
    
    Dim lDatVon     As Long
    Dim lDatBis     As Long
    Dim lDatDiff    As Long
    Dim lDatHeute   As Long
    Dim lAnz        As Long
    Dim cSQL        As String
    Dim ctmp        As String
    Dim cLinr       As String
    Dim cVon        As String
    Dim cBis        As String
    Dim cDatum      As String
    Dim dVon        As Double
    Dim dBis        As Double
    Dim rsrs        As Recordset
    Dim rsrs1       As Recordset
    
    fnPruefeDialogEingabenWKL43 = 0
    
    
    If IsNumeric(Text1(0).Text) = False Then
        Text1(0).Text = ""
    End If
    
    
    ctmp = Text1(0).Text
    cLinr = Trim$(ctmp)
    If cLinr = "" Then
        fnPruefeDialogEingabenWKL43 = 1
        Exit Function
    End If
    
    If List3.ListCount = 0 And Text1(1).Text = "" And Text1(2).Text = "" Then
        Text1(1).Text = "1"
        Text1(2).Text = "999"
    End If
    
    If List3.ListCount <> 0 Then
        Text1(1).Text = ""
        Text1(2).Text = ""
    Else
        If Text1(1).Text = "" And Text1(2).Text <> "" Then
            Text1(1).Text = Text1(2).Text
        End If
    
        If Text1(2).Text = "" And Text1(1).Text <> "" Then
            Text1(2).Text = Text1(1).Text
        End If
    End If
    
    If Text1(1).Text = "1" And Text1(2).Text = "999" Then
        List3.Clear
    ElseIf Text1(1).Text = "0" And Text1(2).Text = "999" Then
        List3.Clear
    
    ElseIf Text1(1).Text <> "" And Text1(2).Text <> "" Then
    
        cSQL = "Select * from LINBEZ where LINR = " & ctmp & " "
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then

            ctmp = Text1(1).Text 'von
            cVon = Trim$(ctmp)
    
            ctmp = Text1(2).Text 'bis
            cBis = Trim$(ctmp)

            dVon = Val(cVon)
            dBis = Val(cBis)
    
            cSQL = "Select * from LINBEZ where LINR = " & cLinr
            cSQL = cSQL & " and LPZ >= " & cVon & " and LPZ <= "
            cSQL = cSQL & cBis & " order by LPZ"
            Set rsrs1 = gdBase.OpenRecordset(cSQL)
            If Not rsrs1.EOF Then
                rsrs1.MoveFirst
                Do While Not rsrs1.EOF
                    If Not IsNull(rsrs1!LPZ) Then
                        ctmp = rsrs1!LPZ
                        ctmp = Trim$(ctmp)
                        List3.AddItem ctmp
                    End If
                    rsrs1.MoveNext
                Loop
            End If
            rsrs1.Close: Set rsrs1 = Nothing
            List3.Refresh
            DoEvents
        End If
        rsrs.Close: Set rsrs = Nothing
        
    End If
    
    If Check1.value = vbUnchecked Then
        ctmp = Text1(3).Text
        ctmp = Trim$(ctmp)
        If ctmp = "" Then
            fnPruefeDialogEingabenWKL43 = 4
            Exit Function
        End If
        
        ctmp = Text1(4).Text
        ctmp = Trim$(ctmp)
        If ctmp = "" Then
            fnPruefeDialogEingabenWKL43 = 5
            Exit Function
        End If
    End If
    
    If dVon > dBis Then
        fnPruefeDialogEingabenWKL43 = 6
        Exit Function
    End If
    
    If Text1(5).Visible Then
        
        lDatHeute = Fix(Now)
        
        cDatum = Text1(5).Text
        cDatum = Trim$(cDatum)
        If cDatum = "" Then
            fnPruefeDialogEingabenWKL43 = 51
            Exit Function
        End If
        If Not IsDate(cDatum) Then
            fnPruefeDialogEingabenWKL43 = 52
            Exit Function
        End If
        lDatVon = DateValue(cDatum)
        
        If lDatVon > lDatHeute Then
            fnPruefeDialogEingabenWKL43 = 53
            Exit Function
        End If
        
        
        cDatum = Text1(6).Text
        cDatum = Trim$(cDatum)
        If cDatum = "" Then
            fnPruefeDialogEingabenWKL43 = 61
            Exit Function
        End If
        If Not IsDate(cDatum) Then
            fnPruefeDialogEingabenWKL43 = 62
            Exit Function
        End If
        lDatBis = DateValue(cDatum)
        
        If lDatBis > lDatHeute Then
            fnPruefeDialogEingabenWKL43 = 63
            Exit Function
        End If
        
        If lDatVon > lDatBis Then
            fnPruefeDialogEingabenWKL43 = 71
            Exit Function
        End If
        
        lDatDiff = lDatBis - lDatVon
        If lDatDiff > 100 Then
            fnPruefeDialogEingabenWKL43 = 72
            Exit Function
        End If
    End If
    
    giMehrLinr = 0
    
    If CheckAlle.Visible = True Then
        giMehrLinr = 1
    End If
    
    If CheckAlle = vbChecked Then
        giMehrLinr = 2
    End If
        
    If Label1(7).Caption = "Auswahl der Lieferanten" Then
        giMehrLinr = 3
    End If
    
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnPruefeDialogEingabenWKL43"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Function
Private Sub SchreibeBest(iAlsWas As Integer)
    On Error GoTo LOKAL_ERROR

    Dim cSQL         As String
    Dim cLieferant   As String
    Dim cWert        As String
    Dim cLiefFax     As String
    Dim cBLinBez     As String
    Dim cKundnr      As String
    Dim cKundFax     As String
    Dim cLinr        As String
    Dim cMitt        As String
    Dim dWert        As Double
    Dim rsrs         As Recordset
    Dim cPfad        As String
    
    cPfad = App.Path  'Applicationpfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    cPfad = cPfad & "kissapp.mdb"
   
    cLinr = Text1(0).Text
    If cLinr = "" Then
        MsgBox "Keine Lieferanten-Nummer angegeben!" & vbCrLf & "Erstellen einer Bestellung nicht möglich!", vbCritical, "STOP!"
        Exit Sub
    End If
    
    Screen.MousePointer = 11

    loeschapp "KDFBEST"
    CreateTable "KDFBEST", gdApp
    
    Text12.Text = SwapStr(Text12.Text, "'", "")
    cLieferant = lbl2(3).Caption
    cWert = lbl2(1).Caption

    cWert = fnMoveComma2Point$(cWert)
    dWert = Val(cWert)
    cWert = Trim$(Str$(dWert))
    If InStr(cWert, ",") > 0 Then
        cWert = fnMoveComma2Point$(cWert)
    End If

    cSQL = "Insert into KDFBEST "
    cSQL = cSQL & "Select '" & cLieferant & "' as LIEFBEZ, "
    cSQL = cSQL & cWert & " as EK_WERT, "
    cSQL = cSQL & "'" & cLinr & "' as LINR, "
    cSQL = cSQL & "'" & gFirma.FirmaName & "' as FIRMANAME, "
    cSQL = cSQL & "'" & gFirma.strasse & "' as STRASSE, "
    cSQL = cSQL & "'" & gFirma.Plz & "' as PLZ, "
    cSQL = cSQL & "'" & gFirma.Ort & "' as ORT, "
    cSQL = cSQL & "'" & gFirma.Tel & "' as TEL, "
    cSQL = cSQL & "'" & gFirma.Fax & "' as FAX, "
    cSQL = cSQL & "'" & Text12.Text & "' as ANUMMER, "
    cSQL = cSQL & "'" & gFirma.FirmaMail & "' as FIRMAMAIL "
    gdApp.Execute cSQL, dbFailOnError

    loeschapp "DDFBEST"
    CreateTable "DDFBEST", gdApp
    
    cSQL = "Insert into DDFBEST Select "
    cSQL = cSQL & " artnr "
    cSQL = cSQL & ", bezeich "
    cSQL = cSQL & ", libesnr "
    cSQL = cSQL & ", lpz"
    cSQL = cSQL & ", mopreis as blinr"
    cSQL = cSQL & ", BESTVOR "
    cSQL = cSQL & ", NOTIZEN "
    cSQL = cSQL & ", LEKPR "
    cSQL = cSQL & ", KVKPR1 "
    cSQL = cSQL & ", EAN "
    cSQL = cSQL & ", BESTVOR_PROBEN "
    cSQL = cSQL & ", BESTVOR_TESTER "
    cSQL = cSQL & ", BESTVOR_NR "
    cSQL = cSQL & " from VORSCHLZ where BESTVOR > 0 "
    
    If Option2(0).value = True Then
        cSQL = cSQL & " order by mopreis, SORTI,BEZEICH"
    ElseIf Option2(1).value = True Then
        cSQL = cSQL & " order by mopreis,BEZEICH"
    ElseIf Option2(2).value = True Then
        cSQL = cSQL & " order by mopreis, LIBESNR"
    ElseIf Option2(3).value = True Then
        cSQL = cSQL & " order by mopreis, awm desc,SORTI,BEZEICH"
    ElseIf Option2(4).value = True Then
        cSQL = cSQL & " order by bestand asc,BEZEICH "
    ElseIf Option2(5).value = True Then
        cSQL = cSQL & " order by AGN,BEZEICH "
    Else
        cSQL = cSQL & " order by mopreis, SORTI,BEZEICH"
    End If
    
    gdApp.Execute cSQL, dbFailOnError

    'lisrt holen
    loeschapp "lisrt"
    
    cSQL = "Select lisrt.* into lisrt in '" & cPfad & "' from lisrt "
    gdBase.Execute cSQL, dbFailOnError
    
    loeschapp "zuordean"
    cSQL = "Select zuordean.* into zuordean in '" & cPfad & "' from zuordean "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Update DDFBEST inner join zuordean on ddfbest.artnr = zuordean.artnr "
    cSQL = cSQL & " set DDFBEST.GPEAN = zuordean.GPEAN "
    cSQL = cSQL & " , DDFBEST.FAKTOR = zuordean.FAKTOR "
    gdApp.Execute cSQL, dbFailOnError
    
    
    Dim sLieffax As String
    sLieffax = ""
    
    'es gibt drei Möglichkeiten
    'per Fax
    'per EDI
    'per Mail
    
    'ialswas = 0 Fax
    'ialswas = 1 EDI
    'ialswas = 2 EMAIL
   
    cSQL = "Update KDFBEST inner join lisrt on KDFBEST.linr = lisrt.linr "
    cSQL = cSQL & " set KDFBEST.LIEF_FAX = lisrt.fax"
    cSQL = cSQL & ", KDFBEST.KUNDNR = lisrt.KUNDNR"
    cSQL = cSQL & ", KDFBEST.KTEXT = lisrt.KTEXT"
    gdApp.Execute cSQL, dbFailOnError
    
    
    If iAlsWas = 1 Then ' EDI
        sLieffax = "EDI am: " & Format(DateValue(Now), "DD.MM.YY") & " um: " & Format(TimeValue(Now), "HH:MM:SS")
        
        cSQL = "Update KDFBEST set LIEF_FAX = '" & sLieffax & "'"
        gdApp.Execute cSQL, dbFailOnError
        
    ElseIf iAlsWas = 2 Then ' EMAIL
        sLieffax = "Email am: " & Format(DateValue(Now), "DD.MM.YY") & " um: " & Format(TimeValue(Now), "HH:MM:SS")
        
        cSQL = "Update KDFBEST set LIEF_FAX = '" & sLieffax & "'"
        gdApp.Execute cSQL, dbFailOnError
    End If
    
    
    
    
    
    
    
    
    
    
    Set rsrs = gdApp.OpenRecordset("Select * from vorschlz")
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!Mitteilung) Then
            cMitt = rsrs!Mitteilung
            
            cSQL = "Update KDFBEST set KDFBEST.MITTEILUNG = '" & cMitt & "'"
            gdApp.Execute cSQL, dbFailOnError
        Else
            cMitt = ""
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Update DDFBEST inner join lisrt on ddfbest.Blinr = lisrt.linr "
    cSQL = cSQL & "set DDFBEST.LINBEZ = lisrt.liefbez "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Update DDFBEST set VERSEH = Bestvor/Faktor where Faktor > 0"
    gdApp.Execute cSQL, dbFailOnError
    
    Screen.MousePointer = 0
    
    If ermgpEAN() Then
        reportbildschirmApp "WKL004ac", "aWKL43b"
    Else
        If Check5.value = vbUnchecked Then
        
            If Modul6.FindFile(App.Path, "aWKL43as.rpt") Then
                reportbildschirmApp "", "aWKL43as"
            Else
                reportbildschirmApp "WKL004ac", "aWKL43a"
            End If
        Else
            reportbildschirmApp "WKL004ac", "aWKL43c"
        End If
    End If

    gbBestVorOk = True

Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SchreibeBest"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
    End If
End Sub
Private Sub SchreibeBestalsDoc(cLinr As String, cverz As String)
    On Error GoTo LOKAL_ERROR

    Dim cSQL         As String
    Dim cLieferant   As String
    Dim cWert        As String
    Dim cLiefFax     As String
    Dim cBLinBez     As String
    Dim cKundnr      As String
    Dim cKundFax     As String
    Dim cMitt        As String
    Dim dWert        As Double
    Dim rsrs         As Recordset
    Dim cPfad        As String
    
    cPfad = App.Path  'Applicationpfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    cPfad = cPfad & "kissapp.mdb"
   

    loeschapp "KDFBEST"
    CreateTable "KDFBEST", gdApp
    
    cLieferant = lbl2(3).Caption
    cWert = lbl2(1).Caption

    cWert = fnMoveComma2Point$(cWert)
    dWert = Val(cWert)
    cWert = Trim$(Str$(dWert))
    If InStr(cWert, ",") > 0 Then
        cWert = fnMoveComma2Point$(cWert)
    End If

    cSQL = "Insert into KDFBEST "
    cSQL = cSQL & "Select '" & cLieferant & "' as LIEFBEZ, "
    cSQL = cSQL & cWert & " as EK_WERT, "
    cSQL = cSQL & "'" & cLinr & "' as LINR, "
    cSQL = cSQL & "'" & gFirma.FirmaName & "' as FIRMANAME, "
    cSQL = cSQL & "'" & gFirma.strasse & "' as STRASSE, "
    cSQL = cSQL & "'" & gFirma.Plz & "' as PLZ, "
    cSQL = cSQL & "'" & gFirma.Ort & "' as ORT, "
    cSQL = cSQL & "'" & gFirma.Tel & "' as TEL, "
    cSQL = cSQL & "'" & gFirma.Fax & "' as FAX, "
    cSQL = cSQL & "'' as ANUMMER, "
    cSQL = cSQL & "'" & gFirma.FirmaMail & "' as FIRMAMAIL "

    gdApp.Execute cSQL, dbFailOnError

    loeschapp "DDFBEST"
    CreateTable "DDFBEST", gdApp
    
    cSQL = "Insert into DDFBEST Select "
    cSQL = cSQL & " artnr "
    cSQL = cSQL & ", bezeich "
    cSQL = cSQL & ", libesnr "
    cSQL = cSQL & ", lpz"
    cSQL = cSQL & ", mopreis as blinr"
    cSQL = cSQL & ", BESTVOR "
    cSQL = cSQL & ", NOTIZEN "
    cSQL = cSQL & ", LEKPR "
    cSQL = cSQL & ", KVKPR1 "
    cSQL = cSQL & ", EAN "
    cSQL = cSQL & " from VORSCHLZ where BESTVOR > 0 "
    
    If Option2(0).value = True Then
        cSQL = cSQL & " order by mopreis, LPZ,BEZEICH"
    ElseIf Option2(1).value = True Then
        cSQL = cSQL & " order by mopreis,BEZEICH"
    ElseIf Option2(2).value = True Then
        cSQL = cSQL & " order by mopreis, LIBESNR"
    ElseIf Option2(3).value = True Then
        cSQL = cSQL & " order by mopreis, awm desc,LPZ,BEZEICH"
    ElseIf Option2(4).value = True Then
        cSQL = cSQL & " order by bestand asc,BEZEICH "
    ElseIf Option2(5).value = True Then
        cSQL = cSQL & " order by AGN,BEZEICH "
    End If
    
    gdApp.Execute cSQL, dbFailOnError

    'lisrt holen
    loeschapp "lisrt"
    
    cSQL = "Select lisrt.* into lisrt in '" & cPfad & "' from lisrt "
    gdBase.Execute cSQL, dbFailOnError
    
    loeschapp "zuordean"
    cSQL = "Select zuordean.* into zuordean in '" & cPfad & "' from zuordean "
    gdBase.Execute cSQL, dbFailOnError
    
    cSQL = "Update DDFBEST inner join zuordean on ddfbest.artnr = zuordean.artnr "
    cSQL = cSQL & " set DDFBEST.GPEAN = zuordean.GPEAN "
    cSQL = cSQL & " , DDFBEST.FAKTOR = zuordean.FAKTOR "
    gdApp.Execute cSQL, dbFailOnError
   
    
    cSQL = "Update KDFBEST inner join lisrt on KDFBEST.linr = lisrt.linr "
    cSQL = cSQL & " set KDFBEST.LIEF_FAX = lisrt.fax"
    cSQL = cSQL & ", KDFBEST.KUNDNR = lisrt.KUNDNR"
    cSQL = cSQL & ", KDFBEST.KTEXT = lisrt.KTEXT"
    gdApp.Execute cSQL, dbFailOnError
    
    Set rsrs = gdApp.OpenRecordset("select * from vorschlz")
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!Mitteilung) Then
            cMitt = rsrs!Mitteilung
            
            cSQL = "Update KDFBEST set KDFBEST.MITTEILUNG = '" & cMitt & "'"
            gdApp.Execute cSQL, dbFailOnError
            
        Else
            cMitt = ""
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Update DDFBEST inner join lisrt on ddfbest.Blinr = lisrt.linr "
    cSQL = cSQL & "set DDFBEST.LINBEZ = lisrt.liefbez "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Update DDFBEST set VERSEH = Bestvor/Faktor where Faktor > 0"
    gdApp.Execute cSQL, dbFailOnError
    
    If ermgpEAN() Then
        reportbildschirmtoTextAppBestellEmail "aWKL43b", cverz & "Bestellung.doc"
'        reportbildschirmApp "WKL004ac", "aWKL43b"
    Else
        If Check5.value = vbUnchecked Then
            reportbildschirmtoTextAppBestellEmail "aWKL43a", cverz & "Bestellung.doc"
'            reportbildschirmApp "WKL004ac", "aWKL43a"
        Else
            reportbildschirmtoTextAppBestellEmail "aWKL43c", cverz & "Bestellung.doc"
'            reportbildschirmApp "WKL004ac", "aWKL43c"
        End If
    End If

    gbBestVorOk = True

Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "SchreibeBestalsDoc"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
        
        
    End If
End Sub
Private Sub SpeichereBestellVorschlagWKL43()
    On Error GoTo LOKAL_ERROR
    
    Dim lRet        As Long
    Dim cPfad       As String
    Dim cPfad2      As String
    Dim bVorhanden  As Boolean
    Dim cSQL        As String
    Dim cdat        As String
    
    cPfad = gcPfad  'Applicationpfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    cPfad2 = gcDBPfad   'Datenbankpfad
    If Right(cPfad2, 1) <> "\" Then
        cPfad2 = cPfad2 & "\"
    End If
    
    cSQL = "Update vorschlz set AWM = '0' where AWM = '99' "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Update vorschlz set AWM = '0' where AWM = '98' "
    gdApp.Execute cSQL, dbFailOnError
    
    cdat = "X" & Trim$(UCase$(Text3.Text))
    cdat = Trim(cdat)
    
    If NewTableSuchenDBKombi(cdat, gdApp) Then
        lRet = MsgBox("Die Datei " & cdat & " existiert bereits! Überschreiben?", vbQuestion + vbYesNo, "ÜBERSCHREIBEN")
        If lRet <> vbYes Then
            Exit Sub
        End If
    End If
    
    loeschNEW cdat, gdApp
    
    schreibalias cdat, Text4.Text
    
    cSQL = "Select * into " & cdat & " from vorschlz "
    gdApp.Execute cSQL, dbFailOnError
        
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SpeichereBestellVorschlagWKL43"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Check1_Click()
    On Error GoTo LOKAL_ERROR
    
    If Check1.value = vbChecked Then
        Text1(3).Visible = False
        Text1(3).Text = ""
        Text1(4).Visible = False
        Text1(4).Text = ""
        Text1(5).Text = ""
        Text1(6).Text = ""
        Label1(8).Visible = False
        Label1(9).Visible = False
        Text1(5).Visible = False
        Text1(6).Visible = False
        Command2(1).Visible = False
        Command2(3).Visible = False
    End If
    
    If Check1.value = vbUnchecked Then
        Text1(3).Visible = True
        Text1(4).Visible = True
        If Option1(1).value = True Then
            Label1(8).Visible = True
            Label1(9).Visible = True
            Text1(5).Visible = True
            Text1(6).Visible = True
            Command2(1).Visible = True
            Command2(3).Visible = True
        End If
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check1_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Check10_Click()
On Error GoTo LOKAL_ERROR

    If Check10.value = vbChecked Then

        List6.Visible = True
    Else
        List6.Clear
        List6.Visible = False
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check10_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Check19_Click()
On Error GoTo LOKAL_ERROR
    
    If Check19.value = vbChecked Then
        'ausblenden
        artikel_suchen
    Else
        'Einblenden
        artikel_suchen
    End If
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check19_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Check20_Click()
On Error GoTo LOKAL_ERROR
    
    If Check20.value = vbChecked Then
        'ausblenden
        artikel_suchen
    Else
        'Einblenden
        artikel_suchen
    End If
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check20_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Check6_Click()
On Error GoTo LOKAL_ERROR
    
    If Check6.value = vbChecked Then
        Command1_Click 0
    Else
        
    End If
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check6_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Check8_Click()
On Error GoTo LOKAL_ERROR
    
    If Check8.value = vbChecked Then
        Check9.Visible = True
    Else
        Check9.Visible = False
    End If
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Check8_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub CheckAlle_Click()
    On Error GoTo LOKAL_ERROR
    
    Dim lcount  As Long
    
    
    If CheckAlle = vbChecked Then
    
        For lcount = 0 To List3.ListCount - 1
                List3.Selected(lcount) = True
        Next lcount
        
    Else
    
        For lcount = 0 To List3.ListCount - 1
            List3.Selected(lcount) = False
        Next lcount

    End If
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "CheckAlle_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1

End Sub

Private Sub cmdDelMitt_Click()
    On Error GoTo LOKAL_ERROR

    txt2.Text = ""
    txt2.SetFocus
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdDelMitt_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub cmdMittClose_Click()
    On Error GoTo LOKAL_ERROR

    Dim ctmp As String
    Dim cSQL As String
    
    ctmp = txt2.Text
    ctmp = Trim$(ctmp)
    ctmp = SwapStr(ctmp, "'", " ")
    
    cSQL = "Update vorschlz Set MITTEILUNG = '" & ctmp & "' "
    gdApp.Execute cSQL, dbFailOnError
    
    fra4.Visible = False
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdMittClose_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub Command0_Click(index As Integer)
    On Error GoTo LOKAL_ERROR

    Dim lrow        As Long
    Dim lcol        As Long
    Dim ctmp        As String
    Dim iFeld       As Integer

    If Frame5.Visible Then
        ctmp = Text3.Text
    Else

        iFeld = Val(Label0(0).Caption)
        ctmp = Text1(iFeld).Text

    End If
    Select Case index
        Case 0 To 9
            ctmp = ctmp & Command0(index).Caption
            Text1(iFeld).Text = ctmp
            Text1(iFeld).SetFocus

        Case Is = 10
            If Len(ctmp) > 0 Then
                ctmp = Left(ctmp, Len(ctmp) - 1)
            End If
            Text1(iFeld).Text = ctmp
            Text1(iFeld).SetFocus

        Case Is = 11
            Text1(iFeld).Text = ""
            Text1(iFeld).SetFocus

        Case Is = 12
            Text1_KeyUp iFeld, vbKeyF2, 0
            
        Case Is = 54 'Lieferant
            Text1_KeyUp 0, vbKeyF2, 0
            
        Case Is = 55 'Linie
            Text1_KeyUp 1, vbKeyF2, 0
            
        Case Is = 57 'AGN
            Text1_KeyUp 8, vbKeyF2, 0

        Case Is = 13
            If iFeld > 0 Then
                iFeld = iFeld - 1
            End If
            Text1(iFeld).SetFocus
        Case Is = 14
            If iFeld < 4 Then
                iFeld = iFeld + 1
            End If
            Text1(iFeld).SetFocus

        Case Is = 15
            If iFeld = 5 Or iFeld = 6 Then
                ctmp = ctmp & Command0(index).Caption
                Text1(iFeld).Text = ctmp
                Text1(iFeld).SetFocus
            End If
            Text1(iFeld).SetFocus

        Case 16 To 51
            ctmp = ctmp & Command0(index).Caption
            Text3.Text = ctmp
            Text3.SetFocus

        Case Is = 52
            Text3.Text = ""
            Text3.SetFocus

        Case Is = 53
            If iFeld = 4 Then
                If InStr(ctmp, ",") = 0 Then
                    ctmp = ctmp & Command0(index).Caption
                    Text1(iFeld).Text = ctmp
                End If
                Text1(iFeld).SetFocus
            End If
            Text1(iFeld).SetFocus

        Case 58 To 67
            ctmp = ctmp & Command0(index).Caption
            gbAender = True

        Case Is = 57
            If Len(ctmp) > 0 Then
                ctmp = Left(ctmp, Len(ctmp) - 1)
            End If

            gbAender = True
        Case Is = 56
             List6_KeyUp vbKeyF2, 0
    End Select

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command0_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
    
    
End Sub

Private Sub Command1_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim iRet        As Integer
    Dim lcount      As Long
    Dim cdatei      As String
    Dim cDatum      As String
    Dim ctmp        As String
    Dim cLinr       As String
    Dim cPfad       As String
    
    Screen.MousePointer = 11
    
    Select Case index
        Case Is = 0
            iRet = fnPruefeDialogEingabenWKL43()
            If iRet = 0 Then
                gcBestellName = ""
                gcMitteilung = ""
                Text4.Text = ""
                cLinr = Text1(0).Text
                SSCommand2(2).Enabled = True
                
                voreinstellungspeichernE43B
                loeschNEW "AN" & srechnertab, gdBase
                ErstelleBestellVORSCHLZZENaa
                List3.Clear
            Else
                Select Case iRet
                    Case Is = 1
                        MsgBox "Bitte die Lieferanten-Nummer angeben!", vbCritical, "STOP!"
                        Text1(0).SetFocus
                    Case Is = 2
                        MsgBox "Bitte die Untergrenze der Produktlinien angeben!", vbCritical, "STOP!"
                        Text1(1).SetFocus
                    Case Is = 3
                        MsgBox "Bitte die Obergrenze der Produktlinien angeben!", vbCritical, "STOP!"
                        Text1(2).SetFocus
                    Case Is = 4
                        MsgBox "Bitte die Eindeckwochenzeit angeben!", vbCritical, "STOP!"
                        Text1(3).SetFocus
                    Case Is = 5
                        MsgBox "Bitte den Bevorratungsfaktor angeben!", vbCritical, "STOP!"
                        Text1(4).SetFocus
                    Case Is = 6
                        MsgBox "Die Untergrenze der Produktlinien ist größer als die Obergrenze!", vbCritical, "STOP!"
                        Text1(1).SetFocus
                    Case Is = 51
                        MsgBox "Bitte ein gültiges Datum eingeben (Format TT.MM.JJJJ)!", vbCritical, "STOP!"
                        Text1(5).SetFocus
                    Case Is = 52
                        MsgBox "Bitte ein gültiges Datum eingeben (Format TT.MM.JJJJ)!", vbCritical, "STOP!"
                        Text1(5).SetFocus
                    Case Is = 53
                        MsgBox "Der eingegebene Termin liegt in der Zukunft!", vbCritical, "STOP!"
                        Text1(5).SetFocus
                    Case Is = 61
                        MsgBox "Bitte ein gültiges Datum eingeben (Format TT.MM.JJJJ)!", vbCritical, "STOP!"
                        Text1(6).SetFocus
                    Case Is = 62
                        MsgBox "Bitte ein gültiges Datum eingeben (Format TT.MM.JJJJ)!", vbCritical, "STOP!"
                        Text1(6).SetFocus
                    Case Is = 63
                        MsgBox "Der eingegebene Termin liegt in der Zukunft!", vbCritical, "STOP!"
                        Text1(6).SetFocus
                    Case Is = 71
                        MsgBox "Das VON-Datum ist größer als das BIS-Datum!", vbCritical, "STOP!"
                        Text1(5).SetFocus
                    Case Is = 72
                        iRet = MsgBox("Die Differenz der Datumsfelder in ungewöhnlich groß. Ist die Eingabe richtig?", vbQuestion + vbYesNo, "ZEITRAUM")
                        If iRet = vbYes Then
                            ErstelleBestellVORSCHLZZENaa
                        Else
                            Text1(5).SetFocus
                        End If
                End Select
            End If
        Case Is = 1     'Beenden
            Unload frmWKL43
            
        Case Is = 2     'Vorschlag laden
            Frame7.Visible = True
            Text1(0).Text = ""
            delOld "X"
            
            vorher_holen_X_BV
            
            ListeFuellAnfangsbuch "X", frmWKL43.List4
                  
            Frame7.Visible = True
            Frame0.Visible = False
            Frame1.Visible = False
            
        Case Is = 3     'Einstellungen früher neuer Vorschlag
        
            Frame10.Visible = True
    
            Frame0.Visible = False
            Frame1.Visible = False
            
        Case Is = 4     'löschen Textblock
            If List5.ListIndex < 0 Then
                anzeige "rot", "Bitte einen Eintrag auswählen!", Label1(5)
                Exit Sub
            End If
            DELblock CLng(Right$(List5.list(List5.ListIndex), 10))
            ZeigeblockinList "BESTELLUNG", List5
            anzeige "normal", "Eintrag wurde gelöscht", Label1(5)
            txt2.Text = ""
            Text11.Text = ""
        Case 5  'auswählen
            If List5.ListIndex < 0 Then
                anzeige "rot", "Bitte einen Eintrag auswählen!", Label1(5)
                Exit Sub
            End If
            ZeigeblockinEinzelteile "BESTELLUNG", List5, Text11, txt2, CLng(Right$(List5.list(List5.ListIndex), 10))
        Case 6 'leeren
            Text11.Text = ""
            txt2.Text = ""
        Case 7 'Vorschlag rechnen/zeigen
            If NewTableSuchenDBKombi("BESTLIN", gdBase) Then
                If Datendrin("BESTLIN", gdBase) Then
                    iRet = MsgBox("Möchten Sie den Bestellvorschlag neu erstellen?", vbYesNo + vbQuestion, "Winkiss Frage:")
                    If iRet = vbNo Then
                        anzeige "normal", "Druckvorschau wird erstellt...", lbl7
                        reportbildschirm "", "aZEN43a"
                        anzeige "normal", "", lbl7
                    Else
                        ErmittleBestVorschlag lbl7
                        lWEinBESTLIN lbl7
                        If Datendrin("BESTLIN", gdBase) Then
                            anzeige "normal", "Druckvorschau wird erstellt...", lbl7
                            reportbildschirm "", "aZEN43a"
                            anzeige "normal", "", lbl7
                        End If
                    End If
                Else
                    ErmittleBestVorschlag lbl7
                    lWEinBESTLIN lbl7
                    If Datendrin("BESTLIN", gdBase) Then
                        anzeige "normal", "Druckvorschau wird erstellt...", lbl7
                        reportbildschirm "", "aZEN43a"
                        anzeige "normal", "", lbl7
                    End If
                
                End If
            Else
                ErmittleBestVorschlag lbl7
                lWEinBESTLIN lbl7
                If Datendrin("BESTLIN", gdBase) Then
                    anzeige "normal", "Druckvorschau wird erstellt...", lbl7
                    reportbildschirm "", "aZEN43a"
                    anzeige "normal", "", lbl7
                End If
            End If
        
        Case 8
        
            frmWK15a.Show 1
            Unload frmWKL43
            
    End Select
    
    Screen.MousePointer = 0

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command1_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
    
    
End Sub
Private Sub Command10_Click()
On Error GoTo LOKAL_ERROR
    
    gsARTNR = "Bestellung"
    frmWKL89.Show 1
    gsARTNR = ""
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command10_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
    Fehlermeldung1
End Sub
Private Sub Command11_Click()
On Error GoTo LOKAL_ERROR
    
    frmWKL49.Show 1
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command11_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
    Fehlermeldung1
End Sub

Private Sub Command14_Click()
On Error GoTo LOKAL_ERROR

    
    
    Dim sSQL As String
    
    sSQL = "Delete from LISRT_MAIL where LINR = " & Label6(8).Caption
    gdBase.Execute sSQL, dbFailOnError
    
    Text14.Text = Trim(Text14.Text)
    If Text14.Text <> "" Then
        
'        Text14.Text = SwapStr(Text14.Text, Chr(10), "")
'        Text14.Text = SwapStr(Text14.Text, Chr(13), "")
        Text14.Text = SwapStr(Text14.Text, "'", " ")
        speicher_Mail_Text Label6(8).Caption, Text14.Text
    
    End If
    
    
    
    
    
    
    
    Frame12.Visible = False
    
    If GibtEsMailText(CLng(Text1(0).Text)) Then
        lbl2(3).ForeColor = vbRed
    Else
        lbl2(3).ForeColor = lbl5(4).ForeColor
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command14_Click"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Sub
Private Sub speicher_Mail_Text(lLinr As Long, sMailtext As String)
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL As String
    
    sSQL = "Insert into LISRT_MAIL (Linr,Mailtext) values ( " & lLinr & ",'" & sMailtext & "')"
    gdBase.Execute sSQL, dbFailOnError

    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "speicher_Mail_Text"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Sub
Private Sub Command2_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cArtNr     As String
    Dim Datum1 As Date
    
    Select Case index
        Case 0
            If Label9(49).Caption <> "" Then
            
                Datum1 = DateValue("01.01." & Label9(49).Caption)
                
                cArtNr = Right(lbl3.Caption, Len(lbl3.Caption) - 9)
                diagrammfuellen cArtNr, Datum1
                
                Label9(50).Caption = Label9(49).Caption
                Label9(49).Caption = CInt(Label9(49).Caption) - 1
                
            End If
        Case 2
            Text5.Text = Format(Datumschreiben11a(7500, 13000), "DD.MM.YYYY")
        Case 1
            Text1(5).Text = Format(Datumschreiben11a(3000, 4000), "DD.MM.YY")
        Case 3
            Text1(6).Text = Format(Datumschreiben11a(3000, 4000), "DD.MM.YY")
            'fertig
    End Select
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command2_Click"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Sub
Private Sub Command3_Click()
    On Error GoTo LOKAL_ERROR
    
    Dim cArtNr     As String
    Dim Datum1 As Date
    
    If Label9(50).Caption <> "" Then
    
        Label9(49).Caption = Label9(50).Caption
        Label9(50).Caption = CInt(Label9(50).Caption) + 1
        
        Datum1 = DateValue("01.01." & Label9(50).Caption)
        
        cArtNr = Right(lbl3.Caption, Len(lbl3.Caption) - 9)
        diagrammfuellen cArtNr, Datum1
        
    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command3_Click"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Sub
Private Sub Command4_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cArtNr      As String
    Dim Datum1      As Date
    
    Screen.MousePointer = 11
    Select Case index
        Case Is = 0
            SpeichereBestellVorschlagWKL43
            
            Command4_Click 1
            
        Case Is = 1
            Frame5.Visible = False
            fra0.Visible = True
        Case 2
            If List2.ListCount > 0 Then
                Datum1 = DateValue("01.01." & Label9(0).Caption)
                cArtNr = Left(List2.list(List2.ListIndex), 6)
                diagrammfuellenMod3 cArtNr, Datum1
                
                Label9(1).Caption = Label9(0).Caption
                Label9(0).Caption = CInt(Label9(0).Caption) - 1
            End If
            
        Case 3
            If List2.ListCount > 0 Then
                Label9(0).Caption = Label9(1).Caption
                Label9(1).Caption = CInt(Label9(1).Caption) + 1
                
                Datum1 = DateValue("01.01." & Label9(1).Caption)
                
                cArtNr = Left(List2.list(List2.ListIndex), 6)
                diagrammfuellenMod3 cArtNr, Datum1
            End If

    End Select
    Screen.MousePointer = 0
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command4_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Function ermDisLinr(cDateiName As String) As String
On Error GoTo LOKAL_ERROR

    Dim cSQL        As String
    Dim rsrs        As DAO.Recordset
    
    ermDisLinr = ""
    
    cSQL = "Select distinct(linr) as dislinr from " & cDateiName
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!dislinr) Then
            ermDisLinr = rsrs!dislinr
        End If
    End If
    rsrs.Close: Set rsrs = Nothing

Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermDisLinr"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Function
Private Sub Lade_Bestellvorschlag(cdat As String)
On Error GoTo LOKAL_ERROR

    Dim lcount      As Long
    Dim cdatei      As String
    Dim ctmp        As String
    Dim cDatum      As String
    Dim cPfad       As String
    Dim cPfad2      As String
    Dim cSQL        As String
    Dim rsRs2       As DAO.Recordset
    Dim rsrs        As DAO.Recordset
    Dim sAccPfad    As String
    Dim sBezVorschlag As String

    cPfad = gcPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    cPfad2 = gcDBPfad
    If Right(cPfad2, 1) <> "\" Then
        cPfad2 = cPfad2 & "\"
    End If

    loeschNEW "AN" & srechnertab, gdBase
    
    If cdat <> "" Then
        cdatei = cdat
    Else
                
        cdatei = List4.list(List4.ListIndex)
        
        
        sBezVorschlag = Mid(cdatei, 51, 20)
        Text4.Text = Trim(sBezVorschlag)
        
        cdatei = UCase$(cdatei)
        cdatei = Left(cdatei, 12)
        cdatei = Trim$(cdatei)
        
        sVorschlaege(0) = cdatei
        
        Set rsrs = gdApp.OpenRecordset(cdatei, dbOpenTable)
        If rsrs.EOF Then
            rsrs.Close: Set rsrs = Nothing
            MsgBox "Die Datei ist fehlerhaft. Sie konnte nicht geöffnet werden!", vbCritical, "Winkiss Hinweis:"
    
            loeschapp cdatei
            
            File1.Refresh 'Liste erneuern
            List4.Clear
            For lcount = 0 To File1.ListCount - 1
                cdatei = File1.list(lcount)
                cdatei = UCase$(cdatei)
                ctmp = cPfad & cdatei
                cDatum = FileDateTime(ctmp)
                cdatei = cdatei & Space$(12 - Len(cdatei)) & " " & cDatum
                List4.AddItem cdatei
            Next lcount
            Screen.MousePointer = 0
            
            Exit Sub
        Else
            rsrs.Close
        
        End If
    
    End If

    picprogress.Visible = True
    txtStatus.Text = "3"
    vorschlzRefresh
    SSCommand1.Caption = "Vorschlag > 0"
    txtStatus.Text = "4"
    
    If Not SpalteInTabellegefundenNEW(cdatei, "AGN", gdApp) Then
        SpalteAnfuegenNEW cdatei, "AGN", "long", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "MINMEN", gdApp) Then
        SpalteAnfuegenNEW cdatei, "MINMEN", "long", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "MINBEST", gdApp) Then
        SpalteAnfuegenNEW cdatei, "MINBEST", "long", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "BESTAND", gdApp) Then
        SpalteAnfuegenNEW cdatei, "BESTAND", "long", gdApp
    End If



    If Not SpalteInTabellegefundenNEW(cdatei, "AWM", gdApp) Then
        SpalteAnfuegenNEW cdatei, "AWM", "Text(2)", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "RKZ", gdApp) Then
        SpalteAnfuegenNEW cdatei, "RKZ", "Text(1)", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "EAN", gdApp) Then
        SpalteAnfuegenNEW cdatei, "EAN", "Text(13)", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "ekpr", gdApp) Then
        SpalteAnfuegenNEW cdatei, "ekpr", "double", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "vkpr", gdApp) Then
        SpalteAnfuegenNEW cdatei, "vkpr", "double", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "NOTIZEN", gdApp) Then
        SpalteAnfuegenNEW cdatei, "NOTIZEN", "Text(40)", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "FAKTOR", gdApp) Then
        SpalteAnfuegenNEW cdatei, "FAKTOR", "double", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "LPZ_VON", gdApp) Then
        SpalteAnfuegenNEW cdatei, "LPZ_VON", "long", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "LPZ_BIS", gdApp) Then
        SpalteAnfuegenNEW cdatei, "LPZ_BIS", "long", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "EINDECK", gdApp) Then
        SpalteAnfuegenNEW cdatei, "EINDECK", "long", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "INBEST", gdApp) Then
        SpalteAnfuegenNEW cdatei, "INBEST", "long", gdApp
    End If

    If Not SpalteInTabellegefundenNEW(cdatei, "BEVORRAT", gdApp) Then
        SpalteAnfuegenNEW cdatei, "BEVORRAT", "double", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "FAKTOR", gdApp) Then
        SpalteAnfuegenNEW cdatei, "FAKTOR", "double", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "VKAMo1", gdApp) Then
        SpalteAnfuegenNEW cdatei, "VKAMo1", "double", gdApp
    End If
   
    If Not SpalteInTabellegefundenNEW(cdatei, "VKVMo1", gdApp) Then
        SpalteAnfuegenNEW cdatei, "VKVMo1", "double", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "VKLJ1", gdApp) Then
        SpalteAnfuegenNEW cdatei, "VKLJ1", "double", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "VKVJ1", gdApp) Then
        SpalteAnfuegenNEW cdatei, "VKVJ1", "double", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "MITTEILUNG", gdApp) Then
        SpalteAnfuegenNEW cdatei, "MITTEILUNG", "Text(250)", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "ANZEIGE", gdApp) Then
        SpalteAnfuegenNEW cdatei, "ANZEIGE", "Integer", gdApp
    End If
    
    Dim i As Integer
    
    For i = 1 To 12
        If Not SpalteInTabellegefundenNEW(cdatei, "LJ" & i, gdApp) Then
            SpalteAnfuegenNEW cdatei, "LJ" & i, "Integer", gdApp
        End If
        
        If Not SpalteInTabellegefundenNEW(cdatei, "VJ" & i, gdApp) Then
            SpalteAnfuegenNEW cdatei, "VJ" & i, "Integer", gdApp
        End If
    Next i
    
    If Not SpalteInTabellegefundenNEW(cdatei, "PIN", gdApp) Then
        SpalteAnfuegenNEW cdatei, "PIN", "Text(1)", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "GROESSE", gdApp) Then
        SpalteAnfuegenNEW cdatei, "GROESSE", "Text(1)", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "MWST", gdApp) Then
        SpalteAnfuegenNEW cdatei, "MWST", "Text(1)", gdApp
    End If
    
    If Not SpalteInTabellegefundenNEW(cdatei, "HS", gdApp) Then
        SpalteAnfuegenNEW cdatei, "HS", "double", gdApp
    End If
    
    
    
    Set rsrs = gdApp.OpenRecordset(cdatei, dbOpenTable)
    txtStatus.Text = "6"
    Set rsRs2 = gdApp.OpenRecordset("vorschlz", dbOpenTable)
    txtStatus.Text = "8"

    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            rsRs2.AddNew
            rsRs2!artnr = rsrs!artnr
            rsRs2!BEZEICH = rsrs!BEZEICH
            rsRs2!AGN = rsrs!AGN
            rsRs2!lekpr = rsrs!lekpr
            rsRs2!AWM = rsrs!AWM
            rsRs2!ekpr = rsrs!ekpr
            rsRs2!vkpr = rsrs!vkpr
            rsRs2!linr = rsrs!linr
            cLinr = rsrs!linr
            rsRs2!LIBESNR = rsrs!LIBESNR
            rsRs2!KVKPR1 = rsrs!KVKPR1
            rsRs2!EAN = rsrs!EAN
            rsRs2!MOPREIS = rsrs!MOPREIS
            rsRs2!RKZ = rsrs!RKZ
            rsRs2!LPZ = rsrs!LPZ
            rsRs2!NOTIZEN = rsrs!NOTIZEN
            rsRs2!MINMEN = rsrs!MINMEN
            rsRs2!MINBEST = rsrs!MINBEST
            rsRs2!BESTAND = rsrs!BESTAND
            rsRs2!INBEST = rsrs!INBEST
            rsRs2!anzeige = rsrs!anzeige
            rsRs2!LPZ_VON = rsrs!LPZ_VON
            rsRs2!LPZ_BIS = rsrs!LPZ_BIS
            rsRs2!EINDECK = rsrs!EINDECK
            rsRs2!lekpr = rsrs!lekpr
            rsRs2!MOPREIS = rsrs!MOPREIS
            rsRs2!BESTVOR = rsrs!BESTVOR
            rsRs2!Faktor = rsrs!Faktor
            rsRs2!BEVORRAT = rsrs!BEVORRAT
            rsRs2!VKAMo1 = rsrs!VKAMo1
            rsRs2!VKVMO1 = rsrs!VKVMO1
            rsRs2!VKLJ1 = rsrs!VKLJ1
            rsRs2!VKVJ1 = rsrs!VKVJ1
            rsRs2!Mitteilung = rsrs!Mitteilung
            rsRs2!LJ1 = rsrs!LJ1
            rsRs2!LJ2 = rsrs!LJ2
            rsRs2!LJ3 = rsrs!LJ3
            rsRs2!LJ4 = rsrs!LJ4
            rsRs2!LJ5 = rsrs!LJ5
            rsRs2!LJ6 = rsrs!LJ6
            rsRs2!LJ7 = rsrs!LJ7
            rsRs2!LJ8 = rsrs!LJ8
            rsRs2!LJ9 = rsrs!LJ9
            rsRs2!LJ10 = rsrs!LJ10
            rsRs2!LJ11 = rsrs!LJ11
            rsRs2!LJ12 = rsrs!LJ12
            rsRs2!VJ1 = rsrs!VJ1
            rsRs2!VJ2 = rsrs!VJ2
            rsRs2!VJ3 = rsrs!VJ3
            rsRs2!VJ4 = rsrs!VJ4
            rsRs2!VJ5 = rsrs!VJ5
            rsRs2!VJ6 = rsrs!VJ6
            rsRs2!VJ7 = rsrs!VJ7
            rsRs2!VJ8 = rsrs!VJ8
            rsRs2!VJ9 = rsrs!VJ9
            rsRs2!VJ10 = rsrs!VJ10
            rsRs2!VJ11 = rsrs!VJ11
            rsRs2!VJ12 = rsrs!VJ12
            rsRs2!GROESSE = rsrs!GROESSE
            rsRs2!PIN = rsrs!PIN
            rsRs2!MWST = rsrs!MWST
            rsRs2!HS = rsrs!HS
            
            
            rsRs2.Update
            rsrs.MoveNext
        Loop
    End If
    rsRs2.Close: Set rsRs2 = Nothing: Set rsRs2 = Nothing
    rsrs.Close: Set rsrs = Nothing
    
    txtStatus.Text = "24"
    
    Frame0.Visible = True
    
    gcBestellName = ""
    gcMitteilung = ""
    LeseMitteilungWKL43
    
    txtStatus.Text = "46"

    Screen.MousePointer = 11

    lbl6(15).Caption = gcFilNr
    
    sAccPfad = App.Path & "\kissapp.mdb"
    
    loeschNEW "ARTLIEF", gdApp
    TransferTab gdBase, sAccPfad, "ARTLIEF"

    loeschNEW "KONTIN", gdApp
    TransferTab gdBase, sAccPfad, "KONTIN"
    
    loeschNEW "INTERART", gdApp
    TransferTab gdBase, sAccPfad, "INTERART"
    
    'VPE
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].ARTLIEF AS B ON A.artnr = b.artnr and A.LINR = b.LINR"
    cSQL = cSQL & " SET A.MINMEN = B.MINMEN "
    cSQL = cSQL & " , A.RKZ = B.RKZ "
    gdApp.Execute cSQL, dbFailOnError
    
    'Bestand
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].ARTIKEL AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.BESTAND = B.BESTAND "
    gdApp.Execute cSQL, dbFailOnError
    
    'ARTMERK
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].ARTMERK AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.MERK = B.MERK "
    gdApp.Execute cSQL, dbFailOnError
    
    'ARTFARB2
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].ARTFARB2 AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.awm2 = B.awm2 "
    gdApp.Execute cSQL, dbFailOnError
    
    'MWST
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].ARTIKEL AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.MWST = B.MWST "
    gdApp.Execute cSQL, dbFailOnError
    
    'Interart
    cSQL = "UPDATE VORSCHLZ SET SHOP = 'N' "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].Interart AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.SHOP = 'J' "
    gdApp.Execute cSQL, dbFailOnError
    
    Text12.Text = ermMaxAufnr
    
    updatesorti
    
    cSQL = "Update VORSCHLZ set VORSCHLZ.SOKO = 999999 "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Update VORSCHLZ inner join KONTIN on VORSCHLZ.artnr = KONTIN.artnr "
    cSQL = cSQL & " set VORSCHLZ.SOKO = clng(VORSCHLZ.bestand) - clng(KONTIN.abestand) "
    gdApp.Execute cSQL, dbFailOnError
    
    
    'aktualisiere VK-Daten
    Dim cJahr       As String
    Dim cMonat      As String
    Dim cJahrV      As String
    Dim cMonatV     As String
    
    cJahr = Year(Now)
    cMonat = Month(Now)
    If cMonat = "1" Then
        cMonatV = "12"
        cJahrV = Trim$(Str$(((Val(cJahr)) - 1)))
    Else
        cMonatV = cMonat - 1
        cJahrV = cJahr
    End If
    
    
    
    
    'VKLJ1
    cSQL = "UPDATE VORSCHLZ SET VKLJ1 = 0 "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].UMSARTJ AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.VKLJ1 = B.ANZAHLJ "
    cSQL = cSQL & " where B.Jahr =" & cJahr
    gdApp.Execute cSQL, dbFailOnError
    
    
                
    'VKLJ1
    cSQL = "UPDATE VORSCHLZ SET VKVJ1 = 0 "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].UMSARTJ AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.VKVJ1 = B.ANZAHLJ "
    cSQL = cSQL & " where B.Jahr =" & cJahr - 1
    gdApp.Execute cSQL, dbFailOnError
    


    'VKVMo1
    cSQL = "UPDATE VORSCHLZ SET VKVMO1 = 0 "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].UMS_ART AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.VKVMO1 = B.ANZAHL "
    cSQL = cSQL & " where B.Jahr =" & cJahrV
    cSQL = cSQL & " and B.Monat =" & cMonatV
    gdApp.Execute cSQL, dbFailOnError
    


    'VKAMo1
    cSQL = "UPDATE VORSCHLZ SET VKAMO1 = 0 "
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "UPDATE VORSCHLZ AS A INNER JOIN"
    cSQL = cSQL & "[;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].UMS_ART AS B ON A.artnr = b.artnr"
    cSQL = cSQL & " SET A.VKAMO1 = B.ANZAHL "
    cSQL = cSQL & " where B.Jahr =" & cJahr
    cSQL = cSQL & " and B.Monat =" & cMonat
    gdApp.Execute cSQL, dbFailOnError
    
    
    Dim cArtNr As String
    'Vorhandene Bestellungen einlesen
    Set rsrs = gdApp.OpenRecordset("VORSCHLZ", dbOpenTable)
    rsrs.index = "ARTNR"
    
    '************* BESTREST hat kein FILIALNR ******************
    cSQL = "Select ARTNR, SUM(BESTVOR) as INBEST from BESTREST group by ARTNR "
    Set rsRs2 = gdBase.OpenRecordset(cSQL)
    
    If Not rsRs2.EOF Then
        rsRs2.MoveFirst
        Do While Not rsRs2.EOF
            If Not IsNull(rsRs2!artnr) Then
                cArtNr = rsRs2!artnr
            Else
                cArtNr = "-1"
            End If
            rsrs.Seek "=", cArtNr
            If Not rsrs.NoMatch Then
                rsrs.Edit
                rsrs!INBEST = rsRs2!INBEST
                rsrs.Update
            End If
            
            rsRs2.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    rsRs2.Close: Set rsRs2 = Nothing
    
    
    
    
    
    
    

    

    '********** GraphFüllenWKL43 ************
        
    If Check2.value = vbChecked Then
    
        'mit KollegenVerkauf
        GraphFuellenWKL43 Bilde_Umsatz_plusKollVK(cLinr)
    
    Else
        GraphFuellenWKL43 "UMS_ART"
    End If
    
    
    
    
    
    Handelsspanne_rechnen
    
    
    
    zeige_Grid True
    
    Frame7.Visible = False
    
    Screen.MousePointer = 0
    

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Lade_Bestellvorschlag"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
'    Resume Next
End Sub
Private Sub Command5_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    Screen.MousePointer = 11
    
    Dim lRet        As Long
    Dim lfail       As Long
    Dim lcount      As Long
    Dim cdatei      As String
    Dim cQuelle     As String
    
    Dim ctmp        As String
    Dim cDatum      As String
    Dim cPfad       As String
    Dim cPfad2      As String
    Dim iFileNr     As Integer
    Dim cSQL        As String
    Dim rsRs2       As DAO.Recordset
    Dim rsrs        As DAO.Recordset
    Dim rsrs1       As DAO.Recordset
    Dim sAccPfad    As String
    Dim cArtNr      As String
    Dim lLinr       As Long
    Dim dMindest    As Double
    Dim dBestellung As Double
    Dim iRet        As Integer
    Dim mdeErrPrint_sofort As Boolean
    Dim bzusammenlegen As Boolean
    Dim i           As Integer
    
    mdeErrPrint_sofort = False
    bzusammenlegen = False
    
    cPfad = gcPfad
    If Right(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    cPfad2 = gcDBPfad
    If Right(cPfad2, 1) <> "\" Then
        cPfad2 = cPfad2 & "\"
    End If
    
    Select Case index
        Case Is = 0 'Laden
        
            If NewTableSuchenDBKombi("LINBEZ", gdApp) = False Then
                sAccPfad = App.Path & "\kissapp.mdb"
                
                loeschNEW "LINBEZ", gdApp
                TransferTab gdBase, sAccPfad, "LINBEZ"
            End If
        
            For i = 0 To 9
                sVorschlaege(i) = ""
            Next i
        
            fra0.Visible = False

            If List4.ListIndex < 0 Then
                MsgBox "Bitte einen Eintrag auswählen!", vbInformation, "Winkiss Hinweis:"
                List4.SetFocus
            Else
            
                Dim cLinrPruef As String
                Dim cAktLinrPruef As String
                Dim lZaehler As Long
                lZaehler = 0
                For lcount = 0 To List4.ListCount - 1
                    If List4.Selected(lcount) = True Then
                        lZaehler = lZaehler + 1
                    End If
                Next lcount
            
                If lZaehler > 1 Then 'mehrere sind markiert
                    iRet = MsgBox("Wollen Sie die " & lZaehler & " Bestell-Dateien wirklich zusammenlegen?", vbYesNo + vbDefaultButton2 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                    
                        For lcount = 0 To List4.ListCount - 1
                            If List4.Selected(lcount) = True Then
                                cdatei = List4.list(lcount)
                                cdatei = UCase$(cdatei)
                                cdatei = Left(cdatei, 12)
                                cdatei = Trim$(cdatei)
    
                                cAktLinrPruef = ermDisLinr(cdatei)
                                
                                If cLinrPruef <> "" Then
                                    If cAktLinrPruef <> cLinrPruef Then
                                        MsgBox "Bitte gleiche Lieferanten auswählen!", vbInformation, "Winkiss Hinweis:"
                                        bzusammenlegen = False
                                        Exit For
                                        Exit Sub
                                    Else
                                         bzusammenlegen = True
                                    End If
                                Else
                                    cLinrPruef = cAktLinrPruef
                                End If
                    
                            End If
                        Next lcount
                    End If
                    
                    'alles OKAY, dann zusammenlegen
                    
                    If bzusammenlegen = True Then
                        loeschNEW "BESTDAT" & srechnertab, gdApp
                        
                        lZaehler = 0
                        
                        For lcount = 0 To List4.ListCount - 1
                        
                            If List4.Selected(lcount) = True Then
                                cdatei = List4.list(lcount)
                                cdatei = UCase$(cdatei)
                                cdatei = Left(cdatei, 12)
                                cdatei = Trim$(cdatei)
                                
                                sVorschlaege(lZaehler) = cdatei
                                
                                
                                
                                
                                If SpalteInTabellegefundenNEW(cdatei, "BESTVOR_PROBEN", gdApp) = False Then
                                    SpalteAnfuegenNEW cdatei, "BESTVOR_PROBEN", "Long", gdApp
                        
                                    cSQL = "Update " & cdatei & " set BESTVOR_PROBEN = 0 "
                                    gdApp.Execute cSQL, dbFailOnError
                                End If

                                If SpalteInTabellegefundenNEW(cdatei, "BESTVOR_TESTER", gdApp) = False Then
                                    SpalteAnfuegenNEW cdatei, "BESTVOR_TESTER", "Long", gdApp
                        
                                    cSQL = "Update " & cdatei & " set BESTVOR_TESTER = 0 "
                                    gdApp.Execute cSQL, dbFailOnError
                                End If
                                
                                If SpalteInTabellegefundenNEW(cdatei, "BESTVOR_NR", gdApp) = False Then
                                    SpalteAnfuegenNEW cdatei, "BESTVOR_NR", "Long", gdApp
                        
                                    cSQL = "Update " & cdatei & " set BESTVOR_NR = 0 "
                                    gdApp.Execute cSQL, dbFailOnError
                                End If
                                
                                
                                
                                
                                lZaehler = lZaehler + 1
                                
                                If lZaehler > 1 Then
                                
                                    cSQL = "Update BESTDAT" & srechnertab & " inner join " & cdatei
                                    cSQL = cSQL & " on BESTDAT" & srechnertab & ".artnr = " & cdatei & ".artnr "
                                    cSQL = cSQL & " set BESTDAT" & srechnertab & ".bestvor = BESTDAT" & srechnertab & ".bestvor  + " & cdatei & ".bestvor "
                                    gdApp.Execute cSQL, dbFailOnError
                                
                                    cSQL = "Insert into BESTDAT" & srechnertab & " select * from " & cdatei
                                    cSQL = cSQL & " where not artnr in (Select Artnr from BESTDAT" & srechnertab & ")"
                                    gdApp.Execute cSQL, dbFailOnError
                
                                Else
                                    cSQL = "Select * into BESTDAT" & srechnertab & " from " & cdatei
                                    gdApp.Execute cSQL, dbFailOnError
                                End If
                                
                                
                    
                            End If
                        Next lcount
                        
                        Lade_Bestellvorschlag "BESTDAT" & srechnertab
                    End If

                    
                Else
            
                    Lade_Bestellvorschlag ""
                End If
              
            End If
     
        Case Is = 1 'Löschen
            If List4.ListIndex < 0 Then
                MsgBox "Bitte einen Eintrag auswählen!", vbInformation, "Winkiss Hinweis:"
                List4.SetFocus
            Else
            
            
                lZaehler = 0
                For lcount = 0 To List4.ListCount - 1
                    If List4.Selected(lcount) = True Then
                        lZaehler = lZaehler + 1
                    End If
                Next lcount
            
                If lZaehler > 1 Then 'mehrere sind markiert
                    iRet = MsgBox("Wollen Sie die " & lZaehler & " Bestell-Dateien wirklich löschen?", vbYesNo + vbDefaultButton2 + vbQuestion, "Winkiss Frage:")
                    If iRet = vbYes Then
                    
                        For lcount = 0 To List4.ListCount - 1
                            If List4.Selected(lcount) = True Then
                                cdatei = List4.list(lcount)
                                cdatei = UCase$(cdatei)
                                cdatei = Left(cdatei, 12)
                                cdatei = Trim$(cdatei)
                                cPfad = gcPfad
                                If Right(cPfad, 1) <> "\" Then
                                    cPfad = cPfad & "\"
                                End If
                                cQuelle = cPfad & cdatei
                                
                                loeschapp cdatei
                
                            End If
                        Next lcount
                        
                    End If
                    
                Else
                
                    For lcount = 0 To List4.ListCount - 1
                        If List4.Selected(lcount) = True Then
                            cdatei = List4.list(lcount)
                            cdatei = UCase$(cdatei)
                            cdatei = Left(cdatei, 12)
                            cdatei = Trim$(cdatei)
                            cPfad = gcPfad
                            If Right(cPfad, 1) <> "\" Then
                                cPfad = cPfad & "\"
                            End If
                            cQuelle = cPfad & cdatei
                            
                            lRet = MsgBox("Wollen Sie die markierte Datei wirklich löschen?", vbQuestion + vbYesNo, "LÖSCHEN")
                            If lRet = vbYes Then
                                loeschapp cdatei
                            End If
            
                        End If
                    Next lcount
                
                
                
                
                
                End If
                
                ListeFuellAnfangsbuch "X", frmWKL43.List4
            End If
                
        Case Is = 2
            Frame0.Visible = True
            Frame1.Visible = True
            Frame7.Visible = False
        
        Case Is = 3 'aus MDE
        
            anzeige "normal", "", lbl7
            voreinstellungspeichernE43B
            
            If Text1(0).Text <> "" Then
                If IsNumeric(Text1(0).Text) Then
                    cLinr = Val(Text1(0).Text)
                Else
                    anzeige "rot", "Bitte Lieferanten wählen", lbl7
                    Text1(0).SetFocus
                    Screen.MousePointer = 0
                    Exit Sub
                End If
            Else
                anzeige "rot", "Bitte Lieferanten wählen", lbl7
                Text1(0).SetFocus
                Screen.MousePointer = 0
                Exit Sub
            End If
            
            If MDEeinlesenOhneLinr(lbl7, txtStatus, picprogress, frmWKL43) = False Then
                anzeige "rot", "Es konnten keine Daten aus dem MDE - Gerät ausgelesen werden.", lbl7
                Exit Sub
            Else
                picprogress.Visible = True
                txtStatus.Text = "3"
                vorschlzRefresh
                SSCommand1.Caption = "Vorschlag > 0"
    
                txtStatus.Text = "4"
        
                WeiterverarbeitungMDE cLinr
            End If
            
             sAccPfad = App.Path & "\kissapp.mdb"
            
            loeschNEW "ARTLIEF", gdApp
            TransferTab gdBase, sAccPfad, "ARTLIEF"
            
            loeschNEW "KONTIN", gdApp
            TransferTab gdBase, sAccPfad, "KONTIN"
            
            
            cSQL = "Update VORSCHLZ inner join artlief"
            cSQL = cSQL & " on VORSCHLZ.artnr = artlief.artnr "
            cSQL = cSQL & " set VORSCHLZ.libesnr = artlief.libesnr "
            cSQL = cSQL & " , VORSCHLZ.minmen = artlief.minmen "
            cSQL = cSQL & " , VORSCHLZ.LEKPR = artlief.LEKPR "
            cSQL = cSQL & " , VORSCHLZ.LINR = artlief.LINR "
            
            cSQL = cSQL & " , VORSCHLZ.RKZ = artlief.RKZ "
'            cSQL = cSQL & " , VORSCHLZ.EXDAT = artlief.EXDAT "
            
            cSQL = cSQL & " Where artlief.linr = " & cLinr
            gdApp.Execute cSQL, dbFailOnError
            
            
            
            
            
            
            If mdeErr = True Then
                Command5(4).Visible = True
                Command5(4).BackColor = vbRed
                
                
                iRet = MsgBox("Möchten Sie das Protokoll der 'unbestellbaren Artikel' sofort drucken?", vbQuestion + vbYesNo, "Winkiss Frage:")
                If iRet = vbYes Then
                    mdeErrPrint_sofort = True
'                    Command5_Click 4
                End If
                
                
            End If

            txtStatus.Text = "24"

            Frame0.Visible = True

            gcBestellName = ""
            gcMitteilung = ""
            LeseMitteilungWKL43

            txtStatus.Text = "46"

            Screen.MousePointer = 11

            lbl6(15).Caption = gcFilNr
            
            'sind woanders günstiger, dann löschen
            If Check10.value = vbChecked Then
            
                loeschNEW "BESTEVER", gdApp
                CreateTableT2 "BESTEVER", gdApp
            
                cSQL = "Select * from VORSCHLZ"
                Set rsrs1 = gdApp.OpenRecordset(cSQL)
                If Not rsrs1.EOF Then
                    rsrs1.MoveFirst
                    Do While Not rsrs1.EOF
                        If Not IsNull(rsrs1!artnr) Then
                            cArtNr = rsrs1!artnr
                        Else
                            cArtNr = ""
                        End If
                        
                        
                        
                        If List6.ListCount > 0 Then
                            For lcount = 0 To List6.ListCount - 1
                                lLinr = Val(Trim(Left(List6.list(lcount), 6)))
                                If ArtikelmitkleinerenLEKandererLieferantenloeschen(cArtNr, lLinr) = True Then

                                End If
                            Next lcount
                        Else
                            If ArtikelmitkleinerenLEKandererLieferantenloeschen(cArtNr, 0) = True Then
                                
                            End If
                        End If
                        
                        rsrs1.MoveNext
                    Loop
                    
                End If
                rsrs1.Close: Set rsrs1 = Nothing
            End If
            'Ende ***  sind woanders günstiger, dann löschen
            
            If Check15.value = vbChecked Then
                cSQL = "Update VORSCHLZ "
                cSQL = cSQL & " set BESTVOR = BESTVOR * MINMEN"
                cSQL = cSQL & " where not minmen is null"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            If Check1.value = vbChecked Then
                cSQL = "Select ARTNR, MINMEN, BESTVOR "
                cSQL = cSQL & " from VORSCHLZ"
                Set rsrs = gdApp.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
                    
                    Do While Not rsrs.EOF
                    
                        If Not IsNull(rsrs!BESTVOR) Then
                            dBestellung = rsrs!BESTVOR
                        Else
                            dBestellung = 0
                        End If
                        
                        If Not IsNull(rsrs!MINMEN) Then
                            dMindest = rsrs!MINMEN
                        Else
                            dMindest = 0
                        End If
                        
                        If dMindest = 0 Then
                            dMindest = 1
                        End If
                        
                        If dBestellung < 0 Then
                            dBestellung = 0
                        End If
                         
                        dBestellung = dBestellung / dMindest
                        If dBestellung <> Fix(dBestellung) Then
                            dBestellung = Fix(dBestellung) + 1
                        End If
                        dBestellung = dBestellung * dMindest
                        
                        rsrs.Edit
                        rsrs!BESTVOR = dBestellung
                        rsrs.Update
                       
                        rsrs.MoveNext
                    Loop
                End If
                rsrs.Close: Set rsrs = Nothing
            
            End If
            
            'unbekannte bzw nicht dem Lieferanten zugehörig
            
            loeschNEW "INTERART", gdApp
            TransferTab gdBase, sAccPfad, "INTERART"

            cSQL = "Update VORSCHLZ inner join INTERART on VORSCHLZ.artnr = INTERART.artnr "
            cSQL = cSQL & " set VORSCHLZ.SHOP = 'J' "
            gdApp.Execute cSQL, dbFailOnError

            loeschNEW "ARTFARB2", gdApp
            TransferTab gdBase, sAccPfad, "ARTFARB2"

            cSQL = "Update VORSCHLZ inner join ARTFARB2 on VORSCHLZ.artnr = ARTFARB2.artnr "
            cSQL = cSQL & " set VORSCHLZ.awm2 = artfarb2.awm2 "
            gdApp.Execute cSQL, dbFailOnError

            loeschNEW "ARTMERK", gdApp
            TransferTab gdBase, sAccPfad, "ARTMERK"

            cSQL = "Update VORSCHLZ inner join ARTMERK on VORSCHLZ.artnr = ARTMERK.artnr "
            cSQL = cSQL & " set VORSCHLZ.MERK = ARTMERK.MERK "
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Update VORSCHLZ set LINR = " & cLinr
            gdApp.Execute cSQL, dbFailOnError

            Text12.Text = ermMaxAufnr
            
            loeschNEW "LINBEZ", gdApp
            TransferTab gdBase, sAccPfad, "LINBEZ"
            
            
            
            
            
            
            
            'Vorhandene Bestellungen einlesen
            Set rsrs = gdApp.OpenRecordset("VORSCHLZ", dbOpenTable)
            rsrs.index = "ARTNR"
            
            '************* BESTREST hat kein FILIALNR ******************
            cSQL = "Select ARTNR, SUM(BESTVOR) as INBEST from BESTREST group by ARTNR "
            Set rsRs2 = gdBase.OpenRecordset(cSQL)
            
            If Not rsRs2.EOF Then
                rsRs2.MoveFirst
                Do While Not rsRs2.EOF
                    If Not IsNull(rsRs2!artnr) Then
                        cArtNr = rsRs2!artnr
                    Else
                        cArtNr = "-1"
                    End If
                    rsrs.Seek "=", cArtNr
                    If Not rsrs.NoMatch Then
                        rsrs.Edit
                        rsrs!INBEST = rsRs2!INBEST
                        rsrs.Update
                    End If
                    
                    rsRs2.MoveNext
                Loop
            End If
            rsrs.Close: Set rsrs = Nothing
            rsRs2.Close: Set rsRs2 = Nothing: Set rsRs2 = Nothing
        
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
'            Frame7.Visible = False
            
            If Check10.value = vbChecked Then
            
                loeschNEW "ARTIKEL", gdApp
                TransferTab gdBase, sAccPfad, "ARTIKEL"
        
                cSQL = "Update BestEver set bvo = 0 "
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Update BestEver b inner join VORSCHLZ v on b.artnr = v.artnr set b.bvo = v.bestvor where v.bestvor > 0"
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Delete from BestEver where bvo = 0"
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Update BestEver b inner join artikel a on b.artnr = a.artnr "
                cSQL = cSQL & " set b.bezeich = a.bezeich "
                cSQL = cSQL & " , b.ean = a.ean "
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Update BestEver set Ersparnis_E = LEKPR_TEUER - LEKPR "
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Update BestEver set Ersparnis_KUM = Ersparnis_E * BVO "
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Delete from VORSCHLZ where artnr in (select artnr from BestEver)"
                gdApp.Execute cSQL, dbFailOnError
                
               
                
                sAccPfad = App.Path & "\kissapp.mdb"
                loeschNEW "LISRT", gdApp
                TransferTab gdBase, sAccPfad, "LISRT"
                
                cSQL = "Update BestEver set LINR_TEUER = " & cLinr
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Update BestEver b inner join LISRT l on b.LINR_TEUER = l.LINR "
                cSQL = cSQL & " set b.LIEFBEZ_TEUER = l.LIEFBEZ "
                cSQL = cSQL & " , b.KUERZEL_TEUER = l.KUERZEL "
                gdApp.Execute cSQL, dbFailOnError
                
                reportbildschirmApp "", "aWKL43d"
                
            End If
            
            
            
            'Bestimmte Farbe BVO =0
            If sFarbe1 <> "" Then
                cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe1 & "'"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            If sFarbe2 <> "" Then
                cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe2 & "'"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            If sFarbe3 <> "" Then
                cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe3 & "'"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            
            
            
            
            '********** GraphFüllenWKL43 ************
        
            If Check2.value = vbChecked Then
            
                'mit KollegenVerkauf
                GraphFuellenWKL43 Bilde_Umsatz_plusKollVK(cLinr)
            
            Else
                GraphFuellenWKL43 "UMS_ART"
            End If
            
            Handelsspanne_rechnen
            
            updatesorti

            zeige_Grid True

            Frame7.Visible = False
            
            If mdeErrPrint_sofort = True Then
                Command5_Click 4
            End If
                
                

            Screen.MousePointer = 0
        Case 4
            reportbildschirm "INVENe", "aWKL43m"
        Case 5
        
            anzeige "normal", "", lbl7
            
            If Text1(0).Text <> "" Then
                If IsNumeric(Text1(0).Text) Then
                    cLinr = Val(Text1(0).Text)
                Else
                    anzeige "rot", "Bitte Lieferanten wählen", lbl7
                    Text1(0).SetFocus
                    Screen.MousePointer = 0
                    Exit Sub
                End If
            Else
                anzeige "rot", "Bitte Lieferanten wählen", lbl7
                Text1(0).SetFocus
                Screen.MousePointer = 0
                Exit Sub
            End If
            
            picprogress.Visible = True
            txtStatus.Text = "3"
            vorschlzRefresh
            SSCommand1.Caption = "Vorschlag > 0"

            txtStatus.Text = "4"
        
            If Excelimport(cLinr) = False Then
            
                anzeige "rot", "keine Artikel", lbl7
                Text1(0).SetFocus
                Screen.MousePointer = 0
                Exit Sub
            
            End If
            
            sAccPfad = App.Path & "\kissapp.mdb"
            
            loeschNEW "ARTLIEF", gdApp
            TransferTab gdBase, sAccPfad, "ARTLIEF"
            
            cSQL = "Update VORSCHLZ inner join artlief"
            cSQL = cSQL & " on VORSCHLZ.artnr = artlief.artnr "
            cSQL = cSQL & " set VORSCHLZ.libesnr = artlief.libesnr "
            cSQL = cSQL & " , VORSCHLZ.minmen = artlief.minmen "
            cSQL = cSQL & " , VORSCHLZ.LEKPR = artlief.LEKPR "
            cSQL = cSQL & " , VORSCHLZ.LINR = artlief.LINR "
            
            cSQL = cSQL & " , VORSCHLZ.RKZ = artlief.RKZ "
'            cSQL = cSQL & " , VORSCHLZ.EXDAT = artlief.EXDAT "
            
            cSQL = cSQL & " Where artlief.linr = " & cLinr
            gdApp.Execute cSQL, dbFailOnError
            
            
            
            If mdeErr Then
                anzeigeNew "normal", "nicht erkannte Artikel werden angezeigt...", lbl7
                reportbildschirm "", "aWKL61e" 'Error artikel mde
                anzeigeNew "normal", "", lbl7
            End If
            
            
            txtStatus.Text = "24"

            Frame0.Visible = True

            gcBestellName = ""
            gcMitteilung = ""
            LeseMitteilungWKL43

            txtStatus.Text = "46"

            Screen.MousePointer = 11

            lbl6(15).Caption = gcFilNr
            
            'sind woanders günstiger, dann löschen
            If Check10.value = vbChecked Then
                cSQL = "Select * from VORSCHLZ"
                Set rsrs1 = gdApp.OpenRecordset(cSQL)
                If Not rsrs1.EOF Then
                    rsrs1.MoveFirst
                    Do While Not rsrs1.EOF
                        If Not IsNull(rsrs1!artnr) Then
                            cArtNr = rsrs1!artnr
                        Else
                            cArtNr = ""
                        End If
                        
                        If List6.ListCount > 0 Then
                            For lcount = 0 To List6.ListCount - 1
                        
                                lLinr = Val(Trim(Left(List6.list(lcount), 6)))
                                If ArtikelmitkleinerenLEKandererLieferantenloeschen(cArtNr, lLinr) = True Then
                                    gdApp.Execute "Delete from VORSCHLZ where artnr = " & cArtNr, dbFailOnError
                                End If
                            
                            Next lcount
                        End If
                        
                        rsrs1.MoveNext
                    Loop
                    
                End If
                rsrs1.Close: Set rsrs1 = Nothing
            End If
            'Ende ***  sind woanders günstiger, dann löschen
            
        
            sAccPfad = App.Path & "\kissapp.mdb"
            
            If Check15.value = vbChecked Then
                cSQL = "Update VORSCHLZ "
                cSQL = cSQL & " set BESTVOR = BESTVOR * MINMEN"
                cSQL = cSQL & " where not minmen is null"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            If Check1.value = vbChecked Then
                cSQL = "Select ARTNR, MINMEN, BESTVOR "
                cSQL = cSQL & " from VORSCHLZ"
                Set rsrs = gdApp.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
                    
                    Do While Not rsrs.EOF
                    
                        If Not IsNull(rsrs!BESTVOR) Then
                            dBestellung = rsrs!BESTVOR
                        Else
                            dBestellung = 0
                        End If
                        
                        If Not IsNull(rsrs!MINMEN) Then
                            dMindest = rsrs!MINMEN
                        Else
                            dMindest = 0
                        End If
                        
                        If dMindest = 0 Then
                            dMindest = 1
                        End If
                        
                        If dBestellung < 0 Then
                            dBestellung = 0
                        End If
                         
                        dBestellung = dBestellung / dMindest
                        If dBestellung <> Fix(dBestellung) Then
                            dBestellung = Fix(dBestellung) + 1
                        End If
                        dBestellung = dBestellung * dMindest
                        
                        rsrs.Edit
                        rsrs!BESTVOR = dBestellung
                        rsrs.Update
                       
                        rsrs.MoveNext
                    Loop
                End If
                rsrs.Close: Set rsrs = Nothing
            
            End If
            
            'unbekannte bzw nicht dem Lieferanten zugehörig
            
            loeschNEW "INTERART", gdApp
            TransferTab gdBase, sAccPfad, "INTERART"

            cSQL = "Update VORSCHLZ inner join INTERART on VORSCHLZ.artnr = INTERART.artnr "
            cSQL = cSQL & " set VORSCHLZ.SHOP = 'J' "
            gdApp.Execute cSQL, dbFailOnError

            loeschNEW "ARTFARB2", gdApp
            TransferTab gdBase, sAccPfad, "ARTFARB2"

            cSQL = "Update VORSCHLZ inner join ARTFARB2 on VORSCHLZ.artnr = ARTFARB2.artnr "
            cSQL = cSQL & " set VORSCHLZ.awm2 = artfarb2.awm2 "
            gdApp.Execute cSQL, dbFailOnError

            loeschNEW "ARTMERK", gdApp
            TransferTab gdBase, sAccPfad, "ARTMERK"

            cSQL = "Update VORSCHLZ inner join ARTMERK on VORSCHLZ.artnr = ARTMERK.artnr "
            cSQL = cSQL & " set VORSCHLZ.MERK = ARTMERK.MERK "
            gdApp.Execute cSQL, dbFailOnError
            
            
            
            
            'Bestimmte Farbe BVO =0
            If sFarbe1 <> "" Then
                cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe1 & "'"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            If sFarbe2 <> "" Then
                cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe2 & "'"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            If sFarbe3 <> "" Then
                cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe3 & "'"
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            
            

            Text12.Text = ermMaxAufnr
            
            loeschNEW "LINBEZ", gdApp
            TransferTab gdBase, sAccPfad, "LINBEZ"
            
            updatesorti

            zeige_Grid True

            Frame7.Visible = False

            Screen.MousePointer = 0
            
        Case 6
            voreinstellungspeichernE43B
            Frame0.Visible = True
            Frame1.Visible = True
            Frame10.Visible = False
            
            If Check13.value = vbChecked Then
                Frame11.Visible = True
                Frame2.Visible = False
            Else
                
                Frame11.Visible = False
                Frame2.Visible = True
            End If
    End Select
    
    Screen.MousePointer = 0

Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
    
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Command5_Click"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
        Resume Next
    End If
    
End Sub
Private Function Excelimport(sLinr As String) As Boolean
On Error GoTo LOKAL_ERROR
    
    Dim sSQL        As String
    Dim cPfad       As String
    Dim cDatname    As String
    Dim dbExcel     As Database
    Dim rsrs        As Recordset
    Dim rsRs2       As Recordset
    Dim rsArt       As Recordset
    Dim gsExcel50   As String
    Dim rsFilBu     As Recordset
    Dim seekEAN     As String
    Dim sArtnr      As String
    Dim sBudArtnr   As String
    Dim rsArtlief   As DAO.Recordset
    
    gsExcel50 = "Excel 5.0;"
    
    Excelimport = False
    
    If pfadseekExcel_Angebot = False Then
        anzeige "rot2", "Abbruch durch Benutzer", lbl7
        Exit Function
    End If
    
    Screen.MousePointer = 11

    cPfad = lbl7.Caption
    Set dbExcel = OpenDatabase(cPfad, 0, 0, gsExcel50)

    loeschNEW "TERMERR", gdBase
    CreateTableT2 "TERMERR", gdBase
    
    Set rsFilBu = gdBase.OpenRecordset("TERMERR")
    
    If InStr(UCase(cPfad), "BUDNI") > 0 Then
    
        'Import für Budni-Aktionartikel
        
        
        Set rsrs = dbExcel.OpenRecordset("Prospekt$")
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            Do While Not rsrs.EOF
                If Not IsNull(rsrs!BUDNINR) Then
                    sBudArtnr = rsrs!BUDNINR
                    
                    sArtnr = "0"
                    
                    sSQL = "select * from artlief where libesnr = '" & sBudArtnr & "'"
                    sSQL = sSQL & " and linr = " & sLinr
                    Set rsArtlief = gdBase.OpenRecordset(sSQL)
                    If Not rsArtlief.EOF Then
                        sArtnr = Trim(rsArtlief!artnr)
                    Else
                    
                        mdeErr = True
                        rsFilBu.AddNew
    
                        rsFilBu!EAN = ""
                        rsFilBu!NAN = Left(sBudArtnr, 13)
                        rsFilBu!Lieferant = sLinr
                        rsFilBu!ARTIKELTEXT = ""
                        rsFilBu!VPE = 0
                        rsFilBu!LVP = rsrs!VK
    
                        rsFilBu.Update
                    
                    End If
                    rsArtlief.Close: Set rsArtlief = Nothing
                    
                    If Val(sArtnr) > 0 Then
                    
                        sSQL = "select * from artikel where artnr = " & sArtnr
                        Set rsArt = gdBase.OpenRecordset(sSQL)
                        If Not rsArt.EOF Then
                            sArtnr = Trim(rsArt!artnr)
                            
                            Set rsRs2 = gdApp.OpenRecordset("select * from vorschlz where artnr = " & sArtnr)
                            If Not rsRs2.EOF Then
                                
                            Else
                            
                                rsRs2.AddNew
                                rsRs2!artnr = rsArt!artnr
                                rsRs2!BEZEICH = rsArt!BEZEICH
                                rsRs2!AGN = rsArt!AGN
                                rsRs2!lekpr = rsArt!lekpr
                                rsRs2!AWM = rsArt!AWM
                                rsRs2!ekpr = rsArt!ekpr
                                rsRs2!vkpr = rsArt!vkpr
                                rsRs2!linr = rsArt!linr
                                rsRs2!LIBESNR = rsArt!LIBESNR
                                rsRs2!KVKPR1 = rsArt!KVKPR1
                                rsRs2!EAN = rsArt!EAN
                                rsRs2!MOPREIS = rsArt!MOPREIS
                                rsRs2!RKZ = rsArt!RKZ
                                rsRs2!LPZ = rsArt!LPZ
                                rsRs2!NOTIZEN = rsArt!NOTIZEN
                                rsRs2!MINMEN = rsArt!MINMEN
                                rsRs2!BESTAND = rsArt!BESTAND
                                rsRs2!BESTVOR = 0
                                rsRs2.Update
                            
                            End If
                            rsRs2.Close: Set rsRs2 = Nothing
                        
                        Else 'hier die unbekannten
                        
                            mdeErr = True
                            rsFilBu.AddNew
    
                            rsFilBu!EAN = ""
                            rsFilBu!NAN = Left(sBudArtnr, 13)
                            rsFilBu!Lieferant = sLinr
                            rsFilBu!ARTIKELTEXT = ""
                            rsFilBu!VPE = 0
                            rsFilBu!LVP = rsrs!VK
    
                            rsFilBu.Update
                            
                        End If
                        rsArt.Close: Set rsArt = Nothing
                    End If
                Else 'hier die unbekannten
                    
                End If
                    
            rsrs.MoveNext
            Loop
            
        End If
        rsrs.Close: Set rsrs = Nothing
        
    ElseIf InStr(UCase(cPfad), "SORTIMENT HZ") > 0 Then 'Rewe Drogerie
    
'        lAnzZ = 0
        Set rsrs = dbExcel.OpenRecordset("ANGEBOT$")
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            Do While Not rsrs.EOF
                If Not IsNull(rsrs!EAN) Then
                    seekEAN = Trim(Val(rsrs!EAN))
                    seekEAN = checkean(seekEAN)
                    
                    
                    If Len(seekEAN) = 11 Then
                        seekEAN = "0" & seekEAN
                
                        sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                    ElseIf Len(seekEAN) = 8 Then
    
                            sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                            sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                            sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
    
                    Else
                        sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                    End If
    
                    
                    Set rsArt = gdBase.OpenRecordset(sSQL)
                    If Not rsArt.EOF Then
                        sArtnr = Trim(rsArt!artnr)
                        
                        Set rsRs2 = gdApp.OpenRecordset("select * from vorschlz where artnr = " & sArtnr)
                        If Not rsRs2.EOF Then
                            
                        Else
                        
                            rsRs2.AddNew
                            rsRs2!artnr = rsArt!artnr
                            rsRs2!BEZEICH = rsArt!BEZEICH
                            rsRs2!AGN = rsArt!AGN
                            rsRs2!lekpr = rsArt!lekpr
                            rsRs2!AWM = rsArt!AWM
                            rsRs2!ekpr = rsArt!ekpr
                            rsRs2!vkpr = rsArt!vkpr
                            rsRs2!linr = rsArt!linr
                            rsRs2!LIBESNR = rsArt!LIBESNR
                            rsRs2!KVKPR1 = rsArt!KVKPR1
                            rsRs2!EAN = rsArt!EAN
                            rsRs2!MOPREIS = rsArt!MOPREIS
                            rsRs2!RKZ = rsArt!RKZ
                            rsRs2!LPZ = rsArt!LPZ
                            rsRs2!NOTIZEN = rsArt!NOTIZEN
                            rsRs2!MINMEN = rsArt!MINMEN
                            rsRs2!BESTAND = rsArt!BESTAND
                            rsRs2!BESTVOR = 0
                            rsRs2.Update
                        
                        End If
                        rsRs2.Close: Set rsRs2 = Nothing
                        
                        
                    Else 'hier die unbekannten
                    
                        mdeErr = True
                        rsFilBu.AddNew
                        
                        rsFilBu!EAN = Left(seekEAN, 13)
                        rsFilBu!NAN = Left(rsrs!NAN, 13)
'                        rsFilBu!Lieferant = Left(rsrs!Lieferant, 50)
'                        rsFilBu!ARTIKELTEXT = Left(rsrs!ARTIKELTEXT, 50)
'                        rsFilBu!VPE = rsrs!VPE
                        
                        rsFilBu!Lieferant = ""
                        rsFilBu!ARTIKELTEXT = ""
                        rsFilBu!VPE = 0
                        
                        
                        rsFilBu!LVP = rsrs!VK
                        
                        rsFilBu.Update
                        
                    End If
                    rsArt.Close: Set rsArt = Nothing
                Else 'hier die unbekannten
                    
                    mdeErr = True
                    rsFilBu.AddNew
                    
                    rsFilBu!EAN = ""
                    rsFilBu!NAN = Left(rsrs!NAN, 13)
'                    rsFilBu!Lieferant = Left(rsrs!Lieferant, 50)
'                    rsFilBu!ARTIKELTEXT = Left(rsrs!ARTIKELTEXT, 50)
'                    rsFilBu!VPE = rsrs!VPE

                    rsFilBu!Lieferant = ""
                    rsFilBu!ARTIKELTEXT = ""
                    rsFilBu!VPE = 0

                    rsFilBu!LVP = rsrs!VK
                    
                    rsFilBu.Update
                        
                End If
                    
            rsrs.MoveNext
            Loop
            
        End If
        rsrs.Close: Set rsrs = Nothing
    
    
        
    ElseIf InStr(UCase(cPfad), "ARTIKELPREISLISTE") > 0 Then
    
        'Import für Budni-Erstbestellung
    
        Set rsrs = dbExcel.OpenRecordset("Preisliste$")
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            Do While Not rsrs.EOF
            
            
                If Not IsNull(rsrs!BVO) Then
                    If Val(rsrs!BVO) > 0 Then
            
            
                        If Not IsNull(rsrs!LIBESNR) Then
                            sBudArtnr = rsrs!LIBESNR
                            
                            sArtnr = "0"
                            
                            sSQL = "select * from artlief where libesnr = '" & sBudArtnr & "'"
                            sSQL = sSQL & " and linr = " & sLinr
                            Set rsArtlief = gdBase.OpenRecordset(sSQL)
                            If Not rsArtlief.EOF Then
                                sArtnr = Trim(rsArtlief!artnr)
                            Else
                            
                                mdeErr = True
                                rsFilBu.AddNew
            
                                rsFilBu!EAN = ""
                                rsFilBu!NAN = Left(sBudArtnr, 13)
                                rsFilBu!Lieferant = sLinr
                                rsFilBu!ARTIKELTEXT = ""
                                rsFilBu!VPE = 0
                                rsFilBu!LVP = rsrs!VK
            
                                rsFilBu.Update
                            
                            End If
                            rsArtlief.Close: Set rsArtlief = Nothing
                            
                            If Val(sArtnr) > 0 Then
                            
                                sSQL = "select * from artikel where artnr = " & sArtnr
                                Set rsArt = gdBase.OpenRecordset(sSQL)
                                If Not rsArt.EOF Then
                                    sArtnr = Trim(rsArt!artnr)
                                    
                                    Set rsRs2 = gdApp.OpenRecordset("select * from vorschlz where artnr = " & sArtnr)
                                    If Not rsRs2.EOF Then
                                        
                                    Else
                                    
                                        rsRs2.AddNew
                                        rsRs2!artnr = rsArt!artnr
                                        rsRs2!BEZEICH = rsArt!BEZEICH
                                        rsRs2!AGN = rsArt!AGN
                                        rsRs2!lekpr = rsArt!lekpr
                                        rsRs2!AWM = rsArt!AWM
                                        rsRs2!ekpr = rsArt!ekpr
                                        rsRs2!vkpr = rsArt!vkpr
                                        rsRs2!linr = rsArt!linr
                                        rsRs2!LIBESNR = rsArt!LIBESNR
                                        rsRs2!KVKPR1 = rsArt!KVKPR1
                                        rsRs2!EAN = rsArt!EAN
                                        rsRs2!MOPREIS = rsArt!MOPREIS
                                        rsRs2!RKZ = rsArt!RKZ
                                        rsRs2!LPZ = rsArt!LPZ
                                        rsRs2!NOTIZEN = rsArt!NOTIZEN
                                        rsRs2!MINMEN = rsArt!MINMEN
                                        rsRs2!BESTAND = rsArt!BESTAND
                                        rsRs2!BESTVOR = rsrs!BVO
                                        rsRs2.Update
                                    
                                    End If
                                    rsRs2.Close: Set rsRs2 = Nothing
                                
                                Else 'hier die unbekannten
                                
                                    mdeErr = True
                                    rsFilBu.AddNew
            
                                    rsFilBu!EAN = ""
                                    rsFilBu!NAN = Left(sBudArtnr, 13)
                                    rsFilBu!Lieferant = sLinr
                                    rsFilBu!ARTIKELTEXT = ""
                                    rsFilBu!VPE = 0
                                    rsFilBu!LVP = rsrs!VK
            
                                    rsFilBu.Update
                                    
                                End If
                                rsArt.Close: Set rsArt = Nothing
                            End If
                        Else 'hier die unbekannten
                            
        
                        End If
                    End If
                End If
                    
            rsrs.MoveNext
            Loop
            
        End If
        rsrs.Close: Set rsrs = Nothing
    Else
        Set rsrs = dbExcel.OpenRecordset("Prospekt$")
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            Do While Not rsrs.EOF
                If Not IsNull(rsrs!EAN) Then
                    seekEAN = Trim(Val(rsrs!EAN))
                    seekEAN = checkean(seekEAN)
                    
                    If Len(seekEAN) = 11 Then
                        seekEAN = "0" & seekEAN
                
                        sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                    ElseIf Len(seekEAN) = 8 Then
                        If Left(seekEAN, 1) = "2" Then
                            seekEAN = Mid$(seekEAN, 2, 6)
                            sSQL = "select * from artikel where artnr = " & seekEAN
                        Else
                            sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                            sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                            sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                        End If
                    Else
                        sSQL = "select * from artikel where ean = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean2 = '" & seekEAN & "'"
                        sSQL = sSQL & " or ean3 = '" & seekEAN & "'"
                    End If
    
                    
                    Set rsArt = gdBase.OpenRecordset(sSQL)
                    If Not rsArt.EOF Then
                        sArtnr = Trim(rsArt!artnr)
                        
                        Set rsRs2 = gdApp.OpenRecordset("select * from vorschlz where artnr = " & sArtnr)
                        If Not rsRs2.EOF Then
                            
                        Else
                        
                            rsRs2.AddNew
                            rsRs2!artnr = rsArt!artnr
                            rsRs2!BEZEICH = rsArt!BEZEICH
                            rsRs2!AGN = rsArt!AGN
                            rsRs2!lekpr = rsArt!lekpr
                            rsRs2!AWM = rsArt!AWM
                            rsRs2!ekpr = rsArt!ekpr
                            rsRs2!vkpr = rsArt!vkpr
                            rsRs2!linr = rsArt!linr
                            rsRs2!LIBESNR = rsArt!LIBESNR
                            rsRs2!KVKPR1 = rsArt!KVKPR1
                            rsRs2!EAN = rsArt!EAN
                            rsRs2!MOPREIS = rsArt!MOPREIS
                            rsRs2!RKZ = rsArt!RKZ
                            rsRs2!LPZ = rsArt!LPZ
                            rsRs2!NOTIZEN = rsArt!NOTIZEN
                            rsRs2!MINMEN = rsArt!MINMEN
                            rsRs2!BESTAND = rsArt!BESTAND
                            rsRs2!BESTVOR = 0
                            rsRs2.Update
                        
                        End If
                        rsRs2.Close: Set rsRs2 = Nothing
                    
                    Else 'hier die unbekannten
                    
                        mdeErr = True
                        rsFilBu.AddNew
                        
                        rsFilBu!EAN = Left(seekEAN, 13)
                        rsFilBu!NAN = Left(rsrs!NAN, 13)
                        rsFilBu!Lieferant = Left(rsrs!Lieferant, 50)
                        rsFilBu!ARTIKELTEXT = Left(rsrs!ARTIKELTEXT, 50)
                        rsFilBu!VPE = rsrs!VPE
                        rsFilBu!LVP = rsrs!LVP
                        
                        rsFilBu.Update
                        
                    End If
                    rsArt.Close: Set rsArt = Nothing
                Else 'hier die unbekannten
                    
                    mdeErr = True
                    rsFilBu.AddNew
                    
                    rsFilBu!EAN = ""
                    rsFilBu!NAN = Left(rsrs!NAN, 13)
                    rsFilBu!Lieferant = Left(rsrs!Lieferant, 50)
                    rsFilBu!ARTIKELTEXT = Left(rsrs!ARTIKELTEXT, 50)
                    rsFilBu!VPE = rsrs!VPE
                    rsFilBu!LVP = rsrs!LVP
                    
                    rsFilBu.Update
                        
                End If
                    
            rsrs.MoveNext
            Loop
            
        End If
        rsrs.Close: Set rsrs = Nothing
    End If
    rsFilBu.Close: Set rsFilBu = Nothing
    
    
    
    
    
    
    
    Dim cPfad2 As String
    
    cPfad2 = gcDBPfad
    If Right(cPfad2, 1) <> "\" Then
        cPfad2 = cPfad2 & "\"
    End If
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    'update vorschlz inner join artlief
    sSQL = "Update VORSCHLZ z inner join [;DATABASE=" & cPfad2 & "kissdata.mdb;pwd=" & gsPasswort & "].artlief a"
    sSQL = sSQL & " on z.artnr = a.artnr "
    sSQL = sSQL & " set z.libesnr = a.libesnr "
    sSQL = sSQL & " , z.minmen = a.minmen "
    sSQL = sSQL & " , z.LEKPR = a.LEKPR "
    sSQL = sSQL & " , z.LINR = a.LINR "
    sSQL = sSQL & " Where a.linr = " & sLinr
    gdApp.Execute sSQL, dbFailOnError
      
                
    Excelimport = True
    
    
    
    Screen.MousePointer = 0

    dbExcel.Close
    
    
Exit Function
LOKAL_ERROR:
    If err.Number = 3125 Or err.Number = 3011 Then
        anzeige "rot", "Die Excelliste hat nicht das erwartete Format", Label4
        Exit Function
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "Excelimport"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
        
        Fehlermeldung1
'        Resume Next
    End If
End Function
Private Function pfadseekExcel_Angebot() As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim sTitle      As String
    Dim sFilter     As String
    Dim sOldpfad    As String
    Dim sExcelpfad  As String
    
    pfadseekExcel_Angebot = False

    sTitle = "Speichern des Pfades"
    
    sFilter = "Excel - Dateien (*.xls)|*.xls"
    
    sOldpfad = gcDBPfad & "\IN"
    sExcelpfad = pfadaendernKomplett(sTitle, sFilter, sOldpfad)
    
    If UCase(Right(sExcelpfad, 3)) = "XLS" Then
        pfadseekExcel_Angebot = True
        lbl7.Caption = sExcelpfad
    End If
    
    Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "pfadseekExcel_Angebot"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Sub updatesorti()
On Error GoTo LOKAL_ERROR

    Dim cSQL As String

    cSQL = "Update VORSCHLZ inner join LINBEZ on VORSCHLZ.LINR = LINBEZ.LINR "
    cSQL = cSQL & " and VORSCHLZ.LPZ = LINBEZ.LPZ "
    cSQL = cSQL & " set VORSCHLZ.SORTI = LINBEZ.SORTI "
    gdApp.Execute cSQL, dbFailOnError
            
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "updatesorti"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub WeiterverarbeitungMDE(sLinr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL        As String
    Dim RsMDEIN     As DAO.Recordset
    Dim rsArt       As DAO.Recordset
    Dim rsRs2       As DAO.Recordset
    Dim rsLIEF      As DAO.Recordset
    Dim rsFilBu     As DAO.Recordset
    Dim sArtnr      As String
    Dim sEAN        As String
    Dim sMenge      As String
    Dim lscanfolge  As Long
    Dim gbnichtzumLiefgehoerend As Boolean
    Dim gbex As Boolean
    
    mdeErr = False
    lscanfolge = 0
    
    loeschNEW "MDENO", gdBase
    CreateTableT2 "MDENO", gdBase
    
    Set rsFilBu = gdBase.OpenRecordset("MDENO")
    
    Set RsMDEIN = gdBase.OpenRecordset("mdeinh", dbOpenTable)
    If Not RsMDEIN.EOF Then
        RsMDEIN.MoveFirst
        Do While Not RsMDEIN.EOF
        
            lscanfolge = lscanfolge + 1
        
            sEAN = IIf(IsNull(RsMDEIN(0)), "", RsMDEIN(0))
            sEAN = Trim(sEAN)
            sEAN = checkean(sEAN)
            sMenge = IIf(IsNull(RsMDEIN(1)), "", RsMDEIN(1))
            
            
            If Len(sEAN) = 11 Then
                sEAN = "0" & sEAN
                
                If Ist_in_ARTEAN_K(sEAN) Then
                
                End If
        
                cSQL = "select * from artikel where ean = '" & sEAN & "'"
                cSQL = cSQL & " or ean2 = '" & sEAN & "'"
                cSQL = cSQL & " or ean3 = '" & sEAN & "'"
            ElseIf Len(sEAN) = 8 Then
            
                If Left(sEAN, 1) = "2" Then
                
                    If gsMDEGERAET = "BELAMDE" Then
                        cSQL = "select artikel.* from artikel "
                        cSQL = cSQL & " inner join artlief on artikel.artnr = artlief.artnr where artlief.libesnr = '" & sEAN & "'"
                        cSQL = cSQL & " and artlief.linr = " & sLinr
                    Else
                        If Check18.value = vbChecked Then
                        
                            If Ist_in_ARTEAN_K(sEAN) Then
                
                            End If
                        
                            cSQL = "select * from artikel where ean = '" & sEAN & "'"
                            cSQL = cSQL & " or ean2 = '" & sEAN & "'"
                            cSQL = cSQL & " or ean3 = '" & sEAN & "'"
                        Else
                        
                            sEAN = Mid$(sEAN, 2, 6)
                            cSQL = "select * from artikel where artnr = " & sEAN
                        End If
                    End If
                    
                Else
                
                    If Ist_in_ARTEAN_K(sEAN) Then
                
                    End If
                
                    cSQL = "select * from artikel where ean = '" & sEAN & "'"
                    cSQL = cSQL & " or ean2 = '" & sEAN & "'"
                    cSQL = cSQL & " or ean3 = '" & sEAN & "'"
                End If
            ElseIf Len(sEAN) = 6 Then
                cSQL = "select * from artikel where artnr = " & sEAN
                
            Else
            
                If Ist_in_ARTEAN_K(sEAN) Then
                
                End If
                
                cSQL = "select * from artikel where ean = '" & sEAN & "'"
                cSQL = cSQL & " or ean2 = '" & sEAN & "'"
                cSQL = cSQL & " or ean3 = '" & sEAN & "'"
            End If
            
            Set rsArt = gdBase.OpenRecordset(cSQL)
            If Not rsArt.EOF Then
                sArtnr = Trim(rsArt!artnr)
                
                gbex = False
                'muss ich auf EX achten
                If Check8.value = vbChecked Then
                
                    If istderArtikelbeiLinrEX(rsArt!artnr, sLinr) = "J" Then
                
                        rsFilBu.AddNew
                        rsFilBu!EAN = sEAN
                        rsFilBu!Menge = sMenge
                        rsFilBu!lfnr = lscanfolge
    
                        rsFilBu!artnr = rsArt!artnr
                        rsFilBu!BEZEICH = Left("EX " & rsArt!BEZEICH, 35)
                        rsFilBu!AGN = rsArt!AGN
                        rsFilBu!EAN = rsArt!EAN
                        rsFilBu!EAN2 = rsArt!EAN2
                        rsFilBu!EAN3 = rsArt!EAN3
                        rsFilBu!KVKPR1 = rsArt!KVKPR1
                        rsFilBu!LPZ = rsArt!LPZ
                        rsFilBu!BESTAND = rsArt!BESTAND
                        
                        rsFilBu.Update
                        gbex = True
                    
                    End If
                
                End If
                
                'Gibt es dich überhaupt bei dem Lieferanten
                
                If gbex = False Then
                
                    If DatendrinSQL("Select * from Artlief where artnr = " & sArtnr & " and Linr = " & sLinr, gdBase) = False Then
                    
                        'hier die nicht zum Lieferanten gehören
                        mdeErr = True
                        gbnichtzumLiefgehoerend = True
                        
                        rsFilBu.AddNew
                        rsFilBu!EAN = sEAN
                        rsFilBu!Menge = sMenge
                        rsFilBu!lfnr = lscanfolge
    
                        rsFilBu!artnr = rsArt!artnr
                        rsFilBu!BEZEICH = rsArt!BEZEICH
                        rsFilBu!AGN = rsArt!AGN
                        rsFilBu!EAN = rsArt!EAN
                        rsFilBu!EAN2 = rsArt!EAN2
                        rsFilBu!EAN3 = rsArt!EAN3
                        rsFilBu!KVKPR1 = rsArt!KVKPR1
                        rsFilBu!LPZ = rsArt!LPZ
                        rsFilBu!BESTAND = rsArt!BESTAND
    
                        Dim sMin_Linr As String
    
                        sMin_Linr = ermLiefmitkleinstenLEKPR(sArtnr)
    
                        rsFilBu!linr = sMin_Linr
    
                        Set rsLIEF = gdBase.OpenRecordset("select * from Artlief where artnr = " & sArtnr & " and linr = " & sMin_Linr)
                        If Not rsLIEF.EOF Then
    
                            If Not IsNull(rsLIEF!LIBESNR) Then
                                rsFilBu!LIBESNR = rsLIEF!LIBESNR
                            Else
                                rsFilBu!LIBESNR = ""
                            End If
    
                            If Not IsNull(rsLIEF!lekpr) Then
                                rsFilBu!lekpr = rsLIEF!lekpr
                            Else
                                rsFilBu!lekpr = 0
                            End If
    
                        Else
                            rsFilBu!LIBESNR = ""
                            rsFilBu!lekpr = 0
                        End If
                        rsLIEF.Close: Set rsLIEF = Nothing
    
                        rsFilBu.Update
                    Else
                        gbnichtzumLiefgehoerend = False
                    End If
                
                End If
                    
                Set rsRs2 = gdApp.OpenRecordset("select * from vorschlz where artnr = " & sArtnr)
                If Not rsRs2.EOF Then
                    rsRs2.Edit
                    rsRs2!BESTVOR = Val(rsRs2!BESTVOR) + Val(sMenge)
                    rsRs2.Update
                Else
                
                    rsRs2.AddNew
                    rsRs2!artnr = rsArt!artnr
                    rsRs2!BEZEICH = rsArt!BEZEICH
                    rsRs2!AGN = rsArt!AGN
                    rsRs2!lekpr = rsArt!lekpr
                    rsRs2!AWM = rsArt!AWM
                    rsRs2!ekpr = rsArt!ekpr
                    rsRs2!vkpr = rsArt!vkpr
                    rsRs2!linr = rsArt!linr
                    rsRs2!LIBESNR = rsArt!LIBESNR
                    rsRs2!KVKPR1 = rsArt!KVKPR1
                    rsRs2!EAN = rsArt!EAN
                    rsRs2!MOPREIS = rsArt!MOPREIS
                    rsRs2!MWST = rsArt!MWST
                    
                    
                    
                    Set rsLIEF = gdBase.OpenRecordset("select * from Artlief where artnr = " & sArtnr & " and linr = " & sLinr)
                    If Not rsLIEF.EOF Then

                        If Not IsNull(rsLIEF!RKZ) Then
                            rsRs2!RKZ = rsLIEF!RKZ
                        Else
                            rsRs2!RKZ = "N"
                        End If
                    Else
                        rsRs2!RKZ = "N"
                    End If
                    rsLIEF.Close: Set rsLIEF = Nothing
                    
                    
                    rsRs2!LPZ = rsArt!LPZ
                    rsRs2!NOTIZEN = Left(rsArt!NOTIZEN, 25)
                    rsRs2!MINMEN = rsArt!MINMEN
                    rsRs2!MINBEST = rsArt!MINBEST
                    rsRs2!BESTAND = rsArt!BESTAND
                    rsRs2!BESTVOR = sMenge
                    rsRs2.Update
                
                End If
                  
                rsRs2.Close: Set rsRs2 = Nothing
                
                If Check16.value = vbUnchecked Then
                    If gbnichtzumLiefgehoerend = True Then
                        gdApp.Execute "Delete from VORSCHLZ where artnr = " & sArtnr, dbFailOnError
                    End If
                End If
                
                
                   
            Else 'hier die unbekannten
                
                mdeErr = True
                rsFilBu.AddNew
                rsFilBu!EAN = sEAN
                rsFilBu!Menge = sMenge
                rsFilBu!lfnr = lscanfolge
                
                rsFilBu.Update
                
                If Check16.value = vbChecked Then
                
                    Set rsRs2 = gdApp.OpenRecordset("select * from vorschlz where ean = '" & sEAN & "'")
                    If Not rsRs2.EOF Then
                        rsRs2.Edit
                        rsRs2!BESTVOR = Val(rsRs2!BESTVOR) + Val(sMenge)
                        rsRs2.Update
                    Else
                    
                        rsRs2.AddNew
                        rsRs2!artnr = 0
                        rsRs2!BEZEICH = "unbekannt"
                        rsRs2!AGN = 0
                        rsRs2!lekpr = 0
                        rsRs2!AWM = ""
                        rsRs2!ekpr = 0
                        rsRs2!vkpr = 0
                        rsRs2!linr = 0
                        rsRs2!LIBESNR = sEAN
                        rsRs2!KVKPR1 = 0
                        rsRs2!EAN = sEAN
                        rsRs2!MOPREIS = 0
                        rsRs2!RKZ = ""
                        rsRs2!LPZ = 0
                        rsRs2!NOTIZEN = "unbekannt"
                        rsRs2!MINMEN = 1
                        rsRs2!BESTAND = 0
                        rsRs2!BESTVOR = sMenge
                        rsRs2.Update
                    
                    End If
                End If

            End If
            rsArt.Close: Set rsArt = Nothing
            
            RsMDEIN.MoveNext
        Loop
    End If
    RsMDEIN.Close
    
    rsFilBu.Close: Set rsFilBu = Nothing
    
    If Check8.value = vbChecked Then
        gdApp.Execute "Delete from VORSCHLZ where RKZ = 'J'", dbFailOnError
    End If
                
    If mdeErr Then
        cSQL = "Update MDENO inner join lisrt on MDENO.linr = lisrt.linr "
        cSQL = cSQL & " Set MDENO.liefbez = lisrt.liefbez "
        gdBase.Execute cSQL, dbFailOnError
    End If
    
    
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "WeiterverarbeitungMDE"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
'    Resume Next
End Sub

Private Sub WeiterverarbeitungMDELibesnr()
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL        As String
    Dim RsMDEIN     As Recordset
    Dim rsArt       As Recordset
    Dim rsRs2       As Recordset
    Dim sArtnr      As String
    Dim sEAN        As String
    Dim sMenge      As String
    
    Set RsMDEIN = gdBase.OpenRecordset("mdeinh", dbOpenTable)
    If Not RsMDEIN.EOF Then
        RsMDEIN.MoveFirst
        Do While Not RsMDEIN.EOF
        
            If Not IsNull(RsMDEIN(0)) Then
                sEAN = Trim(RsMDEIN(0))
                
                sEAN = CStr(Val(Mid$(sEAN, 1, Len(sEAN) - 1)))
                sMenge = IIf(IsNull(RsMDEIN(1)), "", RsMDEIN(1))
        
                cSQL = "select * from artikel where Libesnr = '" & sEAN & "'"
                Set rsArt = gdBase.OpenRecordset(cSQL)
                If Not rsArt.EOF Then
                    sArtnr = Trim(rsArt!artnr)
                    
                    Set rsRs2 = gdApp.OpenRecordset("select * from vorschlz where artnr = " & sArtnr)
                    If Not rsRs2.EOF Then
                        rsRs2.Edit
                        rsRs2!BESTVOR = Val(rsRs2!BESTVOR) + Val(sMenge)
                        rsRs2.Update
                    Else
                        rsRs2.AddNew
                        rsRs2!artnr = rsArt!artnr
                        rsRs2!BEZEICH = rsArt!BEZEICH
                        rsRs2!AGN = rsArt!AGN
                        rsRs2!lekpr = rsArt!lekpr
                        rsRs2!AWM = rsArt!AWM
                        rsRs2!ekpr = rsArt!ekpr
                        rsRs2!vkpr = rsArt!vkpr
                        rsRs2!linr = rsArt!linr
                        rsRs2!LIBESNR = rsArt!LIBESNR
                        rsRs2!KVKPR1 = rsArt!KVKPR1
                        rsRs2!EAN = rsArt!EAN
                        rsRs2!MOPREIS = rsArt!MOPREIS
                        rsRs2!RKZ = rsArt!RKZ
                        rsRs2!LPZ = rsArt!LPZ
                        rsRs2!NOTIZEN = rsArt!NOTIZEN
                        rsRs2!MINMEN = rsArt!MINMEN
                        rsRs2!BESTAND = rsArt!BESTAND
                        rsRs2!BESTVOR = sMenge
                        rsRs2.Update
                    End If
                    rsRs2.Close: Set rsRs2 = Nothing: Set rsRs2 = Nothing
                End If
                rsArt.Close: Set rsArt = Nothing
            
            End If
            
            RsMDEIN.MoveNext
        Loop
    End If
    RsMDEIN.Close
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "WeiterverarbeitungMDELibesnr"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub Command6_Click()
    gsLinr = Command6.Caption
    frmWKL17.Show 1
    gsLinr = ""
End Sub
Private Sub Command7_Click()
On Error GoTo LOKAL_ERROR

    gckundnr = Text1(0).Text
    gckundnr = Trim$(gckundnr)
    gsARTNR = ""
            
    If IsNumeric(gckundnr) Then
        frmWKL86.Show 1
    End If
    
    gckundnr = ""
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command7_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
    Fehlermeldung1
End Sub
Private Sub Command8_Click()
On Error GoTo LOKAL_ERROR
    
    frmWKL87.Show 1
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command8_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
    Fehlermeldung1
End Sub
Private Sub Command9_Click()
On Error GoTo LOKAL_ERROR

    gckundnr = Text1(0).Text
    gckundnr = Trim$(gckundnr)
    gsARTNR = ""
            
    If IsNumeric(gckundnr) Then
        frmWKL88.Show 1
    End If
    
    gckundnr = ""
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command9_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
    Fehlermeldung1
End Sub
Private Sub Command98_Click()
    On Error GoTo LOKAL_ERROR
    
    gsZSpalte = "Artnr"
    gstab = "Bestellung"
    frmWKL36.Show 1
    'fertig
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Command98_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
    Fehlermeldung1
End Sub
Private Sub FuellenMSFlex43()
    On Error GoTo LOKAL_ERROR
    
    Dim lrow        As Long
    Dim lWert       As Long
    Dim sWert       As String
    Dim dWert       As Double
    Dim siWert      As Single
    Dim rsrs        As Recordset
    Dim siAnzeige   As Single
    Dim i           As Integer
    Dim j           As Integer
    Dim cSQL        As String
    Dim lMax        As Long
    
    If Modul1.gbGrossLief(Command6.Caption) Then
        If Option2(0).value = True Then
            cSQL = "Select * from VORSCHLZ order by mopreis,SORTI,BEZEICH"
        ElseIf Option2(1).value = True Then
            cSQL = "Select * from VORSCHLZ order by mopreis,BEZEICH"
        ElseIf Option2(2).value = True Then
            If Check11.value = vbChecked Then
                cSQL = "Update VORSCHLZ set LIBESNR = '' where LIBESNR is null"
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Select * from VORSCHLZ order by mopreis, val(LIBESNR) asc"
            Else
                'vorher
                cSQL = "Select * from VORSCHLZ order by mopreis,LIBESNR"
            End If
        ElseIf Option2(3).value = True Then
            cSQL = "Select * from VORSCHLZ order by mopreis,AWM desc, SORTI,BEZEICH "
        ElseIf Option2(4).value = True Then
            cSQL = "Select * from VORSCHLZ order by mopreis, bestand asc,BEZEICH "
        ElseIf Option2(5).value = True Then
            cSQL = "Select * from VORSCHLZ order by mopreis, AGN,BEZEICH "
        Else
            cSQL = "Select * from VORSCHLZ order by mopreis,SORTI,BEZEICH"
        End If
    Else
        If Option2(0).value = True Then
            cSQL = "Select * from VORSCHLZ order by SORTI,BEZEICH"
        ElseIf Option2(1).value = True Then
            cSQL = "Select * from VORSCHLZ order by BEZEICH"
        ElseIf Option2(2).value = True Then
            
            If Check11.value = vbChecked Then
                cSQL = "Update VORSCHLZ set LIBESNR = '' where LIBESNR is null"
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Select * from VORSCHLZ order by val(LIBESNR) asc"
            Else
                'vorher
                cSQL = "Select * from VORSCHLZ order by LIBESNR"
            End If
        ElseIf Option2(3).value = True Then
            cSQL = "Select * from VORSCHLZ order by AWM desc, SORTI,BEZEICH "
        ElseIf Option2(4).value = True Then
            cSQL = "Select * from VORSCHLZ order by bestand asc,BEZEICH "
        ElseIf Option2(5).value = True Then
            cSQL = "Select * from VORSCHLZ order by AGN,BEZEICH "
        Else
            cSQL = "Select * from VORSCHLZ order by mopreis,SORTI,BEZEICH"
        End If
    End If
    
    Set rsrs = gdApp.OpenRecordset(cSQL)
    
    If Not rsrs.EOF Then
        rsrs.MoveLast
        glmaxtabzeilenanz = rsrs.RecordCount
      
        MSFlexGrid2.Redraw = False
      
        txtStatus.Text = "0"
        siAnzeige = 0
        
        lrow = 1
        If Not rsrs.EOF Then
      
            rsrs.MoveLast
            lMax = rsrs.RecordCount
            rsrs.MoveFirst
            
            Do While Not rsrs.EOF
          
                siAnzeige = siAnzeige + 1
                txtStatus.Text = CStr((100 * siAnzeige) / lMax)
                lrow = lrow + 1
                
                MSFlexGrid2.Rows = lrow + 1
                
                MSFlexGrid2.Col = 0
                
                For i = 0 To byAnzahlSpalten - 1
                    MSFlexGrid2.Row = 0
                    MSFlexGrid2.Col = i
                    
                    If sSpaltenname(i) = MSFlexGrid2.Text Then
                        
                        Select Case sSpaltenname(i)
                            Case Is = "L EKPR", "L VKPR", "S EKPR", "K VKPR"
                                If Not IsNull(rsrs(sSpaltenbez(i))) Then
                                    sWert = rsrs(sSpaltenbez(i))
                                Else
                                    sWert = "0"
                                End If
                                MSFlexGrid2.Row = lrow
                                MSFlexGrid2.Text = Format$(sWert, "####0.00")
                            Case Is = "ger"
                                If Not IsNull(rsrs(sSpaltenbez(i))) Then
                                    sWert = rsrs(sSpaltenbez(i))
                                Else
                                    sWert = "J"
                                End If
                                
                                MSFlexGrid2.Row = lrow
                                MSFlexGrid2.Text = sWert
                                
                                If sWert = "J" Then
                                    MSFlexGrid2.CellBackColor = vbRed
                                Else
                                    MSFlexGrid2.CellBackColor = vbWhite
                                End If
                            Case Is = "Rabatt"
                                sWert = "0"
                                MSFlexGrid2.Row = lrow
                                MSFlexGrid2.Text = Format$(sWert, "####0")
                            Case Is = "SoK"
                            
                                If Not IsNull(rsrs(sSpaltenbez(i))) Then
                                    sWert = rsrs(sSpaltenbez(i))
                                Else
                                    sWert = "0"
                                End If
                                
                                MSFlexGrid2.Row = lrow
                                If sWert = "999999" Then
                                    MSFlexGrid2.Text = ""
                                Else
                                
                                    If sWert = "0" Then
                                        MSFlexGrid2.CellForeColor = vbRed
                                    Else
                                        MSFlexGrid2.CellForeColor = vbBlack
                                    End If
                                    
                                    MSFlexGrid2.Text = Format$(sWert, "####0")
                                    
                                End If
                            Case Is = "HS"
                                
                                If Not IsNull(rsrs(sSpaltenbez(i))) Then
                                    sWert = Fix(rsrs(sSpaltenbez(i)))
                                Else
                                    sWert = "0"
                                End If
                                MSFlexGrid2.Row = lrow
                                MSFlexGrid2.Text = sWert
                                
                                If CDbl(sWert) >= 100 Then
                                    MSFlexGrid2.CellBackColor = &H8000&
                                ElseIf CDbl(sWert) > 79.99 Then
                                    MSFlexGrid2.CellBackColor = &HC000&
                                ElseIf CDbl(sWert) > 59.99 Then
                                    MSFlexGrid2.CellBackColor = &HFF00&
                                ElseIf CDbl(sWert) > 39.99 Then
                                    MSFlexGrid2.CellBackColor = &HFFFF&
                                ElseIf CDbl(sWert) > 19.99 Then
                                    MSFlexGrid2.CellBackColor = &H80C0FF
                                ElseIf CDbl(sWert) > 0 Then
                                    MSFlexGrid2.CellBackColor = &H80FF&
                                ElseIf CDbl(sWert) <= 0 Then
                                    MSFlexGrid2.CellBackColor = &HFF&
                                End If
                                
                            Case Else
                                If Not IsNull(rsrs(sSpaltenbez(i))) Then
                                    sWert = rsrs(sSpaltenbez(i))
                                Else
                                    sWert = "0"
                                End If
                                MSFlexGrid2.Row = lrow
                                MSFlexGrid2.Text = sWert
                        End Select
                      
                        If Len(MSFlexGrid2.TextMatrix(lrow, i)) * 80 > aBreite(i) Then
                            aBreite(i) = Len(MSFlexGrid2.TextMatrix(lrow, i)) * 80
                        End If
                        
                    End If
                Next i
                rsrs.MoveNext
            Loop
        End If
      
        For i = 0 To byAnzahlSpalten - 1
            MSFlexGrid2.Col = i
            MSFlexGrid2.ColWidth(i) = aBreite(i) * 1.8
        Next i
        
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If byAnzahlSpalten < 2 Then
    
    Else
        MSFlexGrid2.FixedCols = 1
    End If
    
    MSFlexGrid2.RowHeight(1) = 0
    lrow = lrow - 1
    
    MSFlexGrid2.Height = MSFlexGrid2.RowHeight(2) * 12
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "FuellenMSFlex43"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
    Fehlermeldung1
    Resume Next
    
End Sub
Private Sub voreinstellungspeichernE43B()
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL    As String
    
    Dim lVon            As Integer
    Dim lMerke_linr     As Long
    Dim lLinr           As Long
    Dim lcount          As Long
    Dim cMerke_linr     As String
    
    Dim bo0             As Integer
    Dim bo1             As Integer
    Dim bo2             As Integer
    Dim bo3             As Integer
    Dim bo4             As Integer
    Dim bo5             As Integer
    Dim bo6             As Integer
    Dim bo7             As Integer
    Dim bo8             As Integer
    Dim bo9             As Integer
    Dim bo10            As Integer
    Dim bo11            As Integer
    Dim bo12            As Integer
    Dim bo13            As Integer
    Dim bo14            As Integer
    Dim bo15            As Integer
   
    loeschNEW "E43B", gdApp
    CreateTable "E43B", gdApp
    
    'merke wenn woanders günstiger
    
    If NewTableSuchenDBKombi("MERKE43LINR", gdBase) = False Then
        CreateTableT2 "MERKE43LINR", gdBase
    End If
    
    If IsNumeric(Text1(0).Text) Then
        lLinr = Text1(0).Text
    End If
    
    sSQL = "Delete from MERKE43LINR  "
    sSQL = sSQL & " where linr = " & lLinr
    gdBase.Execute sSQL, dbFailOnError
    
    For lcount = 0 To List6.ListCount - 1
                
        cMerke_linr = Trim(Left(List6.list(lcount), 6))
        
        If IsNumeric(cMerke_linr) Then
            lMerke_linr = cMerke_linr
            
            sSQL = "Insert into MERKE43LINR (LINR,MERKELINR) "
            sSQL = sSQL & " values (" & lLinr & "," & lMerke_linr & ")"
            gdBase.Execute sSQL, dbFailOnError
        End If
    Next lcount
    
    If IsNumeric(Text1(1).Text) Then
        lVon = Text1(1).Text
    Else
        lVon = 1
    End If
    
    If SSCommand2(10).Caption = "Grafik Aus" Then
        bo0 = 0
    Else
        bo0 = 1
    End If
    
    bo1 = Option2(0).value
    bo2 = Option2(1).value
    bo3 = Option2(2).value
    bo4 = Option2(3).value
    bo5 = Option2(4).value
    bo8 = Option2(5).value
    
    If Check1.value = vbChecked Then
        bo6 = 0
    Else
        bo6 = -1
    End If
    
    If Check8.value = vbChecked Then
        bo7 = 0
    Else
        bo7 = -1
    End If
    
    If Check12.value = vbChecked Then
        bo9 = 0
    Else
        bo9 = -1
    End If
    
    If Check13.value = vbChecked Then
        bo10 = 0
    Else
        bo10 = -1
    End If
    
    If Check14.value = vbChecked Then
        bo11 = 0
    Else
        bo11 = -1
    End If
    
    If Check15.value = vbChecked Then
        bo12 = 0
    Else
        bo12 = -1
    End If
    
    If Check16.value = vbChecked Then
        bo13 = 0
    Else
        bo13 = -1
    End If
    
    If Check17.value = vbChecked Then
        bo14 = 0
    Else
        bo14 = -1
    End If
    
    If Check18.value = vbChecked Then
        bo15 = 0
    Else
        bo15 = -1
    End If
    
    sFarbe1 = Text15(0).Text
    sFarbe2 = Text15(1).Text
    sFarbe3 = Text15(2).Text
   
    sSQL = "Insert into E43B ( lvon,bo0,bo1,bo2,bo3,bo4,bo5,bo6,bo7,bo8,bo9,MERKEF,bo10,bo11,bo12,bo13,bo14,bo15,FARBE1,FARBE2,FARBE3) "
    sSQL = sSQL & " values (" & lVon & "," & bo0 & "," & bo1 & "," & bo2 & "," & bo3
    sSQL = sSQL & "," & bo4 & "," & bo5 & "," & bo6 & "," & bo7 & "," & bo8 & "," & bo9
    sSQL = sSQL & ",'" & sMerke_Focus & "'," & bo10 & "," & bo11 & "," & bo12 & "," & bo13 & "," & bo14 & "," & bo15 & " "
    sSQL = sSQL & ",'" & sFarbe1 & "','" & sFarbe2 & "','" & sFarbe3 & "')"
    gdApp.Execute sSQL, dbFailOnError
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungspeichernE43B"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub voreinstellungladenE43B()
    On Error GoTo LOKAL_ERROR
    
    Dim rs As Recordset
    Dim bo0 As Integer
    
    
    Set rs = gdApp.OpenRecordset("E43B")
    If Not rs.EOF Then
    
        If Not IsNull(rs!Farbe1) Then
            sFarbe1 = rs!Farbe1
        Else
            sFarbe1 = ""
        End If
        
        If Not IsNull(rs!Farbe2) Then
            sFarbe2 = rs!Farbe2
        Else
            sFarbe2 = ""
        End If
        
        If Not IsNull(rs!Farbe3) Then
            sFarbe3 = rs!Farbe3
        Else
            sFarbe3 = ""
        End If
    
        If Not IsNull(rs!MerkeF) Then
            sMerke_Focus = rs!MerkeF
        Else
            sMerke_Focus = "Text8"
        End If
        
        Text15(0).Text = sFarbe1
        Text15(1).Text = sFarbe2
        Text15(2).Text = sFarbe3
    
        If Not IsNull(rs!lVon) Then
            Text1(1).Text = rs!lVon
        Else
            Text1(1).Text = "1"
        End If
        
        If Not IsNull(rs!bo0) Then
            bo0 = rs!bo0
        Else
            bo0 = -1
        End If
        
        Option2(0).value = rs!bo1
        Option2(1).value = rs!bo2
        Option2(2).value = rs!bo3
        Option2(3).value = rs!bo4
        Option2(4).value = rs!bo5
        Option2(5).value = rs!bo8
        
        If rs!bo6 = True Then
            Check1.value = vbUnchecked
        Else
            Check1.value = vbChecked
        End If
        
        If rs!bo7 = True Then
            Check8.value = vbUnchecked
        Else
            Check8.value = vbChecked
        End If
        
        If rs!bo9 = True Then
            Check12.value = vbUnchecked
        Else
            Check12.value = vbChecked
        End If
        
        If rs!bo10 = True Then
            Check13.value = vbUnchecked
        Else
            Check13.value = vbChecked
        End If
        
        If rs!bo11 = True Then
            Check14.value = vbUnchecked
        Else
            Check14.value = vbChecked
        End If
        
        If rs!bo12 = True Then
            Check15.value = vbUnchecked
        Else
            Check15.value = vbChecked
        End If
        
        If rs!bo13 = True Then
            Check16.value = vbUnchecked
        Else
            Check16.value = vbChecked
        End If
        
        If rs!bo14 = True Then
            Check17.value = vbUnchecked
        Else
            Check17.value = vbChecked
        End If
        
        If rs!bo15 = True Then
            Check18.value = vbUnchecked
        Else
            Check18.value = vbChecked
        End If
        
    End If
    rs.Close: Set rs = Nothing
    
    If bo0 = 1 Then
        SSCommand2(10).Caption = "Grafik Aus"
    ElseIf bo0 = 0 Then
        SSCommand2(10).Caption = "Grafik Ein"
    Else
        SSCommand2(10).Caption = "Grafik Aus"
    End If

     
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "voreinstellungladenE43B"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
'    Resume Next
End Sub
Private Sub Form_Load()
    On Error GoTo LOKAL_ERROR
    Screen.MousePointer = 11

    Dim lAnz        As Long
    Dim sSQL        As String
    Dim rsrs        As Recordset
    Dim lAnzSatz    As Long
    Dim lAktSatz    As Long

    WKL43Positionieren
    Modul6.Skalieren Me, True, True: Modul6.Schrift Me: Modul6.Log Me
    Modul6.Farbform Me, Label0(2)

    KomprimieredieAPP

    gbErfolg = True

    gitop = Shape1(0).Top

    gitop3 = Shape3(0).Top

    gbBestVorOk = False
    UeberlaufFehler = False
    gbenterC = False

    Text1(0).Text = ""
    Text1(1).Text = "1"
    Text1(2).Text = "999"
    Text1(3).Text = "4"
    Text1(4).Text = "1"
    Text1(5).Text = ""
    Text1(6).Text = ""
    Text1(8).Text = ""

    fuellecombo1

    If NewTableSuchenDBKombi("E43B", gdApp) Then
        If SpalteInTabellegefundenNEW("E43B", "Bo12", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo12", "BIT", gdApp

            sSQL = "Update E43B set bo12 = 0 "
            gdApp.Execute sSQL, dbFailOnError

        End If

        If SpalteInTabellegefundenNEW("E43B", "Bo13", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo13", "BIT", gdApp

            sSQL = "Update E43B set bo13 = 0 "
            gdApp.Execute sSQL, dbFailOnError

        End If

        If SpalteInTabellegefundenNEW("E43B", "Bo14", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo14", "BIT", gdApp

            sSQL = "Update E43B set bo14 = -1 "
            gdApp.Execute sSQL, dbFailOnError

        End If

        If SpalteInTabellegefundenNEW("E43B", "Bo15", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo15", "BIT", gdApp

            sSQL = "Update E43B set bo15 = -1 "
            gdApp.Execute sSQL, dbFailOnError

        End If
        
        If SpalteInTabellegefundenNEW("E43B", "MERKEF", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "MERKEF", "Text(10)", gdApp

            sSQL = "Update E43B set MERKEF = 'Text8' "
            gdApp.Execute sSQL, dbFailOnError

        End If
        
        If SpalteInTabellegefundenNEW("E43B", "FARBE1", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "FARBE1", "Text(2)", gdApp

            sSQL = "Update E43B set FARBE1 = '' "
            gdApp.Execute sSQL, dbFailOnError

        End If
        
        If SpalteInTabellegefundenNEW("E43B", "FARBE2", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "FARBE2", "Text(2)", gdApp

            sSQL = "Update E43B set FARBE2 = '' "
            gdApp.Execute sSQL, dbFailOnError

        End If
        
        If SpalteInTabellegefundenNEW("E43B", "FARBE3", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "FARBE3", "Text(2)", gdApp

            sSQL = "Update E43B set FARBE3 = '' "
            gdApp.Execute sSQL, dbFailOnError

        End If
        
        If SpalteInTabellegefundenNEW("E43B", "Bo5", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo5", "BIT", gdApp

            sSQL = "Update E43B set bo5 = -1 "
            gdApp.Execute sSQL, dbFailOnError
        End If
        
        If SpalteInTabellegefundenNEW("E43B", "Bo6", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo6", "BIT", gdApp

            sSQL = "Update E43B set bo6 = -1 "
            gdApp.Execute sSQL, dbFailOnError
        End If
        
        If SpalteInTabellegefundenNEW("E43B", "Bo7", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo7", "BIT", gdApp

            sSQL = "Update E43B set bo7 = -1 "
            gdApp.Execute sSQL, dbFailOnError
        End If
        
        If SpalteInTabellegefundenNEW("E43B", "Bo8", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo8", "BIT", gdApp

            sSQL = "Update E43B set bo8 = -1 "
            gdApp.Execute sSQL, dbFailOnError
        End If
        
        If SpalteInTabellegefundenNEW("E43B", "Bo9", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo9", "BIT", gdApp

            sSQL = "Update E43B set bo9 = -1 "
            gdApp.Execute sSQL, dbFailOnError
        End If
        
        If SpalteInTabellegefundenNEW("E43B", "Bo10", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo10", "BIT", gdApp

            sSQL = "Update E43B set bo10 = -1 "
            gdApp.Execute sSQL, dbFailOnError
        End If
        
        If SpalteInTabellegefundenNEW("E43B", "Bo11", gdApp) = False Then
            SpalteAnfuegenNEW "E43B", "Bo11", "BIT", gdApp

            sSQL = "Update E43B set bo11 = -1 "
            gdApp.Execute sSQL, dbFailOnError
        End If
        
        

        voreinstellungladenE43B
    End If

    fraArtAnfuegen.Visible = False
    fra0.Visible = False
    Frame1.Visible = True

    List3.Clear

    If gbBILDTAST = False Then
        Frame0.Visible = False
    Else
        Frame0.Visible = True
    End If

    If Check13.value = vbChecked Then
        Frame11.Visible = True
        Frame2.Visible = False
    Else

        Frame11.Visible = False
        Frame2.Visible = True
    End If

    gcBestellName = ""
    gcMitteilung = ""
    
    Screen.MousePointer = 0
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Form_Load"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub fuellecombo1()
    On Error GoTo LOKAL_ERROR
    
    Combo1.Clear
    Combo1.AddItem "100"
    Combo1.AddItem "90"
    Combo1.AddItem "80"
    Combo1.AddItem "70"
    Combo1.AddItem "60"
    Combo1.AddItem "50"
    Combo1.AddItem "40"
    Combo1.AddItem "30"
    Combo1.AddItem "20"
    Combo1.AddItem "10"
    
    Combo1.Text = "80"
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fuellecombo1"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub

Private Sub Form_Unload(Cancel As Integer)
    On Error GoTo LOKAL_ERROR
    
    LogtoEnd Me

    loeschNEW "ptmp", gdBase
    loeschNEW "ptmp1", gdBase
    loeschNEW "ptmp2", gdBase
    
    loeschNEW "AN" & srechnertab, gdBase
    
    loeschNEW "TERMERR", gdBase
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Form_Unload"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub diagrammfuellen(sArtnr As String, Jahrkl As Date)
    On Error GoTo LOKAL_ERROR
    
    Dim i               As Integer
    Dim j               As Integer
    Dim iTop            As Integer
    Dim myarr(0 To 23)  As Long
    Dim cSQL            As String
    Dim rsrs            As Recordset
    Dim iMax            As Integer
    Dim iBuffer         As Integer
    
    cSQL = "Select * from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Year(Jahrkl) - 1
    
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF

            myarr(rsrs!Monat - 1) = rsrs!ANZAHL
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Select * from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Year(Jahrkl)
    
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF

            myarr(rsrs!Monat - 1 + 12) = rsrs!ANZAHL
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    Set rsrs = Nothing
        
    iBuffer = 0
    iMax = 0
    
    For i = 0 To 23
        iBuffer = myarr(i)
        If iBuffer > iMax Then
            iMax = iBuffer
        End If
    Next i
    
        iMax = IIf(iMax = 0, 1, iMax)
    
    For i = 0 To 23
        Shape1(i).Top = gitop
        Shape1(i).Height = (1900 / iMax) * IIf(myarr(i) < 0, 0, myarr(i))
        Shape1(i).Top = gitop - ((1900 / iMax) * myarr(i))
        
        Label10(i).Top = Shape1(i).Top - 250
        Label10(i).Caption = myarr(i)
        Label10(i).Refresh
    Next i
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "diagrammfuellen"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub diagrammfuellenShape3(sArtnr As String, Jahrkl As Long)
    On Error GoTo LOKAL_ERROR
    
    Dim i               As Integer
    Dim j               As Integer
    Dim iTop            As Integer
    Dim myarr(0 To 35)  As Long
    Dim cSQL            As String
    Dim rsrs            As Recordset
    Dim iMax            As Integer
    Dim iBuffer         As Integer
    Dim lAnzahl         As Long
    
    cSQL = "Select * from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Jahrkl - 2
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            myarr(rsrs!Monat - 1) = rsrs!ANZAHL
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    'summen jahres
    cSQL = "Select sum(anzahl) as maxi from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Jahrkl - 2
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!maxi) Then
            lAnzahl = rsrs!maxi
        Else
            lAnzahl = 0
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    Label9(3).Caption = Jahrkl - 2 & ": " & lAnzahl
    
    cSQL = "Select sum(anzahl) as maxi from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Jahrkl - 1
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!maxi) Then
            lAnzahl = rsrs!maxi
        Else
            lAnzahl = 0
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    Label9(4).Caption = Jahrkl - 1 & ": " & lAnzahl
    
    cSQL = "Select sum(anzahl) as maxi from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Jahrkl
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!maxi) Then
            lAnzahl = rsrs!maxi
        Else
            lAnzahl = 0
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    Label9(5).Caption = Jahrkl & ": " & lAnzahl
    
    'summen jahres ende
    
    
    
    cSQL = "Select * from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Jahrkl - 1
    
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF

            myarr(rsrs!Monat - 1 + 12) = rsrs!ANZAHL
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Select * from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Jahrkl
    
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF

            myarr(rsrs!Monat - 1 + 12 + 12) = rsrs!ANZAHL
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    Set rsrs = Nothing
        
    iBuffer = 0
    iMax = 0
    
    For i = 0 To 35
        iBuffer = myarr(i)
        If iBuffer > iMax Then
            iMax = iBuffer
        End If
    Next i
    
        iMax = IIf(iMax = 0, 1, iMax)
    
    For i = 0 To 35
        Shape3(i).Top = gitop3
        Shape3(i).Height = (1900 / iMax) * IIf(myarr(i) < 0, 0, myarr(i))
        Shape3(i).Top = gitop3 - ((1900 / iMax) * myarr(i))
        
        Label30(i).Top = Shape3(i).Top - 250
        Label30(i).Caption = myarr(i)
        Label30(i).Refresh
    Next i
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "diagrammfuellenShape3"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub diagrammfuellenalt(sArtnr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim i               As Integer
    Dim j               As Integer
    Dim iTop            As Integer
    Dim myarr(0 To 23)  As Long
    Dim cSQL            As String
    Dim rsrs            As Recordset
    Dim iMax            As Integer
    Dim iBuffer         As Integer
    
    cSQL = "Select * from VORSCHLZ  where ARTNR = " & sArtnr
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
    
        For i = 0 To 11
            j = i + 1
            If Not IsNull(rsrs("VJ" & j)) Then
                myarr(i) = rsrs("VJ" & j)
            Else
                myarr(i) = 0
            End If
        Next i
        
        For i = 12 To 23
            j = i - 11
            If Not IsNull(rsrs("LJ" & j)) Then
                myarr(i) = rsrs("LJ" & j)
            Else
                myarr(i) = 0
            End If
        Next i

    End If
    
    rsrs.Close: Set rsrs = Nothing
    
    iBuffer = 0
    iMax = 0
    
    For i = 0 To 23
        iBuffer = myarr(i)
        If iBuffer > iMax Then
            iMax = iBuffer
        End If
    Next i
    
        iMax = IIf(iMax = 0, 1, iMax)
    
    For i = 0 To 23
        Shape1(i).Top = gitop
        Shape1(i).Height = (1900 / iMax) * IIf(myarr(i) < 0, 0, myarr(i))
        Shape1(i).Top = gitop - ((1900 / iMax) * myarr(i))
        
        Label10(i).Top = Shape1(i).Top - 400 ' 250
        Label10(i).Caption = myarr(i)
        Label10(i).Refresh
    Next i
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "diagrammfuellenalt"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1

    
End Sub
Private Sub Detaildatenermitteln(cArtNr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim l          As Long
    Dim lVorhanden As Long
    Dim ctmp       As String
    Dim cBezeich   As String
    Dim cSQL       As String
    Dim iCol1      As Integer
    Dim iRow1      As Integer
    Dim iCol2      As Integer
    Dim iRow2      As Integer
    Dim iMonat     As Integer
    Dim rsrs       As Recordset

    iRow1 = MSFlexGrid2.Row
    iCol1 = MSFlexGrid2.Col
    
    
    cBezeich = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerBEZEICH)
    cBezeich = Mid$(cBezeich, 1, 35)
    lbl3.Caption = "ArtNr. : " & cArtNr
    lbl4.Caption = cBezeich
    
    '********************* Spalte Notizen ***********************
    
    cSQL = "Select Notizen from VORSCHLZ where ARTNR = " & cArtNr
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!NOTIZEN) Then
            ctmp = rsrs!NOTIZEN
        Else
            ctmp = ""
        End If
        Label3(0).Caption = ctmp
    End If
    rsrs.Close: Set rsrs = Nothing

    lbl3.Caption = "ArtNr. : " & cArtNr
    lbl4.Caption = cBezeich
    
    '********************* Spalte BESTAND ***********************
    
    cSQL = "Select BESTAND from VORSCHLZ where ARTNR = " & cArtNr
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!BESTAND) Then
            ctmp = rsrs!BESTAND
        Else
            ctmp = 0
        End If
        lbl6(9).Caption = ctmp
    Else
        lbl6(9).Caption = "0"
    End If
    lbl6(9).Refresh
    rsrs.Close: Set rsrs = Nothing
    
    lbl6(41).Caption = ZeigeArtmerk(cArtNr)
    lbl6(41).ForeColor = vbRed
    lbl6(41).Refresh
    
    lbl6(12).Caption = vkljB(cArtNr)
    lbl6(12).Refresh
    lbl6(13).Caption = vkvjB(cArtNr)
    lbl6(13).Refresh
    lbl6(10).Caption = vkamB(cArtNr)
    lbl6(10).Refresh
    lbl6(11).Caption = vkvmB(cArtNr)
    lbl6(11).Refresh
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Detaildatenermitteln"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub LEKandererLieferantenermitteln(cArtNr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim dMin        As Double
    Dim dMax        As Double
    Dim dtmp        As Double
    Dim cSQL        As String
    Dim rsrs        As Recordset
    Dim sLinr       As String
    Dim sBez        As String
    Dim cMin        As String

    dMin = 0
    dMax = 0
    dtmp = 0
    '**************************** LEK ************************
     
    cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr
    cSQL = cSQL & " and linr = " & cLinr
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!lekpr) Then
            dMax = rsrs!lekpr
            dMin = dMax
        Else
            dMax = 0
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr
    cSQL = cSQL & " and linr <> " & cLinr
    cSQL = cSQL & " and LEKPR > 0 "
    cSQL = cSQL & " and RKZ = 'N' "
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!lekpr) Then
                dtmp = rsrs!lekpr
            Else
                dtmp = 0
            End If
            
            If dtmp < dMin Then
                dMin = dtmp
                cMin = Format$(dMin, "###,##0.00")
                If Not IsNull(rsrs!linr) Then
                    sLinr = rsrs!linr
                Else
                    sLinr = ""
                End If
            ElseIf dtmp = dMin Then
                dMin = dtmp
                cMin = Format$(dMin, "###,##0.00")
                If Not IsNull(rsrs!linr) Then
                    sLinr = rsrs!linr
                Else
                    sLinr = ""
                End If
            End If
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If sLinr <> "" Then
        cSQL = "Select * from lisrt where linr = " & sLinr
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!LIEFBEZ) Then
                sBez = rsrs!LIEFBEZ
            Else
                sBez = ""
            End If
        End If
        rsrs.Close: Set rsrs = Nothing
    End If
    
    If dMin < dMax Then
        Label3(2).Visible = True
        Label3(2).Caption = "Diesen Artikel können Sie bei " & sBez & " (" & sLinr & ") für " & cMin & " Euro beziehen."
        Label3(2).ForeColor = vbRed
        
        Label3(5).Visible = True
        Label3(5).Caption = "Diesen Artikel können Sie bei " & sBez & " (" & sLinr & ") für " & cMin & " Euro beziehen."
        Label3(5).ForeColor = vbRed
        
        
    ElseIf dMin = dMax And sLinr <> "" Then
        Label3(2).Visible = True
        Label3(2).Caption = "gleicher Preis auch bei " & sBez & " (" & sLinr & ") "
        Label3(2).ForeColor = vbGreen
        
        Label3(5).Visible = True
        Label3(5).Caption = "gleicher Preis auch bei " & sBez & " (" & sLinr & ") "
        Label3(5).ForeColor = vbGreen
        
    Else
        Label3(2).Visible = False
        Label3(5).Visible = False
    End If
     
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "LEKandererLieferantenermitteln"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Function ArtikelmitkleinerenLEKandererLieferantenloeschen(cArtNr As String, lLinr As Long) As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim dMin            As Double
    Dim dMax            As Double
    Dim dtmp            As Double
    Dim cSQL            As String
    Dim rsrs            As Recordset
    Dim sLinr           As String
    Dim sBez            As String
    Dim cMin            As String
    Dim sERG_Libesnr    As String
    Dim sERG_MINMEN     As String
    Dim sERG_kuerzel    As String
    If cArtNr = "" Then
        Exit Function
    End If
    
    ArtikelmitkleinerenLEKandererLieferantenloeschen = False

    dMin = 0
    dMax = 0
    dtmp = 0
    '**************************** LEK ************************
    

    
     
    cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr
    cSQL = cSQL & " and linr = " & cLinr
    
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!lekpr) Then
            dMax = rsrs!lekpr
            dMin = dMax
        Else
            dMax = 0
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr
    If lLinr = 0 Then
        cSQL = cSQL & " and linr <> " & cLinr
    Else
        cSQL = cSQL & " and linr = " & lLinr
    End If
    cSQL = cSQL & " and lekpr > 0 "
    cSQL = cSQL & " and RKZ = 'N'"
    
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!lekpr) Then
                dtmp = rsrs!lekpr
            Else
                dtmp = 0
            End If
            If dtmp < dMin Then
            
                sERG_Libesnr = ""
                sERG_MINMEN = "0"
                sLinr = ""
            
                dMin = dtmp
                cMin = Format$(dMin, "###,##0.00")
                If Not IsNull(rsrs!linr) Then
                    sLinr = rsrs!linr
                End If
                
                If Not IsNull(rsrs!LIBESNR) Then
                    sERG_Libesnr = rsrs!LIBESNR
                End If
                
                If Not IsNull(rsrs!MINMEN) Then
                    sERG_MINMEN = rsrs!MINMEN
                End If
            End If
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If sLinr <> "" Then
    
        sERG_kuerzel = ""
        sBez = ""
        
        cSQL = "Select * from lisrt where linr = " & sLinr
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!LIEFBEZ) Then
                sBez = rsrs!LIEFBEZ
            End If
            
            If Not IsNull(rsrs!Kuerzel) Then
                sERG_kuerzel = rsrs!Kuerzel
            End If
        End If
        rsrs.Close: Set rsrs = Nothing
    End If
    
    If dMin < dMax Then
        ArtikelmitkleinerenLEKandererLieferantenloeschen = True
        
        Insert_BestEver cArtNr, sLinr, sERG_Libesnr, sERG_MINMEN, sBez, dMin, dMax, sERG_kuerzel
    End If
     
    Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ArtikelmitkleinerenLEKandererLieferantenloeschen"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Function
Private Sub Insert_BestEver(sArtnr As String, sLinr As String, slibesnr As String, sVPE As String, _
sLiefBez As String, dLEK_MIN As Double, dLEK_TEUER As Double, sKurz As String)
On Error GoTo LOKAL_ERROR

    Dim sSQL As String
    
    If sArtnr = "" Then
        Exit Sub
    End If

    If sVPE = "" Then sVPE = "0"
    If sLinr = "" Then sLinr = "0"
    
    sSQL = "Insert into BESTEVER (Artnr,LINR,LIBESNR,MINMEN,LIEFBEZ,LEKPR,LEKPR_TEUER,Kuerzel)"
    sSQL = sSQL & " values ( "
    sSQL = sSQL & " " & sArtnr & " "
    sSQL = sSQL & " ," & sLinr & " "
    sSQL = sSQL & " ,'" & slibesnr & "' "
    sSQL = sSQL & " ," & sVPE & " "
    sSQL = sSQL & " ,'" & sLiefBez & "' "
    sSQL = sSQL & " ,'" & dLEK_MIN & "' "
    sSQL = sSQL & " ,'" & dLEK_TEUER & "' "
    sSQL = sSQL & " ,'" & sKurz & "' "
    sSQL = sSQL & " ) "
    gdApp.Execute sSQL, dbFailOnError
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Insert_BestEver"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
'    Resume Next
End Sub

Private Sub fra1_MouseMove(Button As Integer, Shift As Integer, X As Single, Y As Single)
On Error GoTo LOKAL_ERROR

    lbl1(3).ForeColor = glS1
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fra1_MouseMove"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "

    Fehlermeldung1
End Sub


Private Sub lbl1_Click(index As Integer)
On Error GoTo LOKAL_ERROR

    If index = 3 Then
        If lbl1(3).Caption = "Artnr/EAN" Then
            lbl1(3).Caption = "LibesNr"
        ElseIf lbl1(3).Caption = "LibesNr" Then
            lbl1(3).Caption = "Artnr/EAN"
        End If
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "lbl1_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "

    Fehlermeldung1
End Sub
Private Sub lbl1_MouseMove(index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
On Error GoTo LOKAL_ERROR

    If index = 3 Then
        lbl1(3).ForeColor = glLink
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "lbl1_MouseMove"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub List2_Change()
On Error GoTo LOKAL_ERROR

    Dim cArtNr      As String
    Dim Datum1 As Date

    Datum1 = DateValue("01.01." & Label9(1).Caption)
    cArtNr = Left(List2.list(List2.ListIndex), 6)

    diagrammfuellenMod3 cArtNr, Datum1
    Detaildatenermitteln2 cArtNr

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List2_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "

    Fehlermeldung1
End Sub

Private Sub lbl2_Click(index As Integer)
On Error GoTo LOKAL_ERROR
    
    If index = 3 Then
        Frame12.Visible = True
        Label6(9).Caption = lbl2(3).Caption
        Label6(8).Caption = Command6.Caption
        
        ZeigeMailText CLng(Label6(8).Caption)
    End If
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "lbl2_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub ZeigeMailText(lLinr As Long)
On Error GoTo LOKAL_ERROR

Dim sSQL    As String
Dim rsrs    As Recordset

Text14.Text = ""

sSQL = "Select * from LISRT_MAIL  "
sSQL = sSQL & " where Linr = " & lLinr & ""
Set rsrs = gdBase.OpenRecordset(sSQL)

If Not rsrs.EOF Then
    If Not IsNull(rsrs!MAILTEXT) Then
        Text14.Text = rsrs!MAILTEXT
    End If
End If

rsrs.Close: Set rsrs = Nothing

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "ZeigeMailText"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub List2_Click()
On Error GoTo LOKAL_ERROR

    Dim cArtNr      As String
    Dim Datum1 As Date

    Datum1 = DateValue("01.01." & Label9(1).Caption)
    cArtNr = Left(List2.list(List2.ListIndex), 6)

    diagrammfuellenMod3 cArtNr, Datum1
    Detaildatenermitteln2 cArtNr

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List2_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "

    Fehlermeldung1
End Sub

Private Sub List6_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    Dim ctmp As String
    Dim lcount As Long
    
    List6.Visible = True
    
    If KeyCode = vbKeyF2 Then
        gF2Prompt.cFeld = ""
        gF2Prompt.cWert = ""
        gF2Prompt.cWert2 = ""
        gF2Prompt.cWahl = ""
        gF2Prompt.bMultiple = False
        
        gF2Prompt.cFeld = "LINR"
            
        If gF2Prompt.cFeld <> "" Then
            frmWK00a.Show 1
            If gF2Prompt.cWahl <> "" Then
                List6.AddItem gF2Prompt.cWahl
            End If
        End If
    End If

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "List6_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub MSFlexGrid2_Click()
On Error GoTo LOKAL_ERROR

    glSelect = MSFlexGrid2.Row
    If glSelect = glmaxtabzeilenanz + 1 Then
        MSFlexGrid2.TopRow = glSelect
        MSFlexGrid2.Row = glSelect
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFlexGrid2_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub MSFlexGrid2_DblClick()
    On Error GoTo LOKAL_ERROR
    
    If MSFlexGrid2.Row > 1 Then

    Else
        sortierenGrid MSFlexGrid2
    End If
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFlexGrid2_DblClick"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub



Private Sub MSFlexGrid2_KeyDown(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR

    Dim lrow As Long
    Dim lcol As Long
    
    lrow = MSFlexGrid2.Row
    lcol = MSFlexGrid2.Col
    

    
    If KeyCode <> vbKeyDown And KeyCode <> vbKeyUp And KeyCode <> vbKeyRight And KeyCode <> vbKeyLeft Then
    
        Select Case lcol
            Case Is = SpaltennummerBESTVOR
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
                
            Case Is = SpaltennummerBESTVOR_NR
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            Case Is = SpaltennummerBESTVOR_TESTER
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            Case Is = SpaltennummerBESTVOR_PROBEN
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            Case Is = SpaltennummerMINBEST
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                

                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            Case Is = SpaltennummerMINMEN
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                

                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            Case Is = SpaltennummerBESTAND
            
                If Check14.value = vbUnchecked Then 'Bestandsveränderung erlaubt
        
                    If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    
    
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                        
                    ElseIf iKeypress > 0 And KeyCode = 46 Then
                    
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    iKeypress = iKeypress + 1
                End If
                
            Case Is = SpaltennummerNOTIZEN
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    
'                        MSFlexGrid2.Row = lrow
'                        MSFlexGrid2.Col = lcol
'                        MSFlexGrid2.Text = ""
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            Case Is = SpaltennummerRKZ
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            Case Is = SpaltennummerAWM
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
                
            Case Is = SpaltennummerAWM2
        
                If iKeypress = 0 And KeyCode <> vbKeyBack Then
                    
                    If KeyCode = 187 Or KeyCode = 189 Or KeyCode = 107 Or KeyCode = 109 Or KeyCode = vbKeyF2 Or KeyCode = vbKeyF3 Or KeyCode = vbKeyF4 Or KeyCode = vbKeyF5 Or KeyCode = vbKeyF6 Then
                    
                    Else
                        MSFlexGrid2.Row = lrow
                        MSFlexGrid2.Col = lcol
                        MSFlexGrid2.Text = ""
                    
                    End If
                    
                ElseIf iKeypress > 0 And KeyCode = 46 Then
                
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    MSFlexGrid2.Text = ""
                
                End If
                iKeypress = iKeypress + 1
            
        End Select
    End If
    
    
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFlexGrid2_KeyDown"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub


Private Sub MSFlexGrid2_SelChange()
    On Error GoTo LOKAL_ERROR

    Dim lColmerker          As Long
    Dim lRowmerker          As Long
    Dim cJahrNow            As String
    Dim cArtNr              As String
    Dim cartnrzuSpeichern   As String
    Dim dat                 As Date
    Dim sZubest             As String
    Dim lBest               As Long
    Dim cPreis              As String
    Dim cSQL                As String
    
    If MSFlexGrid2.Row > 1 Then
    
        MSFlexGrid2.Redraw = False
        
'        If SSCommand2(10).Caption = "Grafik Aus" Then
            '******************** für das Diagramm *******************
            cJahrNow = Year(Now)
            cArtNr = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
            If cArtNr <> "" Then
                If IsNumeric(cArtNr) Then
                    If Check13.value = vbUnchecked Then
                        diagrammfuellenalt cArtNr
                    ElseIf Check13.value = vbChecked Then
                        diagrammfuellenShape3 cArtNr, Year(DateValue(Now))
                    End If
                    
                    ErmlzDreiZugaenge cArtNr, List7
                    
                End If
            End If
    
            Label9(49).Caption = cJahrNow - 1
            Label9(50).Caption = cJahrNow
            
            If cArtNr <> "" Then
                If IsNumeric(cArtNr) Then
                    Detaildatenermitteln cArtNr
                    LEKandererLieferantenermitteln cArtNr
                End If
            End If
            
            cArtNr = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
            
            lbl6(25).Caption = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr) & Space(2) & MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerBEZEICH)
            lbl6(25).Refresh
            
            If cArtNr <> "" Then
                If IsNumeric(cArtNr) Then
                    lbl6(17).Caption = vkljB(cArtNr)
                    lbl6(17).Refresh
                    lbl6(19).Caption = vkvjB(cArtNr)
                    lbl6(19).Refresh
                    lbl6(22).Caption = vkamB(cArtNr)
                    lbl6(22).Refresh
                    lbl6(23).Caption = vkvmB(cArtNr)
                    lbl6(23).Refresh
                    
                    lbl6(40).Caption = ZeigeArtmerk(cArtNr)
                    lbl6(40).ForeColor = vbRed
                    lbl6(40).Refresh
                    
                    lbl1(8).Caption = ZeigeArtKondi(cArtNr)
                    lbl1(8).ForeColor = vbRed
                    lbl1(8).Refresh
                    
                    
                End If
            End If
            
            
            

    
        If gbAender Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            sZubest = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerBESTVOR)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            bestvor_zwischenspeichern cartnrzuSpeichern, sZubest
            
            lbl2(0).Caption = BerechneBestellAnzZEN
            lbl2(1).Caption = BerechneBestellwertZEN
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAender = False
            
        End If
        
        If gbAenderNR Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            sZubest = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerBESTVOR_NR)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            nr_zwischenspeichern cartnrzuSpeichern, sZubest
                
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderNR = False
        End If
        
        If gbAenderPROBEN Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            sZubest = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerBESTVOR_PROBEN)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            proben_zwischenspeichern cartnrzuSpeichern, sZubest
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderPROBEN = False
        End If
        
        If gbAenderTESTER Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            sZubest = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerBESTVOR_TESTER)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            TESTER_zwischenspeichern cartnrzuSpeichern, sZubest
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderTESTER = False
        End If
        
        
        
        If gbAenderMINBEST Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            cPreis = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerMINBEST)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            
            If IsNumeric(cPreis) Then
                Artikelveraenderung cartnrzuSpeichern, cPreis, "Artikel bea Tabelle", "MINBEST"
                
                cSQL = "Update VORSCHLZ set MINBEST = " & cPreis
                cSQL = cSQL & " where artnr = " & cartnrzuSpeichern
                gdApp.Execute cSQL, dbFailOnError
                
            End If
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderMINBEST = False
            
        End If
        
        If gbAenderMINMEN Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            cPreis = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerMINMEN)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            If IsNumeric(cPreis) Then
            
                cSQL = "Update artlief set minmen = " & cPreis & " where artnr = " & cartnrzuSpeichern
                cSQL = cSQL & " and linr = " & Text1(0).Text
                gdBase.Execute cSQL, dbFailOnError
                
                cSQL = "Update VORSCHLZ set MINMEN = " & cPreis
                cSQL = cSQL & " where artnr = " & cartnrzuSpeichern
                gdApp.Execute cSQL, dbFailOnError
                
            End If
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderMINMEN = False
            
        End If
        
        If gbAenderBEST Then
        
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            lBest = Val(MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerBESTAND))
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            If Check14.value = vbUnchecked Then 'Bestandsveränderung erlaubt
                BestandsverauchinBestell cartnrzuSpeichern, lBest
                Bestandsveraenderung cartnrzuSpeichern, lBest, "Bestellung Tabelle"
                
                Beep
                Beep
            End If
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderBEST = False
        End If
        
        If gbAenderRKZ Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            cPreis = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerRKZ)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            If cPreis <> "" Then
                Artikelveraenderung cartnrzuSpeichern, UCase(cPreis), "Artikel bea Tabelle", "RKZ"
                
                cSQL = "Update VORSCHLZ set RKZ = '" & cPreis & "'"
                cSQL = cSQL & " where artnr = " & cartnrzuSpeichern
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            Beep
            Beep
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderRKZ = False
            
        End If
        
        If gbAenderAWM Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            cPreis = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerAWM)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            If IsNumeric(cPreis) Then
                Artikelveraenderung cartnrzuSpeichern, cPreis, "Artikel bea Tabelle", "AWM"
                
                If Check12.value = vbChecked Then
                    If cPreis = "3" Then 'Farbe rot
                        Artikelveraenderung cartnrzuSpeichern, "N", "Artikel bea Tabelle", "GEFUEHRT"
                    End If
                End If
                
                FaerbenFlex cPreis, MSFlexGrid2, CInt(SpaltennummerArtnr), CInt(glSelect) 'CInt(lRowMerker)
                FaerbePlus2 MSFlexGrid2, CInt(SpaltennummerArtnr), CInt(glSelect)
                
                cSQL = "Update VORSCHLZ set awm = '" & cPreis & "'"
                cSQL = cSQL & " where artnr = " & cartnrzuSpeichern
                gdApp.Execute cSQL, dbFailOnError
            End If
            
            Beep
            Beep
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderAWM = False
            
        End If
        
        If gbAenderAWM2 Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row

            cPreis = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerAWM2)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)

            If IsNumeric(cPreis) Then
            
                If Val(cPreis) < 20 Then
                
                    cSQL = "Delete from ARTFARB2 where artnr = " & cartnrzuSpeichern
                    gdApp.Execute cSQL, dbFailOnError
                    
                    cSQL = "Insert into ARTFARB2 (ARTNR,AWM2) values (" & cartnrzuSpeichern & ", '" & cPreis & "')"
                    gdApp.Execute cSQL, dbFailOnError
                
                    cSQL = "Delete from ARTFARB2 where artnr = " & cartnrzuSpeichern
                    gdBase.Execute cSQL, dbFailOnError
                    
                    cSQL = "Insert into ARTFARB2 (ARTNR,AWM2) values (" & cartnrzuSpeichern & ", '" & cPreis & "')"
                    gdBase.Execute cSQL, dbFailOnError
                    
                    FaerbenFlex cPreis, MSFlexGrid2, CInt(SpaltennummerAWM2), CInt(glSelect)
    
                    cSQL = "Update VORSCHLZ set awm2 = '" & cPreis & "'"
                    cSQL = cSQL & " where artnr = " & cartnrzuSpeichern
                    gdApp.Execute cSQL, dbFailOnError
                End If
            End If

            Beep
            Beep

            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker

            gbAenderAWM2 = False

        End If
        
        If gbAenderNOTIZEN Then
            lColmerker = MSFlexGrid2.Col
            lRowmerker = MSFlexGrid2.Row
            
            cPreis = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerNOTIZEN)
            cartnrzuSpeichern = MSFlexGrid2.TextMatrix(Val(lbl6(0).Caption), SpaltennummerArtnr)
            
            
            Artikelveraenderung cartnrzuSpeichern, cPreis, "Artikel bea Tabelle", "NOTIZEN"
            
            cSQL = "Update VORSCHLZ set NOTIZEN = '" & cPreis & "'"
            cSQL = cSQL & " where artnr = " & cartnrzuSpeichern
            gdApp.Execute cSQL, dbFailOnError
             
            Beep
            Beep
            
            MSFlexGrid2.Col = lColmerker
            MSFlexGrid2.Row = lRowmerker
            
            gbAenderNOTIZEN = False
            
        End If
    
        MSFlexGrid2.Redraw = True
    End If
    
    MSFlexGrid2_Click
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFLexGrid2_SelChange"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub

Private Function BerechneBestellwertZEN() As String
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL            As String
    Dim dBestellwert    As Double
    Dim rsrs            As Recordset
    
    Screen.MousePointer = 11
    
    dBestellwert = 0
    
    
    cSQL = "Select SUM(BESTVOR) as MENGE, SUM(LEKPR * BESTVOR) as WERT from vorschlz"
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!Wert) Then
            dBestellwert = rsrs!Wert
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    BerechneBestellwertZEN = Format$(dBestellwert, "###,##0.00") & " " & gcWaehrung
    

    Screen.MousePointer = 0
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BerechneBestellwertZEN"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function
Private Function BerechneBestellAnzZEN() As String
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL            As String
    Dim dAnz            As Double
    Dim rsrs            As Recordset
    
    Screen.MousePointer = 11
    
    dAnz = 0
    
    cSQL = "Select SUM(BESTVOR) as MENGE, SUM(LEKPR * BESTVOR) as WERT from vorschlz"
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!Menge) Then
            dAnz = rsrs!Menge
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    BerechneBestellAnzZEN = Format$(dAnz, "###,##0")
    

    
    Screen.MousePointer = 0
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BerechneBestellAnzZEN"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Function

Private Sub bestvor_zwischenspeichern(cArtNr As String, sBestvor As String)
On Error GoTo LOKAL_ERROR

    Dim sSQL As String
    Dim lFaktor As Long
    Dim lBestellmenge As Long
    Dim siErgebnis As Single
    
    If IsNumeric(cArtNr) Then
        If Trim$(sBestvor) = "" Then
            sBestvor = "0"
        End If
    
        If IsNumeric(sBestvor) Then
        
            If Len(sBestvor) > 6 Then
                anzeige "rot", "Die Bestellmenge ist zu groß!", lbl7
                gbAender = False
                Exit Sub
            Else

                sSQL = "update vorschlz set bestvor= " & sBestvor & " where artnr = " & cArtNr
                gdApp.Execute sSQL, dbFailOnError
                
            End If
        
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "bestvor_zwischenspeichern"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub nr_zwischenspeichern(cArtNr As String, sBestvor As String)
On Error GoTo LOKAL_ERROR

    Dim sSQL As String
    Dim lFaktor As Long
    Dim lBestellmenge As Long
    Dim siErgebnis As Single
    
    If IsNumeric(cArtNr) Then
        If Trim$(sBestvor) = "" Then
            sBestvor = "0"
        End If
    
        If IsNumeric(sBestvor) Then
        
            If Len(sBestvor) > 6 Then
                anzeige "rot", "Die Naturalrabattmenge ist zu groß!", lbl7
                gbAender = False
                Exit Sub
            Else
                sSQL = "update vorschlz set BESTVOR_NR= " & sBestvor & " where artnr = " & cArtNr
                gdApp.Execute sSQL, dbFailOnError
            End If
            
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "nr_zwischenspeichern"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub TESTER_zwischenspeichern(cArtNr As String, sBestvor As String)
On Error GoTo LOKAL_ERROR

    Dim sSQL As String
    Dim lFaktor As Long
    Dim lBestellmenge As Long
    Dim siErgebnis As Single
    
    If IsNumeric(cArtNr) Then
        If Trim$(sBestvor) = "" Then
            sBestvor = "0"
        End If
    
        If IsNumeric(sBestvor) Then
            If Len(sBestvor) > 6 Then
                anzeige "rot", "Die Testermenge ist zu groß!", lbl7
                gbAender = False
                Exit Sub
            Else
                sSQL = "update vorschlz set BESTVOR_TESTER= " & sBestvor & " where artnr = " & cArtNr
                gdApp.Execute sSQL, dbFailOnError
            End If
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "TESTER_zwischenspeichern"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub proben_zwischenspeichern(cArtNr As String, sBestvor As String)
On Error GoTo LOKAL_ERROR

    Dim sSQL As String
    Dim lFaktor As Long
    Dim lBestellmenge As Long
    Dim siErgebnis As Single
    
    If IsNumeric(cArtNr) Then
        If Trim$(sBestvor) = "" Then
            sBestvor = "0"
        End If
    
        If IsNumeric(sBestvor) Then
        
            If Len(sBestvor) > 6 Then
                anzeige "rot", "Die Probenmenge ist zu groß!", lbl7
                gbAender = False
                Exit Sub
            Else
                sSQL = "update vorschlz set BESTVOR_PROBEN= " & sBestvor & " where artnr = " & cArtNr
                gdApp.Execute sSQL, dbFailOnError
            End If
        
        End If
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "proben_zwischenspeichern"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Function vkamB(cArtNr As String) As String
    On Error GoTo LOKAL_ERROR

    Dim cSQL As String
    Dim rsrs As Recordset
    Dim ctmp As String

    cSQL = "Select VKAMO1 from VORSCHLZ where ARTNR = " & cArtNr
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!VKAMo1) Then
            ctmp = rsrs!VKAMo1
        Else
            ctmp = 0
        End If
        vkamB = ctmp

    Else
        vkamB = "0"

    End If
    rsrs.Close: Set rsrs = Nothing
    
    Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "vkamB"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Function
Private Function vkvmB(cArtNr As String) As String
    On Error GoTo LOKAL_ERROR

    Dim cSQL As String
    Dim rsrs As Recordset
    Dim ctmp As String

    cSQL = "Select VKVMO1 from VORSCHLZ where ARTNR = " & cArtNr
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!VKVMO1) Then
            ctmp = rsrs!VKVMO1
        Else
            ctmp = 0
        End If
        vkvmB = ctmp

    Else
        vkvmB = "0"

    End If
    rsrs.Close: Set rsrs = Nothing
    
    Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "vkvmB"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Function
Private Function vkljB(cArtNr As String) As String

    On Error GoTo LOKAL_ERROR
    
    '***************************** VKLJ ***********************
    Dim cSQL As String
    Dim rsrs As Recordset
    Dim ctmp As String
    
    cSQL = "Select VKLJ1 from VORSCHLZ where ARTNR = " & cArtNr
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!VKLJ1) Then
            ctmp = rsrs!VKLJ1
        Else
            ctmp = "0"
        End If
        vkljB = ctmp
        
    Else
        vkljB = "0"
    End If
    rsrs.Close: Set rsrs = Nothing
    

    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "vkljB"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Function
Private Function vkvjB(cArtNr As String) As String

    On Error GoTo LOKAL_ERROR
    
    '***************************** VKVJ ***********************
    Dim cSQL As String
    Dim rsrs As Recordset
    Dim ctmp As String
    
    cSQL = "Select VKVJ1 from VORSCHLZ where ARTNR = " & cArtNr
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!VKVJ1) Then
            ctmp = rsrs!VKVJ1
        Else
            ctmp = "0"
        End If
        vkvjB = ctmp
        
    Else
        vkvjB = "0"
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "vkvjB"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. "
    
    Fehlermeldung1
End Function
Private Sub Option1_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Select Case index
        Case Is = 0
            Text1(5).Text = ""
            Text1(6).Text = ""
            Label1(8).Visible = False
            Label1(9).Visible = False
            Text1(5).Visible = False
            Text1(6).Visible = False
            Command2(1).Visible = False
            Command2(3).Visible = False
        Case Is = 1
            Label1(8).Visible = True
            Label1(9).Visible = True
            Text1(5).Visible = True
            Text1(6).Visible = True
            Command2(1).Visible = True
            Command2(3).Visible = True
    End Select
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Option1_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Option2_Click(index As Integer)
On Error GoTo LOKAL_ERROR

If Option2(2).value = True Then
    Check11.Visible = True
Else
    Check11.Visible = False
End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Option2_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub SSCommand1_Click()
    On Error GoTo LOKAL_ERROR

    Dim rec As Recordset
    Dim sSQL As String
    
    anzeige "normal", "", lbl7
    
    MSFlexGrid2_SelChange
    
    If SSCommand1.Caption = "Vorschlag > 0" Then
    
        SSCommand1.Caption = "Vorschlag Alles"
        loeschNEW "VORSCHLZTE", gdApp
        
        sSQL = "select  * into VORSCHLZTE from vorschlz where bestvor is null or bestvor=0"
        gdApp.Execute sSQL, dbFailOnError
        
        sSQL = "Delete from vorschlz where bestvor is null or bestvor=0"
        gdApp.Execute sSQL, dbFailOnError

    ElseIf SSCommand1.Caption = "Vorschlag Alles" Then
        SSCommand1.Caption = "Vorschlag > 0"
        If NewTableSuchenDBKombi("VORSCHLZTE", gdApp) = True Then
        
            sSQL = "Insert into vorschlz select  * from VORSCHLZTE"
            gdApp.Execute sSQL, dbFailOnError
        
        End If
    End If
    
    MSFlexGrid2.Clear
    zeige_Grid False, True, False
    
    lbl6(0).Caption = "1"
    lbl6(1).Caption = "2"
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SSCommand1_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub zeige_Grid(bAllesneu As Boolean, Optional bMitKundbest As Boolean = True, Optional bKBHochAddieren As Boolean = True)
On Error GoTo LOKAL_ERROR

    Dim sSQL        As String
    Dim j           As Integer
    Dim recAnz      As Recordset
    Dim rsrs        As Recordset
    Dim ctmp        As String
    Dim siFak       As Single
    Dim cArtNr      As String
    Dim iStufe      As Integer
    
    lbl2(0).Caption = "0"
    lbl2(1).Caption = "0.00 EUR"
    Command6.Caption = ""
    
    Label3(2).Caption = ""
    Label3(5).Caption = ""
    Label3(2).Visible = False
    Label3(5).Visible = False
    
    picprogress.Visible = True
    
    Set recAnz = gdApp.OpenRecordset("vorschlz")
    
    If Check6.value = vbUnchecked Then
        If recAnz.EOF Then
    
            gbBestVorOk = True
            MSFlexGrid2.Visible = False
            
            MSFlexGrid2.Clear
            fra0.Visible = False
            Frame1.Visible = True
            MsgBox "Keine Artikel für Bestellung gefunden!", vbInformation, "Winkiss Hinweis:"
            
            Exit Sub
        End If
    End If
    recAnz.Close: Set recAnz = Nothing
    
    Set recAnz = gdApp.OpenRecordset("vorschlz")
    If Not recAnz.EOF Then
        recAnz.MoveLast
        If Val(recAnz.RecordCount) > 14999 Then
            gbBestVorOk = True
            MSFlexGrid2.Visible = False
            MSFlexGrid2.Clear
            fra0.Visible = False
            Frame1.Visible = True
            MsgBox "Über 15000 Artikel (" & recAnz.RecordCount & ") wurden für die Bestellung gefunden! Bitte schränken Sie Ihre Suche ein.", vbInformation, "Winkiss Hinweis:"
            recAnz.Close: Set recAnz = Nothing
            Exit Sub
        End If
    End If
    recAnz.Close: Set recAnz = Nothing
    
    If Text1(0).Text <> "" Then
        Command6.Caption = Text1(0).Text
    Else
        sSQL = "Select LINR from VORSCHLZ "
        Set rsrs = gdApp.OpenRecordset(sSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!linr) Then
                Text1(0).Text = rsrs!linr
                Command6.Caption = rsrs!linr
            End If
        End If
        rsrs.Close: Set rsrs = Nothing
    End If
    
    txtStatus.Text = "50"
    
    If bAllesneu = True Then
    
        lbl5(3).Caption = "0.00 EUR"
        lbl5(5).Caption = "0.00 EUR"
    
        lbl5(3).Caption = Format$(Einkaufsumsatzermittlung(cLinr, gdBase, CInt(Year(Now))), "########0.00 EUR LJ")
        lbl5(3).Caption = lbl5(3).Caption & vbCrLf & Format$(Einkaufsumsatzermittlung(cLinr, gdBase, CInt(Year(Now) - 1)), "########0.00 EUR VJ")
        txtStatus.Text = "52"
        lbl5(5).Caption = Format$(LAGEREKermittlung(cLinr), "########0.00 EUR")
            
        lbl5(3).Refresh
        lbl5(5).Refresh
    End If
    
    Screen.MousePointer = 11

    Tabcheck "Bestellung"
    txtStatus.Text = "53"
    
    gbenterC = False
    
    FormatGridOverTablay "Bestellung"

    With MSFlexGrid2
        .Redraw = False
        .Visible = False
        .Clear
        .Rows = 25
        
        
        .Cols = byAnzahlSpalten
        .FixedCols = 0
        .FixedRows = 1
        .Row = 0
        For j = 0 To byAnzahlSpalten - 1
            .Col = j
            .Text = sSpaltenname(j)
        Next j
    End With
    
    lbl2(1).Caption = "0 EUR"
    
    FuellenMSFlex43
    
    fra0.Visible = False
    Me.Refresh
    
    txtStatus.Text = "3"
    
    ermittlespalten
    
    If bAllesneu = True Then
    
        lbl5(1).Caption = "0.00 EUR"
        lbl2(3).Caption = ""
    
        sSQL = "select liefbez,awert from lisrt where linr= " & Text1(0).Text
        Set recAnz = gdBase.OpenRecordset(sSQL)
        
        If Not recAnz.EOF Then
            If Not IsNull(recAnz!LIEFBEZ) Then
                lbl2(3).Caption = recAnz!LIEFBEZ
            End If
            
            If Not IsNull(recAnz!AWERT) Then
                lbl5(1).Caption = Format$(recAnz!AWERT, "###,##0.00") & " " & gcWaehrung
            End If
            
            If GibtEsMailText(CLng(Text1(0).Text)) Then
                lbl2(3).ForeColor = vbRed
            Else
                lbl2(3).ForeColor = lbl5(4).ForeColor
            End If
        End If
        recAnz.Close: Set recAnz = Nothing
        
    End If
    
    
    
    txtStatus.Text = "24"
    
    iStufe = 10
    
    MSFlexGrid2.Redraw = False
    
    txtStatus.Text = "29"
    
    Tabellenbreiteanpassen MSFlexGrid2, 1.25 * gdTabfak
    
    
    fra0.Visible = False
    Me.Refresh
    
    iStufe = 11
    
    txtStatus.Text = "37"
    Screen.MousePointer = 11
    FaerbenGrid MSFlexGrid2, CInt(SpaltennummerAWM), CInt(SpaltennummerArtnr)
    Screen.MousePointer = 0
    
    Screen.MousePointer = 11
    FaerbenGrid MSFlexGrid2, CInt(SpaltennummerAWM2), CInt(SpaltennummerAWM2)
    Screen.MousePointer = 0
    
    Screen.MousePointer = 11
    RechneRab MSFlexGrid2, SpaltennummerRab, SpaltennummerKVKPR, SpaltennummerVKPR
    Screen.MousePointer = 0
    
    Screen.MousePointer = 11
    FaerbenGrid_INBEST MSFlexGrid2, CInt(SpaltennummerInBe)
    Screen.MousePointer = 0
    
    fra0.Visible = False
    Me.Refresh
    
    MSFlexGrid2.Redraw = False
    
    txtStatus.Text = "45"
    
    If Check3.value = vbChecked Then
        Screen.MousePointer = 11
        If bMitKundbest = True Then
            FaerbeBVOwegenKU MSFlexGrid2, SpaltennummerBESTVOR, SpaltennummerArtnr, bKBHochAddieren
        End If
        Screen.MousePointer = 0
    End If
    
    fra0.Visible = False
    Me.Refresh
    
    txtStatus.Text = "56"
    If Check4.value = vbChecked Then
        'Konditionen mitnehmen
        Screen.MousePointer = 11
        FaerbeBVOwegenKondi MSFlexGrid2, SpaltennummerBESTVOR, SpaltennummerArtnr, CInt(Combo1.Text), SpaltennummerBESTVOR_NR
        Screen.MousePointer = 0
    End If

    fra0.Visible = False
    Me.Refresh
    
    txtStatus.Text = "66"
    Screen.MousePointer = 11
    FaerbeBestvor MSFlexGrid2, SpaltennummerBESTVOR, SpaltennummerArtnr
    Screen.MousePointer = 0

    fra0.Visible = False
    Me.Refresh

    txtStatus.Text = "81"
    Screen.MousePointer = 11
    FaerbePlus MSFlexGrid2, SpaltennummerArtnr
    Screen.MousePointer = 0
    
    
    txtStatus.Text = "89"
'    zeigetabinrichtigerGrößean1
    zeigetabinrichtigerGrößean2
    
    fra0.Visible = False
    Me.Refresh
    
    MSFlexGrid2.ColWidth(SpaltennummerNOTIZEN) = MSFlexGrid2.ColWidth(SpaltennummerNOTIZEN) * 2
    
    iStufe = 12
    
    
    fra0.Visible = True
    Frame1.Visible = False

    MSFlexGrid2.Visible = True
    MSFlexGrid2.Redraw = True
    

'    MSFlexGrid2.Row = 1
    lbl6(0).Caption = 1
    lbl6(1).Caption = 3
    
    iStufe = 13
    
    lbl6(2).Caption = MSFlexGrid2.TextMatrix(2, SpaltennummerArtnr)
    iStufe = 14
    lbl3.Caption = "ArtNr. : " & MSFlexGrid2.TextMatrix(2, SpaltennummerArtnr)
    iStufe = 15
    lbl4.Caption = MSFlexGrid2.TextMatrix(2, SpaltennummerBEZEICH)
    iStufe = 16
    
    cArtNr = MSFlexGrid2.TextMatrix(2, SpaltennummerArtnr)
    
    txtStatus.Text = "91"
    lbl2(0).Caption = BerechneBestellAnzZEN
    txtStatus.Text = "94"
    lbl2(1).Caption = BerechneBestellwertZEN
    
    picprogress.Visible = False
    txtStatus.Text = "0"
    iStufe = 22
    
    MSFlexGrid2.TopRow = 1
    MSFlexGrid2.Col = SpaltennummerBESTVOR
    MSFlexGrid2.Row = 1
    MSFlexGrid2.SetFocus
'    MSFlexGrid2.SetFocus
    gbenterC = True
    iStufe = 23
    Screen.MousePointer = 0
    
    
    
    SSCommand2(2).Enabled = True
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "zeige_Grid"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten. " & iStufe
    
    Fehlermeldung1

End Sub
Private Sub zeige_Grid3()
On Error GoTo LOKAL_ERROR

    Dim sArtbez      As String
    Dim i           As Integer
    Dim j           As Integer
    Dim lRows       As Long
    Dim bFound      As Boolean
    Dim lLaengebez  As Long
    
    bFound = False
    
    sArtbez = Trim$(Text10.Text)
    lLaengebez = Len(sArtbez)
   
    MSFlexGrid2.Redraw = False
    Text10.Text = ""
    lRows = MSFlexGrid2.Rows
    MSFlexGrid2.Row = 0
    
    For j = 0 To MSFlexGrid2.Cols - 1
        MSFlexGrid2.Col = j
        If MSFlexGrid2.Text = "Artikelbezeichnung" Then
        
            For i = 2 To lRows - 1
                MSFlexGrid2.Row = i
                MSFlexGrid2.Col = j
                
                If UCase(Left(MSFlexGrid2.Text, lLaengebez)) = UCase(sArtbez) Then
                    
                    MSFlexGrid2.TopRow = i
                    MSFlexGrid2.Col = SpaltennummerBESTVOR
                    MSFlexGrid2.Row = i
                    MSFlexGrid2.SetFocus
                    bFound = True
                    Exit For
                Else
                    MSFlexGrid2.TopRow = 1
                    MSFlexGrid2.Row = 1
                    Text10.Text = ""
                    Text10.SetFocus
                    bFound = False
                    
                End If
            Next i
            
            Exit For
        End If
    Next j
    MSFlexGrid2.Redraw = True



    If bFound = False Then
    '    anzeige "Rot", "Artikel wurde in diesem Bestellvorschlag nicht gefunden.", lbl7
        Text10.Text = ""
        Text10.SetFocus
        MSFlexGrid2.Col = 0
        MSFlexGrid2.Row = 0
    Else
        MSFlexGrid2_SelChange
    End If
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "zeige_Grid3"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1

End Sub
Private Sub SSCommand2_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim lcount      As Long
    Dim lAnzRows    As Long
    Dim cPfad       As String
    Dim cPfad1      As String
    Dim ctmp        As String
    Dim cSQL        As String
    Dim iRet        As Integer
    Dim rsrs        As Recordset
    Dim rsMitt      As Recordset
    Dim i           As Integer

    Screen.MousePointer = 11
    
    cPfad = App.Path              'Anwendungspfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad1 = gcDBPfad           'Datenbankpfad
    If Right$(cPfad1, 1) <> "\" Then
        cPfad1 = cPfad1 & "\"
    End If
    
    Select Case index
        Case Is = 0     '** Schließen **
            If Not gbBestVorOk Then
                ctmp = "Der BestellVORSCHLZag wurde bisher noch nicht ausgedruckt" & vbCrLf & "bzw. per FAX verschickt."
                ctmp = ctmp & vbCrLf & vbCrLf & "Damit gilt der BestellVORSCHLZag noch nicht als Bestellung!"
                ctmp = ctmp & vbCrLf & vbCrLf & "Den Dialog trotzdem verlassen?"

                iRet = MsgBox(ctmp, vbQuestion + vbYesNo, "Winkiss Frage:")
                If iRet <> vbYes Then
'                    bclickAusb = False
                    Screen.MousePointer = 0
                    Exit Sub
                End If
            End If

            '** Drucker wieder auf Listendrucker zurücksetzen **
'            setzedrucker gcListenDrucker
            '** Unload frmZENac
            fra0.Visible = False
            Text1(0).Text = ""
'            Text1(1).Text = "1"
            Text1(2).Text = "999"
            
            
            Text1(3).Text = "4"
            Text1(4).Text = "1"
            Text1(8).Text = ""
            
            For i = 5 To 6
                Text1(i).Text = ""
            Next i

            Frame1.Visible = True
            
            For i = 0 To 23
                Label10(i).Caption = ""
                Shape1(i).Top = gitop
                Shape1(i).Height = 15
            Next i
            
            For i = 0 To 35
                Label30(i).Caption = ""
                Shape3(i).Top = gitop
                Shape3(i).Height = 15
            Next i
            
            
            gbErfolg = True
        Case 1    '** Speichern / Drucken / Faxen **
            If BestellungWegSpeichern = True Then
                iBestellungAls = 0 'als Fax
                SchreibeBest iBestellungAls 'Faxen
            End If
        Case Is = 2 '** automatische Übertragung**
        
            ctmp = "Möchten Sie wirklich diese Bestellung per Email übertragen?" & vbCrLf & vbCrLf
            ctmp = ctmp & "an: " & lbl2(3).Caption & vbCrLf
            ctmp = ctmp & "Bestellwert EK Netto: " & lbl2(1).Caption & vbCrLf
            ctmp = ctmp & "Artikelanzahl: " & lbl2(0).Caption & vbCrLf
        

            iRet = MsgBox(ctmp, vbQuestion + vbYesNo + vbDefaultButton2, "Winkiss Frage:")
            If iRet = vbYes Then
    
                If gbErfolg = True Then
                    If BestellungWegSpeichern Then
                        
                        iBestellungAls = 2 'Mail
                        SchreibeSpeziFormat gsLinr
                        
                        
                        
                        If Check7.value = vbChecked Then
                            
                            SchreibeBest iBestellungAls 'EMAIL oder EDI
                        End If
        
    
                        gbBestVorOk = True
                        gbErfolg = False
                    End If
                End If
            End If
        Case 3
            SucheInGrid
        Case Is = 4     'alles auf 0
            cSQL = "Update VORSCHLZ set BESTVOR = 0"
            gdApp.Execute cSQL, dbFailOnError
            zeige_Grid False
        Case Is = 5     'Mitteilung schreiben
            fra4.Visible = True
            ZeigeblockinList "BESTELLUNG", List5
            
            txt2.Text = ""
            txt2.SetFocus
        Case Is = 6     'Zwischen speichern
            MSFlexGrid2_SelChange
            Frame5.BackColor = glH2
            Frame6.BackColor = glH2
            Frame5.Visible = True
'            Text4.Text = ""
            Text3.Text = Command6.Caption
            Text3.SetFocus
        Case Is = 7
            MSFlexGrid2_SelChange
            SSCommand2(7).Enabled = False
            BestVorNurDruckenWKL43
            SSCommand2(7).Enabled = True
        Case Is = 8
            gcArtNrFiliale = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
            frmWKLam.Show 1
            MSFlexGrid2.SetFocus
        Case Is = 9 'Artikel anfügen
        
            Dim cZiel           As String
            Dim sSQL            As String
    
            cZiel = gcDBPfad
            If Right$(cZiel, 1) <> "\" Then
                cZiel = cZiel & "\"
            End If
            
            MSFlexGrid2_SelChange
        
            loeschNEW "VORSCHLZ", gdBase
            TransferTab gdApp, cZiel & "Kissdata.mdb", "VORSCHLZ"
            
            If NewTableSuchenDBKombi("AN" & srechnertab, gdBase) = False Then
            
                loeschNEW "AN" & srechnertab, gdBase
        
                sSQL = "select artikel.* into AN" & srechnertab & " from artikel inner join artlief"
                sSQL = sSQL & " on artikel.artnr = artlief.artnr "
                sSQL = sSQL & " Where artlief.linr = " & Command6.Caption
                gdBase.Execute sSQL, dbFailOnError
                
                sSQL = "Update AN" & srechnertab & " inner join artlief"
                sSQL = sSQL & " on AN" & srechnertab & ".artnr = artlief.artnr "
                sSQL = sSQL & " set AN" & srechnertab & ".libesnr = artlief.libesnr "
                sSQL = sSQL & " , AN" & srechnertab & ".minmen = artlief.minmen "
                sSQL = sSQL & " , AN" & srechnertab & ".LEKPR = artlief.LEKPR "
                sSQL = sSQL & " , AN" & srechnertab & ".LINR = artlief.LINR "
                sSQL = sSQL & " , AN" & srechnertab & ".RKZ = artlief.RKZ "
                sSQL = sSQL & " , AN" & srechnertab & ".EXDAT = artlief.EXDAT "
                sSQL = sSQL & " Where artlief.linr = " & Command6.Caption
                gdBase.Execute sSQL, dbFailOnError
                
                'last vk Tabelle bauen
                loeschNEW "AN_LASTZU" & srechnertab, gdBase
    
                sSQL = "Select Artnr, max(adate) as lastzu into AN_LASTZU" & srechnertab & " "
                sSQL = sSQL & " from Zugang  "
'                sSQL = sSQL & " Where Zugang.linr = " & Command6.Caption
                sSQL = sSQL & " group by Artnr  "
                gdBase.Execute sSQL, dbFailOnError
                
                sSQL = "Update AN" & srechnertab & " set lastdate = null "
                gdBase.Execute sSQL, dbFailOnError
                
                sSQL = "Update AN" & srechnertab & " inner join AN_LASTZU" & srechnertab & ""
                sSQL = sSQL & " on AN" & srechnertab & ".artnr = AN_LASTZU" & srechnertab & ".artnr "
                sSQL = sSQL & " set AN" & srechnertab & ".lastdate = AN_LASTZU" & srechnertab & ".lastzu "
                gdBase.Execute sSQL, dbFailOnError

                sSQL = "Delete from AN" & srechnertab & " "
                sSQL = sSQL & " where artnr in(select artnr from VORSCHLZ)"
                gdBase.Execute sSQL, dbFailOnError
                
                CheckIndex "AN" & srechnertab, "bezeich", "", gdBase
                
                MSFlexGrid2_SelChange
                fraArtAnfuegen.Visible = True
                List2.Visible = False

                Me.Refresh
                
                Label6(5).Caption = "Artikel anfügen:"
                Label6(5).ForeColor = glS1
                
                Label9(0).Caption = Year(DateValue(Now)) - 1
                Label9(1).Caption = Year(DateValue(Now))
                
                Text6.Text = ""
                Text7.Text = ""
                Text8.Text = ""
                Text2.Text = ""
                List2.Clear
                
                beinschr = False
                
                If DatendrinWieviel("AN" & srechnertab, gdBase) > 2000 Then
                    Label6(1).Caption = "0"
                Else
                    Label6(1).Caption = "1"
                End If
                
                If Label6(1).Caption = "1" Then
                    cmdAnfuegen_Click 0
                End If
            Else
                fraArtAnfuegen.Visible = True
                
                If Label6(1).Caption = "1" Then
                
                    For lcount = 0 To List1.ListCount - 1
                        List2.AddItem List1.list(lcount)
                    Next lcount
'                    List2.list = List1.list
                Else
                    List2.Clear
                End If
                
                List2.Visible = True
                
                If List2.ListCount = 0 Then
                    Label6(5).ForeColor = vbRed
                Else
                    Label6(5).ForeColor = glS1
                End If
                Label6(5).Caption = List2.ListCount & " Artikel"
                Label6(5).Refresh
                
                Text6.Text = ""
                Text7.Text = ""
                Text8.Text = ""
                Text2.Text = ""
                
                Select Case sMerke_Focus
                    Case "Text8"
                        Text8.SetFocus
                    Case "Text2"
                        Text2.SetFocus
                    Case "Text6"
                        Text6.SetFocus
                    Case "Text7"
                        Text7.SetFocus
                End Select
            End If
        Case Is = 10    'Grafik ein/aus
            zeigetabinrichtigerGrößean1
            zeigetabinrichtigerGrößean2
            voreinstellungspeichernE43B
        Case Is = 11
            If Text10.Text <> "" Then
                zeige_Grid3
            Else
                zeige_Grid False, True, False
            End If
        Case 12
        
            Dim ctemp As String
        
            ctemp = "Möchten Sie Artikel mit gleichen Einkaufspreisen eines bestimmten Lieferanten aus diesem Bestellvorschlag entfernen?" & vbCrLf & vbCrLf
            ctemp = ctemp & "So geben Sie bitte die Vergleichslieferantennummer ein!"
        
            Dim cVergleichLinr As String
        
            cVergleichLinr = InputBox(ctemp, "Winkiss Frage:")
            
            
            
            
            iRet = MsgBox("Erst die Artikel einsehen?", vbQuestion + vbYesNo, "Winkiss Frage:")
            If iRet = vbYes Then
                Gleiche_Artikel_drucken Val(cVergleichLinr)
                Screen.MousePointer = 0
                Exit Sub
            End If
            
            
            
            
            
        
            If Val(cVergleichLinr) > 0 Then
            
                sSQL = "Alter Table vorschlz add LEKVERGL double "
                gdApp.Execute sSQL, dbFailOnError
                
                sSQL = "update vorschlz set vorschlz.LEKVERGL = 0 "
                gdApp.Execute sSQL, dbFailOnError
                
                cZiel = gcPfad
                If Right$(cZiel, 1) <> "\" Then
                    cZiel = cZiel & "\"
                End If
                
                loeschNEW "artliefli", gdBase
                
                sSQL = "Select * into artliefli from artlief  where artlief.linr = " & cVergleichLinr
                gdBase.Execute sSQL, dbFailOnError
            
                loeschNEW "artliefli", gdApp
                TransferTab gdBase, cZiel & "Kissapp.mdb", "artliefli"
                
                sSQL = "update vorschlz inner join artliefli on vorschlz.artnr = artliefli.artnr   "
                sSQL = sSQL & " set vorschlz.LEKVERGL = artliefli.lekpr "
                gdApp.Execute sSQL, dbFailOnError
                
                
                
                sSQL = " Update vorschlz Set lekpr  = Round(lekpr,2)"
                gdApp.Execute sSQL, dbFailOnError
                
                sSQL = " Update vorschlz Set LEKVERGL  = Round(LEKVERGL,2)"
                gdApp.Execute sSQL, dbFailOnError
                
                sSQL = "Delete from vorschlz where LEKVERGL = lekpr "
                gdApp.Execute sSQL, dbFailOnError
                
                
                
                sSQL = "Alter Table vorschlz drop LEKVERGL "
                gdApp.Execute sSQL, dbFailOnError
                
                MSFlexGrid2.Clear
                zeige_Grid False
        
                lbl6(0).Caption = "1"
                lbl6(1).Caption = "2"
            
            End If
        
    End Select
    Screen.MousePointer = 0

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SSCommand2_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    Resume Next

End Sub
Private Sub Gleiche_Artikel_drucken(lLinr As Long)
    On Error GoTo LOKAL_ERROR
    
    If lLinr = 0 Then
        Exit Sub
    End If
    
    Dim sSQL As String
    Dim cZiel As String
    
    sSQL = "Alter Table vorschlz add LEKVERGL double "
    gdApp.Execute sSQL, dbFailOnError
                
    sSQL = "update vorschlz set vorschlz.LEKVERGL = 0 "
    gdApp.Execute sSQL, dbFailOnError
                
    cZiel = gcPfad
    If Right$(cZiel, 1) <> "\" Then
        cZiel = cZiel & "\"
    End If
    
    loeschNEW "artliefli", gdBase
    
    sSQL = "Select * into artliefli from artlief  where artlief.linr = " & lLinr
    gdBase.Execute sSQL, dbFailOnError
            
    loeschNEW "artliefli", gdApp
    TransferTab gdBase, cZiel & "Kissapp.mdb", "artliefli"
    
    sSQL = "update vorschlz inner join artliefli on vorschlz.artnr = artliefli.artnr   "
    sSQL = sSQL & " set vorschlz.LEKVERGL = artliefli.lekpr "
    gdApp.Execute sSQL, dbFailOnError
    
    
    
    sSQL = " Update vorschlz Set lekpr  = Round(lekpr,2)"
    gdApp.Execute sSQL, dbFailOnError
    
    sSQL = " Update vorschlz Set LEKVERGL  = Round(LEKVERGL,2)"
    gdApp.Execute sSQL, dbFailOnError
    
    
    
    
                
    loeschNEW "GLEICHELEK", gdApp
                
    sSQL = "select * into GLEICHELEK from vorschlz where LEKVERGL = lekpr "
    gdApp.Execute sSQL, dbFailOnError
                
                
                
    sSQL = "Alter Table vorschlz drop LEKVERGL "
    gdApp.Execute sSQL, dbFailOnError
    
    reportbildschirmApp "", "aWKL4h"
    
    

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Gleiche_Artikel_drucken"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub SucheInGrid()
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL        As String
    Dim llaeng      As Long
    Dim ctmp        As String
    Dim sArtnr      As String
    Dim rsArt       As Recordset
    Dim sBedingung  As String
    Dim i           As Integer
    Dim j           As Integer
    Dim lRows       As Long
    Dim bFound      As Boolean
    
    bFound = False
    
    ctmp = Trim$(Text9.Text)
    llaeng = Len(ctmp)
    
    If lbl1(3).Caption = "Artnr/EAN" Then
    
        If llaeng < 7 Then
            sArtnr = ctmp
        ElseIf llaeng >= 7 Then
            sBedingung = sBedingung & "where ean = '" & ctmp & "'"
            sBedingung = sBedingung & " or ean2 = '" & ctmp & "'"
            sBedingung = sBedingung & " or ean3 = '" & ctmp & "'"
            
            sSQL = "select * from artikel " & sBedingung
            Set rsArt = gdBase.OpenRecordset(sSQL)
                If Not rsArt.EOF Then
                    sArtnr = rsArt!artnr
                End If
            rsArt.Close: Set rsArt = Nothing
        End If
    
        If sArtnr = "" Then
            Text9.Text = ""
            Text9.SetFocus
        Else
     
            MSFlexGrid2.Redraw = False
            Text9.Text = ""
            lRows = MSFlexGrid2.Rows
            MSFlexGrid2.Row = 0
            
            For j = 0 To MSFlexGrid2.Cols - 1
                MSFlexGrid2.Col = j
                If MSFlexGrid2.Text = "ArtNr." Then
                
                    For i = 2 To lRows - 1
                        MSFlexGrid2.Row = i
                        MSFlexGrid2.Col = j
                        
                        If MSFlexGrid2.Text = sArtnr Then
                            
                            MSFlexGrid2.TopRow = i
                            MSFlexGrid2.Col = SpaltennummerBESTVOR
                            MSFlexGrid2.Row = i
                            MSFlexGrid2.SetFocus
                            bFound = True
                            Exit For
                        Else
                            MSFlexGrid2.TopRow = 1
                            MSFlexGrid2.Row = 1
                            Text9.Text = ""
                            Text9.SetFocus
                            bFound = False
                            
                        End If
                    Next i
                    
                    Exit For
                End If
            Next j
            MSFlexGrid2.Redraw = True
     
        End If
        
    ElseIf lbl1(3).Caption = "LibesNr" Then
    
    
        
    
        sSQL = "select a.Artnr from artikel a inner join artlief b on a.artnr = b.artnr"
        sSQL = sSQL & " where b.linr  = " & Command6.Caption
        sSQL = sSQL & " and b.libesnr  = '" & ctmp & "'"
        Set rsArt = gdBase.OpenRecordset(sSQL)
            If Not rsArt.EOF Then
                sArtnr = rsArt!artnr
            End If
        rsArt.Close: Set rsArt = Nothing
    
        If sArtnr = "" Then
            Text9.Text = ""
            Text9.SetFocus
        Else
        
            MSFlexGrid2.Redraw = False
            Text9.Text = ""
            lRows = MSFlexGrid2.Rows
            MSFlexGrid2.Row = 0
            
            For j = 0 To MSFlexGrid2.Cols - 1
                MSFlexGrid2.Col = j
                If MSFlexGrid2.Text = "ArtNr." Then
                
                    For i = 2 To lRows - 1
                        MSFlexGrid2.Row = i
                        MSFlexGrid2.Col = j
                        
                        If MSFlexGrid2.Text = sArtnr Then
                            
                            MSFlexGrid2.TopRow = i
                            MSFlexGrid2.Col = SpaltennummerBESTVOR
                            MSFlexGrid2.Row = i
                            MSFlexGrid2.SetFocus
                            bFound = True
                            Exit For
                        Else
                            MSFlexGrid2.TopRow = 1
                            MSFlexGrid2.Row = 1
                            Text9.Text = ""
                            Text9.SetFocus
                            bFound = False
                            
                        End If
                    Next i
                    
                    Exit For
                End If
            Next j
            MSFlexGrid2.Redraw = True
        
        End If
    End If
    
    If bFound = False Then
        anzeige "Rot", "Artikel wurde in diesem Bestellvorschlag nicht gefunden.", lbl7
        Text9.Text = ""
        Text9.SetFocus
        MSFlexGrid2.Col = 0
        MSFlexGrid2.Row = 0
    Else
        MSFlexGrid2_SelChange
    End If
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SucheInGrid"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub diagrammfuellenMod3(sArtnr As String, Jahrkl As Date)
    On Error GoTo LOKAL_ERROR
    
    Dim i               As Integer
    Dim j               As Integer
    Dim iTop            As Integer
    Dim myarr(0 To 23)  As Long
    Dim cSQL            As String
    Dim rsrs            As Recordset
    Dim iMax            As Integer
    Dim iBuffer         As Integer
    
    cSQL = "Select * from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Year(Jahrkl) - 1
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            myarr(rsrs!Monat - 1) = rsrs!ANZAHL
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    cSQL = "Select * from UMS_ART  where ARTNR = " & sArtnr
    cSQL = cSQL & " and Jahr = " & Year(Jahrkl)
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            myarr(rsrs!Monat - 1 + 12) = rsrs!ANZAHL
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    Set rsrs = Nothing
        
    iBuffer = 0
    iMax = 0
    
    For i = 0 To 23
        iBuffer = myarr(i)
        If iBuffer > iMax Then
            iMax = iBuffer
        End If
    Next i
    
        iMax = IIf(iMax = 0, 1, iMax)
    
    For i = 0 To 23
        Shape2(i).Top = gitop
        Shape2(i).Height = (1900 / iMax) * IIf(myarr(i) < 0, 0, myarr(i))
        Shape2(i).Top = gitop - ((1900 / iMax) * myarr(i))
        
        Label20(i).Top = Shape2(i).Top - 250
        Label20(i).Caption = myarr(i)
        Label20(i).Refresh
    Next i
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "diagrammfuellenMod3"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    Fehlermeldung1
End Sub
Private Sub Detaildatenermitteln2(cArtNr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp       As String
    Dim cSQL       As String
    Dim iMonat     As Integer
    Dim rsrs       As Recordset

    cSQL = "Select BESTAND,Bezeich,Notizen from Artikel where ARTNR = " & cArtNr
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        If Not IsNull(rsrs!BESTAND) Then
            ctmp = rsrs!BESTAND
        Else
            ctmp = "0"
        End If
        lbl6(33).Caption = ctmp
        
        If Not IsNull(rsrs!BEZEICH) Then
            ctmp = rsrs!BEZEICH
        Else
            ctmp = ""
        End If
        Label15.Caption = ctmp
        
        If Not IsNull(rsrs!NOTIZEN) Then
            ctmp = rsrs!NOTIZEN
        Else
            ctmp = ""
        End If
        Label3(3).Caption = ctmp
    End If
    rsrs.Close: Set rsrs = Nothing
    
    Label14.Caption = "ArtNr. : " & cArtNr
    
    Label3(3).Refresh
    Label14.Refresh
    Label15.Refresh
    lbl6(33).Refresh
    
    lbl6(36).Caption = vklj(cArtNr, "Anzahl")
    lbl6(37).Caption = vkvj(cArtNr, "Anzahl")
    lbl6(34).Caption = vkam(cArtNr, "Anzahl")
    lbl6(35).Caption = vkvm(cArtNr, "Anzahl")
    
    lbl6(36).Refresh
    lbl6(37).Refresh
    lbl6(35).Refresh
    lbl6(34).Refresh
     
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Detaildatenermitteln2"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    Fehlermeldung1
End Sub
Private Sub zeigetabinrichtigerGrößean1()
On Error GoTo LOKAL_ERROR

If SSCommand2(10).Caption = "Grafik Aus" Then
    SSCommand2(10).Caption = "Grafik Ein"
Else
    SSCommand2(10).Caption = "Grafik Aus"
End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "zeigetabinrichtigerGrößean1"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub zeigetabinrichtigerGrößean2()
On Error GoTo LOKAL_ERROR

Dim lrow As Long
Dim lcol As Long

lcol = MSFlexGrid2.Col
lrow = MSFlexGrid2.Row

If SSCommand2(10).Caption = "Grafik Aus" Then

    fra5.Visible = False
    With MSFlexGrid2
        If Screen.Height > 10000 Then
            .Height = .RowHeight(2) * 27
        Else
            .Height = .RowHeight(2) * 23
        End If
    End With

Else

    fra5.Visible = True
    MSFlexGrid2.Height = MSFlexGrid2.RowHeight(2) * 12
End If

MSFlexGrid2.Col = lcol
MSFlexGrid2.Row = lrow
MSFlexGrid2.TopRow = lrow


Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "zeigetabinrichtigerGrößean2"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Verbindungseinstellunglesen(ByRef sLifnr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    Dim rsrs As Recordset
    
    cSQL = "select * from lisrt where linr = " & sLifnr
    Set rsrs = gdBase.OpenRecordset(cSQL)
    
    If Not rsrs.EOF Then
    
        If Not IsNull(rsrs!Pass) Then
            sPass = rsrs!Pass
        Else
            sPass = ""
        End If
        
        If Not IsNull(rsrs!bUser) Then
            sUser = rsrs!bUser
        Else
            sUser = ""
        End If
        
        If Not IsNull(rsrs!adress) Then
            sadress = rsrs!adress
        Else
            sadress = ""
        End If
        
        If Not IsNull(rsrs!KennNr) Then
            sKenn = rsrs!KennNr
        Else
            sKenn = ""
        End If
        
        If Not IsNull(rsrs!Kundnr) Then
            sKund = rsrs!Kundnr
        Else
            sKund = ""
        End If
        
        If Not IsNull(rsrs!Format) Then
            sFormat = rsrs!Format
        Else
            sFormat = ""
        End If
        
        If Not IsNull(rsrs!GLN) Then
            sGLNEmpfänger = Trim(rsrs!GLN)
        Else
            sGLNEmpfänger = ""
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Verbindungseinstellunglesen"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub UebertragungPerEmail(cLinr As String, cverz As String, sAuftragsnummer As String, sAnzArt As String, _
sMess As String, sKund As String, gcStsatz As String, sadress As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cQuelle     As String
    Dim cZiel       As String
    Dim lfail       As Long
    Dim lRet        As Long
    Dim sEDIFormat  As String
    Dim ctmp        As String
    

    sEDIFormat = WhatIsXfromXtab(cLinr, "LINR", "LISRT", "Format")
        
    If sEDIFormat = "TABAK" Then
        TabakMail cverz
    ElseIf sEDIFormat = "EDICOTY" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 12
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
    
    ElseIf sEDIFormat = "EDIBIEDRO" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 26
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIPURAL" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 38
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
    
    ElseIf sEDIFormat = "EDICARNOT" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 42
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
    ElseIf sEDIFormat = "EDIBIOGARTEN" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        
        sKund = String$(6 - Len(sKund), "0") & sKund
        
        cZiel = cZiel & "\EDI\BE" & sKund & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 39
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
    ElseIf sEDIFormat = "EDILORE" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        'cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
         cZiel = cZiel & "\EDI\" & sKund & "_KISS_LOREAL_" & sAuftragsnummer & "_" & Format(DateValue(Now), "yyyyMMDD") & Format(TimeValue(Now), "hhmmss") & "_in_a.txt.in"
         
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 27
            frmWKL38.Show 1
            

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIBBI" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 28
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIINTERCO" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        EDIMail cZiel, sAuftragsnummer, sAnzArt, sMess, cLinr, sKund, sadress
        

        
    ElseIf sEDIFormat = "EDIREWE" Then
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        
        cZiel = cZiel & "\EDI\R" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 11
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIRINKLIN" Then
    
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        sKund = String$(6 - Len(sKund), "0") & sKund
        
        cZiel = cZiel & "\EDI\BE_FTP_" & sKund & ".001"

        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 45
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIBOER" Then
    
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        
        Dim sNeuDatName As String
        Dim sTime As String
        Dim sDate As String
        

        sTime = Format$(TimeValue(Now), "HHMMSS")
        sDate = Format$(DateValue(Now), "DDMMYYYY")
     
        
        
        sNeuDatName = "bestell_" & sDate & "_" & sTime & "_" & sKund & "_" & sAuftragsnummer & ".txt"
        
        cZiel = cZiel & "\EDI\" & sNeuDatName

        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 48
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIMENSON" Then
        
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        
        cZiel = cZiel & "\EDI\be00" & sKund & "_" & Format(DateValue(Now), "YYMMDD") & "_" & Format(TimeValue(Now), "HHMMSS") & ".txt"
        
'        cZiel = cZiel & "\EDI\" & sKund & sAuftragsnummer & ".txt"
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 47
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIBELA" Then
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Dim cDatname As String
        cDatname = ""
        
        Select Case Left(sKund, 2)
        
            Case Is = "81"
                cDatname = "TR-WIT-" & sKund
            Case Else
                cDatname = "TR-NMS-" & sKund
        End Select
        cDatname = cDatname & "-" & Format(DateValue(Now), "YYYY-MM-DD") & "-" & Format(TimeValue(Now), "HH-MM-SS") & "-0.MDE"
        
        cZiel = cZiel & "\EDI\" & cDatname
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 31
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
    ElseIf sEDIFormat = "EDILUENING" Then
                
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
        
        sKund = String$(6 - Len(sKund), "0") & sKund
    
        cDatname = "DEWASORDR+1+"
        cDatname = cDatname & sKund & "+"
        cDatname = cDatname & Format(DateValue(Now), "YYYYMMDD") & "+"
        cDatname = cDatname & Format(TimeValue(Now), "HHMMSS") & ".001"
        
        cZiel = cZiel & "\EDI\" & cDatname
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            giKissFtpMode = 34
            frmWKL38.Show 1

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Zentrale Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIBUDNI" Then
                
        'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        
        Dim sMailKundnr As String
        sMailKundnr = sKund
        
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
    
        sKund = String$(6 - Len(sKund), "0") & sKund
    
        cDatname = "BUDNIORDR+1+"
        cDatname = cDatname & sKund & "+"
        cDatname = cDatname & Format(DateValue(Now), "YYYYMMDD") & "+"
        cDatname = cDatname & Format(TimeValue(Now), "HHMMSS") & ".001"
        
        cZiel = cZiel & "\EDI\" & cDatname
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            Dim i As Integer
            
            gbBudni_Bestellung_erfolgreich = False
            
            Dim bmerke As Boolean
            bmerke = gbFTPautomatic
            gbFTPautomatic = True

            giKissFtpMode = 35
            frmWKL38.Show 1

            gbFTPautomatic = bmerke

            If gbBudni_Bestellung_erfolgreich = True Then

                ctmp = "Ihre Bestellung wurde an " & lbl2(3).Caption & " übertragen" & vbCrLf & vbCrLf
                ctmp = ctmp & "Bestellwert EK Netto: " & lbl2(1).Caption & vbCrLf
                ctmp = ctmp & "Artikelanzahl: " & lbl2(0).Caption & vbCrLf & vbCrLf
                ctmp = ctmp & "Drucken Sie sich bitte im Anschluss Ihre Bestellung aus! "
                ctmp = ctmp & "Die Bestellbestätigung sollten Sie innerhalb der nächsten 10 Minuten per Email erhalten." & vbCrLf & vbCrLf
                ctmp = ctmp & "Sollte dies nicht der Fall sein, rufen Sie bitte bei der Firma K.I.S.S. (0511/955910) an!"

                MsgBox ctmp, vbInformation + vbOKOnly, "Winkiss Hinweis:"

                Dim sFirmaBez As String
                sFirmaBez = ermFirmenBez
                Dim cBetreff As String
                Dim cMessagetext As String
                Dim sAttachment As String
                sAttachment = ""


                cBetreff = "Budni-Bestellung hochgeladen, KundNr: " & sMailKundnr


                cMessagetext = "Diese Bestellung wurde von der Firma: " & sFirmaBez & "(" & sMailKundnr & ")" & vbCrLf & vbCrLf
                cMessagetext = cMessagetext & "am: " & Format(DateValue(Now), "DD.MM.YYYY") & vbCrLf & vbCrLf
                cMessagetext = cMessagetext & "um: " & Format(TimeValue(Now), "HH:MM:SS") & vbCrLf & vbCrLf
                cMessagetext = cMessagetext & "auf den Budni-FTP-Server hochgeladen." & vbCrLf
                cMessagetext = cMessagetext & "Bestellwert EK Netto: " & lbl2(1).Caption & vbCrLf
                cMessagetext = cMessagetext & "Artikelanzahl: " & lbl2(0).Caption & vbCrLf

                cMessagetext = cMessagetext & "Die Bestellbestätigung von Budni sollten Sie innerhalb der nächsten 10 Minuten per Email erhalten." & vbCrLf & vbCrLf
                cMessagetext = cMessagetext & "Sollte dies nicht der Fall sein, rufen Sie bitte bei der Firma K.I.S.S. (0511/955910) an!"

                Dim cAbsenderEmail As String
                cAbsenderEmail = ermFirmenMail
                If cAbsenderEmail = "" Then cAbsenderEmail = "hotline@kisswws.de"



                schickeMailimHintergrundSSL sFirmaBez, cAbsenderEmail, cAbsenderEmail, "info@dronova.de" _
                , "bestsend@kisswws.de", gcSMTP_SERVER, gcSMTP_PORT, gcSMTP_USER, gcSMTP_PW, cBetreff, cMessagetext, sAttachment

            Else

                frmWKL209.Show 1
                SSCommand2(2).Enabled = False
            End If

            'alte Vorschläge löschen
            For i = 0 To 9
                If sVorschlaege(i) <> "" Then
                    loeschNEW sVorschlaege(i), gdApp
                End If
            Next i

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    ElseIf sEDIFormat = "EDIBHSG" Then
                
         'kopiere erst aus dem BESTSIC ins EDI Verzeichnis
        Dim sMailKundnr2 As String
        sMailKundnr2 = sKund
        
        cQuelle = gcDBPfad
        If Right$(cQuelle, 1) <> "\" Then
            cQuelle = cQuelle & "\"
        End If
        cQuelle = cQuelle & "BESTSIC\" & cLinr & "\" & cverz & "\EDI.TXT"
        cQuelle = ShortPath(cQuelle)
        
        cZiel = App.Path
        cZiel = ShortPath(cZiel)
        
        Kill cZiel & "\EDI\*.*"
    
        sKund = String$(6 - Len(sKund), "0") & sKund
    
        cDatname = "BUDNIORDR+1+"
        cDatname = cDatname & sKund & "+"
        cDatname = cDatname & Format(DateValue(Now), "YYYYMMDD") & "+"
        cDatname = cDatname & Format(TimeValue(Now), "HHMMSS") & ".txt"
        
        cZiel = cZiel & "\EDI\" & cDatname
        
        lRet = CopyFile(cQuelle, cZiel, lfail)

        If lRet <> 0 Then
            Dim j As Integer
            
            gbBudni_Bestellung_erfolgreich = False
            
            Dim bmerke2 As Boolean
            bmerke2 = gbFTPautomatic
            gbFTPautomatic = True

            giKissFtpMode = 35
            frmWKL38.Show 1

            gbFTPautomatic = bmerke2

            If gbBudni_Bestellung_erfolgreich = True Then

                ctmp = "Ihre Bestellung wurde an " & lbl2(3).Caption & " übertragen" & vbCrLf & vbCrLf
                ctmp = ctmp & "Bestellwert EK Netto: " & lbl2(1).Caption & vbCrLf
                ctmp = ctmp & "Artikelanzahl: " & lbl2(0).Caption & vbCrLf & vbCrLf
                ctmp = ctmp & "Drucken Sie sich bitte im Anschluss Ihre Bestellung aus! "
                ctmp = ctmp & "Die Bestellbestätigung sollten Sie innerhalb der nächsten 10 Minuten per Email erhalten." & vbCrLf & vbCrLf
                ctmp = ctmp & "Sollte dies nicht der Fall sein, rufen Sie bitte bei der Firma K.I.S.S. (0511/955910) an!"

                MsgBox ctmp, vbInformation + vbOKOnly, "Winkiss Hinweis:"

                Dim sFirmaBez2 As String
                sFirmaBez2 = ermFirmenBez
                Dim cBetreff2 As String
                Dim cMessagetext2 As String
                Dim sAttachment2 As String
                sAttachment2 = ""


                cBetreff2 = "Budni-Bestellung hochgeladen, KundNr: " & sMailKundnr2


                cMessagetext2 = "Diese Bestellung wurde von der Firma: " & sFirmaBez2 & "(" & sMailKundnr2 & ")" & vbCrLf & vbCrLf
                cMessagetext2 = cMessagetext2 & "am: " & Format(DateValue(Now), "DD.MM.YYYY") & vbCrLf & vbCrLf
                cMessagetext2 = cMessagetext2 & "um: " & Format(TimeValue(Now), "HH:MM:SS") & vbCrLf & vbCrLf
                cMessagetext2 = cMessagetext2 & "auf den Budni-FTP-Server hochgeladen." & vbCrLf
                cMessagetext2 = cMessagetext2 & "Bestellwert EK Netto: " & lbl2(1).Caption & vbCrLf
                cMessagetext2 = cMessagetext2 & "Artikelanzahl: " & lbl2(0).Caption & vbCrLf

                cMessagetext2 = cMessagetext2 & "Die Bestellbestätigung von Budni sollten Sie innerhalb der nächsten 10 Minuten per Email erhalten." & vbCrLf & vbCrLf
                cMessagetext2 = cMessagetext2 & "Sollte dies nicht der Fall sein, rufen Sie bitte bei der Firma K.I.S.S. (0511/955910) an!"

                Dim cAbsenderEmail2 As String
                cAbsenderEmail2 = ermFirmenMail
                If cAbsenderEmail2 = "" Then cAbsenderEmail2 = "hotline@kisswws.de"



                schickeMailimHintergrundSSL sFirmaBez2, cAbsenderEmail2, cAbsenderEmail2, "info@dronova.de" _
                , "bestsend@kisswws.de", gcSMTP_SERVER, gcSMTP_PORT, gcSMTP_USER, gcSMTP_PW, cBetreff2, cMessagetext2, sAttachment2

            Else

                frmWKL209.Show 1
                SSCommand2(2).Enabled = False
            End If

            'alte Vorschläge löschen
            For j = 0 To 9
                If sVorschlaege(j) <> "" Then
                    loeschNEW sVorschlaege(j), gdApp
                End If
            Next j

        Else
            MsgBox "Die Bestelldatei konnte nicht kopiert werden.", vbCritical, "Winkiss Hinweis:"
        End If
        
    Else
        StandardMail cverz
    End If

    
    Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "UebertragungPerEmail"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
    End If
End Sub
Private Sub EDIMail(cOrdner As String, sAuftragsnummer As String, sAnzArt As String, sMess As String, cLinr As String, sKund As String, sadress As String)
    On Error GoTo LOKAL_ERROR
    
'    Dim cPfad   As String
'
'    cPfad = gcDBPfad    'Datenbankpfad
'    If Right$(cPfad, 1) <> "\" Then
'        cPfad = cPfad & "\"
'    End If
'
'    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & cOrdner & "\"
'    cPfad = ShortPath(cPfad)
    
    gcBestellEmail.SenderName = ermFirmenBez
    gcBestellEmail.ReplyTo = ermFirmenMail
    gcBestellEmail.SenderEMail = "bestsend@kisswws.de"
    
    gbCCfromBestlief = True
    If gbCCfromBestlief = True Then
        gcBestellEmail.CC = ermFirmenMail
    End If
    
    gcBestellEmail.Recipient = sadress
    gcBestellEmail.SMTPAUTH = True
    
    gcBestellEmail.ServerName = gcSMTP_SERVER
    gcBestellEmail.ServerPort = gcSMTP_PORT
    gcBestellEmail.Username = gcSMTP_USER
    gcBestellEmail.Password = gcSMTP_PW
    gcBestellEmail.SSL = gbSMTP_SSL
    
'    gcBestellEmail.ServerName = "smtp.strato.de"
'    gcBestellEmail.ServerPort = 25
'    gcBestellEmail.Username = "bestsend@kisswws.de"
'    gcBestellEmail.Password = "geheim"
    
    gcBestellEmail.Subject = "Bestellung KdNr: " & sKund
    
    
    gcBestellEmail.Message = "Sehr geehrte Damen und Herren," & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "hiermit übermitteln wir Ihnen unsere Bestellung." & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "unsere Kundennummer:         " & sKund & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Auftragsnummer:              " & sAuftragsnummer & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Anzahl bestellter Artikel:   " & sAnzArt & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    
    gcBestellEmail.Message = gcBestellEmail.Message & sMess

    
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Mit freundlichen Grüßen" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("Name") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("Name") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("STRASSE") & ", " & ermvonFirma("PLZ") & " " & ermvonFirma("ort") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Telefon: " & ermvonFirma("tel") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Telefax: " & ermvonFirma("fax") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Email  : " & ermvonFirma("email") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Ust-ID : " & ermvonFirma("steuernr") & vbCrLf
    
    gcBestellEmail.AutoZIP = False
    gcBestellEmail.Attachment1 = ""
    gcBestellEmail.Attachment2 = ""
    gcBestellEmail.Attachment3 = ""
    gcBestellEmail.Attachment4 = ""
    
    gcBestellEmail.Attachment1 = cOrdner 'cPfad & "edi.txt"
    
    
    'Ab hier an frmwkl38 übergeben

    giKissFtpMode = 19 ' BestellEmail verschicken
    frmWKL38.Show 1
    
    Pause (1)
    
    Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "mdlBestell"
    Fehler.gsFunktion = "EDIMail"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
''''Private Sub ParMail(cOrdner As String)
''''    On Error GoTo LOKAL_ERROR
''''
''''    Dim cPfad   As String
'''''    Dim cFirmenbez As String
''''
''''
''''    cPfad = gcDBPfad    'Datenbankpfad
''''    If Right$(cPfad, 1) <> "\" Then
''''        cPfad = cPfad & "\"
''''    End If
''''
''''    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & cOrdner & "\"
''''    cPfad = ShortPath(cPfad)
''''
''''    gcBestellEmail.SenderName = ermFirmenBez
''''    gcBestellEmail.ReplyTo = ermFirmenMail
''''    gcBestellEmail.SenderEMail = "bestsend@kisswws.de"
''''
''''    gbCCfromBestlief = True
''''    If gbCCfromBestlief = True Then
''''        gcBestellEmail.CC = ermFirmenMail
''''    End If
''''
''''    gcBestellEmail.Recipient = sadress
''''    gcBestellEmail.SMTPAUTH = True
''''    gcBestellEmail.ServerName = "smtp.strato.de"
''''    gcBestellEmail.ServerPort = 25
''''    gcBestellEmail.Username = "bestsend@kisswws.de"
''''    gcBestellEmail.Password = "geheim"
''''
''''    gcBestellEmail.Subject = "Bestellung KdNr: " & sKund & " KISS"
''''
''''    gcBestellEmail.Message = "Kundennummer=" & sKund & vbCrLf
''''    gcBestellEmail.Message = gcBestellEmail.Message & "eMail=" & ermFirmenMail & vbCrLf
''''    gcBestellEmail.Message = gcBestellEmail.Message & "BestNummer=" & Text12.Text & vbCrLf
''''    gcBestellEmail.Message = gcBestellEmail.Message & "Positionen=" & lbl2(0).Caption & vbCrLf
''''    gcBestellEmail.Message = gcBestellEmail.Message & "Anlagen:" & vbCrLf
''''    gcBestellEmail.Message = gcBestellEmail.Message & "senden.d" & vbCrLf
''''    gcBestellEmail.Message = gcBestellEmail.Message & "userinfo.x" & vbCrLf
''''
''''    gcBestellEmail.AutoZIP = False
''''    gcBestellEmail.Attachment1 = ""
''''    gcBestellEmail.Attachment2 = ""
''''    gcBestellEmail.Attachment3 = ""
''''    gcBestellEmail.Attachment4 = ""
''''    gcBestellEmail.Attachment5 = ""
''''    gcBestellEmail.Attachment1 = cPfad & "senden.d"
''''    gcBestellEmail.Attachment2 = cPfad & "userinfo.x"
''''
''''    'Ab hier an frmwkl38 übergeben
''''
''''    giKissFtpMode = 19 ' BestellEmail verschicken
''''    frmWKL38.Show 1
''''
''''    Pause (1)
''''
''''    Exit Sub
''''LOKAL_ERROR:
''''
''''    Fehler.gsDescr = err.Description
''''    Fehler.gsNumber = err.Number
''''    Fehler.gsFormular = Me.name
''''    Fehler.gsFunktion = "ParMail"
''''    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
''''
''''    Fehlermeldung1
''''
''''End Sub
'''Private Sub EsuMail(cOrdner As String)
'''    On Error GoTo LOKAL_ERROR
'''
'''    Dim cPfad   As String
'''
'''    cPfad = gcDBPfad    'Datenbankpfad
'''    If Right$(cPfad, 1) <> "\" Then
'''        cPfad = cPfad & "\"
'''    End If
'''
'''    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & cOrdner & "\"
'''    cPfad = ShortPath(cPfad)
'''
'''    gcBestellEmail.SenderName = ermFirmenBez
'''    gcBestellEmail.ReplyTo = ermFirmenMail
'''    gcBestellEmail.SenderEMail = "bestsend@kisswws.de"
'''
'''    gbCCfromBestlief = True
'''    If gbCCfromBestlief = True Then
'''        gcBestellEmail.CC = ermFirmenMail
'''    End If
'''
'''    gcBestellEmail.Recipient = sadress
'''    gcBestellEmail.SMTPAUTH = True
'''    gcBestellEmail.ServerName = "smtp.strato.de"
'''    gcBestellEmail.ServerPort = 25
'''    gcBestellEmail.Username = "bestsend@kisswws.de"
'''    gcBestellEmail.Password = "geheim"
'''
'''    gcBestellEmail.Subject = "Bestellung KdNr: " & sKund & " KISS"
'''    gcBestellEmail.Message = "Kundennummer=" & sKund & vbCrLf
'''    gcBestellEmail.Message = gcBestellEmail.Message & "eMail=" & ermFirmenMail & vbCrLf
'''    gcBestellEmail.Message = gcBestellEmail.Message & "BestNummer=" & Text12.Text & vbCrLf
'''    gcBestellEmail.Message = gcBestellEmail.Message & "Positionen=" & lbl2(0).Caption & vbCrLf
'''    gcBestellEmail.Message = gcBestellEmail.Message & "Anlagen:" & vbCrLf
'''    gcBestellEmail.Message = gcBestellEmail.Message & "senden.d" & vbCrLf
'''    gcBestellEmail.Message = gcBestellEmail.Message & "userinfo.x" & vbCrLf
'''
'''    gcBestellEmail.AutoZIP = False
'''    gcBestellEmail.Attachment1 = ""
'''    gcBestellEmail.Attachment2 = ""
'''    gcBestellEmail.Attachment3 = ""
'''    gcBestellEmail.Attachment4 = ""
'''    gcBestellEmail.Attachment5 = ""
'''    gcBestellEmail.Attachment1 = cPfad & "senden.d"
'''    gcBestellEmail.Attachment2 = cPfad & "userinfo.x"
'''
'''
'''    'Ab hier an frmwkl38 übergeben
'''
'''    giKissFtpMode = 19 ' BestellEmail verschicken
'''    frmWKL38.Show 1
'''
'''
'''    Pause (1)
'''
'''    Exit Sub
'''LOKAL_ERROR:
'''
'''    Fehler.gsDescr = err.Description
'''    Fehler.gsNumber = err.Number
'''    Fehler.gsFormular = Me.name
'''    Fehler.gsFunktion = "EsuMail"
'''    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
'''
'''    Fehlermeldung1
'''
'''End Sub

Private Sub TabakMail(cOrdner As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cPfad   As String
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & cOrdner & "\"
    cPfad = ShortPath(cPfad)
    
    gcBestellEmail.SenderName = ermFirmenBez
    gcBestellEmail.ReplyTo = ermFirmenMail
    gcBestellEmail.SenderEMail = "bestsend@kisswws.de"
    
    gbCCfromBestlief = True
    If gbCCfromBestlief = True Then
        gcBestellEmail.CC = ermFirmenMail
    End If
    
    gcBestellEmail.Recipient = sadress
    gcBestellEmail.SMTPAUTH = True
    
    gcBestellEmail.ServerName = gcSMTP_SERVER
    gcBestellEmail.ServerPort = gcSMTP_PORT
    gcBestellEmail.Username = gcSMTP_USER
    gcBestellEmail.Password = gcSMTP_PW
    gcBestellEmail.SSL = gbSMTP_SSL
    
    
'    gcBestellEmail.ServerName = "smtp.strato.de"
'    gcBestellEmail.ServerPort = 25
'    gcBestellEmail.Username = "bestsend@kisswws.de"
'    gcBestellEmail.Password = "geheim"
    
    gcBestellEmail.Subject = "Bestellung"
    
    gcBestellEmail.Message = "Sehr geehrte Damen und Herren," & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "hiermit übermitteln wir Ihnen unsere Bestellung." & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "unsere Kundennummer:         " & sKenn & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Auftragsnummer:              " & Right(Text12.Text, 4) & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Anzahl bestellter Artikel:   " & lbl2(0).Caption & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Mit freundlichen Grüßen" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("Name") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Anlagen:" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "bestell.txt" & vbCrLf

    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("Name") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("STRASSE") & ", " & ermvonFirma("PLZ") & " " & ermvonFirma("ort") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Telefon: " & ermvonFirma("tel") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Telefax: " & ermvonFirma("fax") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Email  : " & ermvonFirma("email") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Ust-ID : " & ermvonFirma("steuernr") & vbCrLf
    
    

    gcBestellEmail.AutoZIP = False
    gcBestellEmail.Attachment1 = ""
    gcBestellEmail.Attachment2 = ""
    gcBestellEmail.Attachment3 = ""
    gcBestellEmail.Attachment4 = ""
    gcBestellEmail.Attachment5 = ""
    gcBestellEmail.Attachment1 = cPfad & "bestell.txt"
    
    'Ab hier an frmwkl38 übergeben

    giKissFtpMode = 19 ' BestellEmail verschicken
    frmWKL38.Show 1

    Pause (1)
    
    Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "TabakMail"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Function ermMailText(cLinr As String) As String
On Error GoTo LOKAL_ERROR

    Dim cSQL As String
    Dim rsrs As Recordset
    ermMailText = ""
    
    cSQL = "Select MAILTEXT from LISRT_MAIL where linr = " & cLinr
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!MAILTEXT) Then
            ermMailText = rsrs!MAILTEXT
        End If
    End If
    rsrs.Close: Set rsrs = Nothing
                
Exit Function
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermMailText"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Function
Private Sub StandardMail(cOrdner As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cPfad   As String
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & cOrdner & "\"
    cPfad = ShortPath(cPfad)
    
    Dim sFirmenMail As String
    sFirmenMail = ermFirmenMail
    
    Dim sMailtext As String
    sMailtext = ermMailText(cLinr)
    
    gcBestellEmail.SenderName = ermFirmenBez
    
    If sFirmenMail <> "" Then
        gcBestellEmail.ReplyTo = sFirmenMail
        gcBestellEmail.SenderEMail = sFirmenMail
    Else
        gcBestellEmail.SenderEMail = "bestsend@kisswws.de"
    End If
    
    gbCCfromBestlief = True
    If gbCCfromBestlief = True Then
        If sFirmenMail <> "" Then
            gcBestellEmail.CC = sFirmenMail
        End If
    End If
    
    
    Dim sTime As String
    Dim sDate As String
    Dim sAuftragsnr As String
    Dim sNeuDatName As String
    Dim sNeuDatNameCSV As String
    Dim sNeuDatNameDoc As String
    Dim lfail As Long
    Dim lRet As Long

    sTime = Format$(TimeValue(Now), "HHMMSS")
    sDate = Format$(DateValue(Now), "DDMMYYYY")
     
    sAuftragsnr = Text12.Text
    sNeuDatName = "bestell_" & sDate & "_" & sTime & "_" & sKund & "_" & sAuftragsnr & ".txt"
    sNeuDatNameCSV = "bestell_" & sDate & "_" & sTime & "_" & sKund & "_" & sAuftragsnr & ".csv"
    sNeuDatNameDoc = "Bestellung_" & sDate & "_" & sTime & "_" & sKund & "_" & sAuftragsnr & ".doc"
    
    
    
    gcBestellEmail.Recipient = sadress
    gcBestellEmail.SMTPAUTH = True
    
    gcBestellEmail.ServerName = gcSMTP_SERVER
    gcBestellEmail.ServerPort = gcSMTP_PORT
    gcBestellEmail.Username = gcSMTP_USER
    gcBestellEmail.Password = gcSMTP_PW
    gcBestellEmail.SSL = gbSMTP_SSL
    
    
    gcBestellEmail.Subject = "Bestellung (" & lbl2(3).Caption & ") KdNr: " & sKund & " (" & ermvonFirma("Name") & ")"
    
    gcBestellEmail.Message = "Sehr geehrte Damen und Herren," & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "hiermit übermitteln wir Ihnen unsere Bestellung." & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "unsere Kundennummer:         " & sKund & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Auftragsnummer:              " & sAuftragsnr & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Anzahl bestellter Artikel:   " & lbl2(0).Caption & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Auftragswert (EK):           " & lbl2(1).Caption & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    
    gcBestellEmail.Message = gcBestellEmail.Message & "Ihre ArtNr." & vbTab & "EAN" & vbTab & vbTab & vbTab & "Artikelbezeichnung" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Bestellmenge" & vbTab & vbTab & "NatRab" & vbTab & "Proben" & vbTab & "Tester" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & gcStsatz
    
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & txt2.Text
    
    If sMailtext <> "" Then
        gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
        gcBestellEmail.Message = gcBestellEmail.Message & sMailtext
        gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    End If

    
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Mit freundlichen Grüßen" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("Name") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Anlagen:" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf

    gcBestellEmail.Message = gcBestellEmail.Message & sNeuDatName & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & sNeuDatNameCSV & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "satzbe.txt" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "tabstopp.txt" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "satzbeII.txt" & vbCrLf
    
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & sNeuDatName & ":    dient der beleglosen Bestellabwicklung" & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & sNeuDatNameCSV & ": dient der beleglosen Bestellabwicklung" & vbCrLf
    

    gcBestellEmail.Message = gcBestellEmail.Message & "tabstopp.txt:   dient der beleglosen Bestellabwicklung" & vbCrLf
    
    gcBestellEmail.Message = gcBestellEmail.Message & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("Name") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & ermvonFirma("STRASSE") & ", " & ermvonFirma("PLZ") & " " & ermvonFirma("ort") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Telefon: " & ermvonFirma("tel") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Telefax: " & ermvonFirma("fax") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Email  : " & ermvonFirma("email") & vbCrLf
    gcBestellEmail.Message = gcBestellEmail.Message & "Ust-ID : " & ermvonFirma("steuernr") & vbCrLf
    
    
    gcBestellEmail.AutoZIP = False
    gcBestellEmail.Attachment1 = ""
    gcBestellEmail.Attachment2 = ""
    gcBestellEmail.Attachment3 = ""
    gcBestellEmail.Attachment4 = ""
    gcBestellEmail.Attachment5 = ""
    gcBestellEmail.Attachment6 = ""
    

    If FileExists(cPfad & "bestell.txt") Then
        Kill cPfad & sNeuDatName

        lRet = CopyFile(cPfad & "bestell.txt", cPfad & sNeuDatName, lfail)

        If lRet <> 0 Then
            gcBestellEmail.Attachment1 = cPfad & sNeuDatName
            Kill cPfad & "bestell.txt"
        End If
        
        Kill cPfad & sNeuDatNameCSV

        lRet = CopyFile(cPfad & "tabstopp.txt", cPfad & sNeuDatNameCSV, lfail)

        If lRet <> 0 Then
            gcBestellEmail.Attachment6 = cPfad & sNeuDatNameCSV
'            Kill cPfad & "bestell.txt"
        End If

    End If
    


    
    gcBestellEmail.Attachment3 = cPfad & "satzbe.txt"
    gcBestellEmail.Attachment4 = cPfad & "tabstopp.txt"
    gcBestellEmail.Attachment5 = cPfad & "satzbeII.txt"
    
   
    
    
    'Ab hier an frmwkl38 übergeben

    giKissFtpMode = 19 ' BestellEmail verschicken
    frmWKL38.Show 1

    Pause (1)
    
    Exit Sub
LOKAL_ERROR:

    If err.Number = 53 Then
        Resume Next
    Else
        
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "StandardMail"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
    End If
    
End Sub
Private Function BestDateiinOrdner(cLinr As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
    On Error GoTo LOKAL_ERROR
    
    Dim cPfad       As String
    Dim sEDIFormat  As String
    Dim sKUNDNR     As String
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    BestDateiinOrdner = ""
    
    VerzVorhanden cLinr, cPfad & "BESTSIC\"
    
    sEDIFormat = WhatIsXfromXtab(cLinr, "LINR", "LISRT", "Format")
    Select Case UCase(sEDIFormat)
        Case "EDICOTY"
            BestDateiinOrdner = EDIFormatCoty(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger)
        Case "EDIINTERCO"
            BestDateiinOrdner = EDIFormatINTERCO(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger)
        Case "EDIBIEDRO"
            BestDateiinOrdner = EDIFormatBIEDRO(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger)
        Case "EDIPURAL"
            BestDateiinOrdner = EDIFormatPURAL(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger)
        Case "EDIBOER"
            sKUNDNR = WhatIsXfromXtab(cLinr, "LINR", "LISRT", "Kundnr")
            BestDateiinOrdner = EDIFormatBOER(cLinr, sKUNDNR, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDIMENSON"
            BestDateiinOrdner = EDIFormatMENSON(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDICARNOT"
            BestDateiinOrdner = EDIFormatCarnot(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger)
        Case "EDIBIOGARTEN"
            BestDateiinOrdner = EDIFormatBIOGARTEN(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger)
        Case "EDIBUDNI"
            BestDateiinOrdner = EDIFormatBUDNI(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
         Case "EDIBHSG"
            BestDateiinOrdner = EDIFormatBHSG(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDILORE"
            BestDateiinOrdner = EDIFormatLore(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDIBBI"
            BestDateiinOrdner = EDIFormatBBI(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDIREWE"
            BestDateiinOrdner = EDIFormatREWE(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDIBELA"
            BestDateiinOrdner = EDIFormatBELA(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDIRINKLIN"
            BestDateiinOrdner = EDIFormatRINKLIN(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "EDILUENING"
            BestDateiinOrdner = EDIFormatLUENING(cLinr, Text12.Text, lbl2(1).Caption, sILN1, sILN2, sGLNEmpfänger, Text13.Text)
        Case "TABAK"
            BestDateiinOrdner = TabakFormat(cLinr)
        Case ""
            sKUNDNR = WhatIsXfromXtab(cLinr, "LINR", "LISRT", "Kundnr")
            BestDateiinOrdner = StandardFormat(cLinr, Text12.Text, sKUNDNR)
    End Select

    
    Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BestDateiinOrdner"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Function
Private Function EDIFormatCoty(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    
    lanzseg = 0
    lcount = 0
    EDIFormatCoty = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatCoty = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
'    cSatz = cSatz & "UNB+UNOC:3+" & sILN1 & ":14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++++++1'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig Testkennung
'    cSatz = cSatz & "UNB+UNOC:3+" & sILN1 & ":14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNB+UNOC:3+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNH+123+ORDERS:D:01B:UN:EAN010'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+BY+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":SRV'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & Trim(MSFlexGrid2.Text) & ":IN'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "IMD+C++CU::9'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & ":PCE'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg & "+123'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatCoty"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatBBI(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, _
sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    
    lanzseg = 0
    lcount = 0
    EDIFormatBBI = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatBBI = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
'    cSatz = cSatz & "UNB+UNOC:3+" & sILN1 & ":14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++++++1'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig Testkennung
'    cSatz = cSatz & "UNB+UNOC:3+" & sILN1 & ":14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNB+UNOC:3+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNH+123+ORDERS:D:01B:UN:EAN010'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "RFF+PD:" & sPromotionDealNumber & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+BY+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":SRV'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & Trim(MSFlexGrid2.Text) & ":IN'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "IMD+C++CU::9'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & ":PCE'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg & "+123'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatBBI"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatPROCTER(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, _
sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    
    lanzseg = 0
    lcount = 0
    EDIFormatPROCTER = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatPROCTER = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
'    cSatz = cSatz & "UNB+UNOC:3+" & sILN1 & ":14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++++++1'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig Testkennung
'    cSatz = cSatz & "UNB+UNOC:3+" & sILN1 & ":14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNB+UNOC:3+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNH+123+ORDERS:D:01B:UN:EAN010'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "RFF+PD:" & sPromotionDealNumber & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+BY+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":SRV'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & Trim(MSFlexGrid2.Text) & ":IN'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "IMD+C++CU::9'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & ":PCE'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg & "+123'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatPROCTER"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatLore(cLinr As String, sBelegnr As String, sRechbetrag As String _
, sILN1 As String, sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    
    lanzseg = 0
    lcount = 0
    EDIFormatLore = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatLore = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf: lanzseg = lanzseg + 1 'Fertig

    cSatz = cSatz & "UNB+UNOC:3+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNH+123+ORDERS:D:01B:UN:EAN010'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & Format(TimeValue(Now), "HHMMSS") & ":204'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "RFF+PD:" & sPromotionDealNumber & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+BY+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":SRV'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & Trim(MSFlexGrid2.Text) & ":IN'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "IMD+C++CU::9'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & ":PCE'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf
    cSatz = cSatz & "UNT+" & lanzseg & "+123'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatLore"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
        Fehlermeldung1
    End If
End Function
''Private Function XMLWAGNERFormat(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
''    On Error GoTo LOKAL_ERROR
''
''    Dim lrow            As Long
''    Dim lPos            As Long
''    Dim lWert           As Long
''    Dim cSatz           As String
''    Dim cSQL            As String
''    Dim cBestMenge      As String
''    Dim cEAN            As String
''    Dim cKVkPr1         As String
''    Dim cBezeich        As String
''    Dim cLiBesNr        As String
''    Dim cPfad           As String
''    Dim iFileNr         As Integer
''    Dim rsrs            As Recordset
''    Dim sTime           As String
''    Dim ctmp            As String
''    Dim lcount          As Long
''    Dim lanzseg         As Long
''
''    lanzseg = 0
''    lcount = 0
''    XMLWAGNERFormat = ""
''
''    sTime = TimeValue(Now)
''    sTime = Right(sTime, 8)
''    sTime = Left(sTime, 5)
''
''    lWert = DateValue(Now)
''    ctmp = Format$(lWert, "DD.MM")
''
''    ctmp = ctmp & sTime
''    ctmp = SwapStr(ctmp, ".", "")
''    ctmp = SwapStr(ctmp, ":", "")
''
''    cPfad = gcDBPfad    'Datenbankpfad
''    If Right$(cPfad, 1) <> "\" Then
''        cPfad = cPfad & "\"
''    End If
''
''    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"
''
''    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"
''
''    XMLWAGNERFormat = ctmp
''
'''    Kill cPfad & "B" & Format(DateValue(Now), "YYYYMMDD") & "F" & gcFilNr & ".txt"
''    Kill cPfad & "EDI.txt"
''
''    iFileNr = FreeFile
''    Open cPfad & "EDI.txt" For Binary As #iFileNr
''
''    sRechbetrag = SwapStr(sRechbetrag, ".", "")
''    sRechbetrag = SwapStr(sRechbetrag, ",", ".")
''    sRechbetrag = SwapStr(sRechbetrag, " EUR", "")
''
''    cSatz = ""
''    cSatz = cSatz & "<?xml version=" & Chr(34) & "1.0" & Chr(34) & " encoding=" & Chr(34) & "ISO-8859-1" & Chr(34) & " ?>" & vbCrLf
''    cSatz = cSatz & "<tBestellungen>" & vbCrLf
''    cSatz = cSatz & "<tBestellung kFirma=" & Chr(34) & "1" & Chr(34) & " cFirma=" & Chr(34) & "Haarmarkt Oliver Wagner GmbH Co. KG" & Chr(34) & " cMandant=" & Chr(34) & "winkiss" & Chr(34) & " cRechnungsNr=" & Chr(34) & "" & Chr(34) & ">" & vbCrLf
''    cSatz = cSatz & "<cSprache>dan</cSprache>" & vbCrLf
''    cSatz = cSatz & "<cWaehrung>EUR</cWaehrung>" & vbCrLf
''    cSatz = cSatz & "<fGuthaben>0</fGuthaben>" & vbCrLf
''    cSatz = cSatz & "<fGesamtsumme>" & sRechbetrag & "</fGesamtsumme>" & vbCrLf
''    cSatz = cSatz & "<cBestellNr>KISS---" & sBelegnr & "</cBestellNr>" & vbCrLf
''    cSatz = cSatz & "<cExterneBestellNr>KISS---" & sBelegnr & "</cExterneBestellNr>" & vbCrLf
''    cSatz = cSatz & "<cVersandartName/>" & vbCrLf
''    cSatz = cSatz & "<cVersandInfo/>" & vbCrLf
''    cSatz = cSatz & "<dVersandDatum/>" & vbCrLf
''    cSatz = cSatz & "<cTracking/>" & vbCrLf
''    cSatz = cSatz & "<cLogistiker/>" & vbCrLf
''    cSatz = cSatz & "<dLieferDatum/>" & vbCrLf
''    cSatz = cSatz & "<cKommentar/>" & vbCrLf
''    cSatz = cSatz & "<cBemerkung/>" & vbCrLf
''    cSatz = cSatz & "<dErstellt>" & Format(DateValue(Now), "YYYY-MM-DD") & "</dErstellt>" & vbCrLf
''    cSatz = cSatz & "<cZahlungsartName/>" & vbCrLf
''    cSatz = cSatz & "<dBezahltDatum/>" & vbCrLf
''    cSatz = cSatz & "<fBezahlt>0.00</fBezahlt>" & vbCrLf
''
''    lPos = LOF(iFileNr)
''    lPos = lPos + 1
''    Put #iFileNr, lPos, cSatz
''
''    For lrow = 1 To MSFlexGrid2.Rows - 1
''        MSFlexGrid2.Row = lrow
''        MSFlexGrid2.Col = SpaltennummerBESTVOR
''        cBestMenge = Trim(MSFlexGrid2.Text)
''
''        If Val(cBestMenge) > 0 Then
''            lcount = lcount + 1
''
''            MSFlexGrid2.Col = SpaltennummerArtnr
''
''            cLiBesNr = ""
''
''            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
''            Set rsrs = gdBase.OpenRecordset(cSQL)
''            If Not rsrs.EOF Then
''                rsrs.MoveFirst
''                If Not IsNull(rsrs!LIBESNR) Then
''                    cLiBesNr = Trim(rsrs!LIBESNR)
''                End If
''            End If
''            rsrs.Close
''
''            cEAN = ""
''            cBezeich = ""
''            cKVkPr1 = ""
''            cSQL = "Select BEZEICH,EAN,KVkPr1 from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
''            Set rsrs = gdBase.OpenRecordset(cSQL)
''            If Not rsrs.EOF Then
''                rsrs.MoveFirst
''                If Not IsNull(rsrs!EAN) Then
''                    cEAN = Trim(rsrs!EAN)
''                End If
''
''                If Not IsNull(rsrs!BEZEICH) Then
''                    cBezeich = Trim(rsrs!BEZEICH)
''                End If
''
''                If Not IsNull(rsrs!KVKPR1) Then
''                    cKVkPr1 = Trim(rsrs!KVKPR1)
''                End If
''            End If
''            rsrs.Close
''
''            cKVkPr1 = SwapStr(cKVkPr1, ",", ".")
''
''            cSatz = ""
''            cSatz = cSatz & "<twarenkorbpos>" & vbCrLf
''            cSatz = cSatz & "<cName>" & cBezeich & "</cName>" & vbCrLf
''            cSatz = cSatz & "<cArtNr>" & cLiBesNr & "</cArtNr>" & vbCrLf
''            cSatz = cSatz & "<cBarcode>" & cEAN & "</cBarcode>" & vbCrLf
''            cSatz = cSatz & "<cSeriennummer/>" & vbCrLf
''            cSatz = cSatz & "<cEinheit/>" & vbCrLf
''            cSatz = cSatz & "<fPreisEinzelNetto/>" & vbCrLf
''            cSatz = cSatz & "<fPreis>" & cKVkPr1 & "</fPreis>" & vbCrLf
''            cSatz = cSatz & "<fMwSt>19.00</fMwSt>" & vbCrLf
''            cSatz = cSatz & "<fAnzahl>" & cBestMenge & "</fAnzahl>" & vbCrLf
''            cSatz = cSatz & "<fRabatt>0.00</fRabatt>" & vbCrLf
''            cSatz = cSatz & "<cPosTyp>standard</cPosTyp>" & vbCrLf
''            cSatz = cSatz & "</twarenkorbpos>" & vbCrLf
''
''            lPos = LOF(iFileNr)
''            lPos = lPos + 1
''            Put #iFileNr, lPos, cSatz
''        End If
''    Next lrow
''
''    cSatz = ""
''    cSatz = cSatz & "<tkunde>" & vbCrLf
''    cSatz = cSatz & "<cKundenNr>" & gcFilNr & "</cKundenNr>" & vbCrLf
''    cSatz = cSatz & "<cAnrede>Fa.</cAnrede>" & vbCrLf
''    cSatz = cSatz & "<cTitel/>" & vbCrLf
''    cSatz = cSatz & "<cVorname>Haarmarkt Oliver Wagner</cVorname>" & vbCrLf
''    cSatz = cSatz & "<cNachname>GmbH &amp; Co KG</cNachname>" & vbCrLf
''    cSatz = cSatz & "<cFirma/>" & vbCrLf
''    cSatz = cSatz & "<cStrasse>" & gFirma.strasse & "</cStrasse>" & vbCrLf
''    cSatz = cSatz & "<cAdressZusatz/>" & vbCrLf
''    cSatz = cSatz & "<cPLZ>" & gFirma.Plz & "</cPLZ>" & vbCrLf
''    cSatz = cSatz & "<cOrt>" & gFirma.Ort & "</cOrt>" & vbCrLf
''    cSatz = cSatz & "<cBundesland/>" & vbCrLf
''    cSatz = cSatz & "<cLand>Deutschland</cLand>" & vbCrLf
''    cSatz = cSatz & "<cTel/>" & vbCrLf
''    cSatz = cSatz & "<cMobil/>" & vbCrLf
''    cSatz = cSatz & "<cFax/>" & vbCrLf
''    cSatz = cSatz & "<cMail>info@haarmarkt-wagner.de</cMail>" & vbCrLf
''    cSatz = cSatz & "<cUSTID/>" & vbCrLf
''    cSatz = cSatz & "<cWWW/>" & vbCrLf
''    cSatz = cSatz & "<cNewsletter/>" & vbCrLf
''    cSatz = cSatz & "<dGeburtstag/>" & vbCrLf
''    cSatz = cSatz & "<fRabatt/>" & vbCrLf
''    cSatz = cSatz & "<cHerkunft>WINKISS</cHerkunft>" & vbCrLf
''    cSatz = cSatz & "<dErstellt>" & Format(DateValue(Now), "YYYY-MM-DD") & "</dErstellt>" & vbCrLf
''    cSatz = cSatz & "</tkunde>" & vbCrLf
''    cSatz = cSatz & "<tlieferadresse>" & vbCrLf
''    cSatz = cSatz & "<cAnrede/>" & vbCrLf
''    cSatz = cSatz & "<cVorname>Haarmarkt Oliver Wagner</cVorname>" & vbCrLf
''    cSatz = cSatz & "<cNachname>GmbH &amp; Co KG</cNachname>" & vbCrLf
''    cSatz = cSatz & "<cTitel/>" & vbCrLf
''    cSatz = cSatz & "<cFirma/>" & vbCrLf
''    cSatz = cSatz & "<cStrasse>" & gFirma.strasse & "</cStrasse>" & vbCrLf
''    cSatz = cSatz & "<cAdressZusatz/>" & vbCrLf
''    cSatz = cSatz & "<cPLZ>" & gFirma.Plz & "</cPLZ>" & vbCrLf
''    cSatz = cSatz & "<cOrt>" & gFirma.Ort & "</cOrt>" & vbCrLf
''    cSatz = cSatz & "<cBundesland/>" & vbCrLf
''    cSatz = cSatz & "<cLand>Deutschland</cLand>" & vbCrLf
''    cSatz = cSatz & "<cTel/>" & vbCrLf
''    cSatz = cSatz & "<cMobil/>" & vbCrLf
''    cSatz = cSatz & "<cFax/>" & vbCrLf
''    cSatz = cSatz & "<cMail>info@haarmarkt-wagner.de</cMail>" & vbCrLf
''    cSatz = cSatz & "</tlieferadresse>" & vbCrLf
''    cSatz = cSatz & "<tzahlungsinfo>" & vbCrLf
''    cSatz = cSatz & "<cBankName/>" & vbCrLf
''    cSatz = cSatz & "<cBLZ/>" & vbCrLf
''    cSatz = cSatz & "<cKontoNr/>" & vbCrLf
''    cSatz = cSatz & "<cKartenNr/>" & vbCrLf
''    cSatz = cSatz & "<dGueltigkeit/>" & vbCrLf
''    cSatz = cSatz & "<cCVV/>" & vbCrLf
''    cSatz = cSatz & "<cKartenTyp/>" & vbCrLf
''    cSatz = cSatz & "<cInhaber/>" & vbCrLf
''    cSatz = cSatz & "</tzahlungsinfo>" & vbCrLf
''    cSatz = cSatz & "</tBestellung>" & vbCrLf
''    cSatz = cSatz & "</tBestellungen>" & vbCrLf
''
''    lPos = LOF(iFileNr)
''    lPos = lPos + 1
''    Put #iFileNr, lPos, cSatz
''
''    Close iFileNr
''
''Exit Function
''LOKAL_ERROR:
''    If err.Number = 53 Then
''        Resume Next
''    Else
''        Fehler.gsDescr = err.Description
''        Fehler.gsNumber = err.Number
''        Fehler.gsFormular = Me.name
''        Fehler.gsFunktion = "XMLWAGNERFormat"
''        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
''
''        Fehlermeldung1
''    End If
''End Function
Private Function EDIFormatREWE(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    Dim lBestmenge      As Long
    Dim cArtNr          As String
    Dim cVPE            As String
    Dim cVPEMENGEN      As String
    Dim cArtikeltext    As String
    Dim cMINMENinARTLIEF As String
    Dim cLiBesNrforPIAIN     As String

    
    lBestmenge = 0
    lanzseg = 0
    lcount = 0
    EDIFormatREWE = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatREWE = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
'    cSatz = cSatz & "UNB+UNOA:2+4327002000002:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++EANCOM" & "+1" & "'" & vbCrLf: lanzseg = lanzseg + 1 'mit Testkennung
    cSatz = cSatz & "UNB+UNOA:2+4327002000002:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++EANCOM" & "'" & vbCrLf: lanzseg = lanzseg + 1  'ohne Testkennung
    cSatz = cSatz & "UNH+123+ORDERS:D:96A:UN:EAN008'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "RFF+PD:" & sPromotionDealNumber & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+BY+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
    
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        MSFlexGrid2.Col = SpaltennummerMINMEN
        cVPE = Val(Trim(MSFlexGrid2.Text))
        
        MSFlexGrid2.Col = SpaltennummerBEZEICH
        cArtikeltext = Trim(MSFlexGrid2.Text)
        If cArtikeltext = "unbekannt" Then
            cArtikeltext = ""
        End If
        
        If Val(cBestMenge) > 0 Then
            If Val(cVPE) > 0 Then
                cVPEMENGEN = CStr(CLng(cBestMenge) / CLng(cVPE))
            Else
                cVPEMENGEN = CStr(CLng(cBestMenge))
            End If
        
            lcount = lcount + 1
            
            lBestmenge = lBestmenge + Val(cVPEMENGEN)
            
'            lBestmenge = lBestmenge + Val(cBestMenge)
            
            MSFlexGrid2.Col = SpaltennummerArtnr
            cArtNr = Trim(MSFlexGrid2.Text)

            cLiBesNr = ""
            cLiBesNrforPIAIN = ""
            cMINMENinARTLIEF = ""

            If Val(Trim(MSFlexGrid2.Text)) > 0 Then
                cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cLiBesNr = ""
                    cLiBesNrforPIAIN = ""
                    If Not IsNull(rsrs!LIBESNR) Then
                        cLiBesNr = Trim(rsrs!LIBESNR)
                        cLiBesNrforPIAIN = Trim(rsrs!LIBESNR)
                        While Len(Trim(cLiBesNrforPIAIN)) < 7
                            cLiBesNrforPIAIN = "0" & cLiBesNrforPIAIN
                        Wend
                    End If
    
                    cMINMENinARTLIEF = ""
                    If Not IsNull(rsrs!MINMEN) Then
                        cMINMENinARTLIEF = Trim(rsrs!MINMEN)
    
                        While Len(Trim(cMINMENinARTLIEF)) < 4
                            cMINMENinARTLIEF = "0" & cMINMENinARTLIEF
                        Wend
                    End If
    
                End If
                rsrs.Close
            End If
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            If cEAN = "" Then cEAN = "0"
            
            If cArtNr = "0" Then
                MSFlexGrid2.Col = SpaltennummerEAN
                cEAN = ""
                cLiBesNr = Trim(MSFlexGrid2.Text)
            End If
            
            'danach
            If cArtNr = "0" Then cArtNr = ""
            

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":EN'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "IMD+A++:::" & cArtikeltext & "'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "PIA+1+" & cLiBesNrforPIAIN & cMINMENinARTLIEF & ":IN'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "PIA+1+" & cArtNr & ":BP'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cVPEMENGEN & "'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "CNT+1:" & lBestmenge & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg & "+310'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatREWE"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatLUENING(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim cArtNr          As String
    Dim cKVK            As String
    Dim sHostArtnr      As String
    Dim cMinMen         As String
    Dim sLiefArtnr      As String
    Dim cVPEMENGEN      As String
    Dim cVPE            As String

    EDIFormatLUENING = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatLUENING = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    sGLNEmpfänger = String$(6 - Len(sGLNEmpfänger), "0") & sGLNEmpfänger
    sBelegnr = String$(6 - Len(sBelegnr), "0") & sBelegnr
    
    cSatz = ""
    cSatz = cSatz & "01"
    cSatz = cSatz & sGLNEmpfänger
    cSatz = cSatz & "  "
    cSatz = cSatz & "00000"
    cSatz = cSatz & "1"
    cSatz = cSatz & "00038960"
    cSatz = cSatz & Format(DateValue(Now), "DDMMYY")
    cSatz = cSatz & "000000000"
    cSatz = cSatz & "Z"
    cSatz = cSatz & Space(8)
    cSatz = cSatz & Format(DateValue(Now), "DDMMYY")
    cSatz = cSatz & "A"
    cSatz = cSatz & sBelegnr
    cSatz = cSatz & vbCrLf
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    For lrow = 1 To MSFlexGrid2.Rows - 1
    
        MSFlexGrid2.Row = lrow
        
        cBestMenge = ""
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        cVPE = ""
        MSFlexGrid2.Col = SpaltennummerMINMEN
        cVPE = Val(Trim(MSFlexGrid2.Text))
    
        cArtNr = ""
        MSFlexGrid2.Col = SpaltennummerArtnr
        cArtNr = Trim(MSFlexGrid2.Text)
        
        If Val(cBestMenge) > 0 Then
            If Val(Trim(MSFlexGrid2.Text)) > 0 Then
            
                
                If Val(cVPE) > 0 Then
                    cVPEMENGEN = CStr(CLng(cBestMenge) / CLng(cVPE))
                Else
                    cVPEMENGEN = CStr(CLng(cBestMenge))
                End If
            
                cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cLiBesNr = ""
                    cMinMen = ""
                    
                    If Not IsNull(rsrs!LIBESNR) Then
                        cLiBesNr = Trim(rsrs!LIBESNR)
                        cLiBesNr = String$(12 - Len(cLiBesNr), " ") & cLiBesNr
                    End If
                    
                    cMinMen = Trim(cVPE)
                    cMinMen = String$(4 - Len(cMinMen), "0") & cMinMen
                    
'                    If Not IsNull(rsrs!MINMEN) Then
'                        cMinMen = Trim(rsrs!MINMEN)
'                        cMinMen = String$(4 - Len(cMinMen), "0") & cMinMen
'                    End If
                    
                End If
                rsrs.Close
                
                cSQL = "Select KVKPR1 from ARTIKEL where ARTNR = " & cArtNr
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cKVK = ""
                    
                    If Not IsNull(rsrs!KVKPR1) Then
                        cKVK = Trim(rsrs!KVKPR1)
                    End If
                    
                End If
                rsrs.Close
            End If
            
            cVPEMENGEN = Format(cVPEMENGEN, "###0.00")
            cVPEMENGEN = SwapStr(cVPEMENGEN, ",", ".")
            cVPEMENGEN = String$(7 - Len(cVPEMENGEN), " ") & cVPEMENGEN
            
'            cBestMenge = Format(cBestMenge, "###0.00")
'            cBestMenge = SwapStr(cBestMenge, ",", ".")
'            cBestMenge = String$(7 - Len(cBestMenge), " ") & cBestMenge
            
            cKVK = Format(cKVK, "####0.00")
            cKVK = SwapStr(cKVK, ",", ".")
            
            cKVK = String$(8 - Len(cKVK), " ") & cKVK
            
            sHostArtnr = cArtNr
            sHostArtnr = String$(12 - Len(sHostArtnr), " ") & sHostArtnr
            
            cSatz = "02" & cLiBesNr
            cSatz = cSatz & cVPEMENGEN
            cSatz = cSatz & cKVK
            cSatz = cSatz & "1"
            cSatz = cSatz & "00"
            cSatz = cSatz & sHostArtnr
            cSatz = cSatz & cMinMen
            
            cSatz = cSatz & Space(15) 'LiefArtnr
            cSatz = cSatz & "0000" 'abteilung
            cSatz = cSatz & "00038960" 'lieferant
            cSatz = cSatz & "0" 'erfart
            cSatz = cSatz & "00000000" 'ZPosNr
            
            cSatz = cSatz & vbCrLf
            
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
            
        End If
    Next lrow
    
    

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatLUENING"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatRINKLIN(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim cArtNr          As String
    Dim cKVK            As String
    Dim sHostArtnr      As String
    Dim cMinMen         As String
    Dim sLiefArtnr      As String
    Dim cVPEMENGEN      As String
    Dim cVPE            As String
    Dim cBezeich        As String

    EDIFormatRINKLIN = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatRINKLIN = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    

    
    sGLNEmpfänger = String$(6 - Len(sGLNEmpfänger), "0") & sGLNEmpfänger
    sBelegnr = String$(6 - Len(sBelegnr), "0") & sBelegnr

    cSatz = ""
    cSatz = cSatz & "D#" & sGLNEmpfänger & Format(DateValue(Now), "YYMMDD") & " " & sBelegnr & vbCrLf 'Fertig
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = ""
    cSatz = cSatz & "                     Bestelltext" & vbCrLf  'Fertig
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    For lrow = 1 To MSFlexGrid2.Rows - 1
    
        MSFlexGrid2.Row = lrow
        
        cBestMenge = ""
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        cVPE = ""
        MSFlexGrid2.Col = SpaltennummerMINMEN
        cVPE = Val(Trim(MSFlexGrid2.Text))
    
        cArtNr = ""
        MSFlexGrid2.Col = SpaltennummerArtnr
        cArtNr = Trim(MSFlexGrid2.Text)
        
        If Val(cBestMenge) > 0 Then
            If Val(Trim(MSFlexGrid2.Text)) > 0 Then
            
                
                If Val(cVPE) > 0 Then
                    cVPEMENGEN = CStr(CLng(cBestMenge) / CLng(cVPE))
                Else
                    cVPEMENGEN = CStr(CLng(cBestMenge))
                End If
            
                cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cLiBesNr = ""
                    cMinMen = ""
                    
                    If Not IsNull(rsrs!LIBESNR) Then
                        cLiBesNr = Trim(rsrs!LIBESNR)
                        cLiBesNr = String$(6 - Len(cLiBesNr), "0") & cLiBesNr
                    End If
                    
                    cMinMen = Trim(cVPE)
                    cMinMen = String$(4 - Len(cMinMen), "0") & cMinMen
                     
                End If
                rsrs.Close
                
                cSQL = "Select KVKPR1,Bezeich from ARTIKEL where ARTNR = " & cArtNr
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cKVK = ""
                    
                    If Not IsNull(rsrs!KVKPR1) Then
                        cKVK = Trim(rsrs!KVKPR1)
                    End If
                    
                    cBezeich = ""
                    
                    If Not IsNull(rsrs!BEZEICH) Then
                        cBezeich = Left(Trim(rsrs!BEZEICH), 30)
                    End If
                    
                End If
                rsrs.Close
            End If
            
            cVPEMENGEN = Val(cVPEMENGEN)
            cVPEMENGEN = String$(4 - Len(cVPEMENGEN), "0") & cVPEMENGEN
            
            cBestMenge = Val(cBestMenge)
            cBestMenge = String$(4 - Len(cBestMenge), "0") & cBestMenge
    
            cBezeich = String$(30 - Len(cBezeich), " ") & cBezeich
            
            cSatz = cLiBesNr
            cSatz = cSatz & "       "
            cSatz = cSatz & "+"
            cSatz = cSatz & cVPEMENGEN
            cSatz = cSatz & "000"
            cSatz = cSatz & cBezeich
            cSatz = cSatz & cMinMen  ' VPE
            cSatz = cSatz & "0000"
            cSatz = cSatz & vbCrLf
            
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
            
        End If
    Next lrow
    
    

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatRINKLIN"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatBELA(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSchreiber      As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim cArtNr          As String
    Dim cVPEMENGEN      As String
    Dim cVPE            As String

    
    EDIFormatBELA = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatBELA = ctmp
    
    
    
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr

    cSchreiber = ""
    cSatz = ""
    cSatz = cSatz & "ACE"
    cSatz = cSatz & "00" & sGLNEmpfänger & "+"
    cSatz = cSatz & "0101+"  'bei Werbebestellungen 02 verwenden mit sPromotionDealNumber später
    cSatz = cSatz & "0201+"  'Orderbuch was auch immer das ist
    
    

    For lrow = 1 To MSFlexGrid2.Rows - 1
    
        MSFlexGrid2.Row = lrow
        
        cBestMenge = ""
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        While Len(Trim(cBestMenge)) < 3
            cBestMenge = "0" & cBestMenge
        Wend
        
        cVPE = ""
        MSFlexGrid2.Col = SpaltennummerMINMEN
        cVPE = Val(Trim(MSFlexGrid2.Text))
        
        cArtNr = ""
        MSFlexGrid2.Col = SpaltennummerArtnr
        cArtNr = Trim(MSFlexGrid2.Text)
        
        If Val(cBestMenge) > 0 Then
        
            If Val(cVPE) > 0 Then
                cVPEMENGEN = CStr(CLng(cBestMenge) / CLng(cVPE))
            Else
                cVPEMENGEN = CStr(CLng(cBestMenge))
            End If
            
            While Len(Trim(cVPEMENGEN)) < 3
                cVPEMENGEN = "0" & cVPEMENGEN
            Wend
        
            If Val(Trim(MSFlexGrid2.Text)) > 0 Then
                cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cLiBesNr = ""
                    
                    If Not IsNull(rsrs!LIBESNR) Then
                        cLiBesNr = Trim(rsrs!LIBESNR)
                        
                        While Len(cLiBesNr) < 8
                            cLiBesNr = cLiBesNr & "0"
                        Wend
                        
                    End If
                End If
                rsrs.Close
            End If
            
            cSatz = cSatz & "03" & cLiBesNr & "+"
            cSatz = cSatz & "04" & cVPEMENGEN & "+"
            
            If Len(cSatz) >= 1024 Then
                cSchreiber = Left(cSatz, 1024) & vbLf
                
                lPos = LOF(iFileNr)
                lPos = lPos + 1
                Put #iFileNr, lPos, cSchreiber
                
                
                cSatz = Right(cSatz, Len(cSatz) - 1024)
            End If
        End If
    Next lrow
    
    cSatz = cSatz & Space(1024 - Len(cSatz)) & vbLf
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatBELA"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatINTERCO(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    Dim lBestmenge      As Long
    
    lBestmenge = 0
    lanzseg = 0
    lcount = 0
    EDIFormatINTERCO = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatINTERCO = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr

    'KISS HANNOVER GLN: 4399 9020 8098 9
    
    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
'    cSatz = cSatz & "UNB+UNOA:2+4327002000002:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++EANCOM" & "+1" & "'" & vbCrLf: lanzseg = lanzseg + 1 'mit Testkennung
    cSatz = cSatz & "UNB+UNOA:2+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++EANCOM" & "'" & vbCrLf: lanzseg = lanzseg + 1  'ohne Testkennung
    cSatz = cSatz & "UNH+123+ORDERS:D:96A:UN:EAN008'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+BY+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            lBestmenge = lBestmenge + Val(cBestMenge)
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            If cEAN = "" Then cEAN = "0"

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":EN'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & "'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "CNT+1:" & lBestmenge & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg & "+310'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatINTERCO"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatBUDNI(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim cArtNr          As String
    Dim cMinMen         As String
    Dim sLiefArtnr      As String
    Dim lLFNR           As Long
    
    EDIFormatBUDNI = ""
    
    lLFNR = 0

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatBUDNI = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    sGLNEmpfänger = String$(6 - Len(sGLNEmpfänger), "0") & sGLNEmpfänger
    sBelegnr = String$(6 - Len(sBelegnr), "0") & sBelegnr
    
   

'    lPos = LOF(iFileNr)
'    lPos = lPos + 1
'    Put #iFileNr, lPos, cSatz
    
    For lrow = 1 To MSFlexGrid2.Rows - 1
    
        MSFlexGrid2.Row = lrow
        
        cBestMenge = ""
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        cArtNr = ""
        MSFlexGrid2.Col = SpaltennummerArtnr
        cArtNr = Trim(MSFlexGrid2.Text)
        
        If Val(cBestMenge) > 0 Then
        
            cLiBesNr = ""
    
            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst

                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
                
            End If
            rsrs.Close
                
            cSQL = "Select EAN,ean2,ean3 from ARTIKEL where ARTNR = " & cArtNr
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                cEAN = ""
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
                
                If cEAN = "" Then
                    If Not IsNull(rsrs!EAN2) Then
                        cEAN = Trim(rsrs!EAN2)
                    End If
                End If
                
                If cEAN = "" Then
                    If Not IsNull(rsrs!EAN3) Then
                        cEAN = Trim(rsrs!EAN3)
                    End If
                End If
                
            End If
            rsrs.Close
            
            If cLiBesNr <> "" Then
            
                lLFNR = lLFNR + 1
                
                cSatz = lLFNR & vbTab
                cSatz = cSatz & cLiBesNr & vbTab
                cSatz = cSatz & cBestMenge & vbTab
                cSatz = cSatz & cEAN & vbTab
                cSatz = cSatz & cArtNr & vbTab
                
                cSatz = cSatz & sBelegnr & vbTab
                cSatz = cSatz & Format(DateValue(Now), "YYYYMMDD") & vbTab
                cSatz = cSatz & sGLNEmpfänger & vbTab
                cSatz = cSatz & vbCrLf
                
                lPos = LOF(iFileNr)
                lPos = lPos + 1
                Put #iFileNr, lPos, cSatz
            
            End If
            
            
            
        End If
    Next lrow
    
    cSatz = "1" & vbTab & vbTab & "00" & vbTab & "1111111111111" & vbTab & "111111" & vbTab & "111111" & vbTab & "11111111" & vbTab & "111111" & vbCrLf
            
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "1" & vbTab & vbTab & "00" & vbTab & "1111111111111" & vbTab & "111111" & vbTab & "111111" & vbTab & "11111111" & vbTab & "111111" & vbCrLf
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "1" & vbTab & vbTab & "00" & vbTab & "1111111111111" & vbTab & "111111" & vbTab & "111111" & vbTab & "11111111" & vbTab & "111111" & vbCrLf
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatBUDNI"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function

Private Function EDIFormatBHSG(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim cArtNr          As String
    Dim cMinMen         As String
    Dim sLiefArtnr      As String
    Dim lLFNR           As Long
    
    EDIFormatBHSG = ""
    
    lLFNR = 0

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatBHSG = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    sGLNEmpfänger = String$(6 - Len(sGLNEmpfänger), "0") & sGLNEmpfänger
    sBelegnr = String$(6 - Len(sBelegnr), "0") & sBelegnr
    
   

'    lPos = LOF(iFileNr)
'    lPos = lPos + 1
'    Put #iFileNr, lPos, cSatz
    
    For lrow = 1 To MSFlexGrid2.Rows - 1
    
        MSFlexGrid2.Row = lrow
        
        cBestMenge = ""
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        cArtNr = ""
        MSFlexGrid2.Col = SpaltennummerArtnr
        cArtNr = Trim(MSFlexGrid2.Text)
        
        If Val(cBestMenge) > 0 Then
        
            cLiBesNr = ""
    
            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst

                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
                
            End If
            rsrs.Close
                
            cSQL = "Select EAN,ean2,ean3 from ARTIKEL where ARTNR = " & cArtNr
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                cEAN = ""
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
                
                If cEAN = "" Then
                    If Not IsNull(rsrs!EAN2) Then
                        cEAN = Trim(rsrs!EAN2)
                    End If
                End If
                
                If cEAN = "" Then
                    If Not IsNull(rsrs!EAN3) Then
                        cEAN = Trim(rsrs!EAN3)
                    End If
                End If
                
            End If
            rsrs.Close
            
            If cLiBesNr <> "" Then
            
                lLFNR = lLFNR + 1
                
                cSatz = lLFNR & vbTab
                cSatz = cSatz & cLiBesNr & vbTab
                cSatz = cSatz & cBestMenge & vbTab
                cSatz = cSatz & cEAN & vbTab
                cSatz = cSatz & cArtNr & vbTab
                
                cSatz = cSatz & sBelegnr & vbTab
                cSatz = cSatz & Format(DateValue(Now), "YYYYMMDD") & vbTab
                cSatz = cSatz & sGLNEmpfänger & vbTab
                cSatz = cSatz & vbCrLf
                
                lPos = LOF(iFileNr)
                lPos = lPos + 1
                Put #iFileNr, lPos, cSatz
            
            End If
            
            
            
        End If
    Next lrow
    
    cSatz = "1" & vbTab & vbTab & "00" & vbTab & "1111111111111" & vbTab & "111111" & vbTab & "111111" & vbTab & "11111111" & vbTab & "111111" & vbCrLf
            
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "1" & vbTab & vbTab & "00" & vbTab & "1111111111111" & vbTab & "111111" & vbTab & "111111" & vbTab & "11111111" & vbTab & "111111" & vbCrLf
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "1" & vbTab & vbTab & "00" & vbTab & "1111111111111" & vbTab & "111111" & vbTab & "111111" & vbTab & "11111111" & vbTab & "111111" & vbCrLf
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatBHSG"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function

Private Function EDIFormatBIEDRO(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    Dim lBestmenge      As Long
    
    lBestmenge = 0
    lanzseg = 0
    lcount = 0
    EDIFormatBIEDRO = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatBIEDRO = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf 'Fertig
    cSatz = cSatz & "UNB+UNOA:2+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++EANCOM" & "'" & vbCrLf  'ohne Testkennung
    cSatz = cSatz & "UNH+123+ORDERS:D:96A:UN:EAN008'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+BY+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            lBestmenge = lBestmenge + Val(cBestMenge)
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            If cEAN = "" Then cEAN = "0"

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":EN'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & "'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "CNT+1:" & lBestmenge & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg + 1 & "+123'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatBIEDRO"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatPURAL(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    Dim lBestmenge      As Long
    
    lBestmenge = 0
    lanzseg = 0
    lcount = 0
    EDIFormatPURAL = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatPURAL = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf 'Fertig
    cSatz = cSatz & "UNB+UNOA:2+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++EANCOM" & "'" & vbCrLf  'ohne Testkennung
    cSatz = cSatz & "UNH+123+ORDERS:D:96A:UN:EAN008'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+BY+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            lBestmenge = lBestmenge + Val(cBestMenge)
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            If cEAN = "" Then cEAN = "0"

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":EN'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & "'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "CNT+1:" & lBestmenge & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg + 1 & "+123'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatPURAL"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function


Private Function EDIFormatMENSON(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim cArtNr          As String
    Dim cKVK            As String
    Dim sHostArtnr      As String
    Dim cMinMen         As String
    Dim sLiefArtnr      As String
    Dim cVPEMENGEN      As String
    Dim cVPE            As String
    Dim cBezeich        As String

    EDIFormatMENSON = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatMENSON = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    

    
    sGLNEmpfänger = String$(6 - Len(sGLNEmpfänger), "0") & sGLNEmpfänger
    sBelegnr = String$(6 - Len(sBelegnr), "0") & sBelegnr

    cSatz = ""
    cSatz = cSatz & "D#" & sGLNEmpfänger & Format(DateValue(Now), "YYMMDD") & " " & sBelegnr & vbCrLf 'Fertig
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
'    cSatz = ""
'    cSatz = cSatz & "                     Bestelltext" & vbCrLf  'Fertig
'
'    lPos = LOF(iFileNr)
'    lPos = lPos + 1
'    Put #iFileNr, lPos, cSatz
    
    For lrow = 1 To MSFlexGrid2.Rows - 1
    
        MSFlexGrid2.Row = lrow
        
        cBestMenge = ""
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        cVPE = ""
        MSFlexGrid2.Col = SpaltennummerMINMEN
        cVPE = Val(Trim(MSFlexGrid2.Text))
    
        cArtNr = ""
        MSFlexGrid2.Col = SpaltennummerArtnr
        cArtNr = Trim(MSFlexGrid2.Text)
        
        cEAN = ""
        MSFlexGrid2.Col = SpaltennummerEAN
        cEAN = Trim(MSFlexGrid2.Text)
        
        cEAN = String$(13 - Len(cEAN), " ") & cEAN
        
        
        If Val(cBestMenge) > 0 Then
            If Val(Trim(MSFlexGrid2.Text)) > 0 Then
            
                
'                If Val(cVPE) > 0 Then
'                    cVPEMENGEN = CStr(CLng(cBestMenge) / CLng(cVPE))
'                Else
                    cVPEMENGEN = CStr(CLng(cBestMenge))
'                End If
'
                cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cLiBesNr = ""
                    cMinMen = ""
                    
                    If Not IsNull(rsrs!LIBESNR) Then
                        cLiBesNr = Trim(rsrs!LIBESNR)
                        cLiBesNr = cLiBesNr & String$(13 - Len(cLiBesNr), " ")
                    End If
                    
                    cMinMen = Trim(cVPE)
                    cMinMen = String$(4 - Len(cMinMen), "0") & cMinMen
                     
                End If
                rsrs.Close
                
                cSQL = "Select KVKPR1,Bezeich from ARTIKEL where ARTNR = " & cArtNr
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
    
                    cKVK = ""
                    
                    If Not IsNull(rsrs!KVKPR1) Then
                        cKVK = Trim(rsrs!KVKPR1)
                    End If
                    
                    cBezeich = ""
                    
                    If Not IsNull(rsrs!BEZEICH) Then
                        cBezeich = Left(Trim(rsrs!BEZEICH), 30)
                    End If
                    
                End If
                rsrs.Close
            End If
            
            cVPEMENGEN = Val(cVPEMENGEN)
            cVPEMENGEN = String$(4 - Len(cVPEMENGEN), "0") & cVPEMENGEN
            
            cBestMenge = Val(cBestMenge)
            cBestMenge = String$(4 - Len(cBestMenge), "0") & cBestMenge
    
            cBezeich = cBezeich & String$(59 - Len(cBezeich), " ")
            
            cSatz = cLiBesNr
'            cSatz = cSatz & "       " '13
            cSatz = cSatz & "+"
            cSatz = cSatz & cVPEMENGEN
            cSatz = cSatz & "000"
            cSatz = cSatz & cBezeich
            
            
            
            
            
'            cSatz = cSatz & cMinMen  ' VPE
            cSatz = cSatz & cEAN
            cSatz = cSatz & "000000"
            cSatz = cSatz & vbCrLf
            
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
            
        End If
    Next lrow
    
    

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatMENSON"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
        Resume Next
    End If
End Function

Private Function EDIFormatBOER(cLinr As String, sKUNDNR As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, _
sILN2 As String, sGLNEmpfänger As String, Optional sPromotionDealNumber As String) As String


    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim cArtNr          As String
    Dim cKVK            As String
    Dim sHostArtnr      As String
    Dim cMinMen         As String
    Dim sLiefArtnr      As String
    Dim cVPEMENGEN      As String
    Dim cVPE            As String
    Dim cBezeich        As String

    Dim lRows               As Long
    Dim lColArtNr           As Long
    Dim lColEAN             As Long
    Dim lColBestell         As Long

'    Dim lcol            As Long
'    Dim lrow            As Long
'    Dim lPos            As Long
'    Dim lWert           As Long
'    Dim cSatz           As String
    Dim ctemp           As String
'    Dim cSQL            As String
'    Dim cFeld           As String
'    Dim cArtNr          As String
'    Dim cEAN            As String
'    Dim cBestMenge      As String
'    Dim cLiBesNr        As String
'    Dim cBezeich        As String
    Dim cKundnr         As String
    Dim cAuftragsnr     As String
    
    Dim cLieferwunsch   As String

'
'    Dim cPfad           As String
'    Dim iFileNr         As Integer
    Dim i               As Integer
    Dim j               As Integer
'    Dim rsrs            As Recordset
'    Dim sTime           As String
'    Dim ctmp            As String
    
   
    
    
    
    

    EDIFormatBOER = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatBOER = ctmp
    
    Kill cPfad & "EDI.txt"
    
    lRows = MSFlexGrid2.Rows

    
    lColArtNr = SpaltennummerArtnr
    lColBestell = SpaltennummerBESTVOR
    lColEAN = SpaltennummerEAN
    
    
    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = MSFlexGrid2.Text
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        If Val(cBestMenge) > 0 Then
        
            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.Text
            
            MSFlexGrid2.Col = lColEAN
            cEAN = MSFlexGrid2.Text
            
            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = rsrs!LIBESNR
                Else
                    cLiBesNr = ""
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            cLiBesNr = Trim(cLiBesNr)
            cLiBesNr = cLiBesNr & Space(15 - Len(cLiBesNr))
            
            cEAN = Trim(cEAN)
            cEAN = cEAN & Space(14 - Len(cEAN))
            
            cBestMenge = Trim(cBestMenge)
            cBestMenge = cBestMenge & Space(4 - Len(cBestMenge))
            
            ctemp = ""
            If Len(cLiBesNr) < 14 Then
                i = 13 - Len(cLiBesNr)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cLiBesNr = ctemp & cLiBesNr
            Else
                cLiBesNr = Left$(cLiBesNr, 13)
            End If
            
            ctemp = ""
            If Len(cEAN) < 14 Then
                i = 13 - Len(cEAN)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cEAN = ctemp & cEAN
            Else
                cEAN = Left$(cEAN, 13)
            End If
            
            ctemp = ""
            If Len(cBestMenge) < 5 Then
                i = 4 - Len(cBestMenge)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cBestMenge = ctemp & cBestMenge
            Else
                cBestMenge = Left$(cBestMenge, 4)
            End If

            ctemp = ""
            If Len(sKUNDNR) < 11 Then
                i = 10 - Len(sKUNDNR)
                For j = 1 To i
                    ctemp = ctemp & " "
                Next j
                cKundnr = sKUNDNR & ctemp
            Else
                cKundnr = Left$(sKUNDNR, 10)
            End If
            
            ctemp = ""
            If Len(sBelegnr) < 11 Then
                i = 10 - Len(sBelegnr)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cAuftragsnr = ctemp & sBelegnr
            Else
                cAuftragsnr = Left$(sBelegnr, 10)
            End If
            
             'Lieferwunschtermin
            lWert = DateValue(Now) + 3
            cLieferwunsch = Format$(lWert, "DDMMYY")
            
            cSatz = "0000000000000" & cLiBesNr & cEAN & cBestMenge & cKundnr & cAuftragsnr & cLieferwunsch
            cSatz = cSatz & Chr$(13) & Chr$(10)
            
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatBOER"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
        Resume Next
    End If
End Function
Private Function EDIFormatCarnot(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    Dim lBestmenge      As Long
    
    lBestmenge = 0
    lanzseg = 0
    lcount = 0
    EDIFormatCarnot = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatCarnot = ctmp
    
    Kill cPfad & "EDI.txt"

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "UNA:+.? '" & vbCrLf 'Fertig
    cSatz = cSatz & "UNB+UNOA:2+4399902080989:14+" & sGLNEmpfänger & ":14+" & Format(DateValue(Now), "YYMMDD") & ":" & Format(TimeValue(Now), "HHMM") & "+" & sBelegnr & "++EANCOM" & "'" & vbCrLf  'ohne Testkennung
    cSatz = cSatz & "UNH+123+ORDERS:D:96A:UN:EAN008'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "BGM+220+" & sBelegnr & "+9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "DTM+2:" & Format(DateValue(Now) + 2, "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "DTM+137:" & Format(DateValue(Now), "YYYYMMDD") & ":102'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "NAD+SU+" & sGLNEmpfänger & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+BY+" & sILN2 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    cSatz = cSatz & "NAD+DP+" & sILN1 & "::9'" & vbCrLf: lanzseg = lanzseg + 1
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)

        If Val(cBestMenge) > 0 Then
            lcount = lcount + 1
            
            lBestmenge = lBestmenge + Val(cBestMenge)
            
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cEAN = ""
            cSQL = "Select EAN from ARTIKEL where ARTNR = " & Trim(MSFlexGrid2.Text)
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!EAN) Then
                    cEAN = Trim(rsrs!EAN)
                End If
            End If
            rsrs.Close

            If cEAN = "" Then cEAN = "0"

            cSatz = ""
            cSatz = cSatz & "LIN+" & lcount & "++" & cEAN & ":EN'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
            cSatz = cSatz & "PIA+1+" & cLiBesNr & ":SA'" & vbCrLf: lanzseg = lanzseg + 1
            cSatz = cSatz & "QTY+21:" & cBestMenge & "'" & vbCrLf: lanzseg = lanzseg + 1

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    cSatz = ""
    cSatz = cSatz & "UNS+S'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "CNT+1:" & lBestmenge & "'" & vbCrLf: lanzseg = lanzseg + 1 'Fertig
    cSatz = cSatz & "UNT+" & lanzseg + 1 & "+123'" & vbCrLf  'Fertig
    cSatz = cSatz & "UNZ+1+" & sBelegnr & "'" & vbCrLf  'Fertig

    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatCarnot"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
    End If
End Function
Private Function EDIFormatBIOGARTEN(cLinr As String, sBelegnr As String, sRechbetrag As String, sILN1 As String, sILN2 As String, sGLNEmpfänger As String) As String
    On Error GoTo LOKAL_ERROR

    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cBestMenge      As String
    Dim cEAN            As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim lcount          As Long
    Dim lanzseg         As Long
    Dim lBestmenge      As Long
    Dim cVPE            As String
    Dim cVPEMENGEN      As String
    Dim cArtikeltext    As String
    Dim cTeil1          As String
    Dim cTeil2          As String
    
    
    lBestmenge = 0
    lanzseg = 0
    lcount = 0
    EDIFormatBIOGARTEN = ""

    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)

    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")

    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")

    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"

    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"

    EDIFormatBIOGARTEN = ctmp
    
    Kill cPfad & "EDI.txt"
    
    sGLNEmpfänger = String$(6 - Len(sGLNEmpfänger), "0") & sGLNEmpfänger
    sBelegnr = String$(6 - Len(sBelegnr), "0") & sBelegnr
    
    'BNN Format Datei

    iFileNr = FreeFile
    Open cPfad & "EDI.txt" For Binary As #iFileNr
    
    'KISS HANNOVER GLN: 4399 9020 8098 9

    cSatz = ""
    cSatz = cSatz & "D#" & sGLNEmpfänger & "000000" & " " & sBelegnr & vbCrLf 'Fertig
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    For lrow = 1 To MSFlexGrid2.Rows - 1
        MSFlexGrid2.Row = lrow
        
        MSFlexGrid2.Col = SpaltennummerBESTVOR
        cBestMenge = Trim(MSFlexGrid2.Text)
        
        MSFlexGrid2.Col = SpaltennummerMINMEN
        cVPE = Val(Trim(MSFlexGrid2.Text))
        
        MSFlexGrid2.Col = SpaltennummerBEZEICH
        cArtikeltext = Trim(MSFlexGrid2.Text)
        If cArtikeltext = "unbekannt" Then
            cArtikeltext = ""
        End If
        
        If Len(cArtikeltext) > 30 Then cArtikeltext = Left(cArtikeltext, 30)
        
        cArtikeltext = cArtikeltext & String$(30 - Len(cArtikeltext), " ")
        

        If Val(cBestMenge) > 0 Then
    
            If Val(cVPE) > 0 Then
                cVPEMENGEN = CStr(CLng(cBestMenge) / CLng(cVPE))
            Else
                cVPEMENGEN = CStr(CLng(cBestMenge))
            End If
            
            cVPEMENGEN = Trim(cVPEMENGEN)
            cVPEMENGEN = Format(cVPEMENGEN, "0000.000")
            cVPEMENGEN = SwapStr(cVPEMENGEN, ",", "")
            
            cVPE = Trim(cVPE)
            cVPE = Format(cVPE, "0000.000")
            cVPE = SwapStr(cVPE, ",", "")
        
            MSFlexGrid2.Col = SpaltennummerArtnr

            cLiBesNr = ""

            cSQL = "Select * from ARTLIEF where ARTNR = " & Trim(MSFlexGrid2.Text) & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close
            
            cLiBesNr = cLiBesNr & String$(13 - Len(cLiBesNr), " ")
            
            cSatz = ""
            cSatz = cSatz & cLiBesNr & "+" & cVPEMENGEN & cArtikeltext & cVPE & vbCrLf: lanzseg = lanzseg + 1  'Fertig
            
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    

    Close iFileNr

Exit Function
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "EDIFormatBIOGARTEN"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."
    
        Fehlermeldung1
        Resume Next
    End If
End Function

Private Sub SchreibeSpeziFormat(cLief As String)
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp As String
    Dim sLieferant As String
    sLieferant = cLief
    gsLinr = cLief
    
    Verbindungseinstellunglesen sLieferant
    

    If Trim(cLief) = "800656" Then 'Procter
        iBestellungAls = 1 'EDI
        ProcterFormat
    Else
    
        Dim sEDIFormat As String
        sEDIFormat = WhatIsXfromXtab(cLief, "LINR", "LISRT", "Format")
        
        If sEDIFormat = "TABAK" Then
            iBestellungAls = 1 'EDI
            Do Until sKenn <> "" And sKund <> "" And sadress <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKenn = "" Or sKund = "" Or sadress = "" Then
                    MsgBox "Es konnte keine Bestellung im Spezialformat geschrieben werden. Bitte vervollständigen Sie Ihre Kundendaten!", vbCritical, "Winkiss Fehler:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress

        
        ElseIf sEDIFormat = "EDILORE" Then
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        ElseIf sEDIFormat = "EDIBUDNI" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sGLNEmpfänger <> ""
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN-Nr: " & sGLNEmpfänger & vbCrLf
                    
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            gsLinr = ""
            
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12.Text, _
            lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
            
         ElseIf sEDIFormat = "EDIBHSG" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sGLNEmpfänger <> ""
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN-Nr: " & sGLNEmpfänger & vbCrLf
                    
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            gsLinr = ""
            
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12.Text, _
            lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
            
        ElseIf sEDIFormat = "EDIBBI" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        ElseIf sEDIFormat = "EDIINTERCO" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        ElseIf sEDIFormat = "EDIBIOGARTEN" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        ElseIf sEDIFormat = "EDICARNOT" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        
        ElseIf sEDIFormat = "EDIPURAL" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        ElseIf sEDIFormat = "EDIBOER" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        ElseIf sEDIFormat = "EDIMENSON" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        ElseIf sEDIFormat = "EDIBIEDRO" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        ElseIf sEDIFormat = "EDILUENING" Then
        
            iBestellungAls = 1 'EDI
            Do Until sKund <> "" And sGLNEmpfänger <> ""
                
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12, lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        
        
        ElseIf sEDIFormat <> "" Then
        
            Do Until sKund <> "" And sadress <> "" And sGLNEmpfänger <> ""
               
                Verbindungseinstellunglesen sLieferant
                     
                If sKund = "" Or sadress = "" Or sGLNEmpfänger = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    ctmp = ctmp & "Kund.-Nr: " & sKund & vbCrLf
                    ctmp = ctmp & "GLN Nr: " & sGLNEmpfänger
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
            
            Do Until gFirma.ILN_1 <> "" And gFirma.ILN_2 <> ""
                ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                ctmp = ctmp & "Geben Sie bitte erst Ihre ILN-Nummern an!"
                MsgBox ctmp, vbInformation, "Winkiss Hinweis:"

                frmWKL16.Show 1
                LeseFirmenDaten
            Loop

            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12.Text, _
            lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
        Else
            'alles andere ohne Formateinstellungen
            Do Until sadress <> ""
               
                Verbindungseinstellunglesen sLieferant
                     
                If sadress = "" Then
                
                    ctmp = "Es konnte keine Bestellung im Spezialformat geschrieben werden." & vbCrLf & vbCrLf
                    ctmp = ctmp & "Bitte vervollständigen Sie Ihre Daten in der nachfolgenden Eingabemaske!" & vbCrLf
                    ctmp = ctmp & "Benötigt werden Einträge unter:" & vbCrLf
                    
                    ctmp = ctmp & "Adresse: " & sadress & vbCrLf
                    
                    MsgBox ctmp, vbInformation, "Winkiss Hinweis:"
                    gsLinr = sLieferant
                    frmWKL17.Show 1
                    
                End If
            Loop
        
            UebertragungPerEmail sLieferant, BestDateiinOrdner(sLieferant, gFirma.ILN_1, gFirma.ILN_2, sGLNEmpfänger), Text12.Text, _
            lbl2(0).Caption, txt2.Text, sKund, gcStsatz, sadress
            
        End If
    End If
    
    gsLinr = ""
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SchreibeSpeziFormat"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Function BestellungWegSpeichern() As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim cBezeich    As String
    Dim lRet        As Long
    Dim ctmp        As String
    Dim cSQL        As String
    Dim rsrs        As Recordset
    Dim lAnzTable   As Long
    Dim lcount      As Long
    Dim bgefunden   As Boolean
    Dim cZiel       As String
    Dim lAktTable   As Long
    Dim cPfad       As String
    Dim cPfad1      As String
    Dim lDatum      As Long
    Dim cDatum      As String
    Dim iStufe      As Integer
    
    cPfad = App.Path              'Anwendungspfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad1 = gcDBPfad           'Datenbankpfad
    If Right$(cPfad1, 1) <> "\" Then
        cPfad1 = cPfad1 & "\"
    End If
    
    iStufe = 1
    
    MSFlexGrid2_SelChange
    BestellungWegSpeichern = False
    
    gsLinr = Command6.Caption
    If Val(lbl2(0).Caption) > 0 Then
        cLinr = Command6.Caption
        
        iStufe = 2
        If cLinr = "400001" Then
            cBezeich = ""
            lRet = fnPruefeBestellVorgabeZENac(cBezeich)
            If lRet <> 0 Then
                ctmp = Trim$(Str$(lRet)) & " - " & cBezeich & ": " & vbCrLf & vbCrLf
                ctmp = ctmp & "Ihre Bestellung entspricht nicht den Bestellvorgaben des Lieferanten!" & vbCrLf
                ctmp = ctmp & "Bitte überprüfen Sie Ihre Bestellmengen" & vbCrLf
                ctmp = ctmp & "(Bestellmenge muß gleich der Bestellvorgabe MINMEN" & vbCrLf
                ctmp = ctmp & "oder ein Vielfaches davon sein)."
                MsgBox ctmp, vbCritical, "STOP"
                Screen.MousePointer = 11
                Exit Function
            End If
        End If
        
        iStufe = 3
        
        cSQL = "Select KUERZEL from LISRT where LINR = " & cLinr & " "
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            If Not IsNull(rsrs!Kuerzel) Then
                ctmp = rsrs!Kuerzel
            Else
                ctmp = "OFFEN"
            End If
        Else
            ctmp = "OFFEN"
        End If
        rsrs.Close: Set rsrs = Nothing
        
        iStufe = 4

        'Namen zuweisen
        If gcBestellName = "" Then
            lcount = 65
            bgefunden = True
            Do While bgefunden
                cZiel = "Q" & cLinr & Chr$(lcount)
                If NewTableSuchenDBKombi("Q" & cLinr & Chr$(lcount), gdBase) Then
                    bgefunden = True
                    lcount = lcount + 1
                Else
                    bgefunden = False
                End If
            Loop
            iStufe = 5
            
            If lcount > 89 Then
                Dim ctempa As String
                ctempa = "Bestellvorschlag speichern nicht möglich. Die Vergabe eines Dateinamens ist gescheitert." & vbCrLf
                ctempa = ctempa & "Löschen Sie erledigte Bestellungen im Wareneingang aus Bestellung!" & vbCrLf & vbCrLf
                
                ctempa = ctempa & "Damit Ihre Bestellung nicht verloren geht, drücken Sie bitte auf 'Zwischenspeichern'"
                MsgBox ctempa, vbOKOnly + vbInformation, "Winkiss Hinweis:"
                Screen.MousePointer = 0
                Exit Function
            End If
            
            iStufe = 6
            
            loeschNEW cZiel, gdApp
            
            cSQL = "Select * into " & cZiel & " from VORSCHLZ "
            cSQL = cSQL & " where BESTVOR > 0 "
            gdApp.Execute cSQL, dbFailOnError
            gdApp.TableDefs.Refresh
            
            iStufe = 7
            
            cPfad1 = ShortPath(cPfad1)
            cPfad = ShortPath(cPfad)

            iStufe = 9

            If cPfad1 = UCase$(cPfad) Or cPfad1 = cPfad Or UCase$(cPfad1) = cPfad Then
                iStufe = 10
                loeschNEW cZiel, gdBase
                
                ctmp = cPfad1 & "kissdata.mdb"
                cSQL = "Select " & cZiel & ".* INTO " & cZiel & " IN '" & ctmp & "' from " & cZiel & " "
                gdApp.Execute cSQL, dbFailOnError
                
            Else
                iStufe = 11
                loeschNEW cZiel, gdBase
                
                ctmp = cPfad1 & "kissdata.mdb"
                cSQL = "Select " & cZiel & ".* INTO " & cZiel & " IN '" & ctmp & "' from " & cZiel & " "
                gdApp.Execute cSQL, dbFailOnError
                    
            End If

            iStufe = 12
            cSQL = "Delete from TABDATUM where TABNAME like '" & cZiel & "*' "
            gdBase.Execute cSQL, dbFailOnError
            
            cSQL = "Insert into TABDATUM (Tabname,Tabdate) values"
            cSQL = cSQL & " ( '" & cZiel & "','" & DateValue(Now) & "')"
            gdBase.Execute cSQL, dbFailOnError
            
            cSQL = "Delete from BESTREST where DATEINAME = '" & cZiel & ".DBF'"
            gdBase.Execute cSQL, dbFailOnError
            
            iStufe = 13
            
            SetzeNeuheitenwiederaufgrau gsLinr
            
            If Text12.Text <> "" Then
                If IsNumeric(Text12.Text) Then
                    schreibeAufnr CLng(Text12.Text), cZiel
                End If
            End If
            
            iStufe = 14
            
            lDatum = Fix(Now)
            cDatum = Trim$(Str$(lDatum))
            
            iStufe = 15
            
            cSQL = "Insert into BESTREST "
            cSQL = cSQL & "Select " & cLinr & " as LINR, "
            cSQL = cSQL & "ARTNR, LEKPR, BESTVOR, '" & cZiel & ".DBF' as DATEINAME, "
            cSQL = cSQL & cDatum & " as BEST_DATUM, " & cDatum & " as UPD_DATUM "
            cSQL = cSQL & " from " & cZiel & " where BESTVOR <> 0 "
            gdBase.Execute cSQL, dbFailOnError
            
            'alle Artikel, die bestellt werden - auf geführt = 'J' setzen
            cSQL = "Update Artikel inner join " & cZiel & " on Artikel.artnr = " & cZiel & ".artnr  "
            cSQL = cSQL & " Set Artikel.gefuehrt = 'J' "
            cSQL = cSQL & " where " & cZiel & ".BESTVOR <> 0 "
            gdBase.Execute cSQL, dbFailOnError
            'Ende, alle Artikel, die bestellt werden - auf geführt = 'J' setzen
            
            If Check3.value = vbChecked Then
            
                cSQL = "Update KUNDBEST inner Join " & cZiel & " on Kundbest.artnr =  " & cZiel & ".artnr"
                cSQL = cSQL & " set STATUSARTIKEL = 'BESTELLT' "
                cSQL = cSQL & " where STATUSARTIKEL = 'INBESTELLUNG' "
                cSQL = cSQL & " and " & cZiel & ".bestvor >= KUNDBEST.BESTELLTMENGE "
                gdBase.Execute cSQL, dbFailOnError
            
            
            End If
            
            
            MsgBox "Bestellvorschlag als Bestellung " & cZiel & " gespeichert!", vbInformation, "ERFOLG"
            BestellungWegSpeichern = True
        End If
    End If
               
    Exit Function
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BestellungWegSpeichern"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf. " & iStufe
    
    Fehlermeldung1
        
    
End Function
Private Sub SetzeNeuheitenwiederaufgrau(sLinr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    
    cSQL = "Update ARTIKEL set AWM = '0' where AWM = '98' and LINR = " & sLinr
    gdBase.Execute cSQL, dbFailOnError
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "SetzeNeuheitenwiederaufgrau"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf."
    
    Fehlermeldung1
End Sub
Private Sub check_MerkeLinr(cLinr As String)
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    Dim rsrs As Recordset
    
    List6.Clear
    
    If NewTableSuchenDBKombi("MERKE43LINR", gdBase) Then
    
        cSQL = "Select MERKElinr from MERKE43LINR "
        cSQL = cSQL & " where LINR = " & Val(cLinr) & " "
        Set rsrs = gdBase.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            
            Do While Not rsrs.EOF
            
                If Not IsNull(rsrs!MERKElinr) Then
                    List6.AddItem rsrs!MERKElinr
                End If
                rsrs.MoveNext
            Loop
                
        End If
        rsrs.Close
    End If
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "check_MerkeLinr"
    Fehler.gsFehlertext = "Es trat ein Fehler im Programmteil Bestellungen auf."
    
    Fehlermeldung1
    
End Sub
Private Sub Text1_Change(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cLinr As String
    
    If index = 0 Then
    
        
        LiefKuerzelAufloesung Label1(10), Text1(0)
    
    
        If IsNumeric(Text1(0).Text) Then
            pruefparlog
            
            check_MerkeLinr Text1(0).Text
            If List6.ListCount > 0 Then
                Check10.value = vbChecked
            End If
            
            If ermoffenKUB(Text1(0).Text) Then
                Check3.Visible = True
                Check3.value = vbChecked
                Check3.ForeColor = vbRed
                Command7.Visible = True
            Else
                Check3.Visible = False
                Check3.value = vbUnchecked
                Command7.Visible = False
               
            End If
            
            If ermKONDIS(Text1(0).Text) Then
                Check4.Visible = True
                Check4.value = vbChecked
                Check4.ForeColor = vbRed
                Command9.Visible = True
                Combo1.Visible = True
            Else
                Check4.Visible = False
                Check4.value = vbUnchecked
                Command9.Visible = False
                Combo1.Visible = False
            End If
        End If
    End If
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_Change"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub

Private Function ermKONDIS(cLinr As String) As Boolean
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL As String
    Dim rsrs As Recordset
    
    ermKONDIS = False
    
    cSQL = "Select KONDITIONEN.ARTNR from KONDITIONEN inner join ARTLIEF on KONDITIONEN.artnr = ARTLIEF.ARTNR"
    cSQL = cSQL & " where ARTLIEF.LINR = " & Val(cLinr)
    Set rsrs = gdBase.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        ermKONDIS = True
    End If
    rsrs.Close: Set rsrs = Nothing
    
    
    
    Exit Function
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermKONDIS"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Function

Private Sub Text1_GotFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Text1(index).BackColor = glSelBack1
    Label0(0).Caption = Trim$(Str$(index))
    Text1(index).SelStart = Len(Text1(index).Text)
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text1_KeyPress(index As Integer, KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cZeichen = Chr$(KeyAscii)
    cZeichen = UCase$(cZeichen)
    KeyAscii = Asc(cZeichen)
    
    Select Case index
        Case 0
            cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
            cValid = cValid & Chr(38) & Chr(45) & Chr(46) & Chr(10) & Chr(13)
            cValid = cValid & "+äÄÜüÖöß"
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
        Case 1 To 3
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
        Case Is = 4
            cValid = "1234567890," & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            If KeyAscii <> 0 Then
                If cZeichen = "," Then
                    If InStr(Text1(index).Text, ",") > 0 Then
                        KeyAscii = 0
                    End If
                End If
            End If
        Case 5 To 6
            cValid = "1234567890." & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
        Case 7
            'beliebig
        Case 8
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
    End Select
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub Text1_KeyUp(index As Integer, KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim ctmp As String
    Dim lcount As Long
    
    If KeyCode = vbKeyF2 Then
        gF2Prompt.cFeld = ""
        gF2Prompt.cWert = ""
        gF2Prompt.cWert2 = ""
        gF2Prompt.cWahl = ""
        
        Select Case index
            Case Is = 0
                gF2Prompt.bMultiple = False
                gF2Prompt.cFeld = "LINRBR"
                
                If gF2Prompt.cFeld <> "" Then
                    frmWK00a.Show 1
                End If
                
                If gF2Prompt.cWahl <> "" Then
                    Text1(index).Text = gF2Prompt.cWahl
                    Label1(10).Caption = gF2Prompt.cWert
                    If index = 0 Then
                        pruefparlog
                    End If
                End If
                
            Case 1, 2
                ctmp = Text1(0).Text
                ctmp = Trim$(ctmp)
                If ctmp = "" Then
                    MsgBox "Bitte einen Lieferanten angeben!", vbInformation, "Winkiss Hinweis:"
                    Text1(0).SetFocus
                    Exit Sub
                End If
                gF2Prompt.bMultiple = True
                gF2Prompt.cFeld = "LPZ"
                gF2Prompt.cWert = ctmp
                    
                If gF2Prompt.cFeld <> "" Then
                    frmWK00a.Show 1
                End If
                List3.Clear
                For lcount = 0 To 100
                    If gF2Prompt.cArray(lcount) <> "" Then
                        List3.AddItem gF2Prompt.cArray(lcount)
                    End If
                Next lcount
            Case 8 'AGN
                gF2Prompt.cFeld = ""
                gF2Prompt.cWert = ""
                gF2Prompt.cWert2 = ""
                gF2Prompt.cWahl = ""
                gF2Prompt.bMultiple = False
                
                gF2Prompt.cFeld = "AGN"
                frmWK00a.Show 1
                If gF2Prompt.cWahl <> "" Then
                    Text1(8).Text = gF2Prompt.cWahl
                End If
            
        End Select
        Text1(index).SetFocus
    End If
    If KeyCode = vbKeyReturn Then
        Command1_Click 0
    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub pruefparlog()
    On Error GoTo LOKAL_ERROR
    Dim sOlinr As String
    Dim rsrs As Recordset
    Dim sSQL As String
    Dim sTmp As String
    
    'Überprüfen ob in UEBERLI
    List3.Clear
    
    sOlinr = Text1(0).Text
    If sOlinr = "" Then Exit Sub
    
    sSQL = "select * from ueberli where OLinr = " & sOlinr
    Set rsrs = gdBase.OpenRecordset(sSQL)
    
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
        
            If Not IsNull(rsrs!linr) Then
                sTmp = rsrs!linr
                If Not IsNull(rsrs!LIEFBEZ) Then
                    sTmp = sTmp & Space(3) & rsrs!LIEFBEZ
                End If
            End If
            
            List3.AddItem sTmp
            rsrs.MoveNext
        Loop
        
        Label1(1).Visible = False
        Label1(4).Visible = False
        Text1(1).Visible = False
        Text1(2).Visible = False
        Text1(8).Visible = False
        Command0(55).Visible = False
        CheckAlle.Visible = True
        checkLPZ.Visible = True
        CheckAlle.value = False
        checkLPZ.value = False
        
        Label1(7).Visible = True
        List3.Visible = True
        Label1(7).Caption = "Auswahl der Lieferanten"
        
        Exit Sub
    End If
        
    rsrs.Close: Set rsrs = Nothing
    
    If Text1(0).Text = "300500" Then
    
        groLieferantenErmittelnUndListeFuellen 300500
    
        Label1(1).Visible = False
        Label1(4).Visible = False
        Text1(1).Visible = False
        Text1(2).Visible = False
        Text1(8).Visible = False
        Command0(55).Visible = False
        CheckAlle.Visible = True
        checkLPZ.Visible = True
        CheckAlle.value = False
        checkLPZ.value = False
'    ElseIf Text1(0).Text = "100000" Then
'
'        groLieferantenErmittelnUndListeFuellen 100000
'
'        Label1(1).Visible = False
'        Label1(4).Visible = False
'        Text1(1).Visible = False
'        Text1(2).Visible = False
'        Command0(55).Visible = False
'        CheckAlle.Visible = True
'        checkLPZ.Visible = True
'        CheckAlle.Value = False
'        checkLPZ.Value = False
    Else
        CheckAlle.Visible = False
        checkLPZ.Visible = False
        List3.Visible = True
        List3.Clear
        Label1(7).Visible = True
        Label1(7).Caption = "gewählte Linien"
        Label1(1).Visible = True
        Label1(4).Visible = True
        Text1(1).Visible = True
        Text1(8).Visible = True
        Text1(2).Visible = True
        Command0(55).Visible = True
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "pruefparlog"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub groLieferantenErmittelnUndListeFuellen(lliefer As Long)
    On Error GoTo LOKAL_ERROR
    
    Dim sSQL        As String
    Dim rsrs        As Recordset
    Dim sTmp        As String
    
    Screen.MousePointer = 11
    
    
    
    loeschNEW "ptmp", gdBase
    
    sSQL = "Select artnr, 0 as linr, '' as liefbez into ptmp from artlief where linr = " & lliefer
    gdBase.Execute sSQL, dbFailOnError
    
    sSQL = "Update ptmp inner join Artlief on ptmp.artnr = artlief.artnr set ptmp.linr = artlief.linr where artlief.linr <> " & lliefer
    gdBase.Execute sSQL, dbFailOnError
    
    
        loeschNEW "ptmp1", gdBase

    sSQL = "Select distinct ptmp.linr into ptmp1 from ptmp "
    gdBase.Execute sSQL, dbFailOnError

    loeschNEW "ptmp2", gdBase
    sSQL = "Select lisrt.linr,lisrt.liefbez into ptmp2 from ptmp1 inner join lisrt on ptmp1.linr = lisrt.linr"
    gdBase.Execute sSQL, dbFailOnError

    List3.Clear
    sSQL = "Select * from ptmp2 order by liefbez "
    Set rsrs = gdBase.OpenRecordset(sSQL)
    
    If Not rsrs.EOF Then
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!linr) Then
                sTmp = rsrs!linr
                If Not IsNull(rsrs!LIEFBEZ) Then
                    sTmp = sTmp & Space(3) & rsrs!LIEFBEZ
                End If
            End If
            
            List3.AddItem sTmp
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    Label1(7).Visible = True
    List3.Visible = True
    Label1(7).Caption = "Auswahl der Lieferanten"
    
    
    
    
    
    
'    loeschNEW "ptmp", gdBase
'
'    sSQL = "Select artnr into ptmp from artlief where linr = " & lliefer
'    gdBase.Execute sSQL, dbFailOnError
'
'    loeschNEW "ptmp1", gdBase
'
'    sSQL = "Select distinct artikel.linr into ptmp1 from ptmp inner join artikel on ptmp.artnr = artikel.artnr"
'    gdBase.Execute sSQL, dbFailOnError
'
'    loeschNEW "ptmp2", gdBase
'    sSQL = "Select lisrt.linr,lisrt.liefbez into ptmp2 from ptmp1 inner join lisrt on ptmp1.linr = lisrt.linr"
'    gdBase.Execute sSQL, dbFailOnError
'
'    List3.Clear
'    sSQL = "Select * from ptmp2 order by liefbez "
'    Set rsrs = gdBase.OpenRecordset(sSQL)
'
'    If Not rsrs.EOF Then
'        Do While Not rsrs.EOF
'            If Not IsNull(rsrs!linr) Then
'                sTmp = rsrs!linr
'                If Not IsNull(rsrs!LIEFBEZ) Then
'                    sTmp = sTmp & Space(3) & rsrs!LIEFBEZ
'                End If
'            End If
'
'            List3.AddItem sTmp
'            rsrs.MoveNext
'        Loop
'    End If
'    rsrs.Close: Set rsrs = Nothing
'
'    Label1(7).Visible = True
'    List3.Visible = True
    Label1(7).Caption = "Auswahl der Lieferanten"
    
    Screen.MousePointer = 0

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "groLieferantenErmittelnUndListeFuellen"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub Text1_LostFocus(index As Integer)
    On Error GoTo LOKAL_ERROR
    
    Text1(index).BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text1_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Text2_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyReturn Then
'        If Label6(1).Caption = "1" Then
            artikel_suchen 'WKL43
            
            If List2.ListCount = 1 Then
                ArtikelAnfuegenWKL43
            Else
                Text2.SetFocus
            End If
            
'        End If
        
    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text2_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text3_Change()
    On Error GoTo LOKAL_ERROR
    
    Text3.SelStart = Len(Text3.Text)
    
    Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_Change"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Text6_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyReturn Then
'        If Label6(1).Caption = "1" Then
            artikel_suchen 'WKL43
            
            If List2.ListCount = 1 Then
                ArtikelAnfuegenWKL43
            Else
                Text6.SetFocus
            End If
'        End If
        
    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text6_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Text7_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyReturn Then
'        If Label6(1).Caption = "1" Then
            artikel_suchen 'WKL43
            
            If List2.ListCount = 1 Then
                ArtikelAnfuegenWKL43
            Else
                Text7.SetFocus
            End If
            
'        End If
        
    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text7_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub Text9_GotFocus()
    On Error GoTo LOKAL_ERROR
    
    Text9.BackColor = glSelBack1
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text9_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text4_GotFocus()
    On Error GoTo LOKAL_ERROR
    
    Text4.BackColor = glSelBack1
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text4_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text3_GotFocus()
    On Error GoTo LOKAL_ERROR
    
    Text3.BackColor = glSelBack1
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text3_KeyPress(KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cValid = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890" & Chr$(8)
    
    cZeichen = Chr$(KeyAscii)
    cZeichen = UCase$(cZeichen)
    
    If InStr(cValid, cZeichen) = 0 Then
        KeyAscii = 0
    Else
        KeyAscii = Asc(cZeichen)
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub Text4_KeyPress(KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
    cValid = cValid & Chr(38) & Chr(45) & Chr(46) & Chr(10) & Chr(13)
    cValid = cValid & "+äÄÜüÖöß"
   
    cZeichen = Chr$(KeyAscii)
    
    If InStr(cValid, cZeichen) = 0 Then
        KeyAscii = 0
    Else
        KeyAscii = Asc(cZeichen)
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text4_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Sub
Private Sub Text10_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR

    If KeyCode = vbKeyReturn Then
        SSCommand2_Click 11
    End If
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text10_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text3_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR

    If KeyCode = vbKeyReturn Then
        Command4_Click 0
    End If
    If KeyCode = vbKeyEscape Then
        Command4_Click 1
    End If
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text3_LostFocus()
On Error GoTo LOKAL_ERROR

    Text3.BackColor = vbWhite
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text3_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text4_LostFocus()
On Error GoTo LOKAL_ERROR

    Text4.BackColor = vbWhite
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text4_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text9_LostFocus()
On Error GoTo LOKAL_ERROR

    Text9.BackColor = vbWhite
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text9_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Handelsspanne_rechnen()
On Error GoTo LOKAL_ERROR


    Dim cSQL As String
    
    If gsSpanne = "SEK" Then
        'Handelsspanne HS über Schnittek
        cSQL = "Update VORSCHLZ set HS = "
        cSQL = cSQL & "  ((((KVKPR1 * 100) / (100 + " & gdMWStV & ")) - ekpr) *100) / ((KVKPR1 * 100) / (100 + " & gdMWStV & ")) "
        cSQL = cSQL & "  "
        cSQL = cSQL & "  where MWST = 'V' and ekpr > 0 and KVKPR1 > 0"
        gdApp.Execute cSQL, dbFailOnError
        
        cSQL = "Update VORSCHLZ set HS = "
        cSQL = cSQL & "  ((((KVKPR1 * 100) / (100 + " & gdMWStE & ")) - ekpr) *100) / ((KVKPR1 * 100) / (100 + " & gdMWStE & ")) "
        cSQL = cSQL & "  "
        cSQL = cSQL & "  where MWST = 'E' and ekpr > 0 and KVKPR1 > 0"
        gdApp.Execute cSQL, dbFailOnError
        
        cSQL = "Update VORSCHLZ set HS = "
        cSQL = cSQL & "  ((((KVKPR1 * 100) / (100)) - ekpr) *100) / ((KVKPR1 * 100) / (100)) "
        cSQL = cSQL & "  "
        cSQL = cSQL & "  where MWST = 'O' and ekpr > 0 and KVKPR1 > 0"
        gdApp.Execute cSQL, dbFailOnError
        
    Else
        'Handelsspanne HS über Listenek
        
        cSQL = "Update VORSCHLZ set HS = "
        cSQL = cSQL & "  ((((KVKPR1 * 100) / (100 + " & gdMWStV & ")) - lekpr) *100) / ((KVKPR1 * 100) / (100 + " & gdMWStV & ")) "
        cSQL = cSQL & "  "
        cSQL = cSQL & "  where MWST = 'V' and lekpr > 0 and KVKPR1 > 0"
        gdApp.Execute cSQL, dbFailOnError
        
        cSQL = "Update VORSCHLZ set HS = "
        cSQL = cSQL & "  ((((KVKPR1 * 100) / (100 + " & gdMWStE & ")) - lekpr) *100) / ((KVKPR1 * 100) / (100 + " & gdMWStE & ")) "
        cSQL = cSQL & "  "
        cSQL = cSQL & "  where MWST = 'E' and lekpr > 0 and KVKPR1 > 0"
        gdApp.Execute cSQL, dbFailOnError
        
        cSQL = "Update VORSCHLZ set HS = "
        cSQL = cSQL & "  ((((KVKPR1 * 100) / (100)) - lekpr) *100) / ((KVKPR1 * 100) / (100)) "
        cSQL = cSQL & "  "
        cSQL = cSQL & "  where MWST = 'O' and lekpr > 0 and KVKPR1 > 0"
        gdApp.Execute cSQL, dbFailOnError
        
    End If
        

Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Handelsspanne_rechnen"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub ErstelleBestellVORSCHLZZENaa()
    On Error GoTo LOKAL_ERROR
    
    Dim lDatVon     As Long
    Dim lDatBis     As Long
    Dim lDatDiff    As Long
    Dim lAnzSatz    As Long
    Dim lAnzahl     As Long
    Dim lEindeckung As Long
    Dim lMengeVor   As Long
    Dim lMengeAkt   As Long
    Dim lcount      As Long
    Dim lMinMen     As Long
    Dim lMenge      As Long
    Dim lBestand    As Long
    Dim lMinBest    As Long
    Dim counter     As Long
    Dim lLinr       As Long
    
    Dim sSQLKOPF    As String
    Dim sSQLALLE    As String
    Dim cPfad       As String
    Dim cLfdJahr    As String
    Dim cLfdMonat   As String
    Dim cFeld       As String
    Dim cSQL        As String
    Dim cSQL2       As String
    Dim cSQL3       As String
    Dim cLPZMin     As String
    Dim cLPZMax     As String
    Dim cEindeck    As String
    Dim cBevorrat   As String
    Dim cAgn        As String
    Dim cProdLinien As String
    Dim cJahr       As String
    Dim cMonat      As String
    Dim cArtNr      As String
    Dim cTmpFilnr   As String
    Dim cDatum      As String
    Dim ctmp        As String
    Dim sAccPfad    As String
    Dim cPLINR      As String
    Dim sSQLCheckLPZ As String
    Dim dMindest    As Double
    Dim dFaktor     As Double
    Dim dBestellung As Double
    Dim dMenge      As Double
    Dim dMengeTag   As Double
    Dim bFehler     As Boolean
    Dim bMinBest    As Boolean
    Dim iTmp        As Integer
    Dim i           As Long
    Dim iGefunden   As Integer
    Dim iFiliale    As Integer
    Dim rsrs        As Recordset
    Dim rsrs1       As Recordset
    Dim rsRs2       As Recordset
    Dim rsRs3       As Recordset
    Dim rsVorschlz  As Recordset
    Dim rsArtlief   As Recordset
    
    picprogress.Visible = True
    txtStatus.Text = "2"
   
    cPfad = gcPfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    bFehler = False
    
    If Check1.value = vbChecked Then
        bMinBest = True
    Else
        bMinBest = False
    End If
    
    txtStatus.Text = "4"
    
    vorschlzRefresh
    SSCommand1.Caption = "Vorschlag > 0"
    txtStatus.Text = "5"
    
    bFehler = False
    
    cLinr = Trim$(Str$(Val(Text1(0).Text)))
    
    Text5.Text = Format(DateValue(Now) + 3, "DD.MM.YYYY")
    Text12.Text = ermMaxAufnr
    
    
    If Check6.value = vbUnchecked Then
    
        If Text1(5).Visible Then
            cDatum = Text1(5).Text
            lDatVon = DateValue(cDatum)
            cDatum = Text1(6).Text
            lDatBis = DateValue(cDatum)
            lDatDiff = lDatBis - lDatVon
            lDatDiff = lDatDiff + 1
        End If
    
        cLPZMin = Trim$(Text1(1).Text)
        cLPZMax = Trim$(Text1(2).Text)
        cEindeck = Trim$(Str$(Val(Text1(3).Text)))
        
        If cEindeck = "" Or cEindeck = "0" Then
            cEindeck = "-1"
        End If
        
        cBevorrat = Trim$(Text1(4).Text)
        
        If cBevorrat = "" Or cBevorrat = "0" Then
            cBevorrat = "-1"
        End If
        
        cBevorrat = fnMoveComma2Point$(cBevorrat)
        
        cAgn = Trim$(Text1(8).Text)
        
        sAccPfad = App.Path & "\kissapp.mdb"
        
        loeschNEW "INTERART", gdApp
        TransferTab gdBase, sAccPfad, "INTERART"
        
        loeschNEW "ARTFARB2", gdApp
        TransferTab gdBase, sAccPfad, "ARTFARB2"
        
        loeschNEW "KONTIN", gdApp
        TransferTab gdBase, sAccPfad, "KONTIN"
        
        loeschNEW "ARTMERK", gdApp
        TransferTab gdBase, sAccPfad, "ARTMERK"
        
        loeschNEW "LINBEZ", gdApp
        TransferTab gdBase, sAccPfad, "LINBEZ"
        
        loeschNEW "ARTLIEF", gdApp
        TransferTab gdBase, sAccPfad, "ARTLIEF"
        
        sSQLKOPF = "insert into vorschlz in '" & sAccPfad & "' "
    
           
        sSQLALLE = " Select distinct"
        sSQLALLE = sSQLALLE & "  A.ARTNR "
        sSQLALLE = sSQLALLE & ", A.BEZEICH "
        sSQLALLE = sSQLALLE & ", A.AGN "
        sSQLALLE = sSQLALLE & ", A.PGN "
        sSQLALLE = sSQLALLE & ", A.GROESSE "
        sSQLALLE = sSQLALLE & ", '' as PIN "
        sSQLALLE = sSQLALLE & ", B.LEKPR "
        sSQLALLE = sSQLALLE & ", A.AWM "
        sSQLALLE = sSQLALLE & ", A.EKPR "
        sSQLALLE = sSQLALLE & ", A.VKPR "
        sSQLALLE = sSQLALLE & ", " & cLinr & " as LINR "
        sSQLALLE = sSQLALLE & ", B.LIBESNR "
        sSQLALLE = sSQLALLE & ", A.KVKPR1 "
        sSQLALLE = sSQLALLE & ", A.EAN "
        sSQLALLE = sSQLALLE & ", 0 as MOPREIS "
        sSQLALLE = sSQLALLE & ", B.RKZ "
        sSQLALLE = sSQLALLE & ", A.LPZ "
        sSQLALLE = sSQLALLE & ", A.NOTIZEN "
        sSQLALLE = sSQLALLE & ", B.MINMEN "
        sSQLALLE = sSQLALLE & ", 0 as MINBEST "
        sSQLALLE = sSQLALLE & ", 0 as INBEST "
        sSQLALLE = sSQLALLE & ", 0 as ANZEIGE "
        sSQLALLE = sSQLALLE & ", 0 as FAKTOR "
        sSQLALLE = sSQLALLE & ", 'N' as SHOP "
        sSQLALLE = sSQLALLE & ", 0 as HS "
        sSQLALLE = sSQLALLE & ", 0 as BESTVOR_PROBEN "
        sSQLALLE = sSQLALLE & ", 0 as BESTVOR_TESTER "
        sSQLALLE = sSQLALLE & ", 0 as BESTVOR_NR "
        sSQLALLE = sSQLALLE & ", A.MWST "
        sSQLALLE = sSQLALLE & ", A.BESTAND "
        sSQLALLE = sSQLALLE & ", NULL as LPZ_BIS "
        sSQLALLE = sSQLALLE & ", NULL as LPZ_VON "
        sSQLALLE = sSQLALLE & ", " & cBevorrat & " as BEVORRAT "
        sSQLALLE = sSQLALLE & ", " & cEindeck & " as EINDECK "
        sSQLALLE = sSQLALLE & ", NULL as VKAMo1 "
        sSQLALLE = sSQLALLE & ", NULL as VKVMo1 "
        sSQLALLE = sSQLALLE & ", NULL as VKLJ1 "
        sSQLALLE = sSQLALLE & ", NULL as VKVJ1 "
        sSQLALLE = sSQLALLE & ", NULL as MITTEILUNG"
        sSQLALLE = sSQLALLE & ", NULL as LJ1 , NULL as LJ2, NULL as LJ3, NULL as LJ4, NULL as LJ5,NULL as LJ6, NULL as LJ7,NULL as LJ8,NULL as LJ9,NULL as LJ10,NULL as LJ11,NULL as LJ12 "
        sSQLALLE = sSQLALLE & ", NULL as VJ1 , NULL as VJ2, NULL as VJ3, NULL as VJ4, NULL as VJ5,NULL as VJ6, NULL as VJ7,NULL as VJ8,NULL as VJ9,NULL as VJ10,NULL as VJ11,NULL as VJ12 "

        If giMehrLinr = 3 Then
            
            For lcount = 0 To List3.ListCount - 1
                If List3.Selected(lcount) = True Then
                    cPLINR = Trim(Left(List3.list(lcount), InStr(1, List3.list(lcount), " ")))
             
                    cSQL = sSQLKOPF
                    sSQLALLE = " Select "
                    sSQLALLE = sSQLALLE & "  A.ARTNR "
                    sSQLALLE = sSQLALLE & ", A.BEZEICH "
                    sSQLALLE = sSQLALLE & ", A.AGN "
                    sSQLALLE = sSQLALLE & ", A.PGN "
                    sSQLALLE = sSQLALLE & ", B.LEKPR "
                    sSQLALLE = sSQLALLE & ", A.AWM "
                    sSQLALLE = sSQLALLE & ", A.EKPR "
                    sSQLALLE = sSQLALLE & ", A.VKPR "
                    sSQLALLE = sSQLALLE & ", " & cLinr & " as LINR "
                    sSQLALLE = sSQLALLE & ", B.LIBESNR "
                    sSQLALLE = sSQLALLE & ", A.KVKPR1 "
                    sSQLALLE = sSQLALLE & ", A.EAN "
                    sSQLALLE = sSQLALLE & ", " & cPLINR & " as MOPREIS "
                    sSQLALLE = sSQLALLE & ", B.RKZ "
                    sSQLALLE = sSQLALLE & ", A.LPZ "
                    sSQLALLE = sSQLALLE & ", A.NOTIZEN "
                    sSQLALLE = sSQLALLE & ", B.MINMEN "
                    sSQLALLE = sSQLALLE & ", 0 as MINBEST "
                    sSQLALLE = sSQLALLE & ", 0 as INBEST "
                    sSQLALLE = sSQLALLE & ", 0 as ANZEIGE "
                    sSQLALLE = sSQLALLE & ", 0 as FAKTOR "
                    sSQLALLE = sSQLALLE & ", 'N' as SHOP "
                    sSQLALLE = sSQLALLE & ", 0 as HS "
                    sSQLALLE = sSQLALLE & ", 0 as BESTVOR_PROBEN "
                    sSQLALLE = sSQLALLE & ", 0 as BESTVOR_TESTER "
                    sSQLALLE = sSQLALLE & ", 0 as BESTVOR_NR "
                    sSQLALLE = sSQLALLE & ", A.MWST "
                    sSQLALLE = sSQLALLE & ", A.BESTAND "
                    sSQLALLE = sSQLALLE & ", NULL as LPZ_BIS "
                    sSQLALLE = sSQLALLE & ", NULL as LPZ_VON "
                    sSQLALLE = sSQLALLE & ", " & cBevorrat & " as BEVORRAT "
                    sSQLALLE = sSQLALLE & ", " & cEindeck & " as EINDECK "
                    sSQLALLE = sSQLALLE & ", NULL as VKAMo1 "
                    sSQLALLE = sSQLALLE & ", NULL as VKVMo1 "
                    sSQLALLE = sSQLALLE & ", NULL as VKLJ1 "
                    sSQLALLE = sSQLALLE & ", NULL as VKVJ1 "
                    sSQLALLE = sSQLALLE & ", NULL as MITTEILUNG"
                    sSQLALLE = sSQLALLE & ", NULL as LJ1 , NULL as LJ2, NULL as LJ3, NULL as LJ4, NULL as LJ5,NULL as LJ6, NULL as LJ7,NULL as LJ8,NULL as LJ9,NULL as LJ10,NULL as LJ11,NULL as LJ12 "
                    sSQLALLE = sSQLALLE & ", NULL as VJ1 , NULL as VJ2, NULL as VJ3, NULL as VJ4, NULL as VJ5,NULL as VJ6, NULL as VJ7,NULL as VJ8,NULL as VJ9,NULL as VJ10,NULL as VJ11,NULL as VJ12 "
                    
                    If checkLPZ = vbChecked Then
                        sSQLCheckLPZ = " and A.LPZ <> 0 "
                    Else
                        sSQLCheckLPZ = ""
                    End If
                       
                    cSQL = cSQL & sSQLALLE
                    cSQL = cSQL & " from ARTIKEL A, ARTLIEF B "
                    cSQL = cSQL & " where B.LINR = " & cPLINR & " "
                    cSQL = cSQL & " and A.ARTNR = B.ARTNR "
                    cSQL = cSQL & " and A.GEFUEHRT = 'J'"
                    cSQL = cSQL & " and (A.SYNSTATUS = 'E' or A.SYNSTATUS = 'A' or A.SYNSTATUS is null)"
                    cSQL = cSQL & sSQLCheckLPZ
                    cSQL = cSQL & " order by A.LPZ, A.BEZEICH "
                    gdBase.Execute cSQL, dbFailOnError
                    
                    txtStatus.Text = CStr(CLng(txtStatus.Text) + 1)
                    
                End If
            Next lcount
            
            cSQL = "Update VORSCHLZ inner join artlief"
            cSQL = cSQL & " on VORSCHLZ.artnr = artlief.artnr "
            cSQL = cSQL & " set VORSCHLZ.libesnr = artlief.libesnr "
            cSQL = cSQL & " , VORSCHLZ.minmen = artlief.minmen "
            cSQL = cSQL & " , VORSCHLZ.LEKPR = artlief.LEKPR "
            cSQL = cSQL & " Where artlief.linr = " & cLinr
            gdApp.Execute cSQL, dbFailOnError
            
        Else
        
            cSQL = "Select * from LINBEZ where LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            
            If Not rsrs.EOF Then
                If cLPZMin <> "" And cLPZMax <> "" Then
                    'alle Linien oder Bereich, List 3 leer
                    
                    cSQL = sSQLKOPF
                    cSQL = cSQL & sSQLALLE
                    cSQL = cSQL & " from ARTIKEL A, ARTLIEF B"
                    cSQL = cSQL & " where B.LINR = " & cLinr & " "
                    cSQL = cSQL & " and A.ARTNR = B.ARTNR "
                    cSQL = cSQL & " and A.GEFUEHRT = 'J'"
                    cSQL = cSQL & " and (A.SYNSTATUS = 'E' or A.SYNSTATUS = 'A' or A.SYNSTATUS is null)"
                    cSQL = cSQL & " and A.LPZ >= " & cLPZMin & " and A.LPZ <= " & cLPZMax & " "
                    If cAgn <> "" Then
                        cSQL = cSQL & " and A.AGN = " & cAgn & " "
                    End If
                    
                    cSQL = cSQL & " order by A.LPZ, A.BEZEICH "
                    gdBase.Execute cSQL, dbFailOnError
                    
                Else    'Lese gewählte Linien, kein Bereich
                    
                    cSQL = sSQLKOPF
                    cSQL = cSQL & sSQLALLE
                    cSQL = cSQL & " from ARTIKEL A, ARTLIEF B "
                    cSQL = cSQL & " where B.LINR = " & cLinr & " "
                    cSQL = cSQL & " and A.ARTNR = B.ARTNR "
                    cSQL = cSQL & " and A.GEFUEHRT = 'J'"
                    cSQL = cSQL & " and (A.SYNSTATUS = 'E' or A.SYNSTATUS = 'A' or A.SYNSTATUS is null)"
                    cSQL = cSQL & " and (A.LPZ = " & Mid(List3.list(0), 1, InStr(1, List3.list(0), " ")) & " "
                    For lcount = 1 To List3.ListCount - 1
                        cSQL = cSQL & " or A.LPZ = " & Mid(List3.list(lcount), 1, InStr(1, List3.list(lcount), " ")) & " "
                    Next lcount
                    cSQL = cSQL & ")"
        
                    If cAgn <> "" Then
                        cSQL = cSQL & " and A.AGN = " & cAgn & " "
                    End If
        
                    cSQL = cSQL & " order by A.LPZ, A.BEZEICH "
                    gdBase.Execute cSQL, dbFailOnError
                End If
                    
            Else  '** rsRs.EOF ( Lieferant hat keine Produktlinien!)
                
                cSQL = sSQLKOPF
                cSQL = cSQL & sSQLALLE
                cSQL = cSQL & " from ARTIKEL A, ARTLIEF B "
                cSQL = cSQL & " where B.LINR = " & cLinr & " "
                cSQL = cSQL & " and A.ARTNR = B.ARTNR "
                cSQL = cSQL & " and A.GEFUEHRT = 'J'"
                cSQL = cSQL & " and (A.SYNSTATUS = 'E' or A.SYNSTATUS = 'A' or A.SYNSTATUS is null)"
                
                If cAgn <> "" Then
                    cSQL = cSQL & " and A.AGN = " & cAgn & " "
                End If
                
                cSQL = cSQL & " order by A.LPZ, A.BEZEICH "
                gdBase.Execute cSQL, dbFailOnError
               
            End If   '** ende von Hole aus der ARTIKEL und ARTLIEF
            '**************************************************************************************
        
            rsrs.Close: Set rsrs = Nothing
        End If
        
        txtStatus.Text = "10"
        
        cSQL = "Update VORSCHLZ inner join INTERART on VORSCHLZ.artnr = INTERART.artnr "
        cSQL = cSQL & " set VORSCHLZ.SHOP = 'J' "
        gdApp.Execute cSQL, dbFailOnError
        
        txtStatus.Text = "11"
        
        cSQL = "Update VORSCHLZ inner join ARTFARB2 on VORSCHLZ.artnr = ARTFARB2.artnr "
        cSQL = cSQL & " set VORSCHLZ.awm2 = artfarb2.awm2 "
        gdApp.Execute cSQL, dbFailOnError
        
        txtStatus.Text = "12"
        
        cSQL = "Update VORSCHLZ set VORSCHLZ.SOKO = 999999 "
        gdApp.Execute cSQL, dbFailOnError
        
        txtStatus.Text = "13"
        
        cSQL = "Update VORSCHLZ inner join KONTIN on VORSCHLZ.artnr = KONTIN.artnr "
        cSQL = cSQL & " set VORSCHLZ.SOKO = clng(VORSCHLZ.bestand) - clng(KONTIN.abestand) "
        gdApp.Execute cSQL, dbFailOnError
        
        txtStatus.Text = "14"
        
        cSQL = "Update VORSCHLZ inner join ARTMERK on VORSCHLZ.artnr = ARTMERK.artnr "
        cSQL = cSQL & " set VORSCHLZ.MERK = ARTMERK.MERK "
        gdApp.Execute cSQL, dbFailOnError
        
        If Check8.value = vbChecked Then
        
            If Check9.value = vbChecked Then
            
                loeschNEW "VTTPGN", gdApp
                cSQL = "select * into VTTPGN from VORSCHLZ where rkz = 'J'  and  Bestand > 0 " 'and PGN = 52 "
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Delete from VORSCHLZ where rkz = 'J' "
                gdApp.Execute cSQL, dbFailOnError
                
                cSQL = "Insert into VORSCHLZ Select * from VTTPGN "
                gdApp.Execute cSQL, dbFailOnError
                
            Else
                cSQL = "Delete from VORSCHLZ where rkz = 'J' "
                gdApp.Execute cSQL, dbFailOnError
            End If
        End If
        
        txtStatus.Text = "15"
        
        If Check10.value = vbChecked Then
        
            loeschNEW "BESTEVER", gdApp
            CreateTableT2 "BESTEVER", gdApp
            

            
            Dim siAnzeige As Single
            Dim lMax As Long
        
            cSQL = "Select * from VORSCHLZ"
            Set rsrs1 = gdApp.OpenRecordset(cSQL)
            If Not rsrs1.EOF Then
            
                rsrs1.MoveLast
                lMax = rsrs1.RecordCount
                txtStatus.Text = "0"
                siAnzeige = 0
            
            
                rsrs1.MoveFirst
                Do While Not rsrs1.EOF
                
                
                    siAnzeige = siAnzeige + 1
                    txtStatus.Text = CStr((100 * siAnzeige) / lMax)
                
                
                    If Not IsNull(rsrs1!artnr) Then
                        cArtNr = rsrs1!artnr
                    Else
                        cArtNr = ""
                    End If
                    
                    If List6.ListCount > 0 Then
                        For lcount = 0 To List6.ListCount - 1
                    
                            lLinr = Val(Trim(Left(List6.list(lcount), 6)))
                            If ArtikelmitkleinerenLEKandererLieferantenloeschen(cArtNr, lLinr) = True Then
                                
                            End If
                        
                        Next lcount
                    Else
                        If ArtikelmitkleinerenLEKandererLieferantenloeschen(cArtNr, 0) = True Then
                            

                        End If
                    End If
                    
                    rsrs1.MoveNext
                Loop
                
            End If
            rsrs1.Close: Set rsrs1 = Nothing
                            
        End If
        
        txtStatus.Text = "16"
        
        
        If Check3.value = vbChecked Then
            loeschNEW "KUNDBEST", gdApp
            loeschNEW "ARTLIEF", gdApp
            
            TransferTab gdBase, sAccPfad, "KUNDBEST"
            TransferTab gdBase, sAccPfad, "ARTLIEF"
            
            cSQL = "Select KUNDBEST.Artnr from KUNDBEST , artlief where artlief.artnr = kundbest.artnr "
            cSQL = cSQL & " and Artlief.LINR = " & cLinr
            cSQL = cSQL & " and KUNDBEST.StatusARTIKEL = 'INBESTELLUNG' and KUNDBEST.artnr not in (select artnr from vorschlz)"
            Set rsrs = gdApp.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                Do While Not rsrs.EOF
                    If Not IsNull(rsrs!artnr) Then
                        ArtikelAnfuegenausKUB rsrs!artnr
                    End If
                
                rsrs.MoveNext
                Loop
                
            End If
            rsrs.Close: Set rsrs = Nothing
        End If
        
        txtStatus.Text = "20"
        
        'Vorhandene Bestellungen einlesen
        Set rsrs = gdApp.OpenRecordset("VORSCHLZ", dbOpenTable)
        rsrs.index = "ARTNR"
        
        '************* BESTREST hat kein FILIALNR ******************
        cSQL = "Select ARTNR, SUM(BESTVOR) as INBEST from BESTREST group by ARTNR "
        Set rsRs2 = gdBase.OpenRecordset(cSQL)
        
        If Not rsRs2.EOF Then
            rsRs2.MoveFirst
            Do While Not rsRs2.EOF
                If Not IsNull(rsRs2!artnr) Then
                    cArtNr = rsRs2!artnr
                Else
                    cArtNr = "-1"
                End If
                rsrs.Seek "=", cArtNr
                If Not rsrs.NoMatch Then
                    rsrs.Edit
                    rsrs!INBEST = rsRs2!INBEST
                    rsrs.Update
                End If
                
                rsRs2.MoveNext
            Loop
        End If
        rsrs.Close: Set rsrs = Nothing
        rsRs2.Close: Set rsRs2 = Nothing: Set rsRs2 = Nothing
        
        txtStatus.Text = "25"
                
        cLfdJahr = Year(Now)
        cLfdMonat = Month(Now)
    
        
        Dim sSQL2 As String
        Dim sSQL3 As String
       
        cSQL = "Select * from VORSCHLZ"
        Set rsrs1 = gdApp.OpenRecordset(cSQL)
        If Not rsrs1.EOF Then
        
            rsrs1.MoveLast
            lMax = rsrs1.RecordCount
            txtStatus.Text = "0"
            siAnzeige = 0
        
        
            rsrs1.MoveFirst
            Do While Not rsrs1.EOF
            
            
                siAnzeige = siAnzeige + 1
                txtStatus.Text = CStr((100 * siAnzeige) / lMax)
            
            
                If Not IsNull(rsrs1!artnr) Then
                    cArtNr = rsrs1!artnr
                Else
                    cArtNr = ""
                End If
                
                cLfdJahr = Year(Now)
                cLfdMonat = Month(Now)
                
                 rsrs1.Edit
                
                '** Verkäufe laufendes Jahr einlesen **
                sSQL3 = "select * from UMSARTJ where ARTNR = " & cArtNr
                sSQL3 = sSQL3 & " and  JAHR = " & cLfdJahr
                Set rsrs = gdBase.OpenRecordset(sSQL3)
                
                If Not rsrs.EOF Then
'                    rsrs1.Edit
                    rsrs1!VKLJ1 = rsrs!ANZAHLJ
                Else
'                    rsrs1.Edit
                    rsrs1!VKLJ1 = 0
                End If
                rsrs.Close: Set rsrs = Nothing
                
                '** Verkäufe laufender Monat einlesen **
                
                sSQL2 = "select * from UMS_ART where ARTNR = " & cArtNr
                sSQL2 = sSQL2 & " and  JAHR = " & cLfdJahr
                sSQL2 = sSQL2 & " and  MONAT = " & cLfdMonat
                Set rsRs2 = gdBase.OpenRecordset(sSQL2)
                If Not rsRs2.EOF Then
                    rsrs1!VKAMo1 = rsRs2!ANZAHL
                Else
                    rsrs1!VKAMo1 = 0
                End If
                rsRs2.Close: Set rsRs2 = Nothing: Set rsRs2 = Nothing
                
                
                
                cLfdJahr = Year(Now)
                cLfdMonat = Month(Now)
                cLfdMonat = Trim$(Str$(((Val(cLfdMonat)) - 1)))
                If cLfdMonat = "0" Then
                    cLfdMonat = "12"
                    cLfdJahr = Trim$(Str$(((Val(cLfdJahr)) - 1)))
                End If
                '** Verkäufe Vor-Monat einlesen **
                
                sSQL2 = "select * from UMS_ART where ARTNR = " & cArtNr
                sSQL2 = sSQL2 & " and  JAHR = " & cLfdJahr
                sSQL2 = sSQL2 & " and  MONAT = " & cLfdMonat
                Set rsRs2 = gdBase.OpenRecordset(sSQL2)
    
                If Not rsRs2.EOF Then
                    rsrs1!VKVMO1 = rsRs2!ANZAHL
                Else
                    rsrs1!VKVMO1 = 0
                End If
                rsRs2.Close: Set rsRs2 = Nothing: Set rsRs2 = Nothing
    
                cLfdJahr = Year(Now)
                cLfdJahr = Trim$(Str$(((Val(cLfdJahr)) - 1)))
                '** Verkäufe Vor-Jahr einlesen **
                
                sSQL3 = "select * from UMSARTJ where ARTNR = " & cArtNr
                sSQL3 = sSQL3 & " and  JAHR = " & cLfdJahr
                Set rsrs = gdBase.OpenRecordset(sSQL3)
                
                If Not rsrs.EOF Then
                    rsrs1!VKVJ1 = rsrs!ANZAHLJ
                Else
                    rsrs1!VKVJ1 = 0
                End If
                rsrs.Close: Set rsrs = Nothing
                
                rsrs1.Update
                rsrs1.MoveNext
            Loop
            
        End If
        rsrs1.Close: Set rsrs1 = Nothing
        
        txtStatus.Text = "31"
        '********** GraphFüllenWKL43 ************
        
        If Check2.value = vbChecked Then
            'mit KollegenVerkauf
            GraphFuellenWKL43 Bilde_Umsatz_plusKollVK(cLinr)
        Else
            GraphFuellenWKL43 "UMS_ART"
        End If
        
        txtStatus.Text = "35"
        
        If Text1(5).Visible = False Then
            FaktorBerechnungWKL43
            
            If UeberlaufFehler Then
                Screen.MousePointer = 0
                
                Exit Sub
            End If
        Else  '*** MaskEdBox1.Visible = True ***
            
            Set rsrs1 = gdApp.OpenRecordset("VORSCHLZ", dbOpenTable)
            rsrs1.index = "ARTNR"
            
            cSQL = "Select ARTNR , SUM(MENGE) as VKVMO1 "
            cSQL = cSQL & " from KASSJOUR"
            cSQL = cSQL & " where ADATE BETWEEN " & Trim$(Str$(lDatVon))
            cSQL = cSQL & " and " & Trim$(Str$(lDatBis))
            cSQL = cSQL & " group by ARTNR"
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                Do While Not rsrs.EOF
                    If Not IsNull(rsrs!artnr) Then
                        cArtNr = rsrs!artnr
                    Else
                        cArtNr = ""
                    End If
                    
                    rsrs1.Seek "=", cArtNr
                    If Not rsrs1.NoMatch Then
                        rsrs1.Edit
                        rsrs1!VKVMO1 = rsrs!VKVMO1
                        rsrs1.Update
                    End If
                    
                    rsrs.MoveNext
                Loop
                
            End If
            rsrs.Close: Set rsrs = Nothing
            rsrs1.Close: Set rsrs1 = Nothing
            
            If Check2.value = vbChecked Then
            
                Set rsrs1 = gdApp.OpenRecordset("VORSCHLZ", dbOpenTable)
                rsrs1.index = "ARTNR"
                
                cSQL = "Select ARTNR , SUM(MENGE) as VKVMO1 "
                cSQL = cSQL & " from KOLLVERK"
                cSQL = cSQL & " where ADATE BETWEEN " & Trim$(Str$(lDatVon))
                cSQL = cSQL & " and " & Trim$(Str$(lDatBis))
                cSQL = cSQL & " group by ARTNR"
                Set rsrs = gdBase.OpenRecordset(cSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveFirst
                    Do While Not rsrs.EOF
                        If Not IsNull(rsrs!artnr) Then
                            cArtNr = rsrs!artnr
                        Else
                            cArtNr = ""
                        End If
                        
                        rsrs1.Seek "=", cArtNr
                        If Not rsrs1.NoMatch Then
                            rsrs1.Edit
                            rsrs1!VKVMO1 = rsrs1!VKVMO1 + rsrs!VKVMO1
                            rsrs1.Update
                        End If
                        
                        rsrs.MoveNext
                    Loop
                    
                End If
                rsrs.Close: Set rsrs = Nothing
                rsrs1.Close: Set rsrs1 = Nothing
            End If
            
            cSQL = "Select * from VORSCHLZ where VKVMo1 > 0 "
            Set rsrs = gdApp.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                Do While Not rsrs.EOF
                    If Not IsNull(rsrs!VKVMO1) Then
                        lMengeVor = rsrs!VKVMO1
                    Else
                        lMengeVor = 0
                    End If
                    rsrs.Edit
                    dMengeTag = lMengeVor / lDatDiff
                    rsrs!Faktor = (Fix(dMengeTag * 100000)) / 100000
                    rsrs.Update
                    rsrs.MoveNext
                Loop
            End If
            rsrs.Close: Set rsrs = Nothing
        End If
        
        txtStatus.Text = "39"
        
        If Text1(3).Visible Then
            lEindeckung = Text1(3).Text
            ctmp = Text1(4).Text
            ctmp = fnMoveComma2Point$(ctmp)
            dFaktor = Val(ctmp)
        End If
        
        cSQL = "Select ARTNR, FAKTOR, BESTAND, MINMEN, MINBEST, BESTVOR "
        cSQL = cSQL & " from VORSCHLZ"
        Set rsrs = gdApp.OpenRecordset(cSQL)
        If Not rsrs.EOF Then
            rsrs.MoveFirst
            i = 1
            Do While Not rsrs.EOF
                If IsNull(rsrs!artnr) Then
                Else
    '
                    cArtNr = rsrs!artnr
                    If cArtNr = 300101 Then
                        cArtNr = cArtNr
                    End If
                    
'                    If cArtNr = 316159 Then
'                        MsgBox "yeah"
'                    End If
                End If
                If IsNull(rsrs!Faktor) Then
                    dMenge = 0
                Else
                    If rsrs!Faktor > 0 Then
                        dMenge = rsrs!Faktor
                    Else
                        dMenge = 0
                    End If
                End If
                
                If IsNull(rsrs!BESTAND) Then
                    lBestand = 0
                Else
                    lBestand = rsrs!BESTAND
                    If lBestand < 0 Then
                        lBestand = 0
                    End If
                End If
                
                If IsNull(rsrs!MINMEN) Then
                    lMinMen = 0
                Else
                    lMinMen = rsrs!MINMEN
                End If
                
                If IsNull(rsrs!MINBEST) Then
                    lMinBest = 0
                Else
                    lMinBest = rsrs!MINBEST
                End If
                
                If Check1.value = vbUnchecked Then
                    dBestellung = dMenge * ((lEindeckung * 7) * dFaktor)
                    
                    If bMinBest Then
                        lBestand = lBestand - lMinBest
                    End If
                    
                    dBestellung = dBestellung - lBestand
                    If dBestellung > 0 Then
                        If Not IsNull(rsrs!MINMEN) Then
                            dMindest = rsrs!MINMEN
                        Else
                            dMindest = 1
                        End If
                        If dMindest = 0 Then
                            dMindest = 1
                        End If
                    Else
                        dBestellung = 0
                        dMindest = 1
                    End If
    
                    dBestellung = dBestellung / dMindest
                    If dBestellung <> Fix(dBestellung) Then
                        dBestellung = Fix(dBestellung) + 1
                    End If
                    dBestellung = dBestellung * dMindest
                Else '** Check1.Value = vbchecked
                    If Not IsNull(rsrs!MINMEN) Then
                        dMindest = rsrs!MINMEN
                    Else
                        dMindest = 0
                    End If
                    If dMindest = 0 Then
                        dMindest = 1
                    End If
                   
                    cSQL3 = "Select MINBEST from ARTIKEL "
                    cSQL3 = cSQL3 & " where ARTNR = " & cArtNr
                    Set rsRs3 = gdBase.OpenRecordset(cSQL3)
                    If Not rsRs3.EOF Then
                        If Not IsNull(rsRs3!MINBEST) Then
                            iTmp = rsRs3!MINBEST
                        Else
                            iTmp = 0
                        End If
                    End If
                    rsRs3.Close: Set rsRs3 = Nothing
                    
                    '** dBestellung = lMinBest - lBestand **
                    dBestellung = iTmp - CInt(lBestand)
                    If dBestellung < 0 Then
                        dBestellung = 0
                    End If
                    dBestellung = dBestellung / dMindest
                    If dBestellung <> Fix(dBestellung) Then
                        dBestellung = Fix(dBestellung) + 1
                    End If
                    dBestellung = dBestellung * dMindest
                End If
                rsrs.Edit
                rsrs!BESTVOR = dBestellung
                rsrs!MINBEST = iTmp
                rsrs.Update
                i = i + 1
                rsrs.MoveNext
            Loop
        End If
        rsrs.Close: Set rsrs = Nothing
        
        txtStatus.Text = "42"
        
        cSQL = "Update VORSCHLZ set BESTVOR = BESTVOR - INBEST"
        gdApp.Execute cSQL, dbFailOnError
        
        txtStatus.Text = "45"
        
        cSQL = "Update VORSCHLZ set BESTVOR = 0 where BESTVOR < 0"
        gdApp.Execute cSQL, dbFailOnError
        
        
        
        'Bestimmte Farbe BVO =0
        If sFarbe1 <> "" Then
            cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe1 & "'"
            gdApp.Execute cSQL, dbFailOnError
        End If
        
        If sFarbe2 <> "" Then
            cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe2 & "'"
            gdApp.Execute cSQL, dbFailOnError
        End If
        
        If sFarbe3 <> "" Then
            cSQL = "Update VORSCHLZ set BESTVOR = 0 where AWM = '" & sFarbe3 & "'"
            gdApp.Execute cSQL, dbFailOnError
        End If
            
        
        'hier Test
        If Check17.value = vbChecked Then
            cSQL = "Delete from vorschlz where bestvor is null or bestvor=0"
            gdApp.Execute cSQL, dbFailOnError
        End If
        'Ende Test
        
        txtStatus.Text = "46"
        
        cSQL = "Update VORSCHLZ set ANZEIGE = 1 where BESTVOR <> 0 or BESTAND <> 0 or FAKTOR <> 0 "
        gdApp.Execute cSQL, dbFailOnError
        txtStatus.Text = "47"
        
        cSQL = "Update VORSCHLZ set AWM = '0' where AWM = '99' "  'löschen der "Artikel anfügen" Farbe
        gdApp.Execute cSQL, dbFailOnError
        txtStatus.Text = "48"
        
        lbl6(0).Caption = "1"
        lbl6(1).Caption = "2"
        
        If Check10.value = vbChecked Then
        
            sAccPfad = App.Path & "\kissapp.mdb"
            loeschNEW "ARTIKEL", gdApp
            TransferTab gdBase, sAccPfad, "ARTIKEL"
        
            cSQL = "Update BestEver set bvo = 0 "
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Update BestEver b inner join VORSCHLZ v on b.artnr = v.artnr set b.bvo = v.bestvor where v.bestvor > 0"
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Delete from BestEver where bvo = 0"
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Update BestEver b inner join artikel a on b.artnr = a.artnr "
            cSQL = cSQL & " set b.bezeich = a.bezeich "
            cSQL = cSQL & " , b.ean = a.ean "
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Update BestEver set Ersparnis_E = LEKPR_TEUER - LEKPR "
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Update BestEver set Ersparnis_KUM = Ersparnis_E * BVO "
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Delete from VORSCHLZ where artnr in (select artnr from BestEver)"
            gdApp.Execute cSQL, dbFailOnError
            
            sAccPfad = App.Path & "\kissapp.mdb"
            loeschNEW "LISRT", gdApp
            TransferTab gdBase, sAccPfad, "LISRT"
            
            cSQL = "Update BestEver set LINR_TEUER = " & cLinr
            gdApp.Execute cSQL, dbFailOnError
            
            cSQL = "Update BestEver b inner join LISRT l on b.LINR_TEUER = l.LINR "
            cSQL = cSQL & " set b.LIEFBEZ_TEUER = l.LIEFBEZ "
            cSQL = cSQL & " , b.KUERZEL_TEUER = l.KUERZEL "
            gdApp.Execute cSQL, dbFailOnError
            
            reportbildschirmApp "", "aWKL43d"
            
        End If
        
        Handelsspanne_rechnen
        
        updatesorti
        
        zeige_Grid True
        
    Else
    
        sAccPfad = App.Path & "\kissapp.mdb"
    
        loeschNEW "INTERART", gdApp
        TransferTab gdBase, sAccPfad, "INTERART"
        
        loeschNEW "KONTIN", gdApp
        TransferTab gdBase, sAccPfad, "KONTIN"
        
        loeschNEW "ARTFARB2", gdApp
        TransferTab gdBase, sAccPfad, "ARTFARB2"
        
        loeschNEW "ARTMERK", gdApp
        TransferTab gdBase, sAccPfad, "ARTMERK"
        
        loeschNEW "LINBEZ", gdApp
        TransferTab gdBase, sAccPfad, "LINBEZ"
    
        updatesorti
        
        zeige_Grid True
    
    End If
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ErstelleBestellVORSCHLZZENaa"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    Resume Next

End Sub
Private Sub ermittlespalten()
    On Error GoTo LOKAL_ERROR
    
    Dim i As Integer

    For i = 0 To byAnzahlSpalten
        Select Case UCase$(sSpaltenbez(i))
            Case Is = "ARTNR"
                SpaltennummerArtnr = i
            Case Is = "BEZEICH"
                SpaltennummerBEZEICH = i
            Case Is = "MINMEN"
                SpaltennummerMINMEN = i
            Case Is = "MINBEST"
                SpaltennummerMINBEST = i
            Case Is = "BESTAND"
                SpaltennummerBESTAND = i
            Case Is = "BESTVOR"
                SpaltennummerBESTVOR = i
            Case Is = "AWM"
                SpaltennummerAWM = i
            Case Is = "AWM2"
                SpaltennummerAWM2 = i
            Case Is = "EAN"
                SpaltennummerEAN = i
            Case Is = "NOTIZEN"
                SpaltennummerNOTIZEN = i
            Case Is = "KVKPR1"
                SpaltennummerKVKPR = i
            Case Is = "VKPR"
                SpaltennummerVKPR = i
            Case Is = "RAB"
                SpaltennummerRab = i
            Case Is = "RKZ"
                SpaltennummerRKZ = i
            Case Is = "INBEST"
                SpaltennummerInBe = i
            Case Is = "BESTVOR_NR"
                SpaltennummerBESTVOR_NR = i
            Case Is = "BESTVOR_PROBEN"
                SpaltennummerBESTVOR_PROBEN = i
            Case Is = "BESTVOR_TESTER"
                SpaltennummerBESTVOR_TESTER = i
        End Select
    Next i
    
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ermittlespalten"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten."

    Fehlermeldung1
End Sub
Private Sub Tabellenbreiteanpassen(gridx As MSFlexGrid, siEigFak As Single)
    On Error GoTo LOKAL_ERROR
    
    Dim siFak       As Single
    Dim bBreit()    As Integer
    Dim i           As Integer
    Dim j           As Integer
    
    With gridx
    
        ReDim bBreit(.Cols - 1)
        
        For j = 0 To .Rows - 1
            For i = 0 To .Cols - 1
                If TextWidth(.TextMatrix(j, i)) > bBreit(i) Then
                    bBreit(i) = TextWidth(.TextMatrix(j, i))
                End If
            Next i
        Next j
        
        
        Select Case Screen.Height
            Case Is > 15000
                siFak = 1.5
            Case Is > 12000
                siFak = 1.4
            Case Is > 11000
                siFak = 1.2
            Case Is > 10000
                siFak = 1.1
            Case Is > 8000
                siFak = 1#
        End Select
        
        For i = 0 To .Cols - 1
            .ColWidth(i) = bBreit(i) * siFak * siEigFak
        Next i
    
    End With
    
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "Tabellenbreiteanpassen"
    Fehler.gsFehlertext = "Bei Anpassen der Tabellenbreite ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub FaerbeBVOwegenKU(gridx As MSFlexGrid, spaltebestvor As Byte, spalteartnr As Byte, bMitErhoehung As Boolean)
    On Error GoTo LOKAL_ERROR

    Dim j           As Integer
    Dim lfakt       As Long
    Dim sierg       As Single
    Dim sArtnr      As String
    
    
    With gridx
        
        For j = 1 To .Rows - 1
            .Row = j
            .Col = spalteartnr
            sArtnr = .Text
            
            lfakt = ermKUBMENGE(sArtnr)
            
            If lfakt > 0 Then
                .Col = spaltebestvor
                
                If bMitErhoehung = True Then
                    .CellBackColor = &HFF00FF
                    .Text = .Text + lfakt
                Else
                    .CellBackColor = &HFF00FF
                End If
            
                bestvor_zwischenspeichern sArtnr, .Text
            Else
                .Col = spaltebestvor
                .CellBackColor = vbGreen
                
                If Val(.Text) > 0 Then
                    .CellFontBold = True
                Else
                    .CellFontBold = False
                End If
            End If
        Next j
    End With
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "FaerbeBVOwegenKU"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub RechneRab(gridx As MSFlexGrid, spalteRab As Byte, spalteKVK As Byte, spalteLVK As Byte)
    On Error GoTo LOKAL_ERROR

    Dim j           As Integer
    Dim siKVK       As Double
    Dim siLVK       As Double
    Dim siRab       As Double
    
    With gridx
        
        For j = 1 To .Rows - 1
            .Row = j
            
            .Col = spalteKVK
            If IsNumeric(.Text) Then
                siKVK = CDbl(.Text)
            Else
                siKVK = 0
            End If
            
            .Col = spalteLVK
            If IsNumeric(.Text) Then
                siLVK = CDbl(.Text)
            Else
                siLVK = 0
            End If
            
            If siLVK > 0 Then
                siRab = 100 - ((siKVK * 100) / siLVK)
            End If
            
            
            .Col = spalteRab
            .Text = Format(siRab, "##0")
        Next j
    End With
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "RechneRab"
    Fehler.gsFehlertext = "Im Programmteil Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub FaerbeBVOwegenKondi(gridx As MSFlexGrid, spaltebestvor As Byte, spalteartnr As Byte, iKondieinhaltung As Integer, spalteNATRAB As Byte)
    On Error GoTo LOKAL_ERROR

    Dim i           As Integer
    Dim j           As Integer
    Dim k As Integer
    Dim lcount              As Long
    Dim iBVOvorher          As Integer
    Dim siKondiErfüllung    As Single
    Dim iKondi100           As Integer
    Dim iBIGKondi100        As Integer
    Dim sArtnr              As String
    Dim siErf               As Single
    Dim lplus               As Long
    Dim iNewBVO             As Integer
    Dim iNatRab             As Integer
    Dim rsrs                As Recordset
    Dim sSQL As String
    
    With gridx
        
        For j = 1 To .Rows - 1
            .Row = j
            .Col = spalteartnr
            sArtnr = .Text
            
            .Col = spaltebestvor
            If .Text <> "" Then
                iBVOvorher = .Text
                
                iNewBVO = 0
                iNatRab = 0
                
                sSQL = "Select KONDI from KONDITIONEN where artnr = " & sArtnr
                sSQL = sSQL & " order by Kondi desc "
                Set rsrs = gdBase.OpenRecordset(sSQL)
                If Not rsrs.EOF Then
                    rsrs.MoveLast
                    lcount = rsrs.RecordCount
                    rsrs.MoveFirst
                    If lcount = 1 Then
                        If Not IsNull(rsrs!kondi) Then
                            iKondi100 = rsrs!kondi
                            iBIGKondi100 = rsrs!kondi
                            Do While iBIGKondi100 < iBVOvorher
                                iBIGKondi100 = iBIGKondi100 + iKondi100
                            Loop
                            
                            siKondiErfüllung = (iBIGKondi100 * iKondieinhaltung) / 100
                            If iBVOvorher > siKondiErfüllung Then
                                'raus und auf Kondi100 setzen
                                iNewBVO = iBIGKondi100
                                iNatRab = iNewBVO / iKondi100
                            End If
                            
                        End If
                    
                    Else
                    
                        Do While Not rsrs.EOF
                            If Not IsNull(rsrs!kondi) Then
                                iKondi100 = rsrs!kondi
                                If iBVOvorher < iKondi100 Then
                                    siKondiErfüllung = (iKondi100 * iKondieinhaltung) / 100
                                    If iBVOvorher > siKondiErfüllung Then
                                        'raus und auf Kondi100 setzen
                                        iNewBVO = iKondi100
                                        iNatRab = iNewBVO / iKondi100
                                        Exit Do
                                    End If
                                End If
                            End If
                        rsrs.MoveNext
                        Loop
                    End If
                End If
                rsrs.Close: Set rsrs = Nothing
            End If
            
            If iNewBVO > 0 Then
            
                'Farbe setzen
                .Col = spaltebestvor
                
                If .CellBackColor = &HFF00FF Then 'nur Kundi
                    .CellBackColor = &HFFFF00    'Kondi + Kundi
                Else
                    .CellBackColor = &H80C0FF 'Kondi nur
                End If
                
                .Text = iNewBVO
                bestvor_zwischenspeichern sArtnr, .Text
             
                If Val(.Text) > 0 Then
                    .CellFontBold = True
                Else
                    .CellFontBold = False
                End If
                
                If iNatRab > 0 Then

                   'NatRab setzen
                   .Col = spalteNATRAB
                   
                   .Text = iNatRab
                   nr_zwischenspeichern sArtnr, .Text
                
                End If
                
                
                
                
                
                

            Else
                .Col = spaltebestvor
                If .CellBackColor = &HFF00FF Then 'nur Kundi

                Else
                    .CellBackColor = vbGreen
                End If

                If Val(.Text) > 0 Then
                    .CellFontBold = True
                Else
                    .CellFontBold = False
                End If
            End If
        Next j
    
    End With
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "FaerbeBVOwegenKondi"
    Fehler.gsFehlertext = "Bei Anpassen der Tabellenbreite ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    Resume Next
End Sub
Private Sub FaerbeBestvor(gridx As MSFlexGrid, spaltebestvor As Byte, spalteartnr As Byte)
    On Error GoTo LOKAL_ERROR

    Dim j           As Integer
    Dim lfakt       As Long
    Dim sierg       As Single
    Dim sArtnr      As String
    
    
    With gridx
        .Redraw = False
        For j = 1 To .Rows - 1
            .Row = j
            .Col = spalteartnr
            sArtnr = .Text
            lfakt = ermfak(sArtnr)
            If lfakt > 0 Then
                .Col = spaltebestvor
                If .CellBackColor = &HFF00FF Then 'nur Kundi
                    .CellBackColor = &H808000
                ElseIf .CellBackColor = &HFFFF00 Then    'Kondi + Kundi
                    .CellBackColor = &HC0C0FF
                ElseIf .CellBackColor = &H80C0FF Then 'Kondi nur
                    .CellBackColor = &HFFC0C0
                Else
                    .CellBackColor = vbYellow
                End If
                
                If Val(.Text) > 0 Then
                    If Val(.Text) < lfakt Then
                        .Text = lfakt
                        bestvor_zwischenspeichern sArtnr, .Text
                    ElseIf Val(.Text) > lfakt Then
                        sierg = Round(Val(.Text) / lfakt, 0)
                        .Text = CStr(Val(lfakt * sierg))
                        bestvor_zwischenspeichern sArtnr, .Text
                    End If
                    
                    
                    If Val(.Text) > 0 Then
                        .CellFontBold = True
                    Else
                        .CellFontBold = False
                    End If
                End If
                
                
                
            Else
                .Col = spaltebestvor
                
                If .CellBackColor = &HFF00FF Then 'nur Kundi
                    
                ElseIf .CellBackColor = &HFFFF00 Then    'Kondi + Kundi
                    
                ElseIf .CellBackColor = &H80C0FF Then 'Kondi nur
                
                Else
                    .CellBackColor = vbGreen
                End If
                
                If Val(.Text) > 0 Then
                    .CellFontBold = True
                Else
                    .CellFontBold = False
                End If
                
                
                
                
                
            End If
            
            
            
        Next j
        .Redraw = True
    End With
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "FaerbeBestvor"
    Fehler.gsFehlertext = "Bei Anpassen der Tabellenbreite ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub FaerbePlus(gridx As MSFlexGrid, spalteartnr As Byte)
    On Error GoTo LOKAL_ERROR

    Dim j           As Integer
    Dim lfakt       As Long
    Dim sierg       As Single
    Dim sArtnr      As String
    Dim lcolor      As Long
    Dim lcolor1     As Long
    
    With gridx
        
        For j = 1 To .Rows - 1
            .Row = j
            .Col = spalteartnr
            lcolor1 = .CellForeColor
            lcolor = .CellBackColor
            .Col = .Col + 1
            .CellBackColor = lcolor
            .CellForeColor = lcolor1
'            .Col = .Col + 1
'            .CellBackColor = lcolor
        Next j
    
    End With
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "FaerbePlus"
    Fehler.gsFehlertext = "Bei Anpassen der Tabellenbreite ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub FaerbePlus2(gridx As MSFlexGrid, spalteartnr As Byte, j As Integer)
    On Error GoTo LOKAL_ERROR

    Dim lfakt       As Long
    Dim sierg       As Single
    Dim sArtnr      As String
    Dim lcolor      As Long
    Dim lcolor1     As Long
    
    With gridx
    
     .Row = j
     .Col = spalteartnr
     
     lcolor1 = .CellForeColor
     lcolor = .CellBackColor
     .Col = .Col + 1
     .CellBackColor = lcolor
     .CellForeColor = lcolor1
     
    End With
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = "Modul1"
    Fehler.gsFunktion = "FaerbePlus2"
    Fehler.gsFehlertext = "Bei Anpassen der Tabellenbreite ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub MSFlexGrid2_KeyPress(KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    Dim lcol As Long
    Dim lrow As Long
    
    lcol = MSFlexGrid2.Col
    lrow = MSFlexGrid2.Row
    
    lbl6(0).Caption = lrow
    
    cZeichen = Chr$(KeyAscii)
    
    Select Case lcol
         Case Is = SpaltennummerBESTAND
            If Check14.value = vbUnchecked Then 'Bestandsveränderung erlaubt
                gbAenderBEST = True
                cValid = "1234567890-" & Chr$(8)
                If InStr(cValid, cZeichen) = 0 Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    MSFlexGrid2.Row = lrow
                    MSFlexGrid2.Col = lcol
                    cValid = MSFlexGrid2.Text
                    If InStr(cValid, ",") > 0 And cZeichen = "," Then
                        KeyAscii = 0
                    End If
                    
                    If KeyAscii <> 0 Then
                        If KeyAscii <> 8 Then
                            If Len(cValid) > 3 Then
                            
                            Else
                                cValid = cValid & Chr$(KeyAscii)
                            End If
                        Else
                            If Len(cValid) > 0 Then
                                cValid = Left$(cValid, Len(cValid) - 1)
                            End If
                        End If
                        MSFlexGrid2.Text = cValid
                    End If
                End If
            End If
        Case Is = SpaltennummerMINBEST
            gbAenderMINBEST = True
            cValid = "1234567890-" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        If Len(cValid) > 3 Then
                        
                        Else
                            cValid = cValid & Chr$(KeyAscii)
                        End If
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
                

            End If
    
        Case Is = SpaltennummerMINMEN
            gbAenderMINMEN = True
            cValid = "1234567890-" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        If Len(cValid) > 3 Then
                        
                        Else
                            cValid = cValid & Chr$(KeyAscii)
                        End If
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
                

            End If
        Case Is = SpaltennummerRKZ
            gbAenderRKZ = True
            cValid = "JNjn" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        cValid = cValid & Chr$(KeyAscii)
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
            End If
        Case Is = SpaltennummerAWM
            gbAenderAWM = True
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        cValid = cValid & Chr$(KeyAscii)
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
            End If
            
        Case Is = SpaltennummerAWM2
            gbAenderAWM2 = True
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        cValid = cValid & Chr$(KeyAscii)
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
            End If
            
        Case Is = SpaltennummerNOTIZEN
            gbAenderNOTIZEN = True
            
            cValid = gcUPPER & gcLower & gcNUM & Chr$(8) & Chr$(32) & Chr(42) 'Leer *
            cValid = cValid & Chr(38) & Chr(45) & Chr(46) '& - .
            cValid = cValid & "+äÄÜüÖöß"

            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        If Len(cValid) > 24 Then
                        
                        Else
                            cValid = cValid & Chr$(KeyAscii)
                        End If
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = UCase(cValid)
                End If
            End If
            
        Case Is = SpaltennummerBESTVOR_NR
            gbAenderNR = True
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        cValid = cValid & Chr$(KeyAscii)
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
            End If
            
        Case Is = SpaltennummerBESTVOR_TESTER
            gbAenderTESTER = True
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        cValid = cValid & Chr$(KeyAscii)
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
            End If
            
        Case Is = SpaltennummerBESTVOR_PROBEN
            gbAenderPROBEN = True
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        cValid = cValid & Chr$(KeyAscii)
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    MSFlexGrid2.Text = cValid
                End If
            End If
    
    
    
        Case Is = SpaltennummerBESTVOR
        
            Dim lFaktor As Long
            
            lFaktor = ermfak(MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr))
            
            gbAender = True
            
            
            cValid = "1234567890" & Chr$(8)
            If InStr(cValid, cZeichen) = 0 Then
                KeyAscii = 0
            End If
            
            If cZeichen = "+" Then
                If lFaktor > 0 Then
                    MSFlexGrid2.Text = Val(MSFlexGrid2.Text) + lFaktor
                Else
                    MSFlexGrid2.Text = Val(MSFlexGrid2.Text) + Val(MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerMINMEN))
'                    MSFlexGrid2.Text = Val(MSFlexGrid2.Text) + 1
                End If
            End If
            
            If cZeichen = "-" Then
            
                MSFlexGrid2.Col = lcol
                MSFlexGrid2.Row = lrow
                If Val(MSFlexGrid2.Text) > 0 Then
                    If lFaktor > 0 Then

                        MSFlexGrid2.Text = Val(MSFlexGrid2.Text) - lFaktor
                    Else
                        MSFlexGrid2.Text = Val(MSFlexGrid2.Text) - Val(MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerMINMEN))
'                        MSFlexGrid2.Text = Val(MSFlexGrid2.Text) - 1
                    
                    End If
                Else
                    MSFlexGrid2.Text = "0"
                End If
            End If
            
            If KeyAscii <> 0 Then
                MSFlexGrid2.Row = lrow
                MSFlexGrid2.Col = lcol
                cValid = MSFlexGrid2.Text
                If InStr(cValid, ",") > 0 And cZeichen = "," Then
                    KeyAscii = 0
                End If
                
                If KeyAscii <> 0 Then
                    If KeyAscii <> 8 Then
                        cValid = cValid & Chr$(KeyAscii)
                    Else
                        If Len(cValid) > 0 Then
                            cValid = Left$(cValid, Len(cValid) - 1)
                        End If
                    End If
                    
                    If lFaktor > 0 Then
                        If cZeichen = "0" Then
                            MSFlexGrid2.Text = "0"
                        Else
                            MSFlexGrid2.Text = lFaktor
                        End If
                    Else
                        MSFlexGrid2.Text = cValid
                    End If
                    
                End If
                
        End If
    
    End Select
     
   
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFlexGrid2_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil  Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub

Private Sub MSFlexGrid2_LostFocus()
    On Error GoTo LOKAL_ERROR
    
    MSFlexGrid2_LeaveCell
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFlexGrid2_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil  Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Sub MSFlexGrid2_LeaveCell()
    On Error GoTo LOKAL_ERROR
    
    iKeypress = 0

    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFlexGrid2_LeaveCell"
    Fehler.gsFehlertext = "Im Programmteil  Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
    
End Sub
Private Sub MSFlexGrid2_KeyUp(KeyCode As Integer, Shift As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim lrow As Long
    
    MSFlexGrid2.Redraw = False

    If KeyCode = vbKeyF2 Then
        lrow = MSFlexGrid2.Row
        gsARTNR = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
        If gsARTNR <> "" Then

            frmWKL10.Show 1
            Me.Refresh
            Screen.MousePointer = 11
            MSFlexGrid2.Col = SpaltennummerBESTVOR
            MSFlexGrid2.Row = lrow
            MSFlexGrid2.TopRow = lrow
            MSFlexGrid2.SetFocus
            Screen.MousePointer = 0
        End If
        gsARTNR = ""
    End If
    
    If KeyCode = vbKeyF3 Then
        lrow = MSFlexGrid2.Row
        gcArtNrFiliale = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
        If gcArtNrFiliale <> "" Then
            frmWKLae.Show 1
            Me.Refresh
            Screen.MousePointer = 11
            MSFlexGrid2.Col = SpaltennummerBESTVOR
            MSFlexGrid2.Row = lrow
            MSFlexGrid2.TopRow = lrow
            MSFlexGrid2.SetFocus
            
            Screen.MousePointer = 0
        End If
        gcArtNrFiliale = ""
    End If
    
    'Notizen
    If KeyCode = vbKeyF4 Then
        lrow = MSFlexGrid2.Row
        gsARTNR = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
        If gsARTNR <> "" Then
            gsArtNot = gsARTNR
            gsArtNotBez = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerBEZEICH)
            frmWKL111.Show 1
            Me.Refresh
            Screen.MousePointer = 11
            MSFlexGrid2.Col = SpaltennummerBESTVOR
            MSFlexGrid2.Row = lrow
            MSFlexGrid2.TopRow = lrow
            MSFlexGrid2.SetFocus
            
            Screen.MousePointer = 0
        End If
        gsARTNR = ""
    End If
    
    'Verkaufshistorie
    If KeyCode = vbKeyF5 Then
        lrow = MSFlexGrid2.Row
        gsARTNR = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
        If gsARTNR <> "" Then

            frmWKL63.Show 1
            Me.Refresh
            Screen.MousePointer = 11
            MSFlexGrid2.Col = SpaltennummerBESTVOR
            MSFlexGrid2.Row = lrow
            MSFlexGrid2.TopRow = lrow
            MSFlexGrid2.SetFocus
            Screen.MousePointer = 0
        End If
        gsARTNR = ""
    End If
    
    'Kundenbestellungen
    If KeyCode = vbKeyF6 Then
        lrow = MSFlexGrid2.Row
        gsARTNR = MSFlexGrid2.TextMatrix(MSFlexGrid2.Row, SpaltennummerArtnr)
        If gsARTNR <> "" Then
            gckundnr = ""
            If IsNumeric(gsARTNR) Then
                frmWKL86.Show 1
            End If
    
            Me.Refresh
            Screen.MousePointer = 11
            MSFlexGrid2.Col = SpaltennummerBESTVOR
            MSFlexGrid2.Row = lrow
            MSFlexGrid2.TopRow = lrow
            MSFlexGrid2.SetFocus
            Screen.MousePointer = 0
        
        End If
        gsARTNR = ""
    End If
    
    MSFlexGrid2.Redraw = True

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "MSFlexGrid2_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1

End Sub
Private Sub BestVorNurDruckenWKL43()
    On Error GoTo LOKAL_ERROR
    
    Dim cDrucker As String
    Dim ctmp     As String
    Dim cSQL     As String
    Dim cPfad    As String
    Dim bReturn  As Boolean
    
    cPfad = gcPfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If

    loeschapp "vorsortz"
    
    cSQL = "Create Table VORSortZ "
    cSQL = cSQL & "( ARTNR Double"
    cSQL = cSQL & ", BEZEICH Text(35)"
    cSQL = cSQL & ", AGN Double"
    cSQL = cSQL & ", LINR Double"
    cSQL = cSQL & ", LIBESNR Text(13)"
    cSQL = cSQL & ", EAN Text(13)"
    cSQL = cSQL & ", RKZ Text(1)"
    cSQL = cSQL & ", LPZ Double"
    cSQL = cSQL & ", AWM Text(2)"
    cSQL = cSQL & ", EKPR Double"
    cSQL = cSQL & ", LEKPR Double"
    cSQL = cSQL & ", VKPR Double"
    cSQL = cSQL & ", KVKPR1 Double"
    cSQL = cSQL & ", MOPREIS Double"
    cSQL = cSQL & ", MINMEN Double"
    cSQL = cSQL & ", MINBEST Long"
    cSQL = cSQL & ", BESTVOR Double"
    cSQL = cSQL & ", FAKTOR Double"
    cSQL = cSQL & ", LPZ_VON Long"
    cSQL = cSQL & ", LPZ_BIS Long"
    cSQL = cSQL & ", EINDECK Long"
    cSQL = cSQL & ", BEVORRAT Double"
    cSQL = cSQL & ", INBEST Long"
    cSQL = cSQL & ", BESTAND Double"
    cSQL = cSQL & ", VKAMo1 Double"
    cSQL = cSQL & ", VKVMo1 Double"
    cSQL = cSQL & ", VKLJ1 Double"
    cSQL = cSQL & ", VKVJ1 Double"
    cSQL = cSQL & ", MITTEILUNG Text(250)"
    cSQL = cSQL & ", ANZEIGE Integer"
    cSQL = cSQL & ", NOTIZEN Text(25)"
    cSQL = cSQL & ", LJ1 Integer"
    cSQL = cSQL & ", LJ2 Integer"
    cSQL = cSQL & ", LJ3 Integer"
    cSQL = cSQL & ", LJ4 Integer"
    cSQL = cSQL & ", LJ5 Integer"
    cSQL = cSQL & ", LJ6 Integer"
    cSQL = cSQL & ", LJ7 Integer"
    cSQL = cSQL & ", LJ8 Integer"
    cSQL = cSQL & ", LJ9 Integer"
    cSQL = cSQL & ", LJ10 Integer"
    cSQL = cSQL & ", LJ11 Integer"
    cSQL = cSQL & ", LJ12 Integer"
    cSQL = cSQL & ", VJ1 Integer"
    cSQL = cSQL & ", VJ2 Integer"
    cSQL = cSQL & ", VJ3 Integer"
    cSQL = cSQL & ", VJ4 Integer"
    cSQL = cSQL & ", VJ5 Integer"
    cSQL = cSQL & ", VJ6 Integer"
    cSQL = cSQL & ", VJ7 Integer"
    cSQL = cSQL & ", VJ8 Integer"
    cSQL = cSQL & ", VJ9 Integer"
    cSQL = cSQL & ", VJ10 Integer"
    cSQL = cSQL & ", VJ11 Integer"
    cSQL = cSQL & ", VJ12 Integer"
    cSQL = cSQL & ", SORT Autoincrement"
    cSQL = cSQL & ", SORTI INTEGER"
    cSQL = cSQL & ") "
    gdApp.Execute cSQL, dbFailOnError
        
    cSQL = "Create Index ARTNR on VORSortZ (ARTNR)"
    gdApp.Execute cSQL, dbFailOnError
    cSQL = "Create Index LINR on VORSortZ (LINR)"
    gdApp.Execute cSQL, dbFailOnError
    cSQL = "Create Index ANZEIGE on VORSortZ (ANZEIGE)"
    gdApp.Execute cSQL, dbFailOnError
    

    cSQL = "Update VORSCHLZ set LPZ_von = 1 where LPZ_VON is null"
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Update VORSCHLZ set LPZ_BIS = 999 where LPZ_BIS is null"
    gdApp.Execute cSQL, dbFailOnError
    
    cSQL = "Insert into VORSortZ select "
    cSQL = cSQL & " ARTNR "
    cSQL = cSQL & ", BEZEICH"
    cSQL = cSQL & ", AGN "
    cSQL = cSQL & ", LINR "
    cSQL = cSQL & ", LIBESNR "
    cSQL = cSQL & ", EAN "
    cSQL = cSQL & ", RKZ "
    cSQL = cSQL & ", LPZ "
    cSQL = cSQL & ", AWM "
    cSQL = cSQL & ", EKPR "
    cSQL = cSQL & ", LEKPR "
    cSQL = cSQL & ", VKPR "
    cSQL = cSQL & ", KVKPR1 "
    cSQL = cSQL & ", MOPREIS "
    cSQL = cSQL & ", MINMEN "
    cSQL = cSQL & ", MINBEST "
    cSQL = cSQL & ", BESTVOR "
    cSQL = cSQL & ", FAKTOR "
    cSQL = cSQL & ", LPZ_VON "
    cSQL = cSQL & ", LPZ_BIS "
    cSQL = cSQL & ", EINDECK "
    cSQL = cSQL & ", BEVORRAT "
    cSQL = cSQL & ", INBEST "
    cSQL = cSQL & ", BESTAND "
    cSQL = cSQL & ", VKAMo1 "
    cSQL = cSQL & ", VKVMo1 "
    cSQL = cSQL & ", VKLJ1 "
    cSQL = cSQL & ", VKVJ1 "
    cSQL = cSQL & ", MITTEILUNG "
    cSQL = cSQL & ", ANZEIGE "
    cSQL = cSQL & ", NOTIZEN "
    cSQL = cSQL & ", LJ1 "
    cSQL = cSQL & ", LJ2 "
    cSQL = cSQL & ", LJ3 "
    cSQL = cSQL & ", LJ4 "
    cSQL = cSQL & ", LJ5 "
    cSQL = cSQL & ", LJ6 "
    cSQL = cSQL & ", LJ7 "
    cSQL = cSQL & ", LJ8 "
    cSQL = cSQL & ", LJ9 "
    cSQL = cSQL & ", LJ10 "
    cSQL = cSQL & ", LJ11 "
    cSQL = cSQL & ", LJ12 "
    cSQL = cSQL & ", VJ1 "
    cSQL = cSQL & ", VJ2 "
    cSQL = cSQL & ", VJ3 "
    cSQL = cSQL & ", VJ4 "
    cSQL = cSQL & ", VJ5 "
    cSQL = cSQL & ", VJ6 "
    cSQL = cSQL & ", VJ7 "
    cSQL = cSQL & ", VJ8 "
    cSQL = cSQL & ", VJ9 "
    cSQL = cSQL & ", VJ10 "
    cSQL = cSQL & ", VJ11 "
    cSQL = cSQL & ", VJ12 "
    cSQL = cSQL & ", SORTI "
    cSQL = cSQL & " from VORSCHLZ "
    
    If Modul6.FindFile(App.Path, "aWKL4bs.rpt") Then
        cSQL = cSQL & " where Bestvor > 0 "
    End If
    
    If Option2(0).value = True Then
        cSQL = cSQL & " order by SORTI,BEZEICH"
    ElseIf Option2(1).value = True Then
        cSQL = cSQL & " order by BEZEICH"
    ElseIf Option2(2).value = True Then
        cSQL = cSQL & " order by LIBESNR"
    ElseIf Option2(3).value = True Then
        cSQL = cSQL & " order by awm desc,SORTI,BEZEICH "
    ElseIf Option2(4).value = True Then
        cSQL = cSQL & " order by bestand asc,BEZEICH "
    ElseIf Option2(5).value = True Then
        cSQL = cSQL & " order by AGN,BEZEICH "
    Else
        cSQL = cSQL & " order by SORTI,BEZEICH"
    End If
    gdApp.Execute cSQL, dbFailOnError
    

    Dim rsrs As DAO.Recordset
    Dim cArtNr As String
    
    cSQL = "Select ARTNR , NOTIZEN from VORSortZ"
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
        
            If Not IsNull(rsrs!artnr) Then
                cArtNr = rsrs!artnr
            Else
                cArtNr = ""
            End If
            
            rsrs.Edit
            rsrs!NOTIZEN = ErmlzVK(cArtNr)
            rsrs.Update
            
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
    If Modul6.FindFile(App.Path, "aWKL4cs.rpt") Then
        reportbildschirmApp "WKL004bG", "aWKL4cs"
    
    ElseIf Modul6.FindFile(App.Path, "aWKL4bs.rpt") Then
        reportbildschirmApp "WKL004bG", "aWKL4bs"
    Else
    
        'Spalten anfügen
        
        If SpalteInTabellegefundenNEW("VORSortZ", "FARBTEXT", gdApp) = False Then
            
            SpalteAnfuegenNEW "VORSortZ", "FARBTEXT", "Text(35)", gdApp
            SpalteAnfuegenNEW "VORSortZ", "FARBwert", "integer", gdApp
            SpalteAnfuegenNEW "VORSortZ", "FARBwertS", "integer", gdApp
            SpalteAnfuegenNEW "VORSortZ", "FARBNR", "integer", gdApp
        End If
        
    
        cSQL = "update VORSortZ set farbnr = Val(AWM) "
        gdApp.Execute cSQL, dbFailOnError
        
        loeschNEW "FARBMERK", gdApp
        TransferTab gdBase, App.Path & "\kissapp.mdb", "FARBMERK"
    
        BringFarbeInsSpiel "VORSortZ", gdApp
        
        reportbildschirmApp "WKL004bG", "aWKL4b"
    End If
    
    
    
    

Exit Sub
LOKAL_ERROR:
    
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BestVorNurDruckenWKL43"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub ErzeugeEDIDateiZENac()
    On Error GoTo LOKAL_ERROR
    
    Dim lRows           As Long
    Dim lCols           As Long
    Dim lColArtNr       As Long
    Dim lColEAN         As Long
    Dim lColBestell     As Long
    Dim lcol            As Long
    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim cSQL            As String
    Dim cFeld           As String
    Dim cArtNr          As String
    Dim cLinr           As String
    Dim cEAN            As String
    Dim cBestMenge      As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim rsrs            As Recordset
    
    cPfad = gcDBPfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad = cPfad & "BESTELL\"
    cPfad = UCase$(cPfad)
    
    cLinr = Command6.Caption
    
    lRows = MSFlexGrid2.Rows
    lCols = MSFlexGrid2.Cols
    
    lColArtNr = SpaltennummerArtnr
    
    Kill cPfad & "BESTELL.TXT"
    
    iFileNr = FreeFile
    Open cPfad & "BESTELL.TXT" For Binary As #iFileNr
    
    cSatz = "@D01" & Space$(16) & "ORDERSD  93A4388449000000" & Space$(22) & "KISS" & Space$(29) & Chr$(13) & Chr$(10)
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "A1  " & gFirma.ILN_1 & " " & gFirma.ILN_2 & " "
    lWert = DateValue(Fix(Now))
    
    cFeld = Format$(Year(lWert + 2), "0000")
    cFeld = cFeld & Format$(Month(lWert + 2), "00")
    cFeld = cFeld & Format$(Day(lWert + 2), "00")
    cSatz = cSatz & cFeld & " "
    cFeld = Format$(Year(lWert), "0000")
    cFeld = cFeld & Format$(Month(lWert), "00")
    cFeld = cFeld & Format$(Day(lWert), "00")
    cSatz = cSatz & cFeld
    cSatz = cSatz & Space$(100 - Len(cSatz)) & Chr$(13) & Chr$(10)
    
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "B1  " & lbl2(0).Caption
    cSatz = cSatz & Space$(98 - Len(cSatz)) & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    

    
    lColEAN = SpaltennummerEAN
    lColBestell = SpaltennummerBESTVOR
    
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = MSFlexGrid2.Text
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        If Val(cBestMenge) > 0 Then
            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.Text
            MSFlexGrid2.Col = lColEAN
            cEAN = MSFlexGrid2.Text
            cEAN = Trim$(cEAN)
            cEAN = cEAN & Space$(13 - Len(cEAN))
            
            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = rsrs!LIBESNR
                Else
                    cLiBesNr = ""
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            cLiBesNr = Trim(cLiBesNr)
            If Len(cLiBesNr) < 7 Then
                cLiBesNr = cLiBesNr & Space$(7 - Len(cLiBesNr))
            Else
                cLiBesNr = Left$(cLiBesNr, 7)
            End If
            
            cSatz = "C1  " & cLiBesNr & " " & cEAN & " " & cBestMenge
            cSatz = cSatz & Space$(100 - Len(cSatz))
            cSatz = cSatz & Chr$(13) & Chr$(10)
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    cSatz = Chr$(26)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    Close iFileNr
    
    MsgBox "Datei 'BESTELL.TXT' in " & cPfad & " erstellt!", vbInformation, "INFO"
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
    
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "ErzeugeEDIDateiZENac"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1

    End If
End Sub
Private Sub TopCosFormat()
    On Error GoTo LOKAL_ERROR
    
    Dim lRows           As Long
    Dim lCols           As Long
    Dim lColArtNr       As Long
    Dim lColEAN         As Long
    Dim lColBestell     As Long
    Dim lcol            As Long
    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim ctemp           As String
    Dim cSQL            As String
    Dim cFeld           As String
    Dim cArtNr          As String
    Dim cLinr           As String
    Dim cEAN            As String
    Dim cBestMenge      As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim rsrs            As Recordset
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad = cPfad & "BESTELL\"
    cPfad = UCase$(cPfad)
    
    cLinr = Command6.Caption
    
    lRows = MSFlexGrid2.Rows
    lCols = MSFlexGrid2.Cols
    
    lColArtNr = SpaltennummerArtnr
    Kill cPfad & "TopCos.TXT"
    
    iFileNr = FreeFile
    Open cPfad & "TopCos.TXT" For Binary As #iFileNr
    
    'Kopfdaten
    
    
    cSatz = "1" & Format(DateValue(Now), "ddmmyy") & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "2" & Trim(sKund) & Chr$(13) & Chr$(10) 'Topcos Kundennummer 4 stellig
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "3" & Trim(sKenn) & Chr$(13) & Chr$(10) 'Topcos Kennnummer 4 stellig
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
        
    cSatz = "4015" & Chr$(13) & Chr$(10) 'fester Wert 4015
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    'Detaildaten
    
    
    lColBestell = SpaltennummerBESTVOR
    

    
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = MSFlexGrid2.Text
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        If Val(cBestMenge) > 0 Then
            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.Text

            
            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = rsrs!LIBESNR
                Else
                    cLiBesNr = ""
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            cLiBesNr = Trim(cLiBesNr)
            
            ctemp = ""
            If Len(cLiBesNr) < 14 Then
                i = 13 - Len(cLiBesNr)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cLiBesNr = ctemp & cLiBesNr
            Else
                cLiBesNr = Left$(cLiBesNr, 13)
            End If
            
            ctemp = ""
            If Len(cBestMenge) < 5 Then
                i = 4 - Len(cBestMenge)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cBestMenge = ctemp & cBestMenge
            Else
                cBestMenge = Left$(cBestMenge, 4)
            End If
            
            cSatz = "5" & cLiBesNr & cBestMenge
            cSatz = cSatz & Chr$(13) & Chr$(10)
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    Close iFileNr
    
    MsgBox "Datei 'TopCos.TXT' in " & cPfad & " erstellt!", vbInformation, "INFO"
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
    
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "TopCosFormat"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
        
    End If
End Sub
Private Sub Text12_KeyPress(KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cValid = gcNUM & Chr$(8)
    
    cZeichen = Chr$(KeyAscii)
    
    If InStr(cValid, cZeichen) = 0 Then
        KeyAscii = 0
    Else
        KeyAscii = Asc(cZeichen)
    End If

Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text12_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil  Bestellung ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
Private Function ParFormat(cLinr As String) As String
    On Error GoTo LOKAL_ERROR
    
    Dim lRows           As Long
    Dim lCols           As Long
    Dim lColArtNr       As Long
    Dim lColEAN         As Long
    Dim lColBestell     As Long
    Dim lcol            As Long
    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim ctemp           As String
    Dim cSQL            As String
    Dim cFeld           As String
    Dim cArtNr          As String
    Dim cEAN            As String
    Dim cBestMenge      As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    
    ParFormat = ""
    
    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)
    
    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")
    
    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"
    
    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"
    
    ParFormat = ctmp
    
    lRows = MSFlexGrid2.Rows
    lCols = MSFlexGrid2.Cols
    
    lColArtNr = SpaltennummerArtnr
    
    iFileNr = FreeFile
    Open cPfad & "senden.d" For Binary As #iFileNr
    
    'Kopfdaten
    cSatz = "1" & Format(DateValue(Now), "ddmmyy") & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "2" & Trim(sKund) & Chr$(13) & Chr$(10) 'Topcos Kundennummer 4 stellig
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "3" & Trim(sKenn) & Chr$(13) & Chr$(10) 'Topcos Kennnummer 4 stellig
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
        
    cSatz = "4015" & Chr$(13) & Chr$(10) 'fester Wert 4015
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    'Detaildaten
    lColBestell = SpaltennummerBESTVOR
    
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = MSFlexGrid2.Text
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        If Val(cBestMenge) > 0 Then
            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.Text

            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = rsrs!LIBESNR
                Else
                    cLiBesNr = ""
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            cLiBesNr = Trim(cLiBesNr)
            
            ctemp = ""
            If Len(cLiBesNr) < 14 Then
                i = 13 - Len(cLiBesNr)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cLiBesNr = ctemp & cLiBesNr
            Else
                cLiBesNr = Left$(cLiBesNr, 13)
            End If
            
            ctemp = ""
            If Len(cBestMenge) < 5 Then
                i = 4 - Len(cBestMenge)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cBestMenge = ctemp & cBestMenge
            Else
                cBestMenge = Left$(cBestMenge, 4)
            End If
            
            cSatz = "5" & cLiBesNr & cBestMenge
            cSatz = cSatz & Chr$(13) & Chr$(10)
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    Close iFileNr
    
    iFileNr = FreeFile
    Open cPfad & "userinfo.x" For Binary As #iFileNr
    
    'Kopfdaten
    
    cSatz = "Kundennummer=" & Trim(sKund) & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "eMail=" & ermFirmenMail & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "Bestnummer=" & Text12.Text & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
        
    cSatz = "Positionen=" & lbl2(0).Caption
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    Close iFileNr
    
'    MsgBox "Die Datei/en befinden sich in:" & vbCrLf & cPfad, vbInformation, "Winkiss Hinweis:"
    
Exit Function
LOKAL_ERROR:
   
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "ParFormat"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Function
Private Function EsuFormat(cLinr As String) As String
    On Error GoTo LOKAL_ERROR
    
    Dim lRows           As Long
    Dim lCols           As Long
    Dim lColArtNr       As Long
    Dim lColEAN         As Long
    Dim lColBestell     As Long
    Dim lcol            As Long
    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim ctemp           As String
    Dim cSQL            As String
    Dim cFeld           As String
    Dim cArtNr          As String
    Dim cEAN            As String
    Dim cBestMenge      As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    
    EsuFormat = ""
    
    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)
    
    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")
    
    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"
    
    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"
    
    EsuFormat = ctmp
    
    lRows = MSFlexGrid2.Rows
    lCols = MSFlexGrid2.Cols
    
    lColArtNr = SpaltennummerArtnr
    
    iFileNr = FreeFile
    Open cPfad & "senden.d" For Binary As #iFileNr
    
    'Kopfdaten
    cSatz = "1" & Format(DateValue(Now), "ddmmyy") & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "2" & Trim(sKund) & Chr$(13) & Chr$(10) 'Topcos Kundennummer 4 stellig
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "3" & Trim(sKenn) & Chr$(13) & Chr$(10) 'Topcos Kennnummer 4 stellig
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
        
    cSatz = "4015" & Chr$(13) & Chr$(10) 'fester Wert 4015
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    'Detaildaten
    lColBestell = SpaltennummerBESTVOR
    
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = MSFlexGrid2.Text
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        If Val(cBestMenge) > 0 Then
            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.Text

            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = rsrs!LIBESNR
                Else
                    cLiBesNr = ""
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            cLiBesNr = Trim(cLiBesNr)
            
            ctemp = ""
            If Len(cLiBesNr) < 14 Then
                i = 13 - Len(cLiBesNr)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cLiBesNr = ctemp & cLiBesNr
            Else
                cLiBesNr = Left$(cLiBesNr, 13)
            End If
            
            ctemp = ""
            If Len(cBestMenge) < 5 Then
                i = 4 - Len(cBestMenge)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cBestMenge = ctemp & cBestMenge
            Else
                cBestMenge = Left$(cBestMenge, 4)
            End If
            
            cSatz = "5" & cLiBesNr & cBestMenge
            cSatz = cSatz & Chr$(13) & Chr$(10)
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    Close iFileNr
    
    iFileNr = FreeFile
    Open cPfad & "userinfo.x" For Binary As #iFileNr
    
    'Kopfdaten
    
    cSatz = "Kundennummer=" & Trim(sKund) & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "eMail=" & ermFirmenMail & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "Bestnummer=" & Text12.Text & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
        
    cSatz = "Positionen=" & lbl2(0).Caption
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    Close iFileNr
    
'    MsgBox "Die Datei/en befinden sich in:" & vbCrLf & cPfad, vbInformation, "Winkiss Hinweis:"
    
Exit Function
LOKAL_ERROR:
   
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "EsuFormat"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Function

Private Function TabakFormat(cLinr As String) As String
    On Error GoTo LOKAL_ERROR
    
    Dim lRows           As Long
    Dim lCols           As Long
    Dim lColArtNr       As Long
    Dim lFaktor         As Long
    Dim lColBestell     As Long
    Dim lcol            As Long
    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim ctemp           As String
    Dim cSQL            As String
    Dim cFeld           As String
    Dim cArtNr          As String
    Dim cEAN            As String
    Dim cBestMenge      As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    Dim dErg            As Double
    Dim cErg            As String
    Dim lRest           As Long
    Dim cRest           As String
    Dim cPs             As String
    
    Dim cStsatz         As String
    
    TabakFormat = ""
    
    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)
    
    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")
    
    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    While Len(Trim(sKund)) < 4
        sKund = "0" & sKund
    Wend
    
    While Len(Trim(sKenn)) < 6
        sKenn = "0" & sKenn
    Wend

    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"
    
    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"
    
    TabakFormat = ctmp
    
    lRows = MSFlexGrid2.Rows
    lCols = MSFlexGrid2.Cols
    
    lColArtNr = SpaltennummerArtnr
    
    iFileNr = FreeFile
    Open cPfad & "BESTELL.TXT" For Binary As #iFileNr
    
    lWert = DateValue(Fix(Now))
    
    lColBestell = SpaltennummerBESTVOR
    
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = MSFlexGrid2.Text
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        If Val(cBestMenge) > 0 Then
        
            cFeld = Format$(Year(lWert), "0000")
            cFeld = cFeld & Format$(Month(lWert), "00")
            cFeld = cFeld & Format$(Day(lWert), "00")
            cFeld = cFeld & ","
            cFeld = cFeld & Format$(Year(lWert), "0000")
            cFeld = cFeld & Format$(Month(lWert), "00")
            cFeld = cFeld & Format$(Day(lWert + 1), "00")
            cFeld = cFeld & ","
            
            'Sendegerät
            cFeld = cFeld & "99999999,"
            
            'Auftragsnummer
            cFeld = cFeld & Right(Trim(Text12.Text), 4) & ","
            
            'DTV KUNDENNUMMER
            cFeld = cFeld & sKund & ","
            
            'DTV KENNNUMMER
            cFeld = cFeld & sKenn & ","
            
            'Filialnummer zur Zeit nicht genutzt
            cFeld = cFeld & ","
            
            'Bestellung Normal
            cFeld = cFeld & Chr(34) & "BN" & Chr(34) & ","
            
            'Libesnr
            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.Text
            
            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                Else
                    cLiBesNr = "000000"
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            While Len(Trim(cLiBesNr)) < 6
                cLiBesNr = "0" & cLiBesNr
            Wend

            
            cFeld = cFeld & cLiBesNr & ","
            'Libesnr ende
            
            'Preisstufe
            MSFlexGrid2.Col = SpaltennummerNOTIZEN
            cPs = Trim(MSFlexGrid2.Text)
            While Len(Trim(cPs)) < 2
                cPs = "0" & cPs
            Wend
            cFeld = cFeld & cPs & ","
            
            lFaktor = ermfak(cArtNr)
            
            If lFaktor <> 0 Then
            
                dErg = Val(cBestMenge) / lFaktor
                lRest = Val(cBestMenge) - (Fix(dErg) * lFaktor)
                
                cErg = Fix(dErg)
                While Len(Trim(cErg)) < 4
                    cErg = "0" & cErg
                Wend
                
                cRest = lRest
                While Len(Trim(cRest)) < 2
                    cRest = "0" & cRest
                Wend
                
                cFeld = cFeld & cErg & "." & cRest & ","
            Else
            
                While Len(Trim(cBestMenge)) < 4
                    cBestMenge = "0" & cBestMenge
                Wend
                cFeld = cFeld & cBestMenge & ".00,"
            End If
            
            
            cFeld = cFeld & Chr$(13) & Chr$(10)
                        
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cFeld
        End If
    Next lrow

    Close iFileNr
    
    SchreibeBestalsDoc cLinr, cPfad
    
Exit Function
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "TabakFormat"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Function

Private Function StandardFormat(cLinr As String, sAuftragsnr As String, sKUNDNR As String) As String
    On Error GoTo LOKAL_ERROR
    
    Dim lRows               As Long
    Dim lCols               As Long
    Dim lColArtNr           As Long
    Dim lColEAN             As Long
    Dim lColBestell         As Long
    
    Dim lColNaturalrabatt   As Long
    Dim lColProben          As Long
    Dim lColTester          As Long
    
    Dim lcol            As Long
    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim ctemp           As String
    Dim cSQL            As String
    Dim cFeld           As String
    Dim cArtNr          As String
    Dim cEAN            As String
    Dim cBestMenge      As String
    Dim cLiBesNr        As String
    Dim cBezeich        As String
    Dim cKundnr         As String
    Dim cAuftragsnr     As String
    Dim cLieferwunsch   As String
    
    Dim cNaturalrabatt  As String
    Dim cProben         As String
    Dim cTester         As String
    
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim rsrs            As Recordset
    Dim sTime           As String
    Dim ctmp            As String
    
    Dim cStsatz         As String
    
    StandardFormat = ""
    
    sTime = TimeValue(Now)
    sTime = Right(sTime, 8)
    sTime = Left(sTime, 5)
    
    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")
    
    ctmp = ctmp & sTime
    ctmp = SwapStr(ctmp, ".", "")
    ctmp = SwapStr(ctmp, ":", "")
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    VerzVorhanden ctmp, cPfad & "BESTSIC\" & cLinr & "\"
    
    cPfad = cPfad & "BESTSIC\" & cLinr & "\" & ctmp & "\"
    
    StandardFormat = ctmp
    
    lRows = MSFlexGrid2.Rows
    lCols = MSFlexGrid2.Cols
    
    lColArtNr = SpaltennummerArtnr
    
    'Detaildaten
    lColBestell = SpaltennummerBESTVOR
    
    lColEAN = SpaltennummerEAN
    
    lColNaturalrabatt = SpaltennummerBESTVOR_NR
    lColProben = SpaltennummerBESTVOR_PROBEN
    lColTester = SpaltennummerBESTVOR_TESTER
    
    iFileNr = FreeFile
    Open cPfad & "bestell.txt" For Binary As #iFileNr
    gcStsatz = ""
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = MSFlexGrid2.Text
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        If Val(cBestMenge) > 0 Then
            MSFlexGrid2.Col = SpaltennummerBEZEICH
            cBezeich = Trim(MSFlexGrid2.Text)
        
            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.Text
            
            MSFlexGrid2.Col = lColEAN
            cEAN = MSFlexGrid2.Text
            
            If lColNaturalrabatt = 0 Then
                cNaturalrabatt = "0"
            Else
                MSFlexGrid2.Col = lColNaturalrabatt
                cNaturalrabatt = MSFlexGrid2.Text
            End If
            
            If lColProben = 0 Then
                cProben = "0"
            Else
                MSFlexGrid2.Col = lColProben
                cProben = MSFlexGrid2.Text
            End If
            
            If lColTester = 0 Then
                cTester = "0"
            Else
                MSFlexGrid2.Col = lColTester
                cTester = MSFlexGrid2.Text
            End If
            
'            MSFlexGrid2.Col = lColProben
'            cProben = MSFlexGrid2.Text
'
'            MSFlexGrid2.Col = lColTester
'            cTester = MSFlexGrid2.Text

            cSQL = "Select * from ARTLIEF where ARTNR = " & cArtNr & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = rsrs!LIBESNR
                Else
                    cLiBesNr = ""
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            

            cLiBesNr = Trim(cLiBesNr)
            cLiBesNr = cLiBesNr & Space(15 - Len(cLiBesNr))
            
            cEAN = Trim(cEAN)
            cEAN = cEAN & Space(14 - Len(cEAN))
            
            cBezeich = SwapStr(cBezeich, vbTab, "")
            cBezeich = SwapStr(cBezeich, Chr(10), "")
            cBezeich = SwapStr(cBezeich, Chr(13), "")
            
            cBezeich = SwapStr(cBezeich, "          ", " ")
            cBezeich = SwapStr(cBezeich, "         ", " ")
            cBezeich = SwapStr(cBezeich, "        ", " ")
            cBezeich = SwapStr(cBezeich, "       ", " ")
            cBezeich = SwapStr(cBezeich, "      ", " ")
            cBezeich = SwapStr(cBezeich, "     ", " ")
            cBezeich = SwapStr(cBezeich, "    ", " ")
            cBezeich = SwapStr(cBezeich, "   ", " ")
            cBezeich = SwapStr(cBezeich, "  ", " ")
            
            cBezeich = Trim(cBezeich)
            
            cBestMenge = Trim(cBestMenge)
            cBestMenge = cBestMenge & Space(4 - Len(cBestMenge))
            
            cNaturalrabatt = Trim(cNaturalrabatt)
            cNaturalrabatt = cNaturalrabatt & Space(4 - Len(cNaturalrabatt))
            
            cProben = Trim(cProben)
            cProben = cProben & Space(4 - Len(cProben))
            
            cTester = Trim(cTester)
            cTester = cTester & Space(4 - Len(cTester))
            
            cStsatz = cLiBesNr & vbTab
            cStsatz = cStsatz & cEAN & vbTab
            cStsatz = cStsatz & cBezeich & vbCrLf
            
            cStsatz = cStsatz & "Bestellmenge: " & cBestMenge & vbTab
            cStsatz = cStsatz & "NR: " & cNaturalrabatt & vbTab
            cStsatz = cStsatz & "Proben: " & cProben & vbTab
            cStsatz = cStsatz & "Tester: " & cTester & vbCrLf
            
            
            
            
            
            
            
            
            
            ctemp = ""
            If Len(cLiBesNr) < 14 Then
                i = 13 - Len(cLiBesNr)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cLiBesNr = ctemp & cLiBesNr
            Else
                cLiBesNr = Left$(cLiBesNr, 13)
            End If
            
            ctemp = ""
            If Len(cEAN) < 14 Then
                i = 13 - Len(cEAN)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cEAN = ctemp & cEAN
            Else
                cEAN = Left$(cEAN, 13)
            End If
            
            ctemp = ""
            If Len(cBestMenge) < 5 Then
                i = 4 - Len(cBestMenge)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cBestMenge = ctemp & cBestMenge
            Else
                cBestMenge = Left$(cBestMenge, 4)
            End If

            ctemp = ""
            If Len(sKUNDNR) < 11 Then
                i = 10 - Len(sKUNDNR)
                For j = 1 To i
                    ctemp = ctemp & " "
                Next j
                cKundnr = sKUNDNR & ctemp
            Else
                cKundnr = Left$(sKUNDNR, 10)
            End If
            
            ctemp = ""
            If Len(sAuftragsnr) < 11 Then
                i = 10 - Len(sAuftragsnr)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cAuftragsnr = ctemp & sAuftragsnr
            Else
                cAuftragsnr = Left$(sAuftragsnr, 10)
            End If
            
            ctemp = ""
            If Len(cNaturalrabatt) < 5 Then
                i = 4 - Len(cNaturalrabatt)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cNaturalrabatt = ctemp & cNaturalrabatt
            Else
                cNaturalrabatt = Left$(cNaturalrabatt, 4)
            End If
            
            ctemp = ""
            If Len(cProben) < 5 Then
                i = 4 - Len(cProben)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cProben = ctemp & cProben
            Else
                cProben = Left$(cProben, 4)
            End If
            
            ctemp = ""
            If Len(cTester) < 5 Then
                i = 4 - Len(cTester)
                For j = 1 To i
                    ctemp = ctemp & "0"
                Next j
                cTester = ctemp & cTester
            Else
                cTester = Left$(cTester, 4)
            End If
            
             'Lieferwunschtermin
            lWert = DateValue(Now) + 3
            cLieferwunsch = Format$(lWert, "DDMMYY")
            
            
            cSatz = "0000000000000" & cLiBesNr & cEAN & cBestMenge & cKundnr & cAuftragsnr & cLieferwunsch & cNaturalrabatt & cProben & cTester
            cSatz = cSatz & Chr$(13) & Chr$(10)
            
            gcStsatz = gcStsatz & cStsatz & Chr$(13) & Chr$(10)
            
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    Close iFileNr
    
    
    
    
    
    
    
    
    
    
    

    
    
    'hier Satzbeschreibung bestell.txt
    iFileNr = FreeFile
    Open cPfad & "satzbe.txt" For Binary As #iFileNr
    
    'Kopfdaten
    cSatz = "Satzbeschreibung der bestell.txt" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Die bestell.txt wird als ASCII - Textdatei, mit fester Feldlänge ausgegeben." & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "Zeichen  1 - 13 =   0000000000000" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 14 - 26 =   Lieferantenbestellnummer" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 27 - 39 =   EAN" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 40 - 43 =   Bestellmenge" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 44 - 53 =   Kundennummer" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 54 - 63 =   Auftragsnummer" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 64 - 69 =   Lieferwunsch" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 70 - 74 =   Naturalrabatt" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 75 - 78 =   Proben" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Zeichen 79 - 82 =   Tester" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "Jeder Satz wird mit CR und LF abgeschlossen." & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Fragen zur Satzbeschreibung an:" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "K.I.S.S. Warenwirtschaftssysteme GmbH" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Brabeckstr. 167, 30539 Hannover" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Telefon +49 511 95591-0" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Telefax +49 511 95591-44" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Email: hotline@kisswws.de" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "www.kisslive.de" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    Close iFileNr
    
    'Hier noch eine Textdatei tabstopp
    
    If IsDate(Text5.Text) = False Then
        Text5.Text = ""
    End If
    
    iFileNr = FreeFile
    Open cPfad & "tabstopp.txt" For Binary As #iFileNr
    For lrow = 1 To lRows - 1
        MSFlexGrid2.Row = lrow
        MSFlexGrid2.Col = lColBestell
        cBestMenge = Trim$(Str$(Val(MSFlexGrid2.Text)))
        If Val(cBestMenge) > 0 Then
            MSFlexGrid2.Col = lColArtNr
            
            
            
            cLiBesNr = ""
            cSQL = "Select * from ARTLIEF where ARTNR = " & MSFlexGrid2.Text & " and LINR = " & cLinr & " "
            Set rsrs = gdBase.OpenRecordset(cSQL)
            If Not rsrs.EOF Then
                rsrs.MoveFirst
                If Not IsNull(rsrs!LIBESNR) Then
                    cLiBesNr = Trim(rsrs!LIBESNR)
                End If
            End If
            rsrs.Close: Set rsrs = Nothing
            
            MSFlexGrid2.Col = lColEAN
            cEAN = MSFlexGrid2.Text
            
            MSFlexGrid2.Col = lColNaturalrabatt
            cNaturalrabatt = MSFlexGrid2.Text
            
            MSFlexGrid2.Col = lColProben
            cProben = MSFlexGrid2.Text
            
            MSFlexGrid2.Col = lColTester
            cTester = MSFlexGrid2.Text
            
            
            cLiBesNr = cLiBesNr & Space(15 - Len(cLiBesNr))
            cBestMenge = Space(6 - Len(cBestMenge)) & cBestMenge
            cSatz = cLiBesNr & vbTab & cEAN & vbTab & cBestMenge & vbTab & Text5.Text & vbTab & cNaturalrabatt & vbTab & cProben & vbTab & cTester
            cSatz = cSatz & Chr$(13) & Chr$(10)

            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    Close iFileNr
    
    'hier Satzbeschreibung tabstopp.txt
    iFileNr = FreeFile
    Open cPfad & "satzbeII.txt" For Binary As #iFileNr
    
    'Kopfdaten
    cSatz = "Satzbeschreibung der tabstopp.txt" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Die tabstopp.txt wird als ASCII - Textdatei, durch Tabstopps getrennter Felder ausgegeben." & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "1. Feld =   Lieferantenbestellnummer" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "2. Feld =   EAN" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "3. Feld =   Bestellmenge" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "4. Feld =   Lieferdatum" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "5. Feld =   Naturalrabatt" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "6. Feld =   Proben" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "7. Feld =   Tester" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz

    cSatz = "Jeder Satz wird mit CR und LF abgeschlossen." & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Fragen zur Satzbeschreibung an:" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "K.I.S.S. Warenwirtschaftssysteme GmbH" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Brabeckstr. 167, 30539 Hannover" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Telefon +49 511 95591-0" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Telefax +49 511 95591-44" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "Email: hotline@kisswws.de" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    cSatz = "www.kisslive.de" & Chr$(13) & Chr$(10)
    lPos = LOF(iFileNr)
    lPos = lPos + 1
    Put #iFileNr, lPos, cSatz
    
    Close iFileNr
    
    
'    SchreibeBestalsDoc cLinr, cPfad

Exit Function
LOKAL_ERROR:
   
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "StandardFormat"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Function
Private Sub ProcterFormat()
    On Error GoTo LOKAL_ERROR
    
    Dim lRows           As Long
    Dim lCols           As Long
    Dim lcol            As Long
    Dim lrow            As Long
    Dim lPos            As Long
    Dim lWert           As Long
    Dim cSatz           As String
    Dim ctemp           As String
    Dim cSQL            As String
    Dim cFeld           As String
    Dim cArtNr          As String
    Dim cLinr           As String
    Dim cEAN            As String
    Dim cBestMenge      As String
    Dim cLiBesNr        As String
    Dim cPfad           As String
    Dim iFileNr         As Integer
    Dim i               As Integer
    Dim j               As Integer
    Dim rsrs            As Recordset
    
   
    Dim cdatei As String
    Dim ctmp As String
    
    cPfad = gcDBPfad    'Datenbankpfad
    If Right$(cPfad, 1) <> "\" Then
        cPfad = cPfad & "\"
    End If
    
    cPfad = cPfad & "BESTELL\"
    cPfad = UCase$(cPfad)
    
    
    lWert = DateValue(Now)
    ctmp = Format$(lWert, "DD.MM")
    
    cdatei = "B" & ctmp & Format$(TimeValue(Now), "HH:MM")
    cdatei = SwapStr(cdatei, ".", "")
    cdatei = SwapStr(cdatei, ":", "")

    Kill cPfad & cdatei & ".csv"
    
    iFileNr = FreeFile
    Open cPfad & cdatei & ".csv" For Binary As #iFileNr
    
  
    'Detaildaten
    lRows = MSFlexGrid2.Rows
    
    Dim lfakt As Long
    Dim lbestmeng As Long
    Dim lBest   As Long
    Dim cBest       As String

    For lrow = 1 To lRows - 1
        cEAN = MSFlexGrid2.TextMatrix(lrow, SpaltennummerEAN)
        cBestMenge = MSFlexGrid2.TextMatrix(lrow, SpaltennummerBESTVOR)
        cBestMenge = Trim$(Str$(Val(cBestMenge)))
        lbestmeng = CLng(cBestMenge)
        
        If Val(cBestMenge) > 0 Then
'            MSFlexGrid2.Col = lColArtNr
            cArtNr = MSFlexGrid2.TextMatrix(lrow, SpaltennummerArtnr)
            lfakt = ermfak(cArtNr)
            
            If lfakt = 0 Then
            
                cLiBesNr = cEAN
                lBest = lbestmeng
                cBest = Trim(lBest)
                
            Else
                cLiBesNr = ermgpEAN1(cArtNr)
                
                lBest = lbestmeng / lfakt
        
                cBest = Trim(lBest)
            End If
            
            cSatz = "line;" & cLiBesNr & ";" & cBest & ";"
            cSatz = cSatz & Chr$(13) & Chr$(10)
            lPos = LOF(iFileNr)
            lPos = lPos + 1
            Put #iFileNr, lPos, cSatz
        End If
    Next lrow
    
    Close iFileNr
    MsgBox "Datei " & cdatei & ".csv in " & cPfad & " erstellt!", vbInformation, "Winkiss Hinweis:"
    
Exit Sub
LOKAL_ERROR:
    If err.Number = 53 Then
        Resume Next
    Else
        Fehler.gsDescr = err.Description
        Fehler.gsNumber = err.Number
        Fehler.gsFormular = Me.name
        Fehler.gsFunktion = "ProcterFormat"
        Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
        
        Fehlermeldung1
    End If
End Sub
Private Sub BerechneBestellwertZENac()
    On Error GoTo LOKAL_ERROR
    
    Dim cSQL            As String
    Dim dAnz            As Double
    Dim dBestellwert    As Double
    Dim rsrs            As Recordset
    
    cSQL = "Select SUM(BESTVOR) as MENGE, SUM(LEKPR * BESTVOR) as WERT from VORSCHLZ"
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        If Not IsNull(rsrs!Menge) Then
            dAnz = rsrs!Menge
        Else
            dAnz = 0
        End If
        
        If Not IsNull(rsrs!Wert) Then
            dBestellwert = rsrs!Wert
        Else
            dBestellwert = 0
        End If
    Else
        dAnz = 0
        dBestellwert = 0
    End If
    rsrs.Close: Set rsrs = Nothing
    
    lbl2(0).Caption = Format$(dAnz, "###,##0")
    lbl2(1).Caption = Format$(dBestellwert, "###,##0.00")
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "BerechneBestellwertZENac"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
    
End Sub
Private Sub cmdMittSave_Click()
    On Error GoTo LOKAL_ERROR
    
    If Text11.Text = "" Then
        Text11.Text = Left(txt2.Text, 35)
        Text11.Text = SwapStr(Text11.Text, Chr(10), "")
        Text11.Text = SwapStr(Text11.Text, Chr(13), "")
        Text11.Text = SwapStr(Text11.Text, "'", " ")
    End If
    
    Speicherblock "BESTELLUNG", txt2.Text, Text11.Text
    ZeigeblockinList "BESTELLUNG", List5
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdMittSave_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
    
    
End Sub
Private Function fnPruefeBestellVorgabeZENac(cBezeich As String) As Long
    On Error GoTo LOKAL_ERROR
    
    Dim lMinMen     As Long
    Dim lBestVor    As Long
    Dim cSQL        As String
    Dim rsrs        As Recordset
    
    fnPruefeBestellVorgabeZENac = 0
    
    cSQL = "Select ARTNR, BEZEICH, BESTVOR, MINMEN from VORSCHLZ where BESTVOR <> 0"
    Set rsrs = gdApp.OpenRecordset(cSQL)
    If Not rsrs.EOF Then
        rsrs.MoveFirst
        Do While Not rsrs.EOF
            If Not IsNull(rsrs!BESTVOR) Then
                lBestVor = rsrs!BESTVOR
            Else
                lBestVor = 0
            End If
            
            If Not IsNull(rsrs!MINMEN) Then
                lMinMen = rsrs!MINMEN
            Else
                lMinMen = 0
            End If
            
            If lMinMen <> 0 Then
                If Fix(lBestVor / lMinMen) <> (lBestVor / lMinMen) Then
                    If Not IsNull(rsrs!artnr) Then
                        fnPruefeBestellVorgabeZENac = rsrs!artnr
                    Else
                        fnPruefeBestellVorgabeZENac = -1
                    End If
                    If Not IsNull(rsrs!BEZEICH) Then
                        cBezeich = rsrs!BEZEICH
                    Else
                        cBezeich = "UNBEKANNT"
                    End If
                    Exit Function
                End If
            Else
            
                If Not IsNull(rsrs!artnr) Then
                    fnPruefeBestellVorgabeZENac = rsrs!artnr
                Else
                    fnPruefeBestellVorgabeZENac = -1
                End If
                
                If Not IsNull(rsrs!BEZEICH) Then
                    cBezeich = rsrs!BEZEICH
                Else
                    cBezeich = "UNBEKANNT"
                End If
                Exit Function
            
            
            End If
            rsrs.MoveNext
        Loop
    End If
    rsrs.Close: Set rsrs = Nothing
    
Exit Function
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "fnPruefeBestellVorgabeZENac"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
    
End Function
Private Sub cmdAnfuegen_Click(index As Integer)
    On Error GoTo LOKAL_ERROR
    Screen.MousePointer = 11
    
    Select Case index
        Case Is = 0

           
            artikel_suchen
            
            If List2.ListCount = 1 Then
                ArtikelAnfuegenWKL43
            End If
            
            
            
        Case Is = 1
            fraArtAnfuegen.Visible = False
        Case Is = 2
            ArtikelAnfuegenWKL43
    End Select
    Screen.MousePointer = 0
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "cmdAnfuegen_Click"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text6_KeyPress(KeyAscii As Integer)
On Error GoTo LOKAL_ERROR
    
    Dim cZeichen As String
    Dim cValid As String
    
    cZeichen = Chr$(KeyAscii)
    cZeichen = UCase$(cZeichen)
    KeyAscii = Asc(cZeichen)
    
    
    cValid = "1234567890" & Chr$(8)
    If InStr(cValid, cZeichen) = 0 Then
        KeyAscii = 0
    End If
       
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text6_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text8_KeyPress(KeyAscii As Integer)
    On Error GoTo LOKAL_ERROR
    
    Dim cZeichen    As String
    Dim bSpringen   As Boolean
    
    cZeichen = Chr$(KeyAscii)
    cZeichen = UCase$(cZeichen)
    KeyAscii = Asc(cZeichen)
    
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_KeyPress"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text8_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyReturn Then
        cmdAnfuegen_Click 0
    Else
    
        If Label6(1).Caption = "1" Then
            artikel_suchen 'WKL43
        End If
        Text8.SetFocus
    End If
Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text8_GotFocus()
On Error GoTo LOKAL_ERROR
    
    Text8.BackColor = glSelBack1
    sMerke_Focus = "Text8"
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text8_LostFocus()
On Error GoTo LOKAL_ERROR
    
    Text8.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text8_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text6_GotFocus()
On Error GoTo LOKAL_ERROR
    
    Text6.BackColor = glSelBack1
    sMerke_Focus = "Text6"
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text6_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text6_LostFocus()
On Error GoTo LOKAL_ERROR
    
    Text6.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text6_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text7_GotFocus()
On Error GoTo LOKAL_ERROR
    
    Text7.BackColor = glSelBack1
    sMerke_Focus = "Text7"
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text7_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text7_LostFocus()
On Error GoTo LOKAL_ERROR
    
    Text7.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text7_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text2_GotFocus()
On Error GoTo LOKAL_ERROR
    
    Text2.BackColor = glSelBack1
    sMerke_Focus = "Text2"
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text2_GotFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text2_LostFocus()
On Error GoTo LOKAL_ERROR
    
    Text2.BackColor = vbWhite
    
    Exit Sub
LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text2_LostFocus"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub
Private Sub Text9_KeyUp(KeyCode As Integer, Shift As Integer)
On Error GoTo LOKAL_ERROR
    
    If KeyCode = vbKeyReturn Then
        SSCommand2_Click 3
    End If
    
Exit Sub
LOKAL_ERROR:

    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "Text9_KeyUp"
    Fehler.gsFehlertext = "Im Programmteil Bestellungen ist ein Fehler aufgetreten. "
    
    Fehlermeldung1
End Sub

Private Sub txtStatus_Change()
On Error GoTo LOKAL_ERROR
    
    Dim nProz As Long
  
    nProz = Val(txtStatus.Text)
    ShowProgress picprogress, nProz, 0, 100, True
    picprogress.Refresh

Exit Sub

LOKAL_ERROR:
    Fehler.gsDescr = err.Description
    Fehler.gsNumber = err.Number
    Fehler.gsFormular = Me.name
    Fehler.gsFunktion = "txtstatus_Change"
    Fehler.gsFehlertext = "Es ist ein Fehler aufgetreten."
    
    Fehlermeldung1
End Sub
